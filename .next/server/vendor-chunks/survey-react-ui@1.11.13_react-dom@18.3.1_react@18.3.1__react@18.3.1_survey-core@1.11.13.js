/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/survey-react-ui@1.11.13_react-dom@18.3.1_react@18.3.1__react@18.3.1_survey-core@1.11.13";
exports.ids = ["vendor-chunks/survey-react-ui@1.11.13_react-dom@18.3.1_react@18.3.1__react@18.3.1_survey-core@1.11.13"];
exports.modules = {

/***/ "(ssr)/./node_modules/.pnpm/survey-react-ui@1.11.13_react-dom@18.3.1_react@18.3.1__react@18.3.1_survey-core@1.11.13/node_modules/survey-react-ui/survey-react-ui.js":
/*!********************************************************************************************************************************************************************!*\
  !*** ./node_modules/.pnpm/survey-react-ui@1.11.13_react-dom@18.3.1_react@18.3.1__react@18.3.1_survey-core@1.11.13/node_modules/survey-react-ui/survey-react-ui.js ***!
  \********************************************************************************************************************************************************************/
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {

eval("/*!\n * surveyjs - Survey JavaScript library v1.11.13\n * Copyright (c) 2015-2024 Devsoft Baltic OÃœ  - http://surveyjs.io/\n * License: MIT (http://www.opensource.org/licenses/mit-license.php)\n */\n(function webpackUniversalModuleDefinition(root, factory) {\n\tif(true)\n\t\tmodule.exports = factory(__webpack_require__(/*! react */ \"(ssr)/./node_modules/.pnpm/next@14.2.7_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react.js\"), __webpack_require__(/*! react-dom */ \"(ssr)/./node_modules/.pnpm/next@14.2.7_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/server/future/route-modules/app-page/vendored/ssr/react-dom.js\"), __webpack_require__(/*! survey-core */ \"(ssr)/./node_modules/.pnpm/survey-core@1.11.13/node_modules/survey-core/survey.core.js\"));\n\telse {}\n})(this, function(__WEBPACK_EXTERNAL_MODULE_react__, __WEBPACK_EXTERNAL_MODULE_react_dom__, __WEBPACK_EXTERNAL_MODULE_survey_core__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __nested_webpack_require_1081__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __nested_webpack_require_1081__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__nested_webpack_require_1081__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__nested_webpack_require_1081__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__nested_webpack_require_1081__.d = function(exports, name, getter) {\n/******/ \t\tif(!__nested_webpack_require_1081__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__nested_webpack_require_1081__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__nested_webpack_require_1081__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __nested_webpack_require_1081__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__nested_webpack_require_1081__.r(ns);\n/******/ \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __nested_webpack_require_1081__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__nested_webpack_require_1081__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__nested_webpack_require_1081__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__nested_webpack_require_1081__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__nested_webpack_require_1081__.p = \"\";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __nested_webpack_require_1081__(__nested_webpack_require_1081__.s = \"./src/entries/react-ui.ts\");\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ \"./src/entries/react-ui.ts\":\n/*!**********************************************!*\\\n  !*** ./src/entries/react-ui.ts + 95 modules ***!\n  \\**********************************************/\n/*! exports provided: Survey, attachKey2click, ReactSurveyElementsWrapper, SurveyNavigationBase, SurveyTimerPanel, SurveyPage, SurveyRow, SurveyPanel, SurveyFlowPanel, SurveyQuestion, SurveyElementErrors, SurveyQuestionAndErrorsCell, ReactSurveyElement, SurveyElementBase, SurveyQuestionElementBase, SurveyQuestionCommentItem, SurveyQuestionComment, SurveyQuestionCheckbox, SurveyQuestionCheckboxItem, SurveyQuestionRanking, SurveyQuestionRankingItem, SurveyQuestionRankingItemContent, RatingItem, RatingItemStar, RatingItemSmiley, RatingDropdownItem, TagboxFilterString, SurveyQuestionOptionItem, SurveyQuestionDropdownBase, SurveyQuestionDropdown, SurveyQuestionTagboxItem, SurveyQuestionTagbox, SurveyQuestionDropdownSelect, SurveyQuestionMatrix, SurveyQuestionMatrixRow, SurveyQuestionMatrixCell, SurveyQuestionHtml, SurveyQuestionFile, SurveyFileChooseButton, SurveyFilePreview, SurveyQuestionMultipleText, SurveyQuestionRadiogroup, SurveyQuestionRadioItem, SurveyQuestionText, SurveyQuestionBoolean, SurveyQuestionBooleanCheckbox, SurveyQuestionBooleanRadio, SurveyQuestionEmpty, SurveyQuestionMatrixDropdownCell, SurveyQuestionMatrixDropdownBase, SurveyQuestionMatrixDropdown, SurveyQuestionMatrixDynamic, SurveyQuestionMatrixDynamicAddButton, SurveyQuestionPanelDynamic, SurveyProgress, SurveyProgressButtons, SurveyProgressToc, SurveyQuestionRating, SurveyQuestionRatingDropdown, SurveyQuestionExpression, PopupSurvey, SurveyWindow, ReactQuestionFactory, ReactElementFactory, SurveyQuestionImagePicker, SurveyQuestionImage, SurveyQuestionSignaturePad, SurveyQuestionButtonGroup, SurveyQuestionCustom, SurveyQuestionComposite, Popup, ListItemContent, ListItemGroup, List, TitleActions, TitleElement, SurveyActionBar, LogoImage, SurveyHeader, SvgIcon, SurveyQuestionMatrixDynamicRemoveButton, SurveyQuestionMatrixDetailButton, SurveyQuestionMatrixDynamicDragDropIcon, SurveyQuestionPanelDynamicAddButton, SurveyQuestionPanelDynamicRemoveButton, SurveyQuestionPanelDynamicPrevButton, SurveyQuestionPanelDynamicNextButton, SurveyQuestionPanelDynamicProgressText, SurveyNavigationButton, QuestionErrorComponent, MatrixRow, Skeleton, NotifierComponent, ComponentsContainer, CharacterCounterComponent, HeaderMobile, HeaderCell, Header, SurveyLocStringViewer, SurveyLocStringEditor, LoadingIndicatorComponent, SvgBundleComponent, SurveyModel, SurveyWindowModel, Model, settings, surveyLocalization, surveyStrings */\n/*! ModuleConcatenation bailout: Cannot concat with external {\"root\":\"React\",\"commonjs2\":\"react\",\"commonjs\":\"react\",\"amd\":\"react\"} (<- Module is not an ECMAScript module) */\n/*! ModuleConcatenation bailout: Cannot concat with external {\"root\":\"ReactDOM\",\"commonjs2\":\"react-dom\",\"commonjs\":\"react-dom\",\"amd\":\"react-dom\"} (<- Module is not an ECMAScript module) */\n/*! ModuleConcatenation bailout: Cannot concat with external {\"root\":\"Survey\",\"commonjs2\":\"survey-core\",\"commonjs\":\"survey-core\",\"amd\":\"survey-core\"} (<- Module is not an ECMAScript module) */\n/***/ (function(module, __nested_webpack_exports__, __nested_webpack_require_7739__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__nested_webpack_require_7739__.r(__nested_webpack_exports__);\n\n// EXPORTS\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"Survey\", function() { return /* reexport */ reactSurvey_Survey; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"attachKey2click\", function() { return /* reexport */ attachKey2click; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"ReactSurveyElementsWrapper\", function() { return /* reexport */ reactsurveymodel_ReactSurveyElementsWrapper; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyNavigationBase\", function() { return /* reexport */ SurveyNavigationBase; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyTimerPanel\", function() { return /* reexport */ reacttimerpanel_SurveyTimerPanel; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyPage\", function() { return /* reexport */ page_SurveyPage; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyRow\", function() { return /* reexport */ row_SurveyRow; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyPanel\", function() { return /* reexport */ panel_SurveyPanel; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyFlowPanel\", function() { return /* reexport */ flow_panel_SurveyFlowPanel; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestion\", function() { return /* reexport */ reactquestion_SurveyQuestion; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyElementErrors\", function() { return /* reexport */ reactquestion_SurveyElementErrors; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionAndErrorsCell\", function() { return /* reexport */ reactquestion_SurveyQuestionAndErrorsCell; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"ReactSurveyElement\", function() { return /* reexport */ ReactSurveyElement; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyElementBase\", function() { return /* reexport */ reactquestion_element_SurveyElementBase; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionElementBase\", function() { return /* reexport */ reactquestion_element_SurveyQuestionElementBase; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionCommentItem\", function() { return /* reexport */ reactquestion_comment_SurveyQuestionCommentItem; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionComment\", function() { return /* reexport */ reactquestion_comment_SurveyQuestionComment; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionCheckbox\", function() { return /* reexport */ reactquestion_checkbox_SurveyQuestionCheckbox; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionCheckboxItem\", function() { return /* reexport */ reactquestion_checkbox_SurveyQuestionCheckboxItem; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionRanking\", function() { return /* reexport */ reactquestion_ranking_SurveyQuestionRanking; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionRankingItem\", function() { return /* reexport */ reactquestion_ranking_SurveyQuestionRankingItem; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionRankingItemContent\", function() { return /* reexport */ reactquestion_ranking_SurveyQuestionRankingItemContent; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"RatingItem\", function() { return /* reexport */ rating_item_RatingItem; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"RatingItemStar\", function() { return /* reexport */ rating_item_star_RatingItemStar; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"RatingItemSmiley\", function() { return /* reexport */ rating_item_smiley_RatingItemSmiley; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"RatingDropdownItem\", function() { return /* reexport */ rating_dropdown_item_RatingDropdownItem; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"TagboxFilterString\", function() { return /* reexport */ tagbox_filter_TagboxFilterString; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionOptionItem\", function() { return /* reexport */ dropdown_item_SurveyQuestionOptionItem; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionDropdownBase\", function() { return /* reexport */ dropdown_base_SurveyQuestionDropdownBase; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionDropdown\", function() { return /* reexport */ reactquestion_dropdown_SurveyQuestionDropdown; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionTagboxItem\", function() { return /* reexport */ tagbox_item_SurveyQuestionTagboxItem; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionTagbox\", function() { return /* reexport */ reactquestion_tagbox_SurveyQuestionTagbox; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionDropdownSelect\", function() { return /* reexport */ dropdown_select_SurveyQuestionDropdownSelect; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionMatrix\", function() { return /* reexport */ reactquestion_matrix_SurveyQuestionMatrix; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionMatrixRow\", function() { return /* reexport */ reactquestion_matrix_SurveyQuestionMatrixRow; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionMatrixCell\", function() { return /* reexport */ reactquestion_matrix_SurveyQuestionMatrixCell; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionHtml\", function() { return /* reexport */ reactquestion_html_SurveyQuestionHtml; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionFile\", function() { return /* reexport */ reactquestion_file_SurveyQuestionFile; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyFileChooseButton\", function() { return /* reexport */ file_choose_button_SurveyFileChooseButton; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyFilePreview\", function() { return /* reexport */ file_preview_SurveyFilePreview; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionMultipleText\", function() { return /* reexport */ reactquestion_multipletext_SurveyQuestionMultipleText; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionRadiogroup\", function() { return /* reexport */ reactquestion_radiogroup_SurveyQuestionRadiogroup; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionRadioItem\", function() { return /* reexport */ reactquestion_radiogroup_SurveyQuestionRadioItem; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionText\", function() { return /* reexport */ reactquestion_text_SurveyQuestionText; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionBoolean\", function() { return /* reexport */ boolean_SurveyQuestionBoolean; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionBooleanCheckbox\", function() { return /* reexport */ boolean_checkbox_SurveyQuestionBooleanCheckbox; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionBooleanRadio\", function() { return /* reexport */ boolean_radio_SurveyQuestionBooleanRadio; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionEmpty\", function() { return /* reexport */ reactquestion_empty_SurveyQuestionEmpty; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionMatrixDropdownCell\", function() { return /* reexport */ reactquestion_matrixdropdownbase_SurveyQuestionMatrixDropdownCell; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionMatrixDropdownBase\", function() { return /* reexport */ reactquestion_matrixdropdownbase_SurveyQuestionMatrixDropdownBase; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionMatrixDropdown\", function() { return /* reexport */ SurveyQuestionMatrixDropdown; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionMatrixDynamic\", function() { return /* reexport */ reactquestion_matrixdynamic_SurveyQuestionMatrixDynamic; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionMatrixDynamicAddButton\", function() { return /* reexport */ reactquestion_matrixdynamic_SurveyQuestionMatrixDynamicAddButton; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionPanelDynamic\", function() { return /* reexport */ reactquestion_paneldynamic_SurveyQuestionPanelDynamic; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyProgress\", function() { return /* reexport */ progress_SurveyProgress; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyProgressButtons\", function() { return /* reexport */ progressButtons_SurveyProgressButtons; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyProgressToc\", function() { return /* reexport */ progressToc_SurveyProgressToc; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionRating\", function() { return /* reexport */ reactquestion_rating_SurveyQuestionRating; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionRatingDropdown\", function() { return /* reexport */ rating_dropdown_SurveyQuestionRatingDropdown; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionExpression\", function() { return /* reexport */ reactquestion_expression_SurveyQuestionExpression; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"PopupSurvey\", function() { return /* reexport */ react_popup_survey_PopupSurvey; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyWindow\", function() { return /* reexport */ SurveyWindow; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"ReactQuestionFactory\", function() { return /* reexport */ ReactQuestionFactory; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"ReactElementFactory\", function() { return /* reexport */ ReactElementFactory; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionImagePicker\", function() { return /* reexport */ imagepicker_SurveyQuestionImagePicker; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionImage\", function() { return /* reexport */ image_SurveyQuestionImage; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionSignaturePad\", function() { return /* reexport */ signaturepad_SurveyQuestionSignaturePad; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionButtonGroup\", function() { return /* reexport */ reactquestion_buttongroup_SurveyQuestionButtonGroup; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionCustom\", function() { return /* reexport */ reactquestion_custom_SurveyQuestionCustom; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionComposite\", function() { return /* reexport */ reactquestion_custom_SurveyQuestionComposite; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"Popup\", function() { return /* reexport */ popup_Popup; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"ListItemContent\", function() { return /* reexport */ list_item_content_ListItemContent; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"ListItemGroup\", function() { return /* reexport */ list_item_group_ListItemGroup; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"List\", function() { return /* reexport */ list_List; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"TitleActions\", function() { return /* reexport */ title_actions_TitleActions; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"TitleElement\", function() { return /* reexport */ title_element_TitleElement; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyActionBar\", function() { return /* reexport */ action_bar_SurveyActionBar; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"LogoImage\", function() { return /* reexport */ logo_image_LogoImage; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyHeader\", function() { return /* reexport */ survey_header_SurveyHeader; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SvgIcon\", function() { return /* reexport */ svg_icon_SvgIcon; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionMatrixDynamicRemoveButton\", function() { return /* reexport */ remove_button_SurveyQuestionMatrixDynamicRemoveButton; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionMatrixDetailButton\", function() { return /* reexport */ detail_button_SurveyQuestionMatrixDetailButton; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionMatrixDynamicDragDropIcon\", function() { return /* reexport */ drag_drop_icon_SurveyQuestionMatrixDynamicDragDropIcon; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionPanelDynamicAddButton\", function() { return /* reexport */ paneldynamic_add_btn_SurveyQuestionPanelDynamicAddButton; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionPanelDynamicRemoveButton\", function() { return /* reexport */ paneldynamic_remove_btn_SurveyQuestionPanelDynamicRemoveButton; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionPanelDynamicPrevButton\", function() { return /* reexport */ paneldynamic_prev_btn_SurveyQuestionPanelDynamicPrevButton; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionPanelDynamicNextButton\", function() { return /* reexport */ paneldynamic_next_btn_SurveyQuestionPanelDynamicNextButton; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyQuestionPanelDynamicProgressText\", function() { return /* reexport */ paneldynamic_progress_text_SurveyQuestionPanelDynamicProgressText; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyNavigationButton\", function() { return /* reexport */ survey_nav_button_SurveyNavigationButton; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"QuestionErrorComponent\", function() { return /* reexport */ question_error_QuestionErrorComponent; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"MatrixRow\", function() { return /* reexport */ row_MatrixRow; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"Skeleton\", function() { return /* reexport */ skeleton_Skeleton; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"NotifierComponent\", function() { return /* reexport */ notifier_NotifierComponent; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"ComponentsContainer\", function() { return /* reexport */ components_container_ComponentsContainer; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"CharacterCounterComponent\", function() { return /* reexport */ character_counter_CharacterCounterComponent; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"HeaderMobile\", function() { return /* reexport */ header_HeaderMobile; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"HeaderCell\", function() { return /* reexport */ header_HeaderCell; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"Header\", function() { return /* reexport */ header_Header; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyLocStringViewer\", function() { return /* reexport */ string_viewer_SurveyLocStringViewer; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyLocStringEditor\", function() { return /* reexport */ string_editor_SurveyLocStringEditor; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"LoadingIndicatorComponent\", function() { return /* reexport */ loading_indicator_LoadingIndicatorComponent; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SvgBundleComponent\", function() { return /* reexport */ svgbundle_SvgBundleComponent; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyModel\", function() { return /* reexport */ external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"SurveyModel\"]; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"SurveyWindowModel\", function() { return /* reexport */ external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"SurveyWindowModel\"]; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"Model\", function() { return /* reexport */ external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"SurveyModel\"]; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"settings\", function() { return /* reexport */ external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"settings\"]; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"surveyLocalization\", function() { return /* reexport */ external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"surveyLocalization\"]; });\n__nested_webpack_require_7739__.d(__nested_webpack_exports__, \"surveyStrings\", function() { return /* reexport */ external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"surveyStrings\"]; });\n\n// EXTERNAL MODULE: external {\"root\":\"Survey\",\"commonjs2\":\"survey-core\",\"commonjs\":\"survey-core\",\"amd\":\"survey-core\"}\nvar external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_ = __nested_webpack_require_7739__(\"survey-core\");\n\n// EXTERNAL MODULE: external {\"root\":\"React\",\"commonjs2\":\"react\",\"commonjs\":\"react\",\"amd\":\"react\"}\nvar external_root_React_commonjs2_react_commonjs_react_amd_react_ = __nested_webpack_require_7739__(\"react\");\nvar external_root_React_commonjs2_react_commonjs_react_amd_react_default = /*#__PURE__*/__nested_webpack_require_7739__.n(external_root_React_commonjs2_react_commonjs_react_amd_react_);\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/element-factory.tsx\nvar ReactElementFactory = /** @class */ (function () {\n    function ReactElementFactory() {\n        this.creatorHash = {};\n    }\n    ReactElementFactory.prototype.registerElement = function (elementType, elementCreator) {\n        this.creatorHash[elementType] = elementCreator;\n    };\n    ReactElementFactory.prototype.getAllTypes = function () {\n        var result = new Array();\n        for (var key in this.creatorHash) {\n            result.push(key);\n        }\n        return result.sort();\n    };\n    ReactElementFactory.prototype.isElementRegistered = function (elementType) {\n        return !!this.creatorHash[elementType];\n    };\n    ReactElementFactory.prototype.createElement = function (elementType, params) {\n        var creator = this.creatorHash[elementType];\n        if (creator == null)\n            return null;\n        return creator(params);\n    };\n    ReactElementFactory.Instance = new ReactElementFactory();\n    return ReactElementFactory;\n}());\n\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactsurveymodel.tsx\n\n\nvar reactsurveymodel_ReactSurveyElementsWrapper = /** @class */ (function () {\n    function ReactSurveyElementsWrapper() {\n    }\n    ReactSurveyElementsWrapper.wrapRow = function (survey, element, row) {\n        var componentName = survey.getRowWrapperComponentName(row);\n        var componentData = survey.getRowWrapperComponentData(row);\n        return ReactElementFactory.Instance.createElement(componentName, {\n            element: element,\n            row: row,\n            componentData: componentData,\n        });\n    };\n    ReactSurveyElementsWrapper.wrapElement = function (survey, element, question) {\n        var componentName = survey.getElementWrapperComponentName(question);\n        var componentData = survey.getElementWrapperComponentData(question);\n        return ReactElementFactory.Instance.createElement(componentName, {\n            element: element,\n            question: question,\n            componentData: componentData,\n        });\n    };\n    ReactSurveyElementsWrapper.wrapQuestionContent = function (survey, element, question) {\n        var componentName = survey.getQuestionContentWrapperComponentName(question);\n        var componentData = survey.getElementWrapperComponentData(question);\n        return ReactElementFactory.Instance.createElement(componentName, {\n            element: element,\n            question: question,\n            componentData: componentData,\n        });\n    };\n    ReactSurveyElementsWrapper.wrapItemValue = function (survey, element, question, item) {\n        var componentName = survey.getItemValueWrapperComponentName(item, question);\n        var componentData = survey.getItemValueWrapperComponentData(item, question);\n        return ReactElementFactory.Instance.createElement(componentName, {\n            key: element === null || element === void 0 ? void 0 : element.key,\n            element: element,\n            question: question,\n            item: item,\n            componentData: componentData,\n        });\n    };\n    ReactSurveyElementsWrapper.wrapMatrixCell = function (survey, element, cell, reason) {\n        if (reason === void 0) { reason = \"cell\"; }\n        var componentName = survey.getElementWrapperComponentName(cell, reason);\n        var componentData = survey.getElementWrapperComponentData(cell, reason);\n        return ReactElementFactory.Instance.createElement(componentName, {\n            element: element,\n            cell: cell,\n            componentData: componentData,\n        });\n    };\n    return ReactSurveyElementsWrapper;\n}());\n\nexternal_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"SurveyModel\"].platform = \"react\";\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion_element.tsx\nvar __extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\nvar reactquestion_element_SurveyElementBase = /** @class */ (function (_super) {\n    __extends(SurveyElementBase, _super);\n    function SurveyElementBase(props) {\n        var _this = _super.call(this, props) || this;\n        _this._allowComponentUpdate = true;\n        return _this;\n    }\n    SurveyElementBase.renderLocString = function (locStr, style, key) {\n        if (style === void 0) { style = null; }\n        return ReactElementFactory.Instance.createElement(locStr.renderAs, {\n            locStr: locStr.renderAsData,\n            style: style,\n            key: key,\n        });\n    };\n    SurveyElementBase.renderQuestionDescription = function (question) {\n        var descriptionText = SurveyElementBase.renderLocString(question.locDescription);\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { style: question.hasDescription ? undefined : { display: \"none\" }, id: question.ariaDescriptionId, className: question.cssDescription }, descriptionText);\n    };\n    SurveyElementBase.prototype.componentDidMount = function () {\n        this.makeBaseElementsReact();\n    };\n    SurveyElementBase.prototype.componentWillUnmount = function () {\n        this.unMakeBaseElementsReact();\n    };\n    SurveyElementBase.prototype.componentDidUpdate = function (prevProps, prevState) {\n        this.makeBaseElementsReact();\n        this.getStateElements().forEach(function (el) {\n            el.afterRerender();\n        });\n    };\n    SurveyElementBase.prototype.allowComponentUpdate = function () {\n        this._allowComponentUpdate = true;\n        this.forceUpdate();\n    };\n    SurveyElementBase.prototype.denyComponentUpdate = function () {\n        this._allowComponentUpdate = false;\n    };\n    SurveyElementBase.prototype.shouldComponentUpdate = function (nextProps, nextState) {\n        if (this._allowComponentUpdate) {\n            this.unMakeBaseElementsReact();\n        }\n        return this._allowComponentUpdate;\n    };\n    SurveyElementBase.prototype.render = function () {\n        if (!this.canRender()) {\n            return null;\n        }\n        this.startEndRendering(1);\n        var res = this.renderElement();\n        this.startEndRendering(-1);\n        if (!!res) {\n            res = this.wrapElement(res);\n        }\n        this.changedStatePropNameValue = undefined;\n        return res;\n    };\n    SurveyElementBase.prototype.wrapElement = function (element) {\n        return element;\n    };\n    Object.defineProperty(SurveyElementBase.prototype, \"isRendering\", {\n        get: function () {\n            var stateEls = this.getRenderedElements();\n            for (var _i = 0, stateEls_1 = stateEls; _i < stateEls_1.length; _i++) {\n                var stateEl = stateEls_1[_i];\n                if (stateEl.reactRendering > 0)\n                    return true;\n            }\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyElementBase.prototype.getRenderedElements = function () {\n        return this.getStateElements();\n    };\n    SurveyElementBase.prototype.startEndRendering = function (val) {\n        var stateEls = this.getRenderedElements();\n        for (var _i = 0, stateEls_2 = stateEls; _i < stateEls_2.length; _i++) {\n            var stateEl = stateEls_2[_i];\n            if (!stateEl.reactRendering)\n                stateEl.reactRendering = 0;\n            stateEl.reactRendering += val;\n        }\n    };\n    SurveyElementBase.prototype.canRender = function () {\n        return true;\n    };\n    SurveyElementBase.prototype.renderElement = function () {\n        return null;\n    };\n    Object.defineProperty(SurveyElementBase.prototype, \"changedStatePropName\", {\n        get: function () {\n            return this.changedStatePropNameValue;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyElementBase.prototype.makeBaseElementsReact = function () {\n        var els = this.getStateElements();\n        for (var i = 0; i < els.length; i++) {\n            els[i].enableOnElementRenderedEvent();\n            this.makeBaseElementReact(els[i]);\n        }\n    };\n    SurveyElementBase.prototype.unMakeBaseElementsReact = function () {\n        var els = this.getStateElements();\n        for (var i = 0; i < els.length; i++) {\n            els[i].disableOnElementRenderedEvent();\n            this.unMakeBaseElementReact(els[i]);\n        }\n    };\n    SurveyElementBase.prototype.getStateElements = function () {\n        var el = this.getStateElement();\n        return !!el ? [el] : [];\n    };\n    SurveyElementBase.prototype.getStateElement = function () {\n        return null;\n    };\n    Object.defineProperty(SurveyElementBase.prototype, \"isDisplayMode\", {\n        get: function () {\n            var props = this.props;\n            return props.isDisplayMode || false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyElementBase.prototype.renderLocString = function (locStr, style, key) {\n        if (style === void 0) { style = null; }\n        return SurveyElementBase.renderLocString(locStr, style, key);\n    };\n    SurveyElementBase.prototype.canMakeReact = function (stateElement) {\n        return !!stateElement && !!stateElement.iteratePropertiesHash;\n    };\n    SurveyElementBase.prototype.makeBaseElementReact = function (stateElement) {\n        var _this = this;\n        if (!this.canMakeReact(stateElement))\n            return;\n        stateElement.iteratePropertiesHash(function (hash, key) {\n            if (!_this.canUsePropInState(key))\n                return;\n            var val = hash[key];\n            if (Array.isArray(val)) {\n                var val = val;\n                val[\"onArrayChanged\"] = function (arrayChanges) {\n                    if (_this.isRendering)\n                        return;\n                    _this.changedStatePropNameValue = key;\n                    _this.setState(function (state) {\n                        var newState = {};\n                        newState[key] = val;\n                        return newState;\n                    });\n                };\n            }\n        });\n        stateElement.setPropertyValueCoreHandler = function (hash, key, val) {\n            if (hash[key] !== val) {\n                hash[key] = val;\n                if (!_this.canUsePropInState(key))\n                    return;\n                if (_this.isRendering)\n                    return;\n                _this.changedStatePropNameValue = key;\n                _this.setState(function (state) {\n                    var newState = {};\n                    newState[key] = val;\n                    return newState;\n                });\n            }\n        };\n    };\n    SurveyElementBase.prototype.canUsePropInState = function (key) {\n        return true;\n    };\n    SurveyElementBase.prototype.unMakeBaseElementReact = function (stateElement) {\n        if (!this.canMakeReact(stateElement))\n            return;\n        stateElement.setPropertyValueCoreHandler = undefined;\n        stateElement.iteratePropertiesHash(function (hash, key) {\n            var val = hash[key];\n            if (Array.isArray(val)) {\n                var val = val;\n                val[\"onArrayChanged\"] = function () { };\n            }\n        });\n    };\n    return SurveyElementBase;\n}(external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Component\"]));\n\nvar ReactSurveyElement = /** @class */ (function (_super) {\n    __extends(ReactSurveyElement, _super);\n    function ReactSurveyElement(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(ReactSurveyElement.prototype, \"cssClasses\", {\n        get: function () {\n            return this.props.cssClasses;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return ReactSurveyElement;\n}(reactquestion_element_SurveyElementBase));\n\nvar reactquestion_element_SurveyQuestionElementBase = /** @class */ (function (_super) {\n    __extends(SurveyQuestionElementBase, _super);\n    function SurveyQuestionElementBase(props) {\n        return _super.call(this, props) || this;\n    }\n    SurveyQuestionElementBase.prototype.componentDidUpdate = function (prevProps, prevState) {\n        _super.prototype.componentDidUpdate.call(this, prevProps, prevState);\n        this.updateDomElement();\n    };\n    SurveyQuestionElementBase.prototype.componentDidMount = function () {\n        _super.prototype.componentDidMount.call(this);\n        this.updateDomElement();\n    };\n    SurveyQuestionElementBase.prototype.componentWillUnmount = function () {\n        _super.prototype.componentWillUnmount.call(this);\n        if (!!this.questionBase) {\n            var contentElement = this.content || this.control;\n            this.questionBase.beforeDestroyQuestionElement(contentElement);\n            if (!!contentElement) {\n                contentElement.removeAttribute(\"data-rendered\");\n            }\n        }\n    };\n    SurveyQuestionElementBase.prototype.updateDomElement = function () {\n        var contentElement = this.content || this.control;\n        if (!!contentElement) {\n            if (contentElement.getAttribute(\"data-rendered\") !== \"r\") {\n                contentElement.setAttribute(\"data-rendered\", \"r\");\n                this.questionBase.afterRenderQuestionElement(contentElement);\n            }\n        }\n    };\n    Object.defineProperty(SurveyQuestionElementBase.prototype, \"questionBase\", {\n        get: function () {\n            return this.props.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionElementBase.prototype.getRenderedElements = function () {\n        return [this.questionBase];\n    };\n    Object.defineProperty(SurveyQuestionElementBase.prototype, \"creator\", {\n        get: function () {\n            return this.props.creator;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionElementBase.prototype.canRender = function () {\n        return !!this.questionBase && !!this.creator;\n    };\n    SurveyQuestionElementBase.prototype.shouldComponentUpdate = function (nextProps, nextState) {\n        if (!_super.prototype.shouldComponentUpdate.call(this, nextProps, nextState))\n            return false;\n        return (!this.questionBase.customWidget ||\n            !!this.questionBase.customWidgetData.isNeedRender ||\n            !!this.questionBase.customWidget.widgetJson.isDefaultRender ||\n            !!this.questionBase.customWidget.widgetJson.render);\n    };\n    Object.defineProperty(SurveyQuestionElementBase.prototype, \"isDisplayMode\", {\n        get: function () {\n            var props = this.props;\n            return (props.isDisplayMode ||\n                (!!this.questionBase && this.questionBase.isInputReadOnly) || false);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionElementBase.prototype.wrapCell = function (cell, element, reason) {\n        if (!reason) {\n            return element;\n        }\n        var survey = this.questionBase\n            .survey;\n        var wrapper = null;\n        if (survey) {\n            wrapper = reactsurveymodel_ReactSurveyElementsWrapper.wrapMatrixCell(survey, element, cell, reason);\n        }\n        return wrapper !== null && wrapper !== void 0 ? wrapper : element;\n    };\n    SurveyQuestionElementBase.prototype.setControl = function (element) {\n        if (!!element) {\n            this.control = element;\n        }\n    };\n    SurveyQuestionElementBase.prototype.setContent = function (element) {\n        if (!!element) {\n            this.content = element;\n        }\n    };\n    return SurveyQuestionElementBase;\n}(reactquestion_element_SurveyElementBase));\n\nvar reactquestion_element_SurveyQuestionUncontrolledElement = /** @class */ (function (_super) {\n    __extends(SurveyQuestionUncontrolledElement, _super);\n    function SurveyQuestionUncontrolledElement(props) {\n        var _this = _super.call(this, props) || this;\n        _this.updateValueOnEvent = function (event) {\n            if (!external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"Helpers\"].isTwoValueEquals(_this.questionBase.value, event.target.value, false, true, false)) {\n                _this.setValueCore(event.target.value);\n            }\n        };\n        _this.updateValueOnEvent = _this.updateValueOnEvent.bind(_this);\n        return _this;\n    }\n    Object.defineProperty(SurveyQuestionUncontrolledElement.prototype, \"question\", {\n        get: function () {\n            return this.questionBase;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionUncontrolledElement.prototype.setValueCore = function (newValue) {\n        this.questionBase.value = newValue;\n    };\n    SurveyQuestionUncontrolledElement.prototype.getValueCore = function () {\n        return this.questionBase.value;\n    };\n    SurveyQuestionUncontrolledElement.prototype.updateDomElement = function () {\n        if (!!this.control) {\n            var control = this.control;\n            var newValue = this.getValueCore();\n            if (!external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"Helpers\"].isTwoValueEquals(newValue, control.value, false, true, false)) {\n                control.value = this.getValue(newValue);\n            }\n        }\n        _super.prototype.updateDomElement.call(this);\n    };\n    SurveyQuestionUncontrolledElement.prototype.getValue = function (val) {\n        if (external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"Helpers\"].isValueEmpty(val))\n            return \"\";\n        return val;\n    };\n    return SurveyQuestionUncontrolledElement;\n}(reactquestion_element_SurveyQuestionElementBase));\n\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/element.tsx\nvar element_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar element_SurveyRowElement = /** @class */ (function (_super) {\n    element_extends(SurveyRowElement, _super);\n    function SurveyRowElement(props) {\n        var _this = _super.call(this, props) || this;\n        _this.element.cssClasses;\n        _this.rootRef = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createRef\"]();\n        return _this;\n    }\n    SurveyRowElement.prototype.getStateElement = function () {\n        return this.element;\n    };\n    Object.defineProperty(SurveyRowElement.prototype, \"element\", {\n        get: function () {\n            return this.props.element;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyRowElement.prototype, \"index\", {\n        get: function () {\n            return this.props.index;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyRowElement.prototype, \"row\", {\n        get: function () {\n            return this.props.row;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyRowElement.prototype, \"survey\", {\n        get: function () {\n            return this.props.survey;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyRowElement.prototype, \"creator\", {\n        get: function () {\n            return this.props.creator;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyRowElement.prototype, \"css\", {\n        get: function () {\n            return this.props.css;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyRowElement.prototype.componentDidMount = function () {\n        _super.prototype.componentDidMount.call(this);\n        if (this.rootRef.current) {\n            (this.element).setWrapperElement(this.rootRef.current);\n        }\n    };\n    SurveyRowElement.prototype.componentWillUnmount = function () {\n        _super.prototype.componentWillUnmount.call(this);\n        this.element.setWrapperElement(undefined);\n    };\n    SurveyRowElement.prototype.shouldComponentUpdate = function (nextProps, nextState) {\n        if (!_super.prototype.shouldComponentUpdate.call(this, nextProps, nextState))\n            return false;\n        if (nextProps.element !== this.element) {\n            if (nextProps.element) {\n                nextProps.element.setWrapperElement(this.rootRef.current);\n            }\n            if (this.element) {\n                this.element.setWrapperElement(undefined);\n            }\n        }\n        this.element.cssClasses;\n        return true;\n    };\n    SurveyRowElement.prototype.renderElement = function () {\n        var element = this.element;\n        var innerElement = this.createElement(element, this.index);\n        var css = element.cssClassesValue;\n        var focusIn = function () {\n            var el = element;\n            if (el && el.isQuestion) {\n                el.focusIn();\n            }\n        };\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: css.questionWrapper, style: element.rootStyle, \"data-key\": innerElement.key, key: innerElement.key, onFocus: focusIn, ref: this.rootRef }, this.row.isNeedRender ? innerElement : ReactElementFactory.Instance.createElement(element.skeletonComponentName, { element: element, css: this.css, })));\n    };\n    SurveyRowElement.prototype.createElement = function (element, elementIndex) {\n        var index = elementIndex ? \"-\" + elementIndex : 0;\n        var elementType = element.getType();\n        if (!ReactElementFactory.Instance.isElementRegistered(elementType)) {\n            elementType = \"question\";\n        }\n        return ReactElementFactory.Instance.createElement(elementType, {\n            key: element.name + index,\n            element: element,\n            creator: this.creator,\n            survey: this.survey,\n            css: this.css,\n        });\n    };\n    return SurveyRowElement;\n}(reactquestion_element_SurveyElementBase));\n\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/row.tsx\nvar row_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\nvar row_SurveyRow = /** @class */ (function (_super) {\n    row_extends(SurveyRow, _super);\n    function SurveyRow(props) {\n        var _this = _super.call(this, props) || this;\n        _this.rootRef = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createRef\"]();\n        _this.recalculateCss();\n        return _this;\n    }\n    SurveyRow.prototype.recalculateCss = function () {\n        this.row.visibleElements.map(function (element) { return element.cssClasses; });\n    };\n    SurveyRow.prototype.getStateElement = function () {\n        return this.row;\n    };\n    Object.defineProperty(SurveyRow.prototype, \"row\", {\n        get: function () {\n            return this.props.row;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyRow.prototype, \"survey\", {\n        get: function () {\n            return this.props.survey;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyRow.prototype, \"creator\", {\n        get: function () {\n            return this.props.creator;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyRow.prototype, \"css\", {\n        get: function () {\n            return this.props.css;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyRow.prototype.canRender = function () {\n        return !!this.row && !!this.survey && !!this.creator;\n    };\n    SurveyRow.prototype.renderElementContent = function () {\n        var _this = this;\n        var elements = this.row.visibleElements.map(function (element, elementIndex) {\n            var index = elementIndex ? \"-\" + elementIndex : 0;\n            var key = element.name + index;\n            return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](element_SurveyRowElement, { element: element, index: elementIndex, row: _this.row, survey: _this.survey, creator: _this.creator, css: _this.css, key: key }));\n        });\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { ref: this.rootRef, className: this.row.getRowCss() }, elements));\n    };\n    SurveyRow.prototype.renderElement = function () {\n        var survey = this.survey;\n        var content = this.renderElementContent();\n        var wrapper = reactsurveymodel_ReactSurveyElementsWrapper.wrapRow(survey, content, this.row);\n        return wrapper || content;\n    };\n    SurveyRow.prototype.componentDidMount = function () {\n        var _this = this;\n        _super.prototype.componentDidMount.call(this);\n        var el = this.rootRef.current;\n        if (this.rootRef.current) {\n            this.row.setRootElement(this.rootRef.current);\n        }\n        if (!!el && !this.row.isNeedRender) {\n            var rowContainerDiv = el;\n            setTimeout(function () {\n                _this.row.startLazyRendering(rowContainerDiv);\n            }, 10);\n        }\n    };\n    SurveyRow.prototype.shouldComponentUpdate = function (nextProps, nextState) {\n        if (!_super.prototype.shouldComponentUpdate.call(this, nextProps, nextState))\n            return false;\n        if (nextProps.row !== this.row) {\n            nextProps.row.isNeedRender = this.row.isNeedRender;\n            nextProps.row.setRootElement(this.rootRef.current);\n            this.row.setRootElement(undefined);\n            this.stopLazyRendering();\n        }\n        this.recalculateCss();\n        return true;\n    };\n    SurveyRow.prototype.stopLazyRendering = function () {\n        this.row.stopLazyRendering();\n        this.row.isNeedRender = !this.row.isLazyRendering();\n    };\n    SurveyRow.prototype.componentWillUnmount = function () {\n        _super.prototype.componentWillUnmount.call(this);\n        this.row.setRootElement(undefined);\n        this.stopLazyRendering();\n    };\n    SurveyRow.prototype.createElement = function (element, elementIndex) {\n        var index = elementIndex ? \"-\" + elementIndex : 0;\n        var elementType = element.getType();\n        if (!ReactElementFactory.Instance.isElementRegistered(elementType)) {\n            elementType = \"question\";\n        }\n        return ReactElementFactory.Instance.createElement(elementType, {\n            key: element.name + index,\n            element: element,\n            creator: this.creator,\n            survey: this.survey,\n            css: this.css,\n        });\n    };\n    return SurveyRow;\n}(reactquestion_element_SurveyElementBase));\n\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/panel-base.tsx\nvar panel_base_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar panel_base_SurveyPanelBase = /** @class */ (function (_super) {\n    panel_base_extends(SurveyPanelBase, _super);\n    function SurveyPanelBase(props) {\n        var _this = _super.call(this, props) || this;\n        _this.rootRef = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createRef\"]();\n        return _this;\n    }\n    SurveyPanelBase.prototype.getStateElement = function () {\n        return this.panelBase;\n    };\n    SurveyPanelBase.prototype.canUsePropInState = function (key) {\n        return key !== \"elements\" && _super.prototype.canUsePropInState.call(this, key);\n    };\n    Object.defineProperty(SurveyPanelBase.prototype, \"survey\", {\n        get: function () {\n            return this.getSurvey();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyPanelBase.prototype, \"creator\", {\n        get: function () {\n            return this.props.creator;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyPanelBase.prototype, \"css\", {\n        get: function () {\n            return this.getCss();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyPanelBase.prototype, \"panelBase\", {\n        get: function () {\n            return this.getPanelBase();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyPanelBase.prototype.getPanelBase = function () {\n        return this.props.element || this.props.question;\n    };\n    SurveyPanelBase.prototype.getSurvey = function () {\n        return (this.props.survey || (!!this.panelBase ? this.panelBase.survey : null));\n    };\n    SurveyPanelBase.prototype.getCss = function () {\n        return this.props.css;\n    };\n    SurveyPanelBase.prototype.componentDidMount = function () {\n        _super.prototype.componentDidMount.call(this);\n        this.doAfterRender();\n    };\n    SurveyPanelBase.prototype.componentWillUnmount = function () {\n        _super.prototype.componentWillUnmount.call(this);\n        var el = this.rootRef.current;\n        if (!!el) {\n            el.removeAttribute(\"data-rendered\");\n        }\n    };\n    SurveyPanelBase.prototype.componentDidUpdate = function (prevProps, prevState) {\n        _super.prototype.componentDidUpdate.call(this, prevProps, prevState);\n        if (!!prevProps.page &&\n            !!this.survey &&\n            !!this.survey.activePage &&\n            prevProps.page.id === this.survey.activePage.id)\n            return;\n        this.doAfterRender();\n    };\n    SurveyPanelBase.prototype.doAfterRender = function () {\n        var el = this.rootRef.current;\n        if (el && this.survey) {\n            if (this.panelBase.isPanel) {\n                this.survey.afterRenderPanel(this.panelBase, el);\n            }\n            else {\n                this.survey.afterRenderPage(el);\n            }\n        }\n    };\n    SurveyPanelBase.prototype.getIsVisible = function () {\n        return this.panelBase.isVisible;\n    };\n    SurveyPanelBase.prototype.canRender = function () {\n        return (_super.prototype.canRender.call(this) && !!this.survey && !!this.panelBase && !!this.panelBase.survey && this.getIsVisible());\n    };\n    SurveyPanelBase.prototype.renderRows = function (css) {\n        var _this = this;\n        return this.panelBase.visibleRows.map(function (row) { return _this.createRow(row, css); });\n    };\n    SurveyPanelBase.prototype.createRow = function (row, css) {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](row_SurveyRow, { key: row.id, row: row, survey: this.survey, creator: this.creator, css: css }));\n    };\n    return SurveyPanelBase;\n}(reactquestion_element_SurveyElementBase));\n\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/svg-icon/svg-icon.tsx\nvar svg_icon_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar svg_icon_SvgIcon = /** @class */ (function (_super) {\n    svg_icon_extends(SvgIcon, _super);\n    function SvgIcon(props) {\n        var _this = _super.call(this, props) || this;\n        _this.svgIconRef = external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createRef();\n        return _this;\n    }\n    SvgIcon.prototype.updateSvg = function () {\n        if (this.props.iconName)\n            Object(external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"createSvg\"])(this.props.size, this.props.width, this.props.height, this.props.iconName, this.svgIconRef.current, this.props.title);\n    };\n    SvgIcon.prototype.componentDidUpdate = function () {\n        this.updateSvg();\n    };\n    SvgIcon.prototype.render = function () {\n        var className = \"sv-svg-icon\";\n        if (this.props.className) {\n            className += \" \" + this.props.className;\n        }\n        return (this.props.iconName ?\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"svg\", { className: className, style: this.props.style, onClick: this.props.onClick, ref: this.svgIconRef, role: \"img\" },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"use\", null))\n            : null);\n    };\n    SvgIcon.prototype.componentDidMount = function () {\n        this.updateSvg();\n    };\n    return SvgIcon;\n}(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Component));\n\nReactElementFactory.Instance.registerElement(\"sv-svg-icon\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(svg_icon_SvgIcon, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/action-bar/action-bar-separator.tsx\nvar action_bar_separator_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\nvar action_bar_separator_SurveyActionBarSeparator = /** @class */ (function (_super) {\n    action_bar_separator_extends(SurveyActionBarSeparator, _super);\n    function SurveyActionBarSeparator(props) {\n        return _super.call(this, props) || this;\n    }\n    SurveyActionBarSeparator.prototype.render = function () {\n        var className = \"sv-action-bar-separator \" + this.props.cssClasses;\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: className });\n    };\n    return SurveyActionBarSeparator;\n}(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Component));\n\nReactElementFactory.Instance.registerElement(\"sv-action-bar-separator\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(action_bar_separator_SurveyActionBarSeparator, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/action-bar/action-bar-item.tsx\nvar action_bar_item_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\n\nvar action_bar_item_SurveyAction = /** @class */ (function (_super) {\n    action_bar_item_extends(SurveyAction, _super);\n    function SurveyAction() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(SurveyAction.prototype, \"item\", {\n        get: function () {\n            return this.props.item;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyAction.prototype.getStateElement = function () {\n        return this.item;\n    };\n    SurveyAction.prototype.renderElement = function () {\n        //refactor\n        var itemClass = this.item.getActionRootCss();\n        var separator = this.item.needSeparator ? (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(action_bar_separator_SurveyActionBarSeparator, null)) : null;\n        var itemComponent = ReactElementFactory.Instance.createElement(this.item.component || \"sv-action-bar-item\", {\n            item: this.item,\n        });\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: itemClass, id: this.item.id },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sv-action__content\" },\n                separator,\n                itemComponent)));\n    };\n    return SurveyAction;\n}(reactquestion_element_SurveyElementBase));\n\nvar action_bar_item_SurveyActionBarItem = /** @class */ (function (_super) {\n    action_bar_item_extends(SurveyActionBarItem, _super);\n    function SurveyActionBarItem() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(SurveyActionBarItem.prototype, \"item\", {\n        get: function () {\n            return this.props.item;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyActionBarItem.prototype.getStateElement = function () {\n        return this.item;\n    };\n    SurveyActionBarItem.prototype.renderElement = function () {\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Fragment, null, this.renderInnerButton());\n    };\n    SurveyActionBarItem.prototype.renderText = function () {\n        if (!this.item.hasTitle)\n            return null;\n        var titleClass = this.item.getActionBarItemTitleCss();\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { className: titleClass }, this.item.title);\n    };\n    SurveyActionBarItem.prototype.renderButtonContent = function () {\n        var text = this.renderText();\n        var svgIcon = !!this.item.iconName ? (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(svg_icon_SvgIcon, { className: this.item.cssClasses.itemIcon, size: this.item.iconSize, iconName: this.item.iconName, title: this.item.tooltip || this.item.title })) : null;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Fragment, null,\n            svgIcon,\n            text));\n    };\n    SurveyActionBarItem.prototype.renderInnerButton = function () {\n        var _this = this;\n        var className = this.item.getActionBarItemCss();\n        var title = this.item.tooltip || this.item.title;\n        var buttonContent = this.renderButtonContent();\n        var tabIndex = this.item.disableTabStop ? -1 : undefined;\n        var button = attachKey2click(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"button\", { className: className, type: \"button\", disabled: this.item.disabled, onMouseDown: function () { return _this.item.doMouseDown(); }, onFocus: function (args) { return _this.item.doFocus(args); }, onClick: function (args) { return _this.item.doAction(args); }, title: title, tabIndex: tabIndex, \"aria-checked\": this.item.ariaChecked, \"aria-expanded\": this.item.ariaExpanded, role: this.item.ariaRole }, buttonContent), this.item, { processEsc: false });\n        return button;\n    };\n    return SurveyActionBarItem;\n}(reactquestion_element_SurveyElementBase));\n\nReactElementFactory.Instance.registerElement(\"sv-action-bar-item\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(action_bar_item_SurveyActionBarItem, props);\n});\n\n// EXTERNAL MODULE: external {\"root\":\"ReactDOM\",\"commonjs2\":\"react-dom\",\"commonjs\":\"react-dom\",\"amd\":\"react-dom\"}\nvar external_root_ReactDOM_commonjs2_react_dom_commonjs_react_dom_amd_react_dom_ = __nested_webpack_require_7739__(\"react-dom\");\nvar external_root_ReactDOM_commonjs2_react_dom_commonjs_react_dom_amd_react_dom_default = /*#__PURE__*/__nested_webpack_require_7739__.n(external_root_ReactDOM_commonjs2_react_dom_commonjs_react_dom_amd_react_dom_);\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/popup/popup.tsx\nvar popup_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\n\nvar popup_Popup = /** @class */ (function (_super) {\n    popup_extends(Popup, _super);\n    function Popup(props) {\n        var _this = _super.call(this, props) || this;\n        _this.containerRef = external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createRef();\n        _this.createModel();\n        return _this;\n    }\n    Object.defineProperty(Popup.prototype, \"model\", {\n        get: function () {\n            return this.props.model;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Popup.prototype.getStateElement = function () {\n        return this.model;\n    };\n    Popup.prototype.createModel = function () {\n        this.popup = Object(external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"createPopupViewModel\"])(this.props.model, undefined);\n    };\n    Popup.prototype.setTargetElement = function () {\n        var container = this.containerRef.current;\n        this.popup.setComponentElement(container, this.props.getTarget ? this.props.getTarget(container) : undefined, this.props.getArea ? this.props.getArea(container) : undefined);\n    };\n    Popup.prototype.componentDidMount = function () {\n        _super.prototype.componentDidMount.call(this);\n        this.setTargetElement();\n    };\n    Popup.prototype.componentDidUpdate = function (prevProps, prevState) {\n        _super.prototype.componentDidUpdate.call(this, prevProps, prevState);\n        this.setTargetElement();\n    };\n    Popup.prototype.componentWillUnmount = function () {\n        _super.prototype.componentWillUnmount.call(this);\n        this.popup.resetComponentElement();\n    };\n    Popup.prototype.shouldComponentUpdate = function (nextProps, nextState) {\n        var _a;\n        if (!_super.prototype.shouldComponentUpdate.call(this, nextProps, nextState))\n            return false;\n        var isNeedUpdate = nextProps.model !== this.popup.model;\n        if (isNeedUpdate) {\n            (_a = this.popup) === null || _a === void 0 ? void 0 : _a.dispose();\n            this.createModel();\n        }\n        return isNeedUpdate;\n    };\n    Popup.prototype.render = function () {\n        this.popup.model = this.model;\n        var popupContainer;\n        if (this.model.isModal) {\n            popupContainer = external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(popup_PopupContainer, { model: this.popup });\n        }\n        else {\n            popupContainer = external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(popup_PopupDropdownContainer, { model: this.popup });\n        }\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { ref: this.containerRef }, popupContainer);\n    };\n    return Popup;\n}(reactquestion_element_SurveyElementBase));\n\nReactElementFactory.Instance.registerElement(\"sv-popup\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(popup_Popup, props);\n});\nvar popup_PopupContainer = /** @class */ (function (_super) {\n    popup_extends(PopupContainer, _super);\n    function PopupContainer(props) {\n        var _this = _super.call(this, props) || this;\n        _this.handleKeydown = function (event) {\n            _this.model.onKeyDown(event);\n        };\n        _this.clickInside = function (ev) {\n            ev.stopPropagation();\n        };\n        return _this;\n    }\n    Object.defineProperty(PopupContainer.prototype, \"model\", {\n        get: function () {\n            return this.props.model;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    PopupContainer.prototype.getStateElement = function () {\n        return this.model;\n    };\n    PopupContainer.prototype.componentDidUpdate = function (prevProps, prevState) {\n        _super.prototype.componentDidUpdate.call(this, prevProps, prevState);\n        if (!this.model.isPositionSet && this.model.isVisible) {\n            this.model.updateOnShowing();\n        }\n    };\n    PopupContainer.prototype.renderContainer = function (popupBaseViewModel) {\n        var _this = this;\n        var headerPopup = popupBaseViewModel.showHeader ? this.renderHeaderPopup(popupBaseViewModel) : null;\n        var headerContent = !!popupBaseViewModel.title ? this.renderHeaderContent() : null;\n        var content = this.renderContent();\n        var footerContent = popupBaseViewModel.showFooter ? this.renderFooter(this.model) : null;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sv-popup__container\", style: {\n                left: popupBaseViewModel.left,\n                top: popupBaseViewModel.top,\n                height: popupBaseViewModel.height,\n                width: popupBaseViewModel.width,\n                minWidth: popupBaseViewModel.minWidth,\n            }, onClick: function (ev) {\n                _this.clickInside(ev);\n            } },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sv-popup__shadow\" },\n                headerPopup,\n                external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sv-popup__body-content\" },\n                    headerContent,\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sv-popup__scrolling-content\" }, content),\n                    footerContent))));\n    };\n    PopupContainer.prototype.renderHeaderContent = function () {\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sv-popup__body-header\" }, this.model.title);\n    };\n    PopupContainer.prototype.renderContent = function () {\n        var contentComponent = ReactElementFactory.Instance.createElement(this.model.contentComponentName, this.model.contentComponentData);\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sv-popup__content\" }, contentComponent);\n    };\n    PopupContainer.prototype.renderHeaderPopup = function (popupModel) {\n        return null;\n    };\n    PopupContainer.prototype.renderFooter = function (popuModel) {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sv-popup__body-footer\" },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(action_bar_SurveyActionBar, { model: popuModel.footerToolbar })));\n    };\n    PopupContainer.prototype.render = function () {\n        var _this = this;\n        var container = this.renderContainer(this.model);\n        var className = new external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"CssClassBuilder\"]()\n            .append(\"sv-popup\")\n            .append(this.model.styleClass)\n            .toString();\n        var style = { display: this.model.isVisible ? \"\" : \"none\", };\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { tabIndex: -1, className: className, style: style, onClick: function (e) {\n                _this.model.clickOutside(e);\n            }, onKeyDown: this.handleKeydown }, container));\n    };\n    return PopupContainer;\n}(reactquestion_element_SurveyElementBase));\n\nvar popup_PopupDropdownContainer = /** @class */ (function (_super) {\n    popup_extends(PopupDropdownContainer, _super);\n    function PopupDropdownContainer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    PopupDropdownContainer.prototype.renderHeaderPopup = function (popupModel) {\n        var popupDropdownModel = popupModel;\n        if (!popupDropdownModel)\n            return null;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { style: {\n                left: popupDropdownModel.pointerTarget.left,\n                top: popupDropdownModel.pointerTarget.top,\n            }, className: \"sv-popup__pointer\" }));\n    };\n    return PopupDropdownContainer;\n}(popup_PopupContainer));\n\n// replace to showDialog then delete\nfunction showModal(componentName, data, onApply, onCancel, cssClass, title, displayMode) {\n    if (displayMode === void 0) { displayMode = \"popup\"; }\n    var options = Object(external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"createDialogOptions\"])(componentName, data, onApply, onCancel, undefined, undefined, cssClass, title, displayMode);\n    return showDialog(options);\n}\nfunction showDialog(dialogOptions, rootElement) {\n    var popupViewModel = Object(external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"createPopupModalViewModel\"])(dialogOptions, rootElement);\n    var onVisibilityChangedCallback = function (_, options) {\n        if (!options.isVisible) {\n            external_root_ReactDOM_commonjs2_react_dom_commonjs_react_dom_amd_react_dom_default.a.unmountComponentAtNode(popupViewModel.container);\n            popupViewModel.dispose();\n        }\n    };\n    popupViewModel.onVisibilityChanged.add(onVisibilityChangedCallback);\n    external_root_ReactDOM_commonjs2_react_dom_commonjs_react_dom_amd_react_dom_default.a.render(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(popup_PopupContainer, { model: popupViewModel }), popupViewModel.container);\n    popupViewModel.model.isVisible = true;\n    return popupViewModel;\n}\nexternal_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"settings\"].showModal = showModal;\nexternal_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"settings\"].showDialog = showDialog;\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/action-bar/action-bar-item-dropdown.tsx\nvar action_bar_item_dropdown_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\nvar action_bar_item_dropdown_SurveyActionBarItemDropdown = /** @class */ (function (_super) {\n    action_bar_item_dropdown_extends(SurveyActionBarItemDropdown, _super);\n    function SurveyActionBarItemDropdown(props) {\n        var _this = _super.call(this, props) || this;\n        _this.viewModel = new external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"ActionDropdownViewModel\"](_this.item);\n        return _this;\n    }\n    SurveyActionBarItemDropdown.prototype.renderInnerButton = function () {\n        var button = _super.prototype.renderInnerButton.call(this);\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Fragment, null,\n            button,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(popup_Popup, { model: this.item.popupModel, getTarget: external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"getActionDropdownButtonTarget\"] })));\n    };\n    SurveyActionBarItemDropdown.prototype.componentWillUnmount = function () {\n        _super.prototype.componentWillUnmount.call(this);\n        this.viewModel.dispose();\n    };\n    return SurveyActionBarItemDropdown;\n}(action_bar_item_SurveyActionBarItem));\n\nReactElementFactory.Instance.registerElement(\"sv-action-bar-item-dropdown\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(action_bar_item_dropdown_SurveyActionBarItemDropdown, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/action-bar/action-bar.tsx\nvar action_bar_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\n\nvar action_bar_SurveyActionBar = /** @class */ (function (_super) {\n    action_bar_extends(SurveyActionBar, _super);\n    function SurveyActionBar(props) {\n        var _this = _super.call(this, props) || this;\n        _this.rootRef = external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createRef();\n        return _this;\n    }\n    Object.defineProperty(SurveyActionBar.prototype, \"handleClick\", {\n        get: function () {\n            return this.props.handleClick !== undefined ? this.props.handleClick : true;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyActionBar.prototype, \"model\", {\n        get: function () {\n            return this.props.model;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyActionBar.prototype.componentDidMount = function () {\n        _super.prototype.componentDidMount.call(this);\n        if (!this.model.hasActions)\n            return;\n        var container = this.rootRef.current;\n        if (!!container) {\n            this.model.initResponsivityManager(container, function (callback) { setTimeout(callback); });\n        }\n    };\n    SurveyActionBar.prototype.componentWillUnmount = function () {\n        _super.prototype.componentWillUnmount.call(this);\n        if (!!this.model.hasActions) {\n            this.model.resetResponsivityManager();\n        }\n    };\n    SurveyActionBar.prototype.componentDidUpdate = function (prevProps, prevState) {\n        _super.prototype.componentDidUpdate.call(this, prevProps, prevState);\n        if (prevProps.model == this.props.model) {\n            return;\n        }\n        if (!!this.model.hasActions) {\n            this.model.resetResponsivityManager();\n            var container = this.rootRef.current;\n            if (!!container) {\n                this.model.initResponsivityManager(container, function (callback) { setTimeout(callback); });\n            }\n        }\n    };\n    SurveyActionBar.prototype.getStateElement = function () {\n        return this.model;\n    };\n    SurveyActionBar.prototype.renderElement = function () {\n        if (!this.model.hasActions)\n            return null;\n        var items = this.renderItems();\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { ref: this.rootRef, className: this.model.getRootCss(), onClick: this.handleClick ? function (event) {\n                event.stopPropagation();\n            } : undefined }, items));\n    };\n    SurveyActionBar.prototype.renderItems = function () {\n        return this.model.renderedActions.map(function (item, itemIndex) {\n            return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(action_bar_item_SurveyAction, { item: item, key: \"item\" + itemIndex }));\n        });\n    };\n    return SurveyActionBar;\n}(reactquestion_element_SurveyElementBase));\n\nReactElementFactory.Instance.registerElement(\"sv-action-bar\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(action_bar_SurveyActionBar, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/title/title-content.tsx\nvar title_content_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\nvar title_content_TitleContent = /** @class */ (function (_super) {\n    title_content_extends(TitleContent, _super);\n    function TitleContent(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(TitleContent.prototype, \"cssClasses\", {\n        get: function () {\n            return this.props.cssClasses;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(TitleContent.prototype, \"element\", {\n        get: function () {\n            return this.props.element;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    TitleContent.prototype.render = function () {\n        if (this.element.isTitleRenderedAsString)\n            return reactquestion_element_SurveyElementBase.renderLocString(this.element.locTitle);\n        var spans = this.renderTitleSpans(this.element.getTitleOwner(), this.cssClasses);\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Fragment, null, spans);\n    };\n    TitleContent.prototype.renderTitleSpans = function (element, cssClasses) {\n        var getSpaceSpan = function (key) {\n            return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { \"data-key\": key, key: key }, \"\\u00A0\"));\n        };\n        var spans = [];\n        if (element.isRequireTextOnStart) {\n            spans.push(this.renderRequireText(element, cssClasses));\n            spans.push(getSpaceSpan(\"req-sp\"));\n        }\n        var questionNumber = element.no;\n        if (questionNumber) {\n            var panelNumber = !!cssClasses.panel ? cssClasses.panel.number : undefined;\n            spans.push(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { \"data-key\": \"q_num\", key: \"q_num\", className: cssClasses.number || panelNumber, style: { position: \"static\" }, \"aria-hidden\": true }, questionNumber));\n            spans.push(getSpaceSpan(\"num-sp\"));\n        }\n        if (element.isRequireTextBeforeTitle) {\n            spans.push(this.renderRequireText(element, cssClasses));\n            spans.push(getSpaceSpan(\"req-sp\"));\n        }\n        spans.push(reactquestion_element_SurveyElementBase.renderLocString(element.locTitle, null, \"q_title\"));\n        if (element.isRequireTextAfterTitle) {\n            spans.push(getSpaceSpan(\"req-sp\"));\n            spans.push(this.renderRequireText(element, cssClasses));\n        }\n        return spans;\n    };\n    TitleContent.prototype.renderRequireText = function (element, cssClasses) {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { \"data-key\": \"req-text\", key: \"req-text\", className: cssClasses.requiredText || cssClasses.panel.requiredText, \"aria-hidden\": true }, element.requiredText));\n    };\n    return TitleContent;\n}(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Component));\n\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/title/title-actions.tsx\nvar title_actions_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\nvar title_actions_TitleActions = /** @class */ (function (_super) {\n    title_actions_extends(TitleActions, _super);\n    function TitleActions() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(TitleActions.prototype, \"cssClasses\", {\n        get: function () {\n            return this.props.cssClasses;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(TitleActions.prototype, \"element\", {\n        get: function () {\n            return this.props.element;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    TitleActions.prototype.render = function () {\n        var titleContent = external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(title_content_TitleContent, { element: this.element, cssClasses: this.cssClasses });\n        if (!this.element.hasTitleActions)\n            return titleContent;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sv-title-actions\" },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { className: \"sv-title-actions__title\" }, titleContent),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(action_bar_SurveyActionBar, { model: this.element.getTitleToolbar() })));\n    };\n    return TitleActions;\n}(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Component));\n\nexternal_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"RendererFactory\"].Instance.registerRenderer(\"element\", \"title-actions\", \"sv-title-actions\");\nReactElementFactory.Instance.registerElement(\"sv-title-actions\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(title_actions_TitleActions, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/title/title-element.tsx\nvar title_element_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar title_element_TitleElement = /** @class */ (function (_super) {\n    title_element_extends(TitleElement, _super);\n    function TitleElement(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(TitleElement.prototype, \"element\", {\n        get: function () {\n            return this.props.element;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    TitleElement.prototype.render = function () {\n        var element = this.element;\n        if (!element || !element.hasTitle)\n            return null;\n        var ariaLabel = element.titleAriaLabel || undefined;\n        var titleContent = (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(title_actions_TitleActions, { element: element, cssClasses: element.cssClasses }));\n        var onClick = undefined;\n        var onKeyUp = undefined;\n        if (element.hasTitleEvents) {\n            onKeyUp = function (evt) {\n                Object(external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"doKey2ClickUp\"])(evt.nativeEvent);\n            };\n        }\n        var CustomTag = element.titleTagName;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(CustomTag, { className: element.cssTitle, id: element.ariaTitleId, \"aria-label\": ariaLabel, tabIndex: element.titleTabIndex, \"aria-expanded\": element.titleAriaExpanded, role: element.titleAriaRole, onClick: onClick, onKeyUp: onKeyUp }, titleContent));\n    };\n    return TitleElement;\n}(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Component));\n\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion_factory.tsx\nvar ReactQuestionFactory = /** @class */ (function () {\n    function ReactQuestionFactory() {\n        this.creatorHash = {};\n    }\n    ReactQuestionFactory.prototype.registerQuestion = function (questionType, questionCreator) {\n        this.creatorHash[questionType] = questionCreator;\n    };\n    ReactQuestionFactory.prototype.getAllTypes = function () {\n        var result = new Array();\n        for (var key in this.creatorHash) {\n            result.push(key);\n        }\n        return result.sort();\n    };\n    ReactQuestionFactory.prototype.createQuestion = function (questionType, params) {\n        var creator = this.creatorHash[questionType];\n        if (creator == null)\n            return null;\n        return creator(params);\n    };\n    ReactQuestionFactory.Instance = new ReactQuestionFactory();\n    return ReactQuestionFactory;\n}());\n\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/character-counter.tsx\nvar character_counter_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar character_counter_CharacterCounterComponent = /** @class */ (function (_super) {\n    character_counter_extends(CharacterCounterComponent, _super);\n    function CharacterCounterComponent() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    CharacterCounterComponent.prototype.getStateElement = function () {\n        return this.props.counter;\n    };\n    CharacterCounterComponent.prototype.renderElement = function () {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: this.props.remainingCharacterCounter }, this.props.counter.remainingCharacterCounter));\n    };\n    return CharacterCounterComponent;\n}(reactquestion_element_SurveyElementBase));\n\nReactElementFactory.Instance.registerElement(\"sv-character-counter\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(character_counter_CharacterCounterComponent, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion_comment.tsx\nvar reactquestion_comment_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\nvar reactquestion_comment_SurveyQuestionComment = /** @class */ (function (_super) {\n    reactquestion_comment_extends(SurveyQuestionComment, _super);\n    function SurveyQuestionComment(props) {\n        return _super.call(this, props) || this;\n    }\n    SurveyQuestionComment.prototype.renderElement = function () {\n        var _this = this;\n        var onBlur = function (e) {\n            if (!_this.question.isInputTextUpdate) {\n                _this.updateValueOnEvent(e);\n            }\n            _this.question.onBlur(e);\n        };\n        var onInput = function (event) {\n            if (_this.question.isInputTextUpdate) {\n                _this.updateValueOnEvent(event);\n            }\n            else {\n                _this.question.updateElement();\n            }\n            var newValue = event.target.value;\n            _this.question.updateRemainingCharacterCounter(newValue);\n        };\n        var placeholder = this.question.renderedPlaceholder;\n        if (this.question.isReadOnlyRenderDiv()) {\n            return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", null, this.question.value);\n        }\n        var counter = !!this.question.getMaxLength() ? (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](character_counter_CharacterCounterComponent, { counter: this.question.characterCounter, remainingCharacterCounter: this.question.cssClasses.remainingCharacterCounter })) : null;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Fragment\"], null,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"textarea\", { id: this.question.inputId, className: this.question.className, disabled: this.question.isDisabledAttr, readOnly: this.question.isReadOnlyAttr, ref: function (textarea) { return (_this.setControl(textarea)); }, maxLength: this.question.getMaxLength(), placeholder: placeholder, onFocus: function (event) { _this.question.onFocus(event); }, onBlur: onBlur, onInput: onInput, onKeyDown: function (event) { _this.question.onKeyDown(event); }, cols: this.question.cols, rows: this.question.rows, \"aria-required\": this.question.a11y_input_ariaRequired, \"aria-label\": this.question.a11y_input_ariaLabel, \"aria-labelledby\": this.question.a11y_input_ariaLabelledBy, \"aria-describedby\": this.question.a11y_input_ariaDescribedBy, \"aria-invalid\": this.question.a11y_input_ariaInvalid, \"aria-errormessage\": this.question.a11y_input_ariaErrormessage, style: { resize: this.question.resizeStyle } }),\n            counter));\n    };\n    return SurveyQuestionComment;\n}(reactquestion_element_SurveyQuestionUncontrolledElement));\n\nvar reactquestion_comment_SurveyQuestionCommentItem = /** @class */ (function (_super) {\n    reactquestion_comment_extends(SurveyQuestionCommentItem, _super);\n    function SurveyQuestionCommentItem(props) {\n        var _this = _super.call(this, props) || this;\n        _this.state = { comment: _this.getComment() || \"\" };\n        return _this;\n    }\n    SurveyQuestionCommentItem.prototype.componentDidUpdate = function (prevProps, prevState) {\n        _super.prototype.componentDidUpdate.call(this, prevProps, prevState);\n        this.updateDomElement();\n    };\n    SurveyQuestionCommentItem.prototype.componentDidMount = function () {\n        _super.prototype.componentDidMount.call(this);\n        this.updateDomElement();\n    };\n    SurveyQuestionCommentItem.prototype.updateDomElement = function () {\n        if (!!this.control) {\n            var control = this.control;\n            var newValue = this.getComment() || \"\";\n            if (!external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"Helpers\"].isTwoValueEquals(newValue, control.value, false, true, false)) {\n                control.value = newValue;\n            }\n        }\n    };\n    SurveyQuestionCommentItem.prototype.setControl = function (element) {\n        if (!!element) {\n            this.control = element;\n        }\n    };\n    SurveyQuestionCommentItem.prototype.canRender = function () {\n        return !!this.props.question;\n    };\n    SurveyQuestionCommentItem.prototype.onCommentChange = function (event) {\n        this.props.question.onCommentChange(event);\n    };\n    SurveyQuestionCommentItem.prototype.onCommentInput = function (event) {\n        this.props.question.onCommentInput(event);\n    };\n    SurveyQuestionCommentItem.prototype.getComment = function () {\n        return this.props.question.comment;\n    };\n    SurveyQuestionCommentItem.prototype.setComment = function (value) {\n        this.props.question.comment = value;\n    };\n    SurveyQuestionCommentItem.prototype.getId = function () {\n        return this.props.question.commentId;\n    };\n    SurveyQuestionCommentItem.prototype.getPlaceholder = function () {\n        return this.props.question.renderedCommentPlaceholder;\n    };\n    SurveyQuestionCommentItem.prototype.renderElement = function () {\n        var _this = this;\n        var question = this.props.question;\n        var className = this.props.otherCss || this.cssClasses.comment;\n        if (question.isReadOnlyRenderDiv()) {\n            var comment = this.getComment() || \"\";\n            return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", null, comment);\n        }\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"textarea\", { id: this.getId(), className: className, ref: function (textarea) { return (_this.setControl(textarea)); }, disabled: this.isDisplayMode, maxLength: question.getOthersMaxLength(), rows: question.commentAreaRows, placeholder: this.getPlaceholder(), onBlur: function (e) { _this.onCommentChange(e); }, onInput: function (e) { return _this.onCommentInput(e); }, \"aria-required\": question.isRequired || question.a11y_input_ariaRequired, \"aria-label\": question.ariaLabel || question.a11y_input_ariaLabel, style: { resize: question.resizeStyle } }));\n    };\n    return SurveyQuestionCommentItem;\n}(ReactSurveyElement));\n\nvar SurveyQuestionOtherValueItem = /** @class */ (function (_super) {\n    reactquestion_comment_extends(SurveyQuestionOtherValueItem, _super);\n    function SurveyQuestionOtherValueItem() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    SurveyQuestionOtherValueItem.prototype.onCommentChange = function (event) {\n        this.props.question.onOtherValueChange(event);\n    };\n    SurveyQuestionOtherValueItem.prototype.onCommentInput = function (event) {\n        this.props.question.onOtherValueInput(event);\n    };\n    SurveyQuestionOtherValueItem.prototype.getComment = function () {\n        return this.props.question.otherValue;\n    };\n    SurveyQuestionOtherValueItem.prototype.setComment = function (value) {\n        this.props.question.otherValue = value;\n    };\n    SurveyQuestionOtherValueItem.prototype.getId = function () {\n        return this.props.question.otherId;\n    };\n    SurveyQuestionOtherValueItem.prototype.getPlaceholder = function () {\n        return this.props.question.otherPlaceholder;\n    };\n    return SurveyQuestionOtherValueItem;\n}(reactquestion_comment_SurveyQuestionCommentItem));\n\nReactQuestionFactory.Instance.registerQuestion(\"comment\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_comment_SurveyQuestionComment, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/custom-widget.tsx\nvar custom_widget_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\nvar custom_widget_SurveyCustomWidget = /** @class */ (function (_super) {\n    custom_widget_extends(SurveyCustomWidget, _super);\n    function SurveyCustomWidget(props) {\n        var _this = _super.call(this, props) || this;\n        _this.widgetRef = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createRef\"]();\n        return _this;\n    }\n    SurveyCustomWidget.prototype._afterRender = function () {\n        if (this.questionBase.customWidget) {\n            var el = this.widgetRef.current;\n            if (!!el) {\n                this.questionBase.customWidget.afterRender(this.questionBase, el);\n                this.questionBase.customWidgetData.isNeedRender = false;\n            }\n        }\n    };\n    SurveyCustomWidget.prototype.componentDidMount = function () {\n        _super.prototype.componentDidMount.call(this);\n        if (this.questionBase) {\n            this._afterRender();\n        }\n    };\n    SurveyCustomWidget.prototype.componentDidUpdate = function (prevProps, prevState) {\n        _super.prototype.componentDidUpdate.call(this, prevProps, prevState);\n        var isDefaultRender = !!this.questionBase.customWidget &&\n            this.questionBase.customWidget.isDefaultRender;\n        if (this.questionBase && !isDefaultRender) {\n            this._afterRender();\n        }\n    };\n    SurveyCustomWidget.prototype.componentWillUnmount = function () {\n        _super.prototype.componentWillUnmount.call(this);\n        if (this.questionBase.customWidget) {\n            var el = this.widgetRef.current;\n            if (!!el) {\n                this.questionBase.customWidget.willUnmount(this.questionBase, el);\n            }\n        }\n    };\n    SurveyCustomWidget.prototype.canRender = function () {\n        return _super.prototype.canRender.call(this) && this.questionBase.visible;\n    };\n    SurveyCustomWidget.prototype.renderElement = function () {\n        var customWidget = this.questionBase.customWidget;\n        if (customWidget.isDefaultRender) {\n            return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { ref: this.widgetRef }, this.creator.createQuestionElement(this.questionBase)));\n        }\n        var widget = null;\n        if (customWidget.widgetJson.render) {\n            widget = customWidget.widgetJson.render(this.questionBase);\n        }\n        else {\n            if (customWidget.htmlTemplate) {\n                var htmlValue = { __html: customWidget.htmlTemplate };\n                return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { ref: this.widgetRef, dangerouslySetInnerHTML: htmlValue });\n            }\n        }\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { ref: this.widgetRef }, widget);\n    };\n    return SurveyCustomWidget;\n}(reactquestion_element_SurveyQuestionElementBase));\n\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/element-header.tsx\nvar element_header_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\nvar element_header_SurveyElementHeader = /** @class */ (function (_super) {\n    element_header_extends(SurveyElementHeader, _super);\n    function SurveyElementHeader() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(SurveyElementHeader.prototype, \"element\", {\n        get: function () {\n            return this.props.element;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyElementHeader.prototype.render = function () {\n        var element = this.element;\n        var title = element.hasTitle ? (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(title_element_TitleElement, { element: element })) : null;\n        var description = element.hasDescriptionUnderTitle\n            ? reactquestion_element_SurveyElementBase.renderQuestionDescription(this.element)\n            : null;\n        var additionalTitleToolbarElement = element.hasAdditionalTitleToolbar ? external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(action_bar_SurveyActionBar, { model: element.additionalTitleToolbar }) : null;\n        var headerStyle = { width: undefined };\n        if (element instanceof external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"Question\"]) {\n            headerStyle.width = element.titleWidth;\n        }\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: element.cssHeader, onClick: function (e) { return element.clickTitleFunction && element.clickTitleFunction(e.nativeEvent); }, style: headerStyle },\n            title,\n            description,\n            additionalTitleToolbarElement));\n    };\n    return SurveyElementHeader;\n}(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Component));\n\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion.tsx\nvar reactquestion_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\n\n\nvar reactquestion_SurveyQuestion = /** @class */ (function (_super) {\n    reactquestion_extends(SurveyQuestion, _super);\n    function SurveyQuestion(props) {\n        var _this = _super.call(this, props) || this;\n        _this.isNeedFocus = false;\n        _this.rootRef = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createRef\"]();\n        return _this;\n    }\n    SurveyQuestion.renderQuestionBody = function (creator, question) {\n        // if (!question.isVisible) return null;\n        var customWidget = question.customWidget;\n        if (!customWidget) {\n            return creator.createQuestionElement(question);\n        }\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](custom_widget_SurveyCustomWidget, { creator: creator, question: question });\n    };\n    SurveyQuestion.prototype.getStateElement = function () {\n        return this.question;\n    };\n    Object.defineProperty(SurveyQuestion.prototype, \"question\", {\n        get: function () {\n            return this.props.element;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestion.prototype, \"creator\", {\n        get: function () {\n            return this.props.creator;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestion.prototype.componentDidMount = function () {\n        _super.prototype.componentDidMount.call(this);\n        if (!!this.question) {\n            this.question[\"react\"] = this;\n        }\n        this.doAfterRender();\n    };\n    SurveyQuestion.prototype.componentWillUnmount = function () {\n        _super.prototype.componentWillUnmount.call(this);\n        if (!!this.question) {\n            this.question[\"react\"] = null;\n        }\n        var el = this.rootRef.current;\n        if (!!el) {\n            el.removeAttribute(\"data-rendered\");\n        }\n    };\n    SurveyQuestion.prototype.componentDidUpdate = function (prevProps, prevState) {\n        _super.prototype.componentDidUpdate.call(this, prevProps, prevState);\n        this.doAfterRender();\n    };\n    SurveyQuestion.prototype.doAfterRender = function () {\n        if (this.isNeedFocus) {\n            if (!this.question.isCollapsed) {\n                this.question.clickTitleFunction();\n            }\n            this.isNeedFocus = false;\n        }\n        if (this.question) {\n            var el = this.rootRef.current;\n            if (el && el.getAttribute(\"data-rendered\") !== \"r\") {\n                el.setAttribute(\"data-rendered\", \"r\");\n                el.setAttribute(\"data-name\", this.question.name);\n                if (this.question.afterRender) {\n                    this.question.afterRender(el);\n                }\n            }\n        }\n    };\n    SurveyQuestion.prototype.canRender = function () {\n        return (_super.prototype.canRender.call(this) &&\n            !!this.question &&\n            !!this.creator);\n    };\n    SurveyQuestion.prototype.renderQuestionContent = function () {\n        var question = this.question;\n        var contentStyle = {\n            display: this.question.renderedIsExpanded ? \"\" : \"none\",\n        };\n        var cssClasses = question.cssClasses;\n        var questionRender = this.renderQuestion();\n        var errorsTop = this.question.showErrorOnTop\n            ? this.renderErrors(cssClasses, \"top\")\n            : null;\n        var errorsBottom = this.question.showErrorOnBottom\n            ? this.renderErrors(cssClasses, \"bottom\")\n            : null;\n        var comment = question && question.hasComment ? this.renderComment(cssClasses) : null;\n        var descriptionUnderInput = question.hasDescriptionUnderInput\n            ? this.renderDescription()\n            : null;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: question.cssContent || undefined, style: contentStyle, role: \"presentation\" },\n            errorsTop,\n            questionRender,\n            comment,\n            errorsBottom,\n            descriptionUnderInput));\n    };\n    SurveyQuestion.prototype.renderElement = function () {\n        var question = this.question;\n        var cssClasses = question.cssClasses;\n        var header = this.renderHeader(question);\n        var headerTop = question.hasTitleOnLeftTop ? header : null;\n        var headerBottom = question.hasTitleOnBottom ? header : null;\n        var errorsAboveQuestion = this.question.showErrorsAboveQuestion\n            ? this.renderErrors(cssClasses, \"\")\n            : null;\n        var errorsBelowQuestion = this.question.showErrorsBelowQuestion\n            ? this.renderErrors(cssClasses, \"\")\n            : null;\n        var rootStyle = question.getRootStyle();\n        var questionContent = this.wrapQuestionContent(this.renderQuestionContent());\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Fragment\"], null,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { ref: this.rootRef, id: question.id, className: question.getRootCss(), style: rootStyle, role: question.ariaRole, \"aria-required\": this.question.ariaRequired, \"aria-invalid\": this.question.ariaInvalid, \"aria-labelledby\": question.ariaLabelledBy, \"aria-describedby\": question.ariaDescribedBy, \"aria-expanded\": question.ariaExpanded },\n                errorsAboveQuestion,\n                headerTop,\n                questionContent,\n                headerBottom,\n                errorsBelowQuestion)));\n    };\n    SurveyQuestion.prototype.wrapElement = function (element) {\n        var survey = this.question.survey;\n        var wrapper = null;\n        if (survey) {\n            wrapper = reactsurveymodel_ReactSurveyElementsWrapper.wrapElement(survey, element, this.question);\n        }\n        return wrapper !== null && wrapper !== void 0 ? wrapper : element;\n    };\n    SurveyQuestion.prototype.wrapQuestionContent = function (element) {\n        var survey = this.question.survey;\n        var wrapper = null;\n        if (survey) {\n            wrapper = reactsurveymodel_ReactSurveyElementsWrapper.wrapQuestionContent(survey, element, this.question);\n        }\n        return wrapper !== null && wrapper !== void 0 ? wrapper : element;\n    };\n    SurveyQuestion.prototype.renderQuestion = function () {\n        return SurveyQuestion.renderQuestionBody(this.creator, this.question);\n    };\n    SurveyQuestion.prototype.renderDescription = function () {\n        return reactquestion_element_SurveyElementBase.renderQuestionDescription(this.question);\n    };\n    SurveyQuestion.prototype.renderComment = function (cssClasses) {\n        var commentText = reactquestion_element_SurveyElementBase.renderLocString(this.question.locCommentText);\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.getCommentAreaCss() },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", null, commentText),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_comment_SurveyQuestionCommentItem, { question: this.question, cssClasses: cssClasses, otherCss: cssClasses.other, isDisplayMode: this.question.isInputReadOnly })));\n    };\n    SurveyQuestion.prototype.renderHeader = function (question) {\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](element_header_SurveyElementHeader, { element: question });\n    };\n    SurveyQuestion.prototype.renderErrors = function (cssClasses, location) {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_SurveyElementErrors, { element: this.question, cssClasses: cssClasses, creator: this.creator, location: location, id: this.question.id + \"_errors\" }));\n    };\n    return SurveyQuestion;\n}(reactquestion_element_SurveyElementBase));\n\nReactElementFactory.Instance.registerElement(\"question\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_SurveyQuestion, props);\n});\nvar reactquestion_SurveyElementErrors = /** @class */ (function (_super) {\n    reactquestion_extends(SurveyElementErrors, _super);\n    function SurveyElementErrors(props) {\n        var _this = _super.call(this, props) || this;\n        _this.state = _this.getState();\n        return _this;\n    }\n    Object.defineProperty(SurveyElementErrors.prototype, \"id\", {\n        get: function () {\n            return this.props.element.id + \"_errors\";\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyElementErrors.prototype, \"element\", {\n        get: function () {\n            return this.props.element;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyElementErrors.prototype, \"creator\", {\n        get: function () {\n            return this.props.creator;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyElementErrors.prototype, \"location\", {\n        get: function () {\n            return this.props.location;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyElementErrors.prototype.getState = function (prevState) {\n        if (prevState === void 0) { prevState = null; }\n        return !prevState ? { error: 0 } : { error: prevState.error + 1 };\n    };\n    SurveyElementErrors.prototype.canRender = function () {\n        return !!this.element && this.element.hasVisibleErrors;\n    };\n    SurveyElementErrors.prototype.componentWillUnmount = function () {\n    };\n    SurveyElementErrors.prototype.renderElement = function () {\n        var errors = [];\n        for (var i = 0; i < this.element.errors.length; i++) {\n            var key = \"error\" + i;\n            errors.push(this.creator.renderError(key, this.element.errors[i], this.cssClasses, this.element));\n        }\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { role: \"alert\", \"aria-live\": \"polite\", className: this.element.cssError, id: this.id }, errors));\n    };\n    return SurveyElementErrors;\n}(ReactSurveyElement));\n\nvar reactquestion_SurveyQuestionAndErrorsWrapped = /** @class */ (function (_super) {\n    reactquestion_extends(SurveyQuestionAndErrorsWrapped, _super);\n    function SurveyQuestionAndErrorsWrapped(props) {\n        return _super.call(this, props) || this;\n    }\n    SurveyQuestionAndErrorsWrapped.prototype.getStateElement = function () {\n        return this.question;\n    };\n    Object.defineProperty(SurveyQuestionAndErrorsWrapped.prototype, \"question\", {\n        get: function () {\n            return this.getQuestion();\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionAndErrorsWrapped.prototype, \"creator\", {\n        get: function () {\n            return this.props.creator;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionAndErrorsWrapped.prototype.getQuestion = function () {\n        return this.props.question;\n    };\n    Object.defineProperty(SurveyQuestionAndErrorsWrapped.prototype, \"itemCss\", {\n        get: function () {\n            return this.props.itemCss;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionAndErrorsWrapped.prototype.componentDidMount = function () {\n        _super.prototype.componentDidMount.call(this);\n        this.doAfterRender();\n    };\n    SurveyQuestionAndErrorsWrapped.prototype.componentDidUpdate = function (prevProps, prevState) {\n        _super.prototype.componentDidUpdate.call(this, prevProps, prevState);\n        this.doAfterRender();\n    };\n    SurveyQuestionAndErrorsWrapped.prototype.doAfterRender = function () { };\n    SurveyQuestionAndErrorsWrapped.prototype.canRender = function () {\n        return !!this.question;\n    };\n    SurveyQuestionAndErrorsWrapped.prototype.renderContent = function () {\n        var renderedQuestion = this.renderQuestion();\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Fragment\"], null, renderedQuestion));\n    };\n    SurveyQuestionAndErrorsWrapped.prototype.getShowErrors = function () {\n        return this.question.isVisible;\n    };\n    SurveyQuestionAndErrorsWrapped.prototype.renderQuestion = function () {\n        return reactquestion_SurveyQuestion.renderQuestionBody(this.creator, this.question);\n    };\n    return SurveyQuestionAndErrorsWrapped;\n}(ReactSurveyElement));\n\nvar reactquestion_SurveyQuestionAndErrorsCell = /** @class */ (function (_super) {\n    reactquestion_extends(SurveyQuestionAndErrorsCell, _super);\n    function SurveyQuestionAndErrorsCell(props) {\n        var _this = _super.call(this, props) || this;\n        _this.cellRef = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createRef\"]();\n        return _this;\n    }\n    SurveyQuestionAndErrorsCell.prototype.componentWillUnmount = function () {\n        _super.prototype.componentWillUnmount.call(this);\n        if (this.question) {\n            var el = this.cellRef.current;\n            if (!!el) {\n                el.removeAttribute(\"data-rendered\");\n            }\n        }\n    };\n    SurveyQuestionAndErrorsCell.prototype.renderCellContent = function () {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.props.cell.cellQuestionWrapperClassName }, this.renderQuestion()));\n    };\n    SurveyQuestionAndErrorsCell.prototype.renderElement = function () {\n        var style = this.getCellStyle();\n        var cell = this.props.cell;\n        var focusIn = function () { cell.focusIn(); };\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"td\", { ref: this.cellRef, className: this.itemCss, colSpan: cell.colSpans, title: cell.getTitle(), style: style, onFocus: focusIn }, this.wrapCell(this.props.cell, this.renderCellContent())));\n    };\n    SurveyQuestionAndErrorsCell.prototype.getCellStyle = function () {\n        return null;\n    };\n    SurveyQuestionAndErrorsCell.prototype.getHeaderText = function () {\n        return \"\";\n    };\n    SurveyQuestionAndErrorsCell.prototype.wrapCell = function (cell, element) {\n        if (!cell) {\n            return element;\n        }\n        var survey = this.question.survey;\n        var wrapper = null;\n        if (survey) {\n            wrapper = reactsurveymodel_ReactSurveyElementsWrapper.wrapMatrixCell(survey, element, cell, this.props.reason);\n        }\n        return wrapper !== null && wrapper !== void 0 ? wrapper : element;\n    };\n    return SurveyQuestionAndErrorsCell;\n}(reactquestion_SurveyQuestionAndErrorsWrapped));\n\nvar reactquestion_SurveyQuestionErrorCell = /** @class */ (function (_super) {\n    reactquestion_extends(SurveyQuestionErrorCell, _super);\n    function SurveyQuestionErrorCell(props) {\n        var _this = _super.call(this, props) || this;\n        _this.state = {\n            changed: 0\n        };\n        if (_this.question) {\n            _this.registerCallback(_this.question);\n        }\n        return _this;\n    }\n    Object.defineProperty(SurveyQuestionErrorCell.prototype, \"question\", {\n        get: function () {\n            return this.props.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionErrorCell.prototype.update = function () {\n        this.setState({ changed: this.state.changed + 1 });\n    };\n    SurveyQuestionErrorCell.prototype.getQuestionPropertiesToTrack = function () {\n        return [\"errors\"];\n    };\n    SurveyQuestionErrorCell.prototype.registerCallback = function (question) {\n        var _this = this;\n        question.registerFunctionOnPropertiesValueChanged(this.getQuestionPropertiesToTrack(), function () {\n            _this.update();\n        }, \"__reactSubscription\");\n    };\n    SurveyQuestionErrorCell.prototype.unRegisterCallback = function (question) {\n        question.unRegisterFunctionOnPropertiesValueChanged(this.getQuestionPropertiesToTrack(), \"__reactSubscription\");\n    };\n    SurveyQuestionErrorCell.prototype.componentDidUpdate = function (prevProps) {\n        if (prevProps.question && prevProps.question !== this.question) {\n            this.unRegisterCallback(prevProps.cell);\n        }\n        if (this.question) {\n            this.registerCallback(this.question);\n        }\n    };\n    SurveyQuestionErrorCell.prototype.componentWillUnmount = function () {\n        if (this.question) {\n            this.unRegisterCallback(this.question);\n        }\n    };\n    SurveyQuestionErrorCell.prototype.render = function () {\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_SurveyElementErrors, { element: this.question, creator: this.props.creator, cssClasses: this.question.cssClasses });\n    };\n    return SurveyQuestionErrorCell;\n}(external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Component\"]));\n\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/page.tsx\nvar page_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\nvar page_SurveyPage = /** @class */ (function (_super) {\n    page_extends(SurveyPage, _super);\n    function SurveyPage(props) {\n        return _super.call(this, props) || this;\n    }\n    SurveyPage.prototype.getPanelBase = function () {\n        return this.props.page;\n    };\n    Object.defineProperty(SurveyPage.prototype, \"page\", {\n        get: function () {\n            return this.panelBase;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    // shouldComponentUpdate(nextProps: any, nextState: any): boolean {\n    //   if(!super.shouldComponentUpdate(nextProps, nextState)) return false;\n    //   return true;\n    // }\n    SurveyPage.prototype.renderElement = function () {\n        var title = this.renderTitle();\n        var description = this.renderDescription();\n        var rows = this.renderRows(this.panelBase.cssClasses);\n        var errors = (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_SurveyElementErrors, { element: this.panelBase, cssClasses: this.panelBase.cssClasses, creator: this.creator }));\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { ref: this.rootRef, className: this.page.cssRoot },\n            title,\n            description,\n            errors,\n            rows));\n    };\n    SurveyPage.prototype.renderTitle = function () {\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](title_element_TitleElement, { element: this.page });\n    };\n    SurveyPage.prototype.renderDescription = function () {\n        if (!this.page._showDescription)\n            return null;\n        var text = reactquestion_element_SurveyElementBase.renderLocString(this.page.locDescription);\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.panelBase.cssClasses.page.description }, text));\n    };\n    return SurveyPage;\n}(panel_base_SurveyPanelBase));\n\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/survey-header/survey-header.tsx\nvar survey_header_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\nvar survey_header_SurveyHeader = /** @class */ (function (_super) {\n    survey_header_extends(SurveyHeader, _super);\n    function SurveyHeader(props) {\n        var _this = _super.call(this, props) || this;\n        _this.state = { changed: 0 };\n        _this.rootRef = external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createRef();\n        return _this;\n    }\n    Object.defineProperty(SurveyHeader.prototype, \"survey\", {\n        get: function () {\n            return this.props.survey;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyHeader.prototype, \"css\", {\n        get: function () {\n            return this.survey.css;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyHeader.prototype.componentDidMount = function () {\n        var self = this;\n        this.survey.afterRenderHeader(this.rootRef.current);\n        this.survey.locLogo.onChanged = function () {\n            self.setState({ changed: self.state.changed + 1 });\n        };\n    };\n    SurveyHeader.prototype.componentWillUnmount = function () {\n        this.survey.locLogo.onChanged = function () { };\n    };\n    SurveyHeader.prototype.renderTitle = function () {\n        if (!this.survey.renderedHasTitle)\n            return null;\n        var description = reactquestion_element_SurveyElementBase.renderLocString(this.survey.locDescription);\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: this.css.headerText, style: { maxWidth: this.survey.titleMaxWidth } },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(title_element_TitleElement, { element: this.survey }),\n            this.survey.renderedHasDescription ? external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: this.css.description }, description) : null));\n    };\n    SurveyHeader.prototype.renderLogoImage = function (isRender) {\n        if (!isRender)\n            return null;\n        var componentName = this.survey.getElementWrapperComponentName(this.survey, \"logo-image\");\n        var componentData = this.survey.getElementWrapperComponentData(this.survey, \"logo-image\");\n        return ReactElementFactory.Instance.createElement(componentName, {\n            data: componentData,\n        });\n    };\n    SurveyHeader.prototype.render = function () {\n        if (!this.survey.renderedHasHeader)\n            return null;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: this.css.header, ref: this.rootRef },\n            this.renderLogoImage(this.survey.isLogoBefore),\n            this.renderTitle(),\n            this.renderLogoImage(this.survey.isLogoAfter),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: this.css.headerClose })));\n    };\n    return SurveyHeader;\n}(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Component));\n\nReactElementFactory.Instance.registerElement(\"survey-header\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(survey_header_SurveyHeader, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/brand-info.tsx\nvar brand_info_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\nvar brand_info_BrandInfo = /** @class */ (function (_super) {\n    brand_info_extends(BrandInfo, _super);\n    function BrandInfo() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    BrandInfo.prototype.render = function () {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sv-brand-info\" },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"a\", { className: \"sv-brand-info__logo\", href: \"https://surveyjs.io/?utm_source=built-in_links&utm_medium=online_survey_tool&utm_campaign=landing_page\" },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"img\", { src: \"https://surveyjs.io/Content/Images/poweredby.svg\" })),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sv-brand-info__text\" },\n                \"Try and see how easy it is to \",\n                external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"a\", { href: \"https://surveyjs.io/create-survey?utm_source=built-in_links&utm_medium=online_survey_tool&utm_campaign=create_survey\" }, \"create a survey\")),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sv-brand-info__terms\" },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"a\", { href: \"https://surveyjs.io/TermsOfUse\" }, \"Terms of Use & Privacy Statement\"))));\n    };\n    return BrandInfo;\n}(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Component));\n\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/notifier.tsx\nvar notifier_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\nvar notifier_NotifierComponent = /** @class */ (function (_super) {\n    notifier_extends(NotifierComponent, _super);\n    function NotifierComponent() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(NotifierComponent.prototype, \"notifier\", {\n        get: function () {\n            return this.props.notifier;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    NotifierComponent.prototype.getStateElement = function () {\n        return this.notifier;\n    };\n    NotifierComponent.prototype.renderElement = function () {\n        if (!this.notifier.isDisplayed)\n            return null;\n        var style = { visibility: this.notifier.active ? \"visible\" : \"hidden\" };\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: this.notifier.css, style: style, role: \"alert\", \"aria-live\": \"polite\" },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", null, this.notifier.message),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(action_bar_SurveyActionBar, { model: this.notifier.actionBar })));\n    };\n    return NotifierComponent;\n}(reactquestion_element_SurveyElementBase));\n\nReactElementFactory.Instance.registerElement(\"sv-notifier\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(notifier_NotifierComponent, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/components-container.tsx\nvar components_container_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\nvar components_container_ComponentsContainer = /** @class */ (function (_super) {\n    components_container_extends(ComponentsContainer, _super);\n    function ComponentsContainer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    ComponentsContainer.prototype.render = function () {\n        var _this = this;\n        var components = this.props.survey.getContainerContent(this.props.container);\n        var needRenderWrapper = this.props.needRenderWrapper === false ? false : true;\n        if (components.length == 0) {\n            return null;\n        }\n        if (!needRenderWrapper) {\n            return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Fragment, null, components.map(function (component) {\n                return ReactElementFactory.Instance.createElement(component.component, { survey: _this.props.survey, model: component.data, container: _this.props.container, key: component.id });\n            }));\n        }\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sv-components-column\" + \" sv-components-container-\" + this.props.container }, components.map(function (component) {\n            return ReactElementFactory.Instance.createElement(component.component, { survey: _this.props.survey, model: component.data, container: _this.props.container, key: component.id });\n        }));\n    };\n    return ComponentsContainer;\n}(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Component));\n\nReactElementFactory.Instance.registerElement(\"sv-components-container\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(components_container_ComponentsContainer, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/svgbundle.tsx\nvar svgbundle_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\nvar svgbundle_SvgBundleComponent = /** @class */ (function (_super) {\n    svgbundle_extends(SvgBundleComponent, _super);\n    function SvgBundleComponent(props) {\n        var _this = _super.call(this, props) || this;\n        _this.containerRef = external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createRef();\n        return _this;\n    }\n    SvgBundleComponent.prototype.componentDidMount = function () {\n        if (!!this.containerRef.current) {\n            this.containerRef.current.innerHTML = external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"SvgRegistry\"].iconsRenderedHtml();\n        }\n    };\n    SvgBundleComponent.prototype.render = function () {\n        var svgStyle = {\n            display: \"none\"\n        };\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"svg\", { style: svgStyle, id: \"sv-icon-holder-global-container\", ref: this.containerRef });\n    };\n    return SvgBundleComponent;\n}(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Component));\n\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactSurvey.tsx\nvar reactSurvey_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __assign = ( false) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\n\n\n\n\n\n\n\n\n\n\n\nvar reactSurvey_Survey = /** @class */ (function (_super) {\n    reactSurvey_extends(Survey, _super);\n    function Survey(props) {\n        var _this = _super.call(this, props) || this;\n        _this.previousJSON = {};\n        _this.isSurveyUpdated = false;\n        _this.createSurvey(props);\n        _this.updateSurvey(props, {});\n        _this.rootRef = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createRef\"]();\n        _this.rootNodeId = props.id || null;\n        _this.rootNodeClassName = props.className || \"\";\n        return _this;\n    }\n    Object.defineProperty(Survey, \"cssType\", {\n        get: function () {\n            return external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"surveyCss\"].currentType;\n        },\n        set: function (value) {\n            external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"StylesManager\"].applyTheme(value);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Survey.prototype.getStateElement = function () {\n        return this.survey;\n    };\n    Survey.prototype.onSurveyUpdated = function () {\n        if (!!this.survey) {\n            var el = this.rootRef.current;\n            if (!!el)\n                this.survey.afterRenderSurvey(el);\n            this.survey.startTimerFromUI();\n        }\n    };\n    Survey.prototype.shouldComponentUpdate = function (nextProps, nextState) {\n        if (!_super.prototype.shouldComponentUpdate.call(this, nextProps, nextState))\n            return false;\n        if (this.isModelJSONChanged(nextProps)) {\n            this.destroySurvey();\n            this.createSurvey(nextProps);\n            this.updateSurvey(nextProps, {});\n            this.isSurveyUpdated = true;\n        }\n        return true;\n    };\n    Survey.prototype.componentDidUpdate = function (prevProps, prevState) {\n        _super.prototype.componentDidUpdate.call(this, prevProps, prevState);\n        this.updateSurvey(this.props, prevProps);\n        if (this.isSurveyUpdated) {\n            this.onSurveyUpdated();\n            this.isSurveyUpdated = false;\n        }\n    };\n    Survey.prototype.componentDidMount = function () {\n        _super.prototype.componentDidMount.call(this);\n        this.onSurveyUpdated();\n    };\n    Survey.prototype.destroySurvey = function () {\n        if (this.survey) {\n            this.survey.renderCallback = undefined;\n            this.survey.onPartialSend.clear();\n            this.survey.stopTimer();\n            this.survey.destroyResizeObserver();\n        }\n    };\n    Survey.prototype.componentWillUnmount = function () {\n        _super.prototype.componentWillUnmount.call(this);\n        this.destroySurvey();\n    };\n    Survey.prototype.doRender = function () {\n        var renderResult;\n        if (this.survey.state == \"completed\") {\n            renderResult = this.renderCompleted();\n        }\n        else if (this.survey.state == \"completedbefore\") {\n            renderResult = this.renderCompletedBefore();\n        }\n        else if (this.survey.state == \"loading\") {\n            renderResult = this.renderLoading();\n        }\n        else if (this.survey.state == \"empty\") {\n            renderResult = this.renderEmptySurvey();\n        }\n        else {\n            renderResult = this.renderSurvey();\n        }\n        var backgroundImage = !!this.survey.backgroundImage ? external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.css.rootBackgroundImage, style: this.survey.backgroundImageStyle }) : null;\n        var header = this.survey.headerView === \"basic\" ? external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](survey_header_SurveyHeader, { survey: this.survey }) : null;\n        var onSubmit = function (event) {\n            event.preventDefault();\n        };\n        var customHeader = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: \"sv_custom_header\" });\n        if (this.survey.hasLogo) {\n            customHeader = null;\n        }\n        var rootCss = this.survey.getRootCss();\n        var cssClasses = this.rootNodeClassName ? this.rootNodeClassName + \" \" + rootCss : rootCss;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { id: this.rootNodeId, ref: this.rootRef, className: cssClasses, style: this.survey.themeVariables, lang: this.survey.locale || \"en\", dir: this.survey.localeDir },\n            this.survey.needRenderIcons ? external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](svgbundle_SvgBundleComponent, null) : null,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.survey.wrapperFormCss },\n                backgroundImage,\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"form\", { onSubmit: onSubmit },\n                    customHeader,\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.css.container },\n                        header,\n                        external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](components_container_ComponentsContainer, { survey: this.survey, container: \"header\", needRenderWrapper: false }),\n                        renderResult,\n                        external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](components_container_ComponentsContainer, { survey: this.survey, container: \"footer\", needRenderWrapper: false }))),\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](notifier_NotifierComponent, { notifier: this.survey.notifier }))));\n    };\n    Survey.prototype.renderElement = function () {\n        return this.doRender();\n    };\n    Object.defineProperty(Survey.prototype, \"css\", {\n        get: function () {\n            return this.survey.css;\n        },\n        set: function (value) {\n            this.survey.css = value;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Survey.prototype.renderCompleted = function () {\n        if (!this.survey.showCompletedPage)\n            return null;\n        var htmlValue = { __html: this.survey.processedCompletedHtml };\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Fragment\"], null,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { dangerouslySetInnerHTML: htmlValue, className: this.survey.completedCss }),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](components_container_ComponentsContainer, { survey: this.survey, container: \"completePage\", needRenderWrapper: false })));\n    };\n    Survey.prototype.renderCompletedBefore = function () {\n        var htmlValue = { __html: this.survey.processedCompletedBeforeHtml };\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { dangerouslySetInnerHTML: htmlValue, className: this.survey.completedBeforeCss }));\n    };\n    Survey.prototype.renderLoading = function () {\n        var htmlValue = { __html: this.survey.processedLoadingHtml };\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { dangerouslySetInnerHTML: htmlValue, className: this.survey.loadingBodyCss }));\n    };\n    Survey.prototype.renderSurvey = function () {\n        var activePage = this.survey.activePage\n            ? this.renderPage(this.survey.activePage)\n            : null;\n        var isStaring = this.survey.isShowStartingPage;\n        var pageId = this.survey.activePage ? this.survey.activePage.id : \"\";\n        var className = this.survey.bodyCss;\n        var style = {};\n        if (!!this.survey.renderedWidth) {\n            style.maxWidth = this.survey.renderedWidth;\n        }\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.survey.bodyContainerCss },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](components_container_ComponentsContainer, { survey: this.survey, container: \"left\" }),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: \"sv-components-column sv-components-column--expandable\" },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](components_container_ComponentsContainer, { survey: this.survey, container: \"center\" }),\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { id: pageId, className: className, style: style },\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](components_container_ComponentsContainer, { survey: this.survey, container: \"contentTop\" }),\n                    activePage,\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](components_container_ComponentsContainer, { survey: this.survey, container: \"contentBottom\" }),\n                    this.survey.showBrandInfo ? external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](brand_info_BrandInfo, null) : null)),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](components_container_ComponentsContainer, { survey: this.survey, container: \"right\" })));\n    };\n    Survey.prototype.renderPage = function (page) {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](page_SurveyPage, { survey: this.survey, page: page, css: this.css, creator: this }));\n    };\n    Survey.prototype.renderEmptySurvey = function () {\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.css.bodyEmpty }, this.survey.emptySurveyText);\n    };\n    Survey.prototype.createSurvey = function (newProps) {\n        if (!newProps)\n            newProps = {};\n        this.previousJSON = {};\n        if (newProps) {\n            if (newProps.model) {\n                this.survey = newProps.model;\n            }\n            else {\n                if (newProps.json) {\n                    this.previousJSON = newProps.json;\n                    this.survey = new external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"SurveyModel\"](newProps.json);\n                }\n            }\n        }\n        else {\n            this.survey = new external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"SurveyModel\"]();\n        }\n        if (!!newProps.css) {\n            this.survey.css = this.css;\n        }\n        this.setSurveyEvents();\n    };\n    Survey.prototype.isModelJSONChanged = function (newProps) {\n        if (!!newProps[\"model\"]) {\n            return this.survey !== newProps[\"model\"];\n        }\n        if (!!newProps[\"json\"]) {\n            return !external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"Helpers\"].isTwoValueEquals(newProps[\"json\"], this.previousJSON);\n        }\n        return false;\n    };\n    Survey.prototype.updateSurvey = function (newProps, oldProps) {\n        if (!newProps)\n            return;\n        oldProps = oldProps || {};\n        for (var key in newProps) {\n            if (key == \"model\" || key == \"children\" || key == \"json\") {\n                continue;\n            }\n            if (key == \"css\") {\n                this.survey.mergeValues(newProps.css, this.survey.getCss());\n                this.survey[\"updateNavigationCss\"]();\n                this.survey[\"updateElementCss\"]();\n                continue;\n            }\n            if (newProps[key] === oldProps[key])\n                continue;\n            if (key.indexOf(\"on\") == 0 && this.survey[key] && this.survey[key].add) {\n                if (!!oldProps[key]) {\n                    this.survey[key].remove(oldProps[key]);\n                }\n                this.survey[key].add(newProps[key]);\n            }\n            else {\n                this.survey[key] = newProps[key];\n            }\n        }\n    };\n    Survey.prototype.setSurveyEvents = function () {\n        var self = this;\n        this.survey.renderCallback = function () {\n            var counter = !!self.state && !!self.state.modelChanged ? self.state.modelChanged : 0;\n            self.setState({ modelChanged: counter + 1 });\n        };\n        this.survey.onPartialSend.add(function (sender) {\n            if (!!self.state) {\n                self.setState(self.state);\n            }\n        });\n    };\n    //ISurveyCreator\n    Survey.prototype.createQuestionElement = function (question) {\n        return ReactQuestionFactory.Instance.createQuestion(question.isDefaultRendering() ? question.getTemplate() : question.getComponentName(), {\n            question: question,\n            isDisplayMode: question.isInputReadOnly,\n            creator: this,\n        });\n    };\n    Survey.prototype.renderError = function (key, error, cssClasses, element) {\n        return ReactElementFactory.Instance.createElement(this.survey.questionErrorComponent, { key: key, error: error, cssClasses: cssClasses, element: element });\n    };\n    Survey.prototype.questionTitleLocation = function () {\n        return this.survey.questionTitleLocation;\n    };\n    Survey.prototype.questionErrorLocation = function () {\n        return this.survey.questionErrorLocation;\n    };\n    return Survey;\n}(reactquestion_element_SurveyElementBase));\n\nReactElementFactory.Instance.registerElement(\"survey\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactSurvey_Survey, props);\n});\nfunction attachKey2click(element, viewModel, options) {\n    if (options === void 0) { options = { processEsc: true, disableTabStop: false }; }\n    if ((!!viewModel && viewModel.disableTabStop) || (!!options && options.disableTabStop)) {\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"cloneElement\"](element, { tabIndex: -1 });\n    }\n    options = __assign({}, options);\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"cloneElement\"](element, {\n        tabIndex: 0,\n        onKeyUp: function (evt) {\n            evt.preventDefault();\n            evt.stopPropagation();\n            Object(external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"doKey2ClickUp\"])(evt, options);\n            return false;\n        },\n        onKeyDown: function (evt) { return Object(external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"doKey2ClickDown\"])(evt, options); },\n        onBlur: function (evt) { return Object(external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"doKey2ClickBlur\"])(evt); },\n    });\n}\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactSurveyNavigationBase.tsx\nvar reactSurveyNavigationBase_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\nvar SurveyNavigationBase = /** @class */ (function (_super) {\n    reactSurveyNavigationBase_extends(SurveyNavigationBase, _super);\n    function SurveyNavigationBase(props) {\n        var _this = _super.call(this, props) || this;\n        _this.updateStateFunction = null;\n        _this.state = { update: 0 };\n        return _this;\n    }\n    Object.defineProperty(SurveyNavigationBase.prototype, \"survey\", {\n        get: function () {\n            return this.props.survey;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyNavigationBase.prototype, \"css\", {\n        get: function () {\n            return this.props.css || this.survey.css;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyNavigationBase.prototype.componentDidMount = function () {\n        if (this.survey) {\n            var self = this;\n            this.updateStateFunction = function () {\n                self.setState({ update: self.state.update + 1 });\n            };\n            this.survey.onPageVisibleChanged.add(this.updateStateFunction);\n        }\n    };\n    SurveyNavigationBase.prototype.componentWillUnmount = function () {\n        if (this.survey && this.updateStateFunction) {\n            this.survey.onPageVisibleChanged.remove(this.updateStateFunction);\n            this.updateStateFunction = null;\n        }\n    };\n    return SurveyNavigationBase;\n}(external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Component\"]));\n\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reacttimerpanel.tsx\nvar reacttimerpanel_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\nvar reacttimerpanel_SurveyTimerPanel = /** @class */ (function (_super) {\n    reacttimerpanel_extends(SurveyTimerPanel, _super);\n    function SurveyTimerPanel(props) {\n        var _this = _super.call(this, props) || this;\n        _this.circleLength = 440;\n        return _this;\n    }\n    SurveyTimerPanel.prototype.getStateElement = function () {\n        return this.timerModel;\n    };\n    Object.defineProperty(SurveyTimerPanel.prototype, \"timerModel\", {\n        get: function () {\n            return this.props.model;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyTimerPanel.prototype, \"progress\", {\n        get: function () {\n            return -this.timerModel.progress * this.circleLength;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyTimerPanel.prototype.render = function () {\n        if (!this.timerModel.isRunning) {\n            return null;\n        }\n        var result = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.timerModel.survey.getCss().timerRoot }, this.timerModel.text);\n        if (this.timerModel.showTimerAsClock) {\n            var style = { strokeDasharray: this.circleLength, strokeDashoffset: this.progress };\n            var progress = (this.timerModel.showProgress ? external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](svg_icon_SvgIcon, { className: this.timerModel.getProgressCss(), style: style, iconName: \"icon-timercircle\", size: \"auto\" }) : null);\n            result =\n                (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.timerModel.rootCss },\n                    progress,\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.timerModel.textContainerCss },\n                        external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: this.timerModel.majorTextCss }, this.timerModel.clockMajorText),\n                        (this.timerModel.clockMinorText ? external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: this.timerModel.minorTextCss }, this.timerModel.clockMinorText) : null))));\n        }\n        return result;\n    };\n    return SurveyTimerPanel;\n}(ReactSurveyElement));\n\nReactElementFactory.Instance.registerElement(\"sv-timerpanel\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reacttimerpanel_SurveyTimerPanel, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/panel.tsx\nvar panel_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\n\n\n\n\nvar panel_SurveyPanel = /** @class */ (function (_super) {\n    panel_extends(SurveyPanel, _super);\n    function SurveyPanel(props) {\n        var _this = _super.call(this, props) || this;\n        _this.hasBeenExpanded = false;\n        return _this;\n    }\n    Object.defineProperty(SurveyPanel.prototype, \"panel\", {\n        get: function () {\n            return this.panelBase;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyPanel.prototype.renderElement = function () {\n        var _this = this;\n        var header = this.renderHeader();\n        var errors = (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_SurveyElementErrors, { element: this.panelBase, cssClasses: this.panelBase.cssClasses, creator: this.creator }));\n        var style = {\n            paddingLeft: this.panel.innerPaddingLeft,\n            display: this.panel.renderedIsExpanded ? undefined : \"none\",\n        };\n        var content = null;\n        if (this.panel.renderedIsExpanded) {\n            // this.hasBeenExpanded = true;\n            var rows = this.renderRows(this.panelBase.cssClasses);\n            var className = this.panelBase.cssClasses.panel.content;\n            content = this.renderContent(style, rows, className);\n        }\n        var focusIn = function () {\n            if (_this.panelBase)\n                _this.panelBase.focusIn();\n        };\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { ref: this.rootRef, className: this.panelBase.getContainerCss(), onFocus: focusIn, id: this.panelBase.id },\n            this.panel.showErrorsAbovePanel ? errors : null,\n            header,\n            this.panel.showErrorsAbovePanel ? null : errors,\n            content));\n    };\n    SurveyPanel.prototype.renderHeader = function () {\n        if (!this.panel.hasTitle && !this.panel.hasDescription) {\n            return null;\n        }\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](element_header_SurveyElementHeader, { element: this.panel });\n    };\n    SurveyPanel.prototype.wrapElement = function (element) {\n        var survey = this.panel.survey;\n        var wrapper = null;\n        if (survey) {\n            wrapper = reactsurveymodel_ReactSurveyElementsWrapper.wrapElement(survey, element, this.panel);\n        }\n        return wrapper !== null && wrapper !== void 0 ? wrapper : element;\n    };\n    SurveyPanel.prototype.renderContent = function (style, rows, className) {\n        var bottom = this.renderBottom();\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { style: style, className: className, id: this.panel.contentId },\n            rows,\n            bottom));\n    };\n    SurveyPanel.prototype.renderTitle = function () {\n        if (!this.panelBase.title)\n            return null;\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](title_element_TitleElement, { element: this.panelBase });\n    };\n    SurveyPanel.prototype.renderDescription = function () {\n        if (!this.panelBase.description)\n            return null;\n        var text = reactquestion_element_SurveyElementBase.renderLocString(this.panelBase.locDescription);\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.panel.cssClasses.panel.description }, text));\n    };\n    SurveyPanel.prototype.renderBottom = function () {\n        var footerToolbar = this.panel.getFooterToolbar();\n        if (!footerToolbar.hasActions)\n            return null;\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](action_bar_SurveyActionBar, { model: footerToolbar });\n    };\n    SurveyPanel.prototype.getIsVisible = function () {\n        return this.panelBase.getIsContentVisible();\n    };\n    return SurveyPanel;\n}(panel_base_SurveyPanelBase));\n\nReactElementFactory.Instance.registerElement(\"panel\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](panel_SurveyPanel, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/flow-panel.tsx\nvar flow_panel_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\nvar flow_panel_SurveyFlowPanel = /** @class */ (function (_super) {\n    flow_panel_extends(SurveyFlowPanel, _super);\n    function SurveyFlowPanel(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(SurveyFlowPanel.prototype, \"flowPanel\", {\n        get: function () {\n            return this.panel;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyFlowPanel.prototype.componentDidMount = function () {\n        _super.prototype.componentDidMount.call(this);\n        if (!!this.flowPanel) {\n            this.flowPanel.onCustomHtmlProducing = function () {\n                return \"\";\n            };\n            this.flowPanel.onGetHtmlForQuestion = this.renderQuestion;\n        }\n    };\n    SurveyFlowPanel.prototype.componentWillUnmount = function () {\n        _super.prototype.componentWillUnmount.call(this);\n        if (!!this.flowPanel) {\n            this.flowPanel.onCustomHtmlProducing = null;\n            this.flowPanel.onGetHtmlForQuestion = null;\n        }\n    };\n    SurveyFlowPanel.prototype.getQuestion = function (name) {\n        return this.flowPanel.getQuestionByName(name);\n    };\n    SurveyFlowPanel.prototype.renderQuestion = function (question) {\n        return \"<question>\" + question.name + \"</question>\";\n    };\n    SurveyFlowPanel.prototype.renderRows = function () {\n        var result = this.renderHtml();\n        if (!!result) {\n            return [result];\n        }\n        else {\n            return [];\n        }\n    };\n    SurveyFlowPanel.prototype.getNodeIndex = function () {\n        return this.renderedIndex++;\n    };\n    SurveyFlowPanel.prototype.renderHtml = function () {\n        if (!this.flowPanel)\n            return null;\n        var html = \"<span>\" + this.flowPanel.produceHtml() + \"</span>\";\n        if (!DOMParser) {\n            var htmlValue = { __html: html };\n            return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { dangerouslySetInnerHTML: htmlValue });\n        }\n        var doc = new DOMParser().parseFromString(html, \"text/xml\");\n        this.renderedIndex = 0;\n        return this.renderParentNode(doc);\n    };\n    SurveyFlowPanel.prototype.renderNodes = function (domNodes) {\n        var nodes = [];\n        for (var i = 0; i < domNodes.length; i++) {\n            var node = this.renderNode(domNodes[i]);\n            if (!!node) {\n                nodes.push(node);\n            }\n        }\n        return nodes;\n    };\n    SurveyFlowPanel.prototype.getStyle = function (nodeType) {\n        var style = {};\n        if (nodeType.toLowerCase() === \"b\") {\n            style.fontWeight = \"bold\";\n        }\n        if (nodeType.toLowerCase() === \"i\") {\n            style.fontStyle = \"italic\";\n        }\n        if (nodeType.toLowerCase() === \"u\") {\n            style.textDecoration = \"underline\";\n        }\n        return style;\n    };\n    SurveyFlowPanel.prototype.renderParentNode = function (node) {\n        var nodeType = node.nodeName.toLowerCase();\n        var children = this.renderNodes(this.getChildDomNodes(node));\n        if (nodeType === \"div\")\n            return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { key: this.getNodeIndex() }, children);\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { key: this.getNodeIndex(), style: this.getStyle(nodeType) }, children));\n    };\n    SurveyFlowPanel.prototype.renderNode = function (node) {\n        if (!this.hasTextChildNodesOnly(node)) {\n            return this.renderParentNode(node);\n        }\n        var nodeType = node.nodeName.toLowerCase();\n        if (nodeType === \"question\") {\n            var question = this.flowPanel.getQuestionByName(node.textContent);\n            if (!question)\n                return null;\n            var questionBody = (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_SurveyQuestion, { key: question.name, element: question, creator: this.creator, css: this.css }));\n            return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { key: this.getNodeIndex() }, questionBody);\n        }\n        if (nodeType === \"div\") {\n            return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { key: this.getNodeIndex() }, node.textContent);\n        }\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { key: this.getNodeIndex(), style: this.getStyle(nodeType) }, node.textContent));\n    };\n    SurveyFlowPanel.prototype.getChildDomNodes = function (node) {\n        var domNodes = [];\n        for (var i = 0; i < node.childNodes.length; i++) {\n            domNodes.push(node.childNodes[i]);\n        }\n        return domNodes;\n    };\n    SurveyFlowPanel.prototype.hasTextChildNodesOnly = function (node) {\n        var nodes = node.childNodes;\n        for (var i = 0; i < nodes.length; i++) {\n            if (nodes[i].nodeName.toLowerCase() !== \"#text\")\n                return false;\n        }\n        return true;\n    };\n    SurveyFlowPanel.prototype.renderContent = function (style, rows) {\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"f-panel\", { style: style }, rows);\n    };\n    return SurveyFlowPanel;\n}(panel_SurveyPanel));\n\nReactElementFactory.Instance.registerElement(\"flowpanel\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](flow_panel_SurveyFlowPanel, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion_checkbox.tsx\nvar reactquestion_checkbox_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\n\nvar reactquestion_checkbox_SurveyQuestionCheckbox = /** @class */ (function (_super) {\n    reactquestion_checkbox_extends(SurveyQuestionCheckbox, _super);\n    function SurveyQuestionCheckbox(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(SurveyQuestionCheckbox.prototype, \"question\", {\n        get: function () {\n            return this.questionBase;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionCheckbox.prototype.renderElement = function () {\n        var _this = this;\n        var cssClasses = this.question.cssClasses;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"fieldset\", { className: this.question.getSelectBaseRootCss(), ref: function (fieldset) { return (_this.setControl(fieldset)); }, role: this.question.a11y_input_ariaRole, \"aria-required\": this.question.a11y_input_ariaRequired, \"aria-label\": this.question.a11y_input_ariaLabel, \"aria-labelledby\": this.question.a11y_input_ariaLabelledBy, \"aria-describedby\": this.question.a11y_input_ariaDescribedBy, \"aria-invalid\": this.question.a11y_input_ariaInvalid, \"aria-errormessage\": this.question.a11y_input_ariaErrormessage },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"legend\", { className: \"sv-hidden\" }, this.question.locTitle.renderedHtml),\n            this.getHeader(),\n            this.question.hasColumns\n                ? this.getColumnedBody(cssClasses)\n                : this.getBody(cssClasses),\n            this.getFooter(),\n            this.question.isOtherSelected ? this.renderOther() : null));\n    };\n    SurveyQuestionCheckbox.prototype.getHeader = function () {\n        var _this = this;\n        if (this.question.hasHeadItems) {\n            return this.question.headItems.map(function (item, ii) {\n                return _this.renderItem(\"item_h\" + ii, item, false, _this.question.cssClasses);\n            });\n        }\n    };\n    SurveyQuestionCheckbox.prototype.getFooter = function () {\n        var _this = this;\n        if (this.question.hasFootItems) {\n            return this.question.footItems.map(function (item, ii) {\n                return _this.renderItem(\"item_f\" + ii, item, false, _this.question.cssClasses);\n            });\n        }\n    };\n    SurveyQuestionCheckbox.prototype.getColumnedBody = function (cssClasses) {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: cssClasses.rootMultiColumn }, this.getColumns(cssClasses)));\n    };\n    SurveyQuestionCheckbox.prototype.getColumns = function (cssClasses) {\n        var _this = this;\n        return this.question.columns.map(function (column, ci) {\n            var items = column.map(function (item, ii) {\n                return _this.renderItem(\"item\" + ii, item, ci === 0 && ii === 0, cssClasses, \"\" + ci + ii);\n            });\n            return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { key: \"column\" + ci + _this.question.getItemsColumnKey(column), className: _this.question.getColumnClass(), role: \"presentation\" }, items));\n        });\n    };\n    SurveyQuestionCheckbox.prototype.getBody = function (cssClasses) {\n        if (this.question.blockedRow) {\n            return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: cssClasses.rootRow }, this.getItems(cssClasses, this.question.dataChoices));\n        }\n        else\n            return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Fragment\"], null, this.getItems(cssClasses, this.question.bodyItems));\n    };\n    SurveyQuestionCheckbox.prototype.getItems = function (cssClasses, choices) {\n        var renderedItems = [];\n        for (var i = 0; i < choices.length; i++) {\n            var item = choices[i];\n            var key = \"item\" + i;\n            var renderedItem = this.renderItem(key, item, i == 0, cssClasses, \"\" + i);\n            if (!!renderedItem) {\n                renderedItems.push(renderedItem);\n            }\n        }\n        return renderedItems;\n    };\n    Object.defineProperty(SurveyQuestionCheckbox.prototype, \"textStyle\", {\n        get: function () {\n            return null;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionCheckbox.prototype.renderOther = function () {\n        var cssClasses = this.question.cssClasses;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.getCommentAreaCss(true) },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](SurveyQuestionOtherValueItem, { question: this.question, otherCss: cssClasses.other, cssClasses: cssClasses, isDisplayMode: this.isDisplayMode })));\n    };\n    SurveyQuestionCheckbox.prototype.renderItem = function (key, item, isFirst, cssClasses, index) {\n        var renderedItem = ReactElementFactory.Instance.createElement(this.question.itemComponent, {\n            key: key,\n            question: this.question,\n            cssClasses: cssClasses,\n            isDisplayMode: this.isDisplayMode,\n            item: item,\n            textStyle: this.textStyle,\n            index: index,\n            isFirst: isFirst,\n        });\n        var survey = this.question.survey;\n        var wrappedItem = null;\n        if (!!survey && !!renderedItem) {\n            wrappedItem = reactsurveymodel_ReactSurveyElementsWrapper.wrapItemValue(survey, renderedItem, this.question, item);\n        }\n        return wrappedItem !== null && wrappedItem !== void 0 ? wrappedItem : renderedItem;\n    };\n    return SurveyQuestionCheckbox;\n}(reactquestion_element_SurveyQuestionElementBase));\n\nvar reactquestion_checkbox_SurveyQuestionCheckboxItem = /** @class */ (function (_super) {\n    reactquestion_checkbox_extends(SurveyQuestionCheckboxItem, _super);\n    function SurveyQuestionCheckboxItem(props) {\n        var _this = _super.call(this, props) || this;\n        _this.handleOnChange = function (event) {\n            _this.question.clickItemHandler(_this.item, event.target.checked);\n        };\n        return _this;\n    }\n    SurveyQuestionCheckboxItem.prototype.getStateElement = function () {\n        return this.item;\n    };\n    Object.defineProperty(SurveyQuestionCheckboxItem.prototype, \"question\", {\n        get: function () {\n            return this.props.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionCheckboxItem.prototype, \"item\", {\n        get: function () {\n            return this.props.item;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionCheckboxItem.prototype, \"textStyle\", {\n        get: function () {\n            return this.props.textStyle;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionCheckboxItem.prototype, \"isFirst\", {\n        get: function () {\n            return this.props.isFirst;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionCheckboxItem.prototype, \"index\", {\n        get: function () {\n            return this.props.index;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionCheckboxItem.prototype, \"hideCaption\", {\n        get: function () {\n            return this.props.hideCaption === true;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionCheckboxItem.prototype.shouldComponentUpdate = function (nextProps, nextState) {\n        if (!_super.prototype.shouldComponentUpdate.call(this, nextProps, nextState))\n            return false;\n        if (!this.question)\n            return false;\n        return (!this.question.customWidget ||\n            !!this.question.customWidgetData.isNeedRender ||\n            !!this.question.customWidget.widgetJson.isDefaultRender ||\n            !!this.question.customWidget.widgetJson.render);\n    };\n    SurveyQuestionCheckboxItem.prototype.canRender = function () {\n        return !!this.item && !!this.question;\n    };\n    SurveyQuestionCheckboxItem.prototype.renderElement = function () {\n        var isChecked = this.question.isItemSelected(this.item);\n        return this.renderCheckbox(isChecked, null);\n    };\n    Object.defineProperty(SurveyQuestionCheckboxItem.prototype, \"inputStyle\", {\n        get: function () {\n            return null; //{ marginRight: \"3px\" };\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionCheckboxItem.prototype.renderCheckbox = function (isChecked, otherItem) {\n        var id = this.question.getItemId(this.item);\n        var itemClass = this.question.getItemClass(this.item);\n        var labelClass = this.question.getLabelClass(this.item);\n        var itemLabel = !this.hideCaption ? external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: this.cssClasses.controlLabel }, this.renderLocString(this.item.locText, this.textStyle)) : null;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: itemClass, role: \"presentation\" },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"label\", { className: labelClass },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"input\", { className: this.cssClasses.itemControl, type: \"checkbox\", name: this.question.name + this.item.id, value: this.item.value, id: id, style: this.inputStyle, disabled: !this.question.getItemEnabled(this.item), readOnly: this.question.isReadOnlyAttr, checked: isChecked, onChange: this.handleOnChange, required: this.question.hasRequiredError() }),\n                this.cssClasses.materialDecorator ?\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: this.cssClasses.materialDecorator }, this.question.itemSvgIcon ?\n                        external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"svg\", { className: this.cssClasses.itemDecorator },\n                            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"use\", { xlinkHref: this.question.itemSvgIcon })) :\n                        null) :\n                    null,\n                itemLabel),\n            otherItem));\n    };\n    return SurveyQuestionCheckboxItem;\n}(ReactSurveyElement));\n\nReactElementFactory.Instance.registerElement(\"survey-checkbox-item\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_checkbox_SurveyQuestionCheckboxItem, props);\n});\nReactQuestionFactory.Instance.registerQuestion(\"checkbox\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_checkbox_SurveyQuestionCheckbox, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion_ranking.tsx\nvar reactquestion_ranking_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\nvar reactquestion_ranking_SurveyQuestionRanking = /** @class */ (function (_super) {\n    reactquestion_ranking_extends(SurveyQuestionRanking, _super);\n    function SurveyQuestionRanking() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(SurveyQuestionRanking.prototype, \"question\", {\n        get: function () {\n            return this.questionBase;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionRanking.prototype.renderElement = function () {\n        var _this = this;\n        if (!this.question.selectToRankEnabled) {\n            return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.rootClass, ref: function (root) { return (_this.setControl(root)); } }, this.getItems()));\n        }\n        else {\n            var unrankedItem = true;\n            return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.rootClass, ref: function (root) { return (_this.setControl(root)); } },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.getContainerClasses(\"from\"), \"data-ranking\": \"from-container\" },\n                    this.getItems(this.question.renderedUnRankingChoices, unrankedItem),\n                    this.question.renderedUnRankingChoices.length === 0 ? external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.containerPlaceholder },\n                        \" \",\n                        this.renderLocString(this.question.locSelectToRankEmptyRankedAreaText),\n                        \" \") : null),\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.containersDivider }),\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.getContainerClasses(\"to\"), \"data-ranking\": \"to-container\" },\n                    this.getItems(),\n                    this.question.renderedRankingChoices.length === 0 ? external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.containerPlaceholder },\n                        \" \",\n                        this.renderLocString(this.question.locSelectToRankEmptyUnrankedAreaText),\n                        \" \") : null)));\n        }\n    };\n    SurveyQuestionRanking.prototype.getItems = function (choices, unrankedItem) {\n        var _this = this;\n        if (choices === void 0) { choices = this.question.renderedRankingChoices; }\n        var items = [];\n        var _loop_1 = function (i) {\n            var item = choices[i];\n            items.push(this_1.renderItem(item, i, function (event) {\n                _this.question.handleKeydown.call(_this.question, event, item);\n            }, function (event) {\n                event.persist();\n                //event.preventDefault();\n                _this.question.handlePointerDown.call(_this.question, event, item, event.currentTarget);\n            }, function (event) {\n                event.persist();\n                //event.preventDefault();\n                _this.question.handlePointerUp.call(_this.question, event, item, event.currentTarget);\n            }, this_1.question.cssClasses, this_1.question.getItemClass(item), this_1.question, unrankedItem));\n        };\n        var this_1 = this;\n        for (var i = 0; i < choices.length; i++) {\n            _loop_1(i);\n        }\n        return items;\n    };\n    SurveyQuestionRanking.prototype.renderItem = function (item, i, handleKeydown, handlePointerDown, handlePointerUp, cssClasses, itemClass, question, unrankedItem) {\n        var key = \"id-\" + item.renderedId;\n        var text = this.renderLocString(item.locText);\n        var index = i;\n        var indexText = this.question.getNumberByIndex(index);\n        var tabIndex = this.question.getItemTabIndex(item);\n        var renderedItem = (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_ranking_SurveyQuestionRankingItem, { key: item.value, text: text, index: index, indexText: indexText, itemTabIndex: tabIndex, handleKeydown: handleKeydown, handlePointerDown: handlePointerDown, handlePointerUp: handlePointerUp, cssClasses: cssClasses, itemClass: itemClass, question: question, unrankedItem: unrankedItem, item: item }));\n        var survey = this.question.survey;\n        var wrappedItem = null;\n        if (!!survey) {\n            wrappedItem = reactsurveymodel_ReactSurveyElementsWrapper.wrapItemValue(survey, renderedItem, this.question, item);\n        }\n        return wrappedItem !== null && wrappedItem !== void 0 ? wrappedItem : renderedItem;\n    };\n    return SurveyQuestionRanking;\n}(reactquestion_element_SurveyQuestionElementBase));\n\nvar reactquestion_ranking_SurveyQuestionRankingItem = /** @class */ (function (_super) {\n    reactquestion_ranking_extends(SurveyQuestionRankingItem, _super);\n    function SurveyQuestionRankingItem() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(SurveyQuestionRankingItem.prototype, \"text\", {\n        get: function () {\n            return this.props.text;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionRankingItem.prototype, \"index\", {\n        get: function () {\n            return this.props.index;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionRankingItem.prototype, \"indexText\", {\n        get: function () {\n            return this.props.indexText;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionRankingItem.prototype, \"handleKeydown\", {\n        get: function () {\n            return this.props.handleKeydown;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionRankingItem.prototype, \"handlePointerDown\", {\n        get: function () {\n            return this.props.handlePointerDown;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionRankingItem.prototype, \"handlePointerUp\", {\n        get: function () {\n            return this.props.handlePointerUp;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionRankingItem.prototype, \"cssClasses\", {\n        get: function () {\n            return this.props.cssClasses;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionRankingItem.prototype, \"itemClass\", {\n        get: function () {\n            return this.props.itemClass;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionRankingItem.prototype, \"itemTabIndex\", {\n        get: function () {\n            return this.props.itemTabIndex;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionRankingItem.prototype, \"question\", {\n        get: function () {\n            return this.props.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionRankingItem.prototype, \"unrankedItem\", {\n        get: function () {\n            return this.props.unrankedItem;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionRankingItem.prototype, \"item\", {\n        get: function () {\n            return this.props.item;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionRankingItem.prototype.renderEmptyIcon = function () {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"svg\", null,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"use\", { xlinkHref: this.question.dashSvgIcon })));\n    };\n    SurveyQuestionRankingItem.prototype.renderElement = function () {\n        var itemContent = ReactElementFactory.Instance.createElement(this.question.itemComponent, { item: this.item, cssClasses: this.cssClasses });\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { tabIndex: this.itemTabIndex, className: this.itemClass, onKeyDown: this.handleKeydown, onPointerDown: this.handlePointerDown, onPointerUp: this.handlePointerUp, \"data-sv-drop-target-ranking-item\": this.index },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { tabIndex: -1, style: { outline: \"none\" } },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.cssClasses.itemGhostNode }),\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.cssClasses.itemContent },\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.cssClasses.itemIconContainer },\n                        external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"svg\", { className: this.question.getIconHoverCss() },\n                            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"use\", { xlinkHref: this.question.dragDropSvgIcon })),\n                        external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"svg\", { className: this.question.getIconFocusCss() },\n                            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"use\", { xlinkHref: this.question.arrowsSvgIcon }))),\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.getItemIndexClasses(this.item) }, (!this.unrankedItem && this.indexText) ? this.indexText : this.renderEmptyIcon()),\n                    itemContent))));\n    };\n    return SurveyQuestionRankingItem;\n}(ReactSurveyElement));\n\nvar reactquestion_ranking_SurveyQuestionRankingItemContent = /** @class */ (function (_super) {\n    reactquestion_ranking_extends(SurveyQuestionRankingItemContent, _super);\n    function SurveyQuestionRankingItemContent() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(SurveyQuestionRankingItemContent.prototype, \"item\", {\n        get: function () {\n            return this.props.item;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionRankingItemContent.prototype, \"cssClasses\", {\n        get: function () {\n            return this.props.cssClasses;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionRankingItemContent.prototype.renderElement = function () {\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.cssClasses.controlLabel }, reactquestion_element_SurveyElementBase.renderLocString(this.item.locText));\n    };\n    return SurveyQuestionRankingItemContent;\n}(ReactSurveyElement));\n\nReactElementFactory.Instance.registerElement(\"sv-ranking-item\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_ranking_SurveyQuestionRankingItemContent, props);\n});\nReactQuestionFactory.Instance.registerQuestion(\"ranking\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_ranking_SurveyQuestionRanking, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/rating/rating-item.tsx\nvar rating_item_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar RatingItemBase = /** @class */ (function (_super) {\n    rating_item_extends(RatingItemBase, _super);\n    function RatingItemBase(props) {\n        var _this = _super.call(this, props) || this;\n        _this.handleOnMouseDown = _this.handleOnMouseDown.bind(_this);\n        return _this;\n    }\n    Object.defineProperty(RatingItemBase.prototype, \"question\", {\n        get: function () {\n            return this.props.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RatingItemBase.prototype, \"item\", {\n        get: function () {\n            return this.props.item;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RatingItemBase.prototype, \"index\", {\n        get: function () {\n            return this.props.index;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    RatingItemBase.prototype.getStateElement = function () {\n        return this.item;\n    };\n    RatingItemBase.prototype.handleOnMouseDown = function (event) {\n        this.question.onMouseDown();\n    };\n    return RatingItemBase;\n}(reactquestion_element_SurveyElementBase));\n\nvar rating_item_RatingItem = /** @class */ (function (_super) {\n    rating_item_extends(RatingItem, _super);\n    function RatingItem() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    RatingItem.prototype.render = function () {\n        var itemText = this.renderLocString(this.item.locText);\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"label\", { onMouseDown: this.handleOnMouseDown, className: this.question.getItemClassByText(this.item.itemValue, this.item.text) },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"input\", { type: \"radio\", className: \"sv-visuallyhidden\", name: this.question.questionName, id: this.question.getInputId(this.index), value: this.item.value, disabled: this.question.isDisabledAttr, readOnly: this.question.isReadOnlyAttr, checked: this.question.value == this.item.value, onClick: this.props.handleOnClick, onChange: function () { }, \"aria-required\": this.question.ariaRequired, \"aria-label\": this.question.ariaLabel, \"aria-invalid\": this.question.ariaInvalid, \"aria-errormessage\": this.question.ariaErrormessage }),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { className: this.question.cssClasses.itemText, \"data-text\": this.item.text }, itemText)));\n    };\n    RatingItem.prototype.componentDidMount = function () {\n        _super.prototype.componentDidMount.call(this);\n    };\n    return RatingItem;\n}(RatingItemBase));\n\nReactElementFactory.Instance.registerElement(\"sv-rating-item\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(rating_item_RatingItem, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/rating/rating-item-star.tsx\nvar rating_item_star_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\nvar rating_item_star_RatingItemStar = /** @class */ (function (_super) {\n    rating_item_star_extends(RatingItemStar, _super);\n    function RatingItemStar() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    RatingItemStar.prototype.render = function () {\n        var _this = this;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"label\", { onMouseDown: this.handleOnMouseDown, className: this.question.getItemClass(this.item.itemValue), onMouseOver: function (e) { return _this.question.onItemMouseIn(_this.item); }, onMouseOut: function (e) { return _this.question.onItemMouseOut(_this.item); } },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"input\", { type: \"radio\", className: \"sv-visuallyhidden\", name: this.question.questionName, id: this.question.getInputId(this.index), value: this.item.value, disabled: this.question.isDisabledAttr, readOnly: this.question.isReadOnlyAttr, checked: this.question.value == this.item.value, onClick: this.props.handleOnClick, onChange: function () { }, \"aria-required\": this.question.ariaRequired, \"aria-label\": this.question.ariaLabel, \"aria-invalid\": this.question.ariaInvalid, \"aria-errormessage\": this.question.ariaErrormessage }),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(svg_icon_SvgIcon, { className: \"sv-star\", size: \"auto\", iconName: this.question.itemStarIcon, title: this.item.text }),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(svg_icon_SvgIcon, { className: \"sv-star-2\", size: \"auto\", iconName: this.question.itemStarIconAlt, title: this.item.text })));\n    };\n    return RatingItemStar;\n}(RatingItemBase));\n\nReactElementFactory.Instance.registerElement(\"sv-rating-item-star\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(rating_item_star_RatingItemStar, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/rating/rating-item-smiley.tsx\nvar rating_item_smiley_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\nvar rating_item_smiley_RatingItemSmiley = /** @class */ (function (_super) {\n    rating_item_smiley_extends(RatingItemSmiley, _super);\n    function RatingItemSmiley() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    RatingItemSmiley.prototype.render = function () {\n        var _this = this;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"label\", { onMouseDown: this.handleOnMouseDown, style: this.question.getItemStyle(this.item.itemValue, this.item.highlight), className: this.question.getItemClass(this.item.itemValue), onMouseOver: function (e) { return _this.question.onItemMouseIn(_this.item); }, onMouseOut: function (e) { return _this.question.onItemMouseOut(_this.item); } },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"input\", { type: \"radio\", className: \"sv-visuallyhidden\", name: this.question.questionName, id: this.question.getInputId(this.index), value: this.item.value, disabled: this.question.isDisabledAttr, readOnly: this.question.isReadOnlyAttr, checked: this.question.value == this.item.value, onClick: this.props.handleOnClick, onChange: function () { }, \"aria-required\": this.question.ariaRequired, \"aria-label\": this.question.ariaLabel, \"aria-invalid\": this.question.ariaInvalid, \"aria-errormessage\": this.question.ariaErrormessage }),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(svg_icon_SvgIcon, { size: \"auto\", iconName: this.question.getItemSmileyIconName(this.item.itemValue), title: this.item.text })));\n    };\n    return RatingItemSmiley;\n}(RatingItemBase));\n\nReactElementFactory.Instance.registerElement(\"sv-rating-item-smiley\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(rating_item_smiley_RatingItemSmiley, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/rating/rating-dropdown-item.tsx\nvar rating_dropdown_item_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar rating_dropdown_item_RatingDropdownItem = /** @class */ (function (_super) {\n    rating_dropdown_item_extends(RatingDropdownItem, _super);\n    function RatingDropdownItem() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(RatingDropdownItem.prototype, \"item\", {\n        get: function () {\n            return this.props.item;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    RatingDropdownItem.prototype.getStateElement = function () {\n        return this.item;\n    };\n    RatingDropdownItem.prototype.render = function () {\n        if (!this.item)\n            return null;\n        var item = this.props.item;\n        var description = this.renderDescription(item);\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sd-rating-dropdown-item\" },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { className: \"sd-rating-dropdown-item_text\" }, item.title),\n            description));\n    };\n    RatingDropdownItem.prototype.renderDescription = function (item) {\n        if (!item.description)\n            return null;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sd-rating-dropdown-item_description\" }, this.renderLocString(item.description, undefined, \"locString\")));\n    };\n    return RatingDropdownItem;\n}(reactquestion_element_SurveyElementBase));\n\nReactElementFactory.Instance.registerElement(\"sv-rating-dropdown-item\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(rating_dropdown_item_RatingDropdownItem, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/tagbox-filter.tsx\nvar tagbox_filter_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\nvar tagbox_filter_TagboxFilterString = /** @class */ (function (_super) {\n    tagbox_filter_extends(TagboxFilterString, _super);\n    function TagboxFilterString(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(TagboxFilterString.prototype, \"model\", {\n        get: function () {\n            return this.props.model;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(TagboxFilterString.prototype, \"question\", {\n        get: function () {\n            return this.props.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    TagboxFilterString.prototype.componentDidUpdate = function (prevProps, prevState) {\n        _super.prototype.componentDidUpdate.call(this, prevProps, prevState);\n        this.updateDomElement();\n    };\n    TagboxFilterString.prototype.componentDidMount = function () {\n        _super.prototype.componentDidMount.call(this);\n        this.updateDomElement();\n    };\n    TagboxFilterString.prototype.updateDomElement = function () {\n        if (!!this.inputElement) {\n            var control = this.inputElement;\n            var newValue = this.model.inputStringRendered;\n            if (!external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"Helpers\"].isTwoValueEquals(newValue, control.value, false, true, false)) {\n                control.value = this.model.inputStringRendered;\n            }\n        }\n    };\n    TagboxFilterString.prototype.onChange = function (e) {\n        var root = external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"settings\"].environment.root;\n        if (e.target === root.activeElement) {\n            this.model.inputStringRendered = e.target.value;\n        }\n    };\n    TagboxFilterString.prototype.keyhandler = function (e) {\n        this.model.inputKeyHandler(e);\n    };\n    TagboxFilterString.prototype.onBlur = function (e) {\n        this.model.onBlur(e);\n    };\n    TagboxFilterString.prototype.onFocus = function (e) {\n        this.model.onFocus(e);\n    };\n    TagboxFilterString.prototype.getStateElement = function () {\n        return this.model;\n    };\n    TagboxFilterString.prototype.render = function () {\n        var _this = this;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.hint },\n            this.model.showHintPrefix ?\n                (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.hintPrefix },\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", null, this.model.hintStringPrefix))) : null,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.hintSuffixWrapper },\n                this.model.showHintString ?\n                    (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.hintSuffix },\n                        external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { style: { visibility: \"hidden\" }, \"data-bind\": \"text: model.filterString\" }, this.model.inputStringRendered),\n                        external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", null, this.model.hintStringSuffix))) : null,\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"input\", { type: \"text\", autoComplete: \"off\", id: this.question.getInputId(), inputMode: this.model.inputMode, ref: function (element) { return (_this.inputElement = element); }, className: this.question.cssClasses.filterStringInput, disabled: this.question.isInputReadOnly, readOnly: this.model.filterReadOnly ? true : undefined, size: !this.model.inputStringRendered ? 1 : undefined, role: this.model.filterStringEnabled ? this.question.ariaRole : undefined, \"aria-expanded\": this.question.ariaExpanded, \"aria-label\": this.question.a11y_input_ariaLabel, \"aria-labelledby\": this.question.a11y_input_ariaLabelledBy, \"aria-describedby\": this.question.a11y_input_ariaDescribedBy, \"aria-controls\": this.model.listElementId, \"aria-activedescendant\": this.model.ariaActivedescendant, placeholder: this.model.filterStringPlaceholder, onKeyDown: function (e) { _this.keyhandler(e); }, onChange: function (e) { _this.onChange(e); }, onBlur: function (e) { _this.onBlur(e); }, onFocus: function (e) { _this.onFocus(e); } }))));\n    };\n    return TagboxFilterString;\n}(reactquestion_element_SurveyElementBase));\n\nReactQuestionFactory.Instance.registerQuestion(\"sv-tagbox-filter\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](tagbox_filter_TagboxFilterString, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/dropdown-item.tsx\nvar dropdown_item_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\nvar dropdown_item_SurveyQuestionOptionItem = /** @class */ (function (_super) {\n    dropdown_item_extends(SurveyQuestionOptionItem, _super);\n    function SurveyQuestionOptionItem(props) {\n        var _this = _super.call(this, props) || this;\n        _this.state = { changed: 0 };\n        _this.setupModel();\n        return _this;\n    }\n    SurveyQuestionOptionItem.prototype.componentDidUpdate = function (prevProps, prevState) {\n        _super.prototype.componentDidUpdate.call(this, prevProps, prevState);\n        this.setupModel();\n    };\n    SurveyQuestionOptionItem.prototype.componentWillUnmount = function () {\n        _super.prototype.componentWillUnmount.call(this);\n        if (!!this.item) {\n            this.item.locText.onChanged = function () { };\n        }\n    };\n    SurveyQuestionOptionItem.prototype.setupModel = function () {\n        if (!this.item.locText)\n            return;\n        var self = this;\n        this.item.locText.onChanged = function () {\n            self.setState({ changed: self.state.changed + 1 });\n        };\n    };\n    SurveyQuestionOptionItem.prototype.getStateElement = function () {\n        return this.item;\n    };\n    Object.defineProperty(SurveyQuestionOptionItem.prototype, \"item\", {\n        get: function () {\n            return this.props.item;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionOptionItem.prototype.canRender = function () {\n        return !!this.item;\n    };\n    SurveyQuestionOptionItem.prototype.renderElement = function () {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"option\", { value: this.item.value, disabled: !this.item.isEnabled }, this.item.text));\n    };\n    return SurveyQuestionOptionItem;\n}(ReactSurveyElement));\n\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/dropdown-base.tsx\nvar dropdown_base_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\n\n\nvar dropdown_base_SurveyQuestionDropdownBase = /** @class */ (function (_super) {\n    dropdown_base_extends(SurveyQuestionDropdownBase, _super);\n    function SurveyQuestionDropdownBase() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.click = function (event) {\n            var _a;\n            (_a = _this.question.dropdownListModel) === null || _a === void 0 ? void 0 : _a.onClick(event);\n        };\n        _this.chevronPointerDown = function (event) {\n            var _a;\n            (_a = _this.question.dropdownListModel) === null || _a === void 0 ? void 0 : _a.chevronPointerDown(event);\n        };\n        _this.clear = function (event) {\n            var _a;\n            (_a = _this.question.dropdownListModel) === null || _a === void 0 ? void 0 : _a.onClear(event);\n        };\n        _this.keyhandler = function (event) {\n            var _a;\n            (_a = _this.question.dropdownListModel) === null || _a === void 0 ? void 0 : _a.keyHandler(event);\n        };\n        _this.blur = function (event) {\n            _this.updateInputDomElement();\n            _this.question.onBlur(event);\n        };\n        _this.focus = function (event) {\n            _this.question.onFocus(event);\n        };\n        return _this;\n    }\n    SurveyQuestionDropdownBase.prototype.getStateElement = function () {\n        return this.question[\"dropdownListModel\"];\n    };\n    SurveyQuestionDropdownBase.prototype.setValueCore = function (newValue) {\n        this.questionBase.renderedValue = newValue;\n    };\n    SurveyQuestionDropdownBase.prototype.getValueCore = function () {\n        return this.questionBase.renderedValue;\n    };\n    SurveyQuestionDropdownBase.prototype.renderReadOnlyElement = function () {\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", null, this.question.readOnlyText);\n    };\n    SurveyQuestionDropdownBase.prototype.renderSelect = function (cssClasses) {\n        var _a, _b;\n        var selectElement = null;\n        if (this.question.isReadOnly) {\n            var text = (this.question.selectedItemLocText) ? this.renderLocString(this.question.selectedItemLocText) : \"\";\n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            selectElement = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { id: this.question.inputId, \"aria-label\": this.question.a11y_input_ariaLabel, \"aria-labelledby\": this.question.a11y_input_ariaLabelledBy, \"aria-describedby\": this.question.a11y_input_ariaDescribedBy, tabIndex: this.question.isDisabledAttr ? undefined : 0, className: this.question.getControlClass() },\n                text,\n                this.renderReadOnlyElement());\n        }\n        else {\n            selectElement = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Fragment\"], null,\n                this.renderInput(this.question[\"dropdownListModel\"]),\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](popup_Popup, { model: (_b = (_a = this.question) === null || _a === void 0 ? void 0 : _a.dropdownListModel) === null || _b === void 0 ? void 0 : _b.popupModel }));\n        }\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: cssClasses.selectWrapper, onClick: this.click },\n            selectElement,\n            this.createChevronButton()));\n    };\n    SurveyQuestionDropdownBase.prototype.renderValueElement = function (dropdownListModel) {\n        if (this.question.showInputFieldComponent) {\n            return ReactElementFactory.Instance.createElement(this.question.inputFieldComponentName, { item: dropdownListModel.getSelectedAction(), question: this.question });\n        }\n        else if (this.question.showSelectedItemLocText) {\n            return this.renderLocString(this.question.selectedItemLocText);\n        }\n        return null;\n    };\n    SurveyQuestionDropdownBase.prototype.renderInput = function (dropdownListModel) {\n        var _this = this;\n        var valueElement = this.renderValueElement(dropdownListModel);\n        var root = external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"settings\"].environment.root;\n        var onInputChange = function (e) {\n            if (e.target === root.activeElement) {\n                dropdownListModel.inputStringRendered = e.target.value;\n            }\n        };\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { id: this.question.inputId, className: this.question.getControlClass(), tabIndex: dropdownListModel.noTabIndex ? undefined : 0, \n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            disabled: this.question.isDisabledAttr, required: this.question.isRequired, onKeyDown: this.keyhandler, onBlur: this.blur, onFocus: this.focus, role: this.question.ariaRole, \"aria-required\": this.question.ariaRequired, \"aria-label\": this.question.ariaLabel, \"aria-invalid\": this.question.ariaInvalid, \"aria-errormessage\": this.question.ariaErrormessage, \"aria-expanded\": this.question.ariaExpanded, \"aria-controls\": dropdownListModel.listElementId, \"aria-activedescendant\": dropdownListModel.ariaActivedescendant },\n            dropdownListModel.showHintPrefix ?\n                (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.hintPrefix },\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", null, dropdownListModel.hintStringPrefix))) : null,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.controlValue },\n                dropdownListModel.showHintString ?\n                    (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.hintSuffix },\n                        external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { style: { visibility: \"hidden\" }, \"data-bind\": \"text: model.filterString\" }, dropdownListModel.inputStringRendered),\n                        external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", null, dropdownListModel.hintStringSuffix))) : null,\n                valueElement,\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"input\", { type: \"text\", autoComplete: \"off\", id: this.question.getInputId(), ref: function (element) { return (_this.inputElement = element); }, className: this.question.cssClasses.filterStringInput, role: dropdownListModel.filterStringEnabled ? this.question.ariaRole : undefined, \"aria-expanded\": this.question.ariaExpanded, \"aria-label\": this.question.a11y_input_ariaLabel, \"aria-labelledby\": this.question.a11y_input_ariaLabelledBy, \"aria-describedby\": this.question.a11y_input_ariaDescribedBy, \"aria-controls\": dropdownListModel.listElementId, \"aria-activedescendant\": dropdownListModel.ariaActivedescendant, placeholder: dropdownListModel.placeholderRendered, readOnly: dropdownListModel.filterReadOnly ? true : undefined, tabIndex: dropdownListModel.noTabIndex ? undefined : -1, disabled: this.question.isDisabledAttr, inputMode: dropdownListModel.inputMode, onChange: function (e) { onInputChange(e); }, onBlur: this.blur, onFocus: this.focus })),\n            this.createClearButton()));\n    };\n    SurveyQuestionDropdownBase.prototype.createClearButton = function () {\n        if (!this.question.allowClear || !this.question.cssClasses.cleanButtonIconId)\n            return null;\n        var style = { display: !this.question.showClearButton ? \"none\" : \"\" };\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.cleanButton, style: style, onClick: this.clear, \"aria-hidden\": \"true\" },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](svg_icon_SvgIcon, { className: this.question.cssClasses.cleanButtonSvg, iconName: this.question.cssClasses.cleanButtonIconId, title: this.question.clearCaption, size: \"auto\" })));\n    };\n    SurveyQuestionDropdownBase.prototype.createChevronButton = function () {\n        if (!this.question.cssClasses.chevronButtonIconId)\n            return null;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.chevronButton, \"aria-hidden\": \"true\", onPointerDown: this.chevronPointerDown },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](svg_icon_SvgIcon, { className: this.question.cssClasses.chevronButtonSvg, iconName: this.question.cssClasses.chevronButtonIconId, size: \"auto\" })));\n    };\n    SurveyQuestionDropdownBase.prototype.renderOther = function (cssClasses) {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.getCommentAreaCss(true) },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](SurveyQuestionOtherValueItem, { question: this.question, otherCss: cssClasses.other, cssClasses: cssClasses, isDisplayMode: this.isDisplayMode, isOther: true })));\n    };\n    SurveyQuestionDropdownBase.prototype.componentDidUpdate = function (prevProps, prevState) {\n        _super.prototype.componentDidUpdate.call(this, prevProps, prevState);\n        this.updateInputDomElement();\n    };\n    SurveyQuestionDropdownBase.prototype.componentDidMount = function () {\n        _super.prototype.componentDidMount.call(this);\n        this.updateInputDomElement();\n    };\n    SurveyQuestionDropdownBase.prototype.updateInputDomElement = function () {\n        if (!!this.inputElement) {\n            var control = this.inputElement;\n            var newValue = this.question.dropdownListModel.inputStringRendered;\n            if (!external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"Helpers\"].isTwoValueEquals(newValue, control.value, false, true, false)) {\n                control.value = this.question.dropdownListModel.inputStringRendered;\n            }\n        }\n    };\n    return SurveyQuestionDropdownBase;\n}(reactquestion_element_SurveyQuestionUncontrolledElement));\n\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion_dropdown.tsx\nvar reactquestion_dropdown_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar reactquestion_dropdown_SurveyQuestionDropdown = /** @class */ (function (_super) {\n    reactquestion_dropdown_extends(SurveyQuestionDropdown, _super);\n    function SurveyQuestionDropdown(props) {\n        return _super.call(this, props) || this;\n    }\n    SurveyQuestionDropdown.prototype.renderElement = function () {\n        var cssClasses = this.question.cssClasses;\n        var comment = this.question.isOtherSelected ? this.renderOther(cssClasses) : null;\n        var select = this.renderSelect(cssClasses);\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.renderCssRoot },\n            select,\n            comment));\n    };\n    return SurveyQuestionDropdown;\n}(dropdown_base_SurveyQuestionDropdownBase));\n\nReactQuestionFactory.Instance.registerQuestion(\"dropdown\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_dropdown_SurveyQuestionDropdown, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/tagbox-item.tsx\nvar tagbox_item_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar tagbox_item_SurveyQuestionTagboxItem = /** @class */ (function (_super) {\n    tagbox_item_extends(SurveyQuestionTagboxItem, _super);\n    function SurveyQuestionTagboxItem(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(SurveyQuestionTagboxItem.prototype, \"question\", {\n        get: function () {\n            return this.props.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionTagboxItem.prototype, \"item\", {\n        get: function () {\n            return this.props.item;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionTagboxItem.prototype.canRender = function () {\n        return !!this.item && !!this.question;\n    };\n    SurveyQuestionTagboxItem.prototype.renderElement = function () {\n        var _this = this;\n        var text = this.renderLocString(this.item.locText);\n        var removeItem = function (event) {\n            _this.question.dropdownListModel.deselectItem(_this.item.value);\n            event.stopPropagation();\n        };\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: \"sv-tagbox__item\" },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: \"sv-tagbox__item-text\" }, text),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.cleanItemButton, onClick: removeItem },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](svg_icon_SvgIcon, { className: this.question.cssClasses.cleanItemButtonSvg, iconName: this.question.cssClasses.cleanItemButtonIconId, size: \"auto\" }))));\n    };\n    return SurveyQuestionTagboxItem;\n}(ReactSurveyElement));\n\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion_tagbox.tsx\nvar reactquestion_tagbox_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\nvar reactquestion_tagbox_SurveyQuestionTagbox = /** @class */ (function (_super) {\n    reactquestion_tagbox_extends(SurveyQuestionTagbox, _super);\n    function SurveyQuestionTagbox(props) {\n        return _super.call(this, props) || this;\n    }\n    SurveyQuestionTagbox.prototype.renderItem = function (key, item) {\n        var renderedItem = (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](tagbox_item_SurveyQuestionTagboxItem, { key: key, question: this.question, item: item }));\n        return renderedItem;\n    };\n    SurveyQuestionTagbox.prototype.renderInput = function (dropdownListModel) {\n        var _this = this;\n        var dropdownMultiSelectListModel = dropdownListModel;\n        var items = this.question.selectedChoices.map(function (choice, index) { return _this.renderItem(\"item\" + index, choice); });\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { id: this.question.inputId, className: this.question.getControlClass(), tabIndex: dropdownListModel.noTabIndex ? undefined : 0, \n            // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n            // @ts-ignore\n            disabled: this.question.isInputReadOnly, required: this.question.isRequired, onKeyDown: this.keyhandler, onBlur: this.blur, role: this.question.ariaRole, \"aria-required\": this.question.ariaRequired, \"aria-label\": this.question.ariaLabel, \"aria-invalid\": this.question.ariaInvalid, \"aria-errormessage\": this.question.ariaErrormessage, \"aria-expanded\": this.question.ariaExpanded, \"aria-controls\": dropdownListModel.listElementId, \"aria-activedescendant\": dropdownListModel.ariaActivedescendant },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.controlValue },\n                items,\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](tagbox_filter_TagboxFilterString, { model: dropdownMultiSelectListModel, question: this.question })),\n            this.createClearButton()));\n    };\n    SurveyQuestionTagbox.prototype.renderElement = function () {\n        var cssClasses = this.question.cssClasses;\n        var comment = this.question.isOtherSelected ? this.renderOther(cssClasses) : null;\n        var select = this.renderSelect(cssClasses);\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.renderCssRoot },\n            select,\n            comment));\n    };\n    SurveyQuestionTagbox.prototype.renderReadOnlyElement = function () {\n        if (this.question.locReadOnlyText) {\n            return this.renderLocString(this.question.locReadOnlyText);\n        }\n        else {\n            return null;\n        }\n    };\n    return SurveyQuestionTagbox;\n}(dropdown_base_SurveyQuestionDropdownBase));\n\nReactQuestionFactory.Instance.registerQuestion(\"tagbox\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_tagbox_SurveyQuestionTagbox, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/dropdown-select.tsx\nvar dropdown_select_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\nvar dropdown_select_SurveyQuestionDropdownSelect = /** @class */ (function (_super) {\n    dropdown_select_extends(SurveyQuestionDropdownSelect, _super);\n    function SurveyQuestionDropdownSelect(props) {\n        return _super.call(this, props) || this;\n    }\n    SurveyQuestionDropdownSelect.prototype.renderSelect = function (cssClasses) {\n        var _this = this;\n        var click = function (event) {\n            _this.question.onClick(event);\n        };\n        var keyup = function (event) {\n            _this.question.onKeyUp(event);\n        };\n        var selectElement = this.isDisplayMode ? (\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n        // @ts-ignore\n        external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { id: this.question.inputId, className: this.question.getControlClass(), disabled: true }, this.question.readOnlyText)) :\n            (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"select\", { id: this.question.inputId, className: this.question.getControlClass(), ref: function (select) { return (_this.setControl(select)); }, autoComplete: this.question.autocomplete, onChange: this.updateValueOnEvent, onInput: this.updateValueOnEvent, onClick: click, onKeyUp: keyup, \"aria-required\": this.question.ariaRequired, \"aria-label\": this.question.ariaLabel, \"aria-invalid\": this.question.ariaInvalid, \"aria-errormessage\": this.question.ariaErrormessage, required: this.question.isRequired },\n                this.question.allowClear ? (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"option\", { value: \"\" }, this.question.placeholder)) : null,\n                this.question.visibleChoices.map(function (item, i) { return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](dropdown_item_SurveyQuestionOptionItem, { key: \"item\" + i, item: item }); })));\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: cssClasses.selectWrapper },\n            selectElement,\n            this.createChevronButton()));\n    };\n    return SurveyQuestionDropdownSelect;\n}(reactquestion_dropdown_SurveyQuestionDropdown));\n\nReactQuestionFactory.Instance.registerQuestion(\"sv-dropdown-select\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](dropdown_select_SurveyQuestionDropdownSelect, props);\n});\nexternal_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"RendererFactory\"].Instance.registerRenderer(\"dropdown\", \"select\", \"sv-dropdown-select\");\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion_matrix.tsx\nvar reactquestion_matrix_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\nvar reactquestion_matrix_SurveyQuestionMatrix = /** @class */ (function (_super) {\n    reactquestion_matrix_extends(SurveyQuestionMatrix, _super);\n    function SurveyQuestionMatrix(props) {\n        var _this = _super.call(this, props) || this;\n        _this.state = { rowsChanged: 0 };\n        return _this;\n    }\n    Object.defineProperty(SurveyQuestionMatrix.prototype, \"question\", {\n        get: function () {\n            return this.questionBase;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionMatrix.prototype.componentDidMount = function () {\n        _super.prototype.componentDidMount.call(this);\n        if (this.question) {\n            var self = this;\n            this.question.visibleRowsChangedCallback = function () {\n                self.setState({ rowsChanged: self.state.rowsChanged + 1 });\n            };\n        }\n    };\n    SurveyQuestionMatrix.prototype.componentWillUnmount = function () {\n        _super.prototype.componentWillUnmount.call(this);\n        if (this.question) {\n            this.question.visibleRowsChangedCallback = null;\n        }\n    };\n    SurveyQuestionMatrix.prototype.renderElement = function () {\n        var _this = this;\n        var cssClasses = this.question.cssClasses;\n        var rowsTH = this.question.hasRows ? external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"td\", null) : null;\n        var headers = [];\n        for (var i = 0; i < this.question.visibleColumns.length; i++) {\n            var column = this.question.visibleColumns[i];\n            var key = \"column\" + i;\n            var columText = this.renderLocString(column.locText);\n            var style = {};\n            if (!!this.question.columnMinWidth) {\n                style.minWidth = this.question.columnMinWidth;\n                style.width = this.question.columnMinWidth;\n            }\n            headers.push(external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"th\", { className: this.question.cssClasses.headerCell, style: style, key: key }, this.wrapCell({ column: column }, columText, \"column-header\")));\n        }\n        var rows = [];\n        var visibleRows = this.question.visibleRows;\n        for (var i = 0; i < visibleRows.length; i++) {\n            var row = visibleRows[i];\n            var key = \"row-\" + row.name + \"-\" + i;\n            rows.push(external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_matrix_SurveyQuestionMatrixRow, { key: key, question: this.question, cssClasses: cssClasses, row: row, isFirst: i == 0 }));\n        }\n        var header = !this.question.showHeader ? null : (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"thead\", null,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"tr\", null,\n                rowsTH,\n                headers)));\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: cssClasses.tableWrapper, ref: function (root) { return (_this.setControl(root)); } },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"fieldset\", null,\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"legend\", { className: \"sv-hidden\" }, this.question.locTitle.renderedHtml),\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"table\", { className: this.question.getTableCss() },\n                    header,\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"tbody\", null, rows)))));\n    };\n    return SurveyQuestionMatrix;\n}(reactquestion_element_SurveyQuestionElementBase));\n\nvar reactquestion_matrix_SurveyQuestionMatrixRow = /** @class */ (function (_super) {\n    reactquestion_matrix_extends(SurveyQuestionMatrixRow, _super);\n    function SurveyQuestionMatrixRow(props) {\n        return _super.call(this, props) || this;\n    }\n    SurveyQuestionMatrixRow.prototype.getStateElement = function () {\n        if (!!this.row)\n            return this.row.item;\n        return _super.prototype.getStateElement.call(this);\n    };\n    Object.defineProperty(SurveyQuestionMatrixRow.prototype, \"question\", {\n        get: function () {\n            return this.props.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionMatrixRow.prototype, \"row\", {\n        get: function () {\n            return this.props.row;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionMatrixRow.prototype.wrapCell = function (cell, element, reason) {\n        if (!reason) {\n            return element;\n        }\n        var survey = this.question.survey;\n        var wrapper = null;\n        if (survey) {\n            wrapper = reactsurveymodel_ReactSurveyElementsWrapper.wrapMatrixCell(survey, element, cell, reason);\n        }\n        return wrapper !== null && wrapper !== void 0 ? wrapper : element;\n    };\n    SurveyQuestionMatrixRow.prototype.canRender = function () {\n        return !!this.row;\n    };\n    SurveyQuestionMatrixRow.prototype.renderElement = function () {\n        var rowsTD = null;\n        if (this.question.hasRows) {\n            var rowText = this.renderLocString(this.row.locText);\n            var style = {};\n            if (!!this.question.rowTitleWidth) {\n                style.minWidth = this.question.rowTitleWidth;\n                style.width = this.question.rowTitleWidth;\n            }\n            rowsTD = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"td\", { style: style, className: this.row.rowTextClasses }, this.wrapCell({ row: this.row }, rowText, \"row-header\"));\n        }\n        var tds = this.generateTds();\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"tr\", { className: this.row.rowClasses || undefined },\n            rowsTD,\n            tds));\n    };\n    SurveyQuestionMatrixRow.prototype.generateTds = function () {\n        var _this = this;\n        var tds = [];\n        var row = this.row;\n        var cellComponent = this.question.cellComponent;\n        var _loop_1 = function () {\n            var td = null;\n            var column = this_1.question.visibleColumns[i];\n            var key = \"value\" + i;\n            var itemClass = this_1.question.getItemClass(row, column);\n            if (this_1.question.hasCellText) {\n                var getHandler = function (column) { return function () { return _this.cellClick(row, column); }; };\n                td = (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"td\", { key: key, className: itemClass, onClick: getHandler ? getHandler(column) : function () { } }, this_1.renderLocString(this_1.question.getCellDisplayLocText(row.name, column))));\n            }\n            else {\n                var renderedCell = ReactElementFactory.Instance.createElement(cellComponent, {\n                    question: this_1.question,\n                    row: this_1.row,\n                    column: column,\n                    columnIndex: i,\n                    cssClasses: this_1.cssClasses,\n                    cellChanged: function () { _this.cellClick(_this.row, column); }\n                });\n                td = (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"td\", { key: key, \"data-responsive-title\": column.locText.renderedHtml, className: this_1.question.cssClasses.cell }, renderedCell));\n            }\n            tds.push(td);\n        };\n        var this_1 = this;\n        for (var i = 0; i < this.question.visibleColumns.length; i++) {\n            _loop_1();\n        }\n        return tds;\n    };\n    SurveyQuestionMatrixRow.prototype.cellClick = function (row, column) {\n        row.value = column.value;\n        this.setState({ value: this.row.value });\n    };\n    return SurveyQuestionMatrixRow;\n}(ReactSurveyElement));\n\nvar reactquestion_matrix_SurveyQuestionMatrixCell = /** @class */ (function (_super) {\n    reactquestion_matrix_extends(SurveyQuestionMatrixCell, _super);\n    function SurveyQuestionMatrixCell(props) {\n        var _this = _super.call(this, props) || this;\n        _this.handleOnMouseDown = _this.handleOnMouseDown.bind(_this);\n        _this.handleOnChange = _this.handleOnChange.bind(_this);\n        return _this;\n    }\n    SurveyQuestionMatrixCell.prototype.handleOnChange = function (event) {\n        if (!!this.props.cellChanged) {\n            this.props.cellChanged();\n        }\n    };\n    SurveyQuestionMatrixCell.prototype.handleOnMouseDown = function (event) {\n        this.question.onMouseDown();\n    };\n    Object.defineProperty(SurveyQuestionMatrixCell.prototype, \"question\", {\n        get: function () {\n            return this.props.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionMatrixCell.prototype, \"row\", {\n        get: function () {\n            return this.props.row;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionMatrixCell.prototype, \"column\", {\n        get: function () {\n            return this.props.column;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionMatrixCell.prototype, \"columnIndex\", {\n        get: function () {\n            return this.props.columnIndex;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionMatrixCell.prototype.canRender = function () {\n        return !!this.question && !!this.row;\n    };\n    SurveyQuestionMatrixCell.prototype.renderElement = function () {\n        var isChecked = this.row.value == this.column.value;\n        var inputId = this.question.inputId + \"_\" + this.row.name + \"_\" + this.columnIndex;\n        var itemClass = this.question.getItemClass(this.row, this.column);\n        var mobileSpan = this.question.isMobile ?\n            (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: this.question.cssClasses.cellResponsiveTitle }, this.renderLocString(this.column.locText)))\n            : undefined;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"label\", { onMouseDown: this.handleOnMouseDown, className: itemClass },\n            this.renderInput(inputId, isChecked),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: this.question.cssClasses.materialDecorator }, this.question.itemSvgIcon ?\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"svg\", { className: this.cssClasses.itemDecorator },\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"use\", { xlinkHref: this.question.itemSvgIcon })) :\n                null),\n            mobileSpan));\n    };\n    SurveyQuestionMatrixCell.prototype.renderInput = function (inputId, isChecked) {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"input\", { id: inputId, type: \"radio\", className: this.cssClasses.itemValue, name: this.row.fullName, value: this.column.value, disabled: this.row.isDisabledAttr, readOnly: this.row.isReadOnlyAttr, checked: isChecked, onChange: this.handleOnChange, \"aria-required\": this.question.a11y_input_ariaRequired, \"aria-label\": this.question.getCellAriaLabel(this.row.locText.renderedHtml, this.column.locText.renderedHtml), \"aria-invalid\": this.question.a11y_input_ariaInvalid, \"aria-errormessage\": this.question.a11y_input_ariaErrormessage }));\n    };\n    return SurveyQuestionMatrixCell;\n}(ReactSurveyElement));\n\nReactElementFactory.Instance.registerElement(\"survey-matrix-cell\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_matrix_SurveyQuestionMatrixCell, props);\n});\nReactQuestionFactory.Instance.registerQuestion(\"matrix\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_matrix_SurveyQuestionMatrix, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion_html.tsx\nvar reactquestion_html_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar reactquestion_html_SurveyQuestionHtml = /** @class */ (function (_super) {\n    reactquestion_html_extends(SurveyQuestionHtml, _super);\n    function SurveyQuestionHtml(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(SurveyQuestionHtml.prototype, \"question\", {\n        get: function () {\n            return this.questionBase;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionHtml.prototype.componentDidMount = function () {\n        this.reactOnStrChanged();\n    };\n    SurveyQuestionHtml.prototype.componentWillUnmount = function () {\n        this.question.locHtml.onChanged = function () { };\n    };\n    SurveyQuestionHtml.prototype.componentDidUpdate = function (prevProps, prevState) {\n        this.reactOnStrChanged();\n    };\n    SurveyQuestionHtml.prototype.reactOnStrChanged = function () {\n        var _this = this;\n        this.question.locHtml.onChanged = function () {\n            _this.setState({ changed: !!_this.state && _this.state.changed ? _this.state.changed + 1 : 1 });\n        };\n    };\n    SurveyQuestionHtml.prototype.canRender = function () {\n        return _super.prototype.canRender.call(this) && !!this.question.html;\n    };\n    SurveyQuestionHtml.prototype.renderElement = function () {\n        var htmlValue = { __html: this.question.locHtml.renderedHtml };\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.renderCssRoot, dangerouslySetInnerHTML: htmlValue }));\n    };\n    return SurveyQuestionHtml;\n}(reactquestion_element_SurveyQuestionElementBase));\n\nReactQuestionFactory.Instance.registerQuestion(\"html\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_html_SurveyQuestionHtml, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/loading-indicator.tsx\nvar loading_indicator_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\nvar loading_indicator_LoadingIndicatorComponent = /** @class */ (function (_super) {\n    loading_indicator_extends(LoadingIndicatorComponent, _super);\n    function LoadingIndicatorComponent() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    LoadingIndicatorComponent.prototype.render = function () {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: \"sd-loading-indicator\" },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](svg_icon_SvgIcon, { iconName: \"icon-loading\", size: \"auto\" })));\n    };\n    return LoadingIndicatorComponent;\n}(external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Component\"]));\n\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/file/file-choose-button.tsx\nvar file_choose_button_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\nvar file_choose_button_SurveyFileChooseButton = /** @class */ (function (_super) {\n    file_choose_button_extends(SurveyFileChooseButton, _super);\n    function SurveyFileChooseButton(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(SurveyFileChooseButton.prototype, \"question\", {\n        get: function () {\n            return (this.props.item && this.props.item.data.question) || this.props.data.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyFileChooseButton.prototype.render = function () {\n        var _this = this;\n        return attachKey2click(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"label\", { tabIndex: 0, className: this.question.getChooseFileCss(), htmlFor: this.question.inputId, \"aria-label\": this.question.chooseButtonText, onClick: function (e) { return _this.question.chooseFile(e.nativeEvent); } },\n            (!!this.question.cssClasses.chooseFileIconId) ? external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(svg_icon_SvgIcon, { title: this.question.chooseButtonText, iconName: this.question.cssClasses.chooseFileIconId, size: \"auto\" }) : null,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", null, this.question.chooseButtonText)));\n    };\n    return SurveyFileChooseButton;\n}(ReactSurveyElement));\n\nReactElementFactory.Instance.registerElement(\"sv-file-choose-btn\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(file_choose_button_SurveyFileChooseButton, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion_file.tsx\nvar reactquestion_file_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\n\n\n\n\n// import { ReactElementFactory, SurveyFileChooseButton } from \"../entries/react-ui-model\";\nvar reactquestion_file_SurveyQuestionFile = /** @class */ (function (_super) {\n    reactquestion_file_extends(SurveyQuestionFile, _super);\n    function SurveyQuestionFile(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(SurveyQuestionFile.prototype, \"question\", {\n        get: function () {\n            return this.questionBase;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionFile.prototype.renderElement = function () {\n        var _this = this;\n        var preview = this.question.allowShowPreview ? this.renderPreview() : null;\n        var loadingIndicator = this.question.showLoadingIndicator ? this.renderLoadingIndicator() : null;\n        var video = this.question.isPlayingVideo ? this.renderVideo() : null;\n        var fileDecorator = this.question.showFileDecorator ? this.renderFileDecorator() : null;\n        var clearButton = this.question.showRemoveButton ? this.renderClearButton(this.question.cssClasses.removeButton) : null;\n        var clearButtonBottom = this.question.showRemoveButtonBottom ? this.renderClearButton(this.question.cssClasses.removeButtonBottom) : null;\n        var fileNavigator = this.question.fileNavigatorVisible ? (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](action_bar_SurveyActionBar, { model: this.question.fileNavigator })) : null;\n        var fileInput;\n        if (this.question.isReadOnlyAttr) {\n            fileInput = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"input\", { readOnly: true, type: \"file\", className: !this.isDisplayMode ? this.question.cssClasses.fileInput : this.question.getReadOnlyFileCss(), id: this.question.inputId, ref: function (input) { return (_this.setControl(input)); }, style: !this.isDisplayMode ? {} : { color: \"transparent\" }, multiple: this.question.allowMultiple, placeholder: this.question.title, accept: this.question.acceptedTypes });\n        }\n        else if (this.question.isDisabledAttr) {\n            fileInput = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"input\", { disabled: true, type: \"file\", className: !this.isDisplayMode ? this.question.cssClasses.fileInput : this.question.getReadOnlyFileCss(), id: this.question.inputId, ref: function (input) { return (_this.setControl(input)); }, style: !this.isDisplayMode ? {} : { color: \"transparent\" }, multiple: this.question.allowMultiple, placeholder: this.question.title, accept: this.question.acceptedTypes });\n        }\n        else if (this.question.hasFileUI) {\n            fileInput = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"input\", { type: \"file\", disabled: this.isDisplayMode, tabIndex: -1, className: !this.isDisplayMode ? this.question.cssClasses.fileInput : this.question.getReadOnlyFileCss(), id: this.question.inputId, ref: function (input) { return (_this.setControl(input)); }, style: !this.isDisplayMode ? {} : { color: \"transparent\" }, \"aria-required\": this.question.ariaRequired, \"aria-label\": this.question.ariaLabel, \"aria-invalid\": this.question.ariaInvalid, \"aria-errormessage\": this.question.ariaErrormessage, multiple: this.question.allowMultiple, title: this.question.inputTitle, accept: this.question.acceptedTypes, capture: this.question.renderCapture });\n        }\n        else {\n            fileInput = null;\n        }\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.fileRootCss, ref: function (el) { return (_this.setContent(el)); } },\n            fileInput,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.dragArea, onDrop: this.question.onDrop, onDragOver: this.question.onDragOver, onDragLeave: this.question.onDragLeave, onDragEnter: this.question.onDragEnter },\n                fileDecorator,\n                loadingIndicator,\n                video,\n                clearButton,\n                preview,\n                clearButtonBottom,\n                fileNavigator)));\n    };\n    SurveyQuestionFile.prototype.renderFileDecorator = function () {\n        var chooseButton = this.question.showChooseButton ? this.renderChooseButton() : null;\n        var actionsContainer = this.question.actionsContainerVisible ? external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](action_bar_SurveyActionBar, { model: this.question.actionsContainer }) : null;\n        var noFileChosen = this.question.isEmpty() ? (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: this.question.cssClasses.noFileChosen }, this.question.noFileChosenCaption)) : null;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.getFileDecoratorCss() },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: this.question.cssClasses.dragAreaPlaceholder }, this.renderLocString(this.question.locRenderedPlaceholder)),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.wrapper },\n                chooseButton,\n                actionsContainer,\n                noFileChosen)));\n    };\n    SurveyQuestionFile.prototype.renderChooseButton = function () {\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](file_choose_button_SurveyFileChooseButton, { data: { question: this.question } });\n    };\n    SurveyQuestionFile.prototype.renderClearButton = function (className) {\n        return !this.question.isUploading ? (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"button\", { type: \"button\", onClick: this.question.doClean, className: className },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", null, this.question.clearButtonCaption),\n            (!!this.question.cssClasses.removeButtonIconId) ? external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](svg_icon_SvgIcon, { iconName: this.question.cssClasses.removeButtonIconId, size: \"auto\", title: this.question.clearButtonCaption }) : null)) : null;\n    };\n    SurveyQuestionFile.prototype.renderPreview = function () {\n        return ReactElementFactory.Instance.createElement(\"sv-file-preview\", { question: this.question });\n    };\n    SurveyQuestionFile.prototype.renderLoadingIndicator = function () {\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.loadingIndicator },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](loading_indicator_LoadingIndicatorComponent, null));\n    };\n    SurveyQuestionFile.prototype.renderVideo = function () {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.videoContainer },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](action_bar_item_SurveyAction, { item: this.question.changeCameraAction }),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](action_bar_item_SurveyAction, { item: this.question.closeCameraAction }),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"video\", { autoPlay: true, playsInline: true, id: this.question.videoId, className: this.question.cssClasses.video }),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](action_bar_item_SurveyAction, { item: this.question.takePictureAction })));\n    };\n    return SurveyQuestionFile;\n}(reactquestion_element_SurveyQuestionElementBase));\n\nReactQuestionFactory.Instance.registerQuestion(\"file\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_file_SurveyQuestionFile, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/file/file-preview.tsx\nvar file_preview_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\nvar file_preview_SurveyFilePreview = /** @class */ (function (_super) {\n    file_preview_extends(SurveyFilePreview, _super);\n    function SurveyFilePreview() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(SurveyFilePreview.prototype, \"question\", {\n        get: function () {\n            return this.props.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyFilePreview.prototype.renderFileSign = function (className, val) {\n        var _this = this;\n        if (!className || !val.name)\n            return null;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: className },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"a\", { href: val.content, onClick: function (event) {\n                    _this.question.doDownloadFile(event, val);\n                }, title: val.name, download: val.name, style: { width: this.question.imageWidth } }, val.name)));\n    };\n    SurveyFilePreview.prototype.renderElement = function () {\n        var _this = this;\n        var previews = this.question.previewValue.map(function (val, index) {\n            if (!val)\n                return null;\n            return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { key: _this.question.inputId + \"_\" + index, className: _this.question.cssClasses.previewItem, onClick: function (event) { return _this.question.doDownloadFileFromContainer(event); }, style: { display: _this.question.isPreviewVisible(index) ? undefined : \"none\" } },\n                _this.renderFileSign(_this.question.cssClasses.fileSign, val),\n                external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: _this.question.getImageWrapperCss(val) },\n                    _this.question.canPreviewImage(val) ? (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"img\", { src: val.content, style: { height: _this.question.imageHeight, width: _this.question.imageWidth }, alt: \"File preview\" })) : (_this.question.cssClasses.defaultImage ? (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(svg_icon_SvgIcon, { iconName: _this.question.cssClasses.defaultImageIconId, size: \"auto\", className: _this.question.cssClasses.defaultImage })) : null),\n                    val.name && !_this.question.isReadOnly ? (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: _this.question.getRemoveButtonCss(), onClick: function (event) { return _this.question.doRemoveFile(val, event); } },\n                        external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { className: _this.question.cssClasses.removeFile }, _this.question.removeFileCaption),\n                        (_this.question.cssClasses.removeFileSvgIconId) ?\n                            (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(svg_icon_SvgIcon, { title: _this.question.removeFileCaption, iconName: _this.question.cssClasses.removeFileSvgIconId, size: \"auto\", className: _this.question.cssClasses.removeFileSvg })) : null)) : null),\n                _this.renderFileSign(_this.question.cssClasses.fileSignBottom, val)));\n        });\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: this.question.cssClasses.fileList || undefined }, previews);\n    };\n    SurveyFilePreview.prototype.canRender = function () {\n        return this.question.showPreviewContainer;\n    };\n    return SurveyFilePreview;\n}(reactquestion_element_SurveyElementBase));\n\nReactElementFactory.Instance.registerElement(\"sv-file-preview\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(file_preview_SurveyFilePreview, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion_multipletext.tsx\nvar reactquestion_multipletext_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\n\nvar reactquestion_multipletext_SurveyQuestionMultipleText = /** @class */ (function (_super) {\n    reactquestion_multipletext_extends(SurveyQuestionMultipleText, _super);\n    function SurveyQuestionMultipleText(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(SurveyQuestionMultipleText.prototype, \"question\", {\n        get: function () {\n            return this.questionBase;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionMultipleText.prototype.renderElement = function () {\n        var cssClasses = this.question.cssClasses;\n        var tableRows = this.question.getRows();\n        var rows = [];\n        for (var i = 0; i < tableRows.length; i++) {\n            if (tableRows[i].isVisible) {\n                rows.push(this.renderRow(i, tableRows[i].cells, cssClasses));\n            }\n        }\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"table\", { className: this.question.getQuestionRootCss() },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"tbody\", null, rows)));\n    };\n    SurveyQuestionMultipleText.prototype.renderCell = function (cell, cssClasses, index) {\n        var cellContent;\n        var focusIn = function () { cell.item.focusIn(); };\n        if (cell.isErrorsCell) {\n            cellContent = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_SurveyQuestionErrorCell, { question: cell.item.editor, creator: this.creator });\n        }\n        else {\n            cellContent = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_multipletext_SurveyMultipleTextItem, { question: this.question, item: cell.item, creator: this.creator, cssClasses: cssClasses });\n        }\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"td\", { key: \"item\" + index, className: cell.className, onFocus: focusIn }, cellContent));\n    };\n    SurveyQuestionMultipleText.prototype.renderRow = function (rowIndex, cells, cssClasses) {\n        var key = \"item\" + rowIndex;\n        var tds = [];\n        for (var i = 0; i < cells.length; i++) {\n            var cell = cells[i];\n            tds.push(this.renderCell(cell, cssClasses, i));\n        }\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"tr\", { key: key, className: cssClasses.row }, tds));\n    };\n    return SurveyQuestionMultipleText;\n}(reactquestion_element_SurveyQuestionElementBase));\n\nvar reactquestion_multipletext_SurveyMultipleTextItem = /** @class */ (function (_super) {\n    reactquestion_multipletext_extends(SurveyMultipleTextItem, _super);\n    function SurveyMultipleTextItem() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(SurveyMultipleTextItem.prototype, \"question\", {\n        get: function () {\n            return this.props.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyMultipleTextItem.prototype, \"item\", {\n        get: function () {\n            return this.props.item;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyMultipleTextItem.prototype.getStateElements = function () {\n        return [this.item, this.item.editor];\n    };\n    Object.defineProperty(SurveyMultipleTextItem.prototype, \"creator\", {\n        get: function () {\n            return this.props.creator;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyMultipleTextItem.prototype.renderElement = function () {\n        var item = this.item;\n        var cssClasses = this.cssClasses;\n        var titleStyle = {};\n        if (!!this.question.itemTitleWidth) {\n            titleStyle.minWidth = this.question.itemTitleWidth;\n            titleStyle.width = this.question.itemTitleWidth;\n        }\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"label\", { className: this.question.getItemLabelCss(item) },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: cssClasses.itemTitle, style: titleStyle },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](title_content_TitleContent, { element: item.editor, cssClasses: item.editor.cssClasses })),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_multipletext_SurveyMultipleTextItemEditor, { cssClasses: cssClasses, itemCss: this.question.getItemCss(), question: item.editor, creator: this.creator })));\n    };\n    return SurveyMultipleTextItem;\n}(ReactSurveyElement));\n\nvar reactquestion_multipletext_SurveyMultipleTextItemEditor = /** @class */ (function (_super) {\n    reactquestion_multipletext_extends(SurveyMultipleTextItemEditor, _super);\n    function SurveyMultipleTextItemEditor() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    SurveyMultipleTextItemEditor.prototype.renderElement = function () {\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.itemCss }, this.renderContent());\n    };\n    return SurveyMultipleTextItemEditor;\n}(reactquestion_SurveyQuestionAndErrorsWrapped));\n\nReactQuestionFactory.Instance.registerQuestion(\"multipletext\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_multipletext_SurveyQuestionMultipleText, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion_radiogroup.tsx\nvar reactquestion_radiogroup_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\n\nvar reactquestion_radiogroup_SurveyQuestionRadiogroup = /** @class */ (function (_super) {\n    reactquestion_radiogroup_extends(SurveyQuestionRadiogroup, _super);\n    function SurveyQuestionRadiogroup(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(SurveyQuestionRadiogroup.prototype, \"question\", {\n        get: function () {\n            return this.questionBase;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionRadiogroup.prototype.renderElement = function () {\n        var _this = this;\n        var cssClasses = this.question.cssClasses;\n        var clearButton = null;\n        if (this.question.showClearButtonInContent) {\n            clearButton = (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", null,\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"input\", { type: \"button\", className: this.question.cssClasses.clearButton, onClick: function () { return _this.question.clearValue(true); }, value: this.question.clearButtonCaption })));\n        }\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"fieldset\", { className: this.question.getSelectBaseRootCss(), ref: function (fieldset) { return (_this.setControl(fieldset)); }, role: this.question.a11y_input_ariaRole, \"aria-required\": this.question.a11y_input_ariaRequired, \"aria-label\": this.question.a11y_input_ariaLabel, \"aria-labelledby\": this.question.a11y_input_ariaLabelledBy, \"aria-describedby\": this.question.a11y_input_ariaDescribedBy, \"aria-invalid\": this.question.a11y_input_ariaInvalid, \"aria-errormessage\": this.question.a11y_input_ariaErrormessage },\n            this.question.hasColumns\n                ? this.getColumnedBody(cssClasses)\n                : this.getBody(cssClasses),\n            this.getFooter(),\n            this.question.isOtherSelected ? this.renderOther(cssClasses) : null,\n            clearButton));\n    };\n    SurveyQuestionRadiogroup.prototype.getFooter = function () {\n        var _this = this;\n        if (this.question.hasFootItems) {\n            return this.question.footItems.map(function (item, ii) {\n                return _this.renderItem(\"item_f\" + ii, item, false, _this.question.cssClasses);\n            });\n        }\n    };\n    SurveyQuestionRadiogroup.prototype.getColumnedBody = function (cssClasses) {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: cssClasses.rootMultiColumn }, this.getColumns(cssClasses)));\n    };\n    SurveyQuestionRadiogroup.prototype.getColumns = function (cssClasses) {\n        var _this = this;\n        var value = this.getStateValue();\n        return this.question.columns.map(function (column, ci) {\n            var items = column.map(function (item, ii) {\n                return _this.renderItem(\"item\" + ci + ii, item, value, cssClasses, \"\" + ci + ii);\n            });\n            return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { key: \"column\" + ci + _this.question.getItemsColumnKey(column), className: _this.question.getColumnClass(), role: \"presentation\" }, items));\n        });\n    };\n    SurveyQuestionRadiogroup.prototype.getBody = function (cssClasses) {\n        if (this.question.blockedRow) {\n            return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: cssClasses.rootRow }, this.getItems(cssClasses, this.question.dataChoices));\n        }\n        else\n            return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Fragment\"], null, this.getItems(cssClasses, this.question.bodyItems));\n    };\n    SurveyQuestionRadiogroup.prototype.getItems = function (cssClasses, choices) {\n        var items = [];\n        var value = this.getStateValue();\n        for (var i = 0; i < choices.length; i++) {\n            var item = choices[i];\n            var renderedItem = this.renderItem(\"item\" + i, item, value, cssClasses, \"\" + i);\n            items.push(renderedItem);\n        }\n        return items;\n    };\n    Object.defineProperty(SurveyQuestionRadiogroup.prototype, \"textStyle\", {\n        get: function () {\n            return null; //{ display: \"inline\", position: \"static\" };\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionRadiogroup.prototype.renderOther = function (cssClasses) {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.getCommentAreaCss(true) },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](SurveyQuestionOtherValueItem, { question: this.question, otherCss: cssClasses.other, cssClasses: cssClasses, isDisplayMode: this.isDisplayMode })));\n    };\n    SurveyQuestionRadiogroup.prototype.renderItem = function (key, item, value, cssClasses, index) {\n        var renderedItem = ReactElementFactory.Instance.createElement(this.question.itemComponent, {\n            key: key,\n            question: this.question,\n            cssClasses: cssClasses,\n            isDisplayMode: this.isDisplayMode,\n            item: item,\n            textStyle: this.textStyle,\n            index: index,\n            isChecked: value === item.value,\n        });\n        var survey = this.question.survey;\n        var wrappedItem = null;\n        if (!!survey) {\n            wrappedItem = reactsurveymodel_ReactSurveyElementsWrapper.wrapItemValue(survey, renderedItem, this.question, item);\n        }\n        return wrappedItem !== null && wrappedItem !== void 0 ? wrappedItem : renderedItem;\n    };\n    SurveyQuestionRadiogroup.prototype.getStateValue = function () {\n        return !this.question.isEmpty() ? this.question.renderedValue : \"\";\n    };\n    return SurveyQuestionRadiogroup;\n}(reactquestion_element_SurveyQuestionElementBase));\n\nvar reactquestion_radiogroup_SurveyQuestionRadioItem = /** @class */ (function (_super) {\n    reactquestion_radiogroup_extends(SurveyQuestionRadioItem, _super);\n    function SurveyQuestionRadioItem(props) {\n        var _this = _super.call(this, props) || this;\n        _this.handleOnChange = _this.handleOnChange.bind(_this);\n        _this.handleOnMouseDown = _this.handleOnMouseDown.bind(_this);\n        return _this;\n    }\n    SurveyQuestionRadioItem.prototype.getStateElement = function () {\n        return this.item;\n    };\n    Object.defineProperty(SurveyQuestionRadioItem.prototype, \"question\", {\n        get: function () {\n            return this.props.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionRadioItem.prototype, \"item\", {\n        get: function () {\n            return this.props.item;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionRadioItem.prototype, \"textStyle\", {\n        get: function () {\n            return this.props.textStyle;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionRadioItem.prototype, \"index\", {\n        get: function () {\n            return this.props.index;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionRadioItem.prototype, \"isChecked\", {\n        get: function () {\n            return this.props.isChecked;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionRadioItem.prototype, \"hideCaption\", {\n        get: function () {\n            return this.props.hideCaption === true;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionRadioItem.prototype.shouldComponentUpdate = function (nextProps, nextState) {\n        if (!_super.prototype.shouldComponentUpdate.call(this, nextProps, nextState))\n            return false;\n        if (!this.question)\n            return false;\n        return (!this.question.customWidget ||\n            !!this.question.customWidgetData.isNeedRender ||\n            !!this.question.customWidget.widgetJson.isDefaultRender ||\n            !!this.question.customWidget.widgetJson.render);\n    };\n    SurveyQuestionRadioItem.prototype.handleOnChange = function (event) {\n        this.question.clickItemHandler(this.item);\n    };\n    SurveyQuestionRadioItem.prototype.handleOnMouseDown = function (event) {\n        this.question.onMouseDown();\n    };\n    SurveyQuestionRadioItem.prototype.canRender = function () {\n        return !!this.question && !!this.item;\n    };\n    SurveyQuestionRadioItem.prototype.renderElement = function () {\n        var itemClass = this.question.getItemClass(this.item);\n        var labelClass = this.question.getLabelClass(this.item);\n        var controlLabelClass = this.question.getControlLabelClass(this.item);\n        var itemLabel = !this.hideCaption ? external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: controlLabelClass }, this.renderLocString(this.item.locText, this.textStyle)) : null;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: itemClass, role: \"presentation\" },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"label\", { onMouseDown: this.handleOnMouseDown, className: labelClass },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"input\", { \"aria-errormessage\": this.question.ariaErrormessage, className: this.cssClasses.itemControl, id: this.question.getItemId(this.item), type: \"radio\", name: this.question.questionName, checked: this.isChecked, value: this.item.value, disabled: !this.question.getItemEnabled(this.item), readOnly: this.question.isReadOnlyAttr, onChange: this.handleOnChange }),\n                this.cssClasses.materialDecorator ?\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: this.cssClasses.materialDecorator }, this.question.itemSvgIcon ?\n                        external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"svg\", { className: this.cssClasses.itemDecorator },\n                            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"use\", { xlinkHref: this.question.itemSvgIcon })) :\n                        null) :\n                    null,\n                itemLabel)));\n    };\n    return SurveyQuestionRadioItem;\n}(ReactSurveyElement));\n\nReactElementFactory.Instance.registerElement(\"survey-radiogroup-item\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_radiogroup_SurveyQuestionRadioItem, props);\n});\nReactQuestionFactory.Instance.registerQuestion(\"radiogroup\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_radiogroup_SurveyQuestionRadiogroup, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion_text.tsx\nvar reactquestion_text_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\nvar reactquestion_text_SurveyQuestionText = /** @class */ (function (_super) {\n    reactquestion_text_extends(SurveyQuestionText, _super);\n    //controlRef: React.RefObject<HTMLInputElement>;\n    function SurveyQuestionText(props) {\n        return _super.call(this, props) || this;\n        //this.controlRef = React.createRef();\n    }\n    SurveyQuestionText.prototype.renderInput = function () {\n        var _this = this;\n        var inputClass = this.question.getControlClass();\n        var placeholder = this.question.renderedPlaceholder;\n        if (this.question.isReadOnlyRenderDiv()) {\n            return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", null, this.question.inputValue);\n        }\n        var counter = !!this.question.getMaxLength() ? (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](character_counter_CharacterCounterComponent, { counter: this.question.characterCounter, remainingCharacterCounter: this.question.cssClasses.remainingCharacterCounter })) : null;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Fragment\"], null,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"input\", { id: this.question.inputId, \n                // disabled={this.isDisplayMode}\n                disabled: this.question.isDisabledAttr, readOnly: this.question.isReadOnlyAttr, className: inputClass, type: this.question.inputType, \n                //ref={this.controlRef}\n                ref: function (input) { return (_this.setControl(input)); }, style: this.question.inputStyle, maxLength: this.question.getMaxLength(), min: this.question.renderedMin, max: this.question.renderedMax, step: this.question.renderedStep, size: this.question.inputSize, placeholder: placeholder, list: this.question.dataListId, autoComplete: this.question.autocomplete, onBlur: function (event) { _this.question.onBlur(event); }, onFocus: function (event) { _this.question.onFocus(event); }, onChange: this.question.onChange, onKeyUp: this.question.onKeyUp, onKeyDown: this.question.onKeyDown, onCompositionUpdate: function (event) { return _this.question.onCompositionUpdate(event.nativeEvent); }, \"aria-required\": this.question.a11y_input_ariaRequired, \"aria-label\": this.question.a11y_input_ariaLabel, \"aria-labelledby\": this.question.a11y_input_ariaLabelledBy, \"aria-describedby\": this.question.a11y_input_ariaDescribedBy, \"aria-invalid\": this.question.a11y_input_ariaInvalid, \"aria-errormessage\": this.question.a11y_input_ariaErrormessage }),\n            counter));\n    };\n    SurveyQuestionText.prototype.renderElement = function () {\n        return (this.question.dataListId ?\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", null,\n                this.renderInput(),\n                this.renderDataList()) :\n            this.renderInput());\n    };\n    SurveyQuestionText.prototype.setValueCore = function (newValue) {\n        this.question.inputValue = newValue;\n    };\n    SurveyQuestionText.prototype.getValueCore = function () {\n        return this.question.inputValue;\n    };\n    SurveyQuestionText.prototype.renderDataList = function () {\n        if (!this.question.dataListId)\n            return null;\n        var items = this.question.dataList;\n        if (items.length == 0)\n            return null;\n        var options = [];\n        for (var i = 0; i < items.length; i++) {\n            options.push(external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"option\", { key: \"item\" + i, value: items[i] }));\n        }\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"datalist\", { id: this.question.dataListId }, options);\n    };\n    return SurveyQuestionText;\n}(reactquestion_element_SurveyQuestionUncontrolledElement));\n\nReactQuestionFactory.Instance.registerQuestion(\"text\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_text_SurveyQuestionText, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/boolean.tsx\nvar boolean_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar boolean_SurveyQuestionBoolean = /** @class */ (function (_super) {\n    boolean_extends(SurveyQuestionBoolean, _super);\n    function SurveyQuestionBoolean(props) {\n        var _this = _super.call(this, props) || this;\n        _this.handleOnChange = _this.handleOnChange.bind(_this);\n        _this.handleOnClick = _this.handleOnClick.bind(_this);\n        _this.handleOnLabelClick = _this.handleOnLabelClick.bind(_this);\n        _this.handleOnSwitchClick = _this.handleOnSwitchClick.bind(_this);\n        _this.handleOnKeyDown = _this.handleOnKeyDown.bind(_this);\n        _this.checkRef = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createRef\"]();\n        return _this;\n    }\n    SurveyQuestionBoolean.prototype.getStateElement = function () {\n        return this.question;\n    };\n    Object.defineProperty(SurveyQuestionBoolean.prototype, \"question\", {\n        get: function () {\n            return this.questionBase;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /*\n    private get allowClick(): boolean {\n      return this.question.isIndeterminate && !this.isDisplayMode;\n    }\n    */\n    SurveyQuestionBoolean.prototype.doCheck = function (value) {\n        this.question.booleanValue = value;\n    };\n    SurveyQuestionBoolean.prototype.handleOnChange = function (event) {\n        this.doCheck(event.target.checked);\n    };\n    SurveyQuestionBoolean.prototype.handleOnClick = function (event) {\n        this.question.onLabelClick(event, true);\n    };\n    SurveyQuestionBoolean.prototype.handleOnSwitchClick = function (event) {\n        this.question.onSwitchClickModel(event.nativeEvent);\n    };\n    SurveyQuestionBoolean.prototype.handleOnLabelClick = function (event, value) {\n        this.question.onLabelClick(event, value);\n    };\n    SurveyQuestionBoolean.prototype.handleOnKeyDown = function (event) {\n        this.question.onKeyDownCore(event);\n    };\n    SurveyQuestionBoolean.prototype.updateDomElement = function () {\n        if (!this.question)\n            return;\n        var el = this.checkRef.current;\n        if (el) {\n            el.indeterminate = this.question.isIndeterminate;\n        }\n        this.setControl(el);\n        _super.prototype.updateDomElement.call(this);\n    };\n    SurveyQuestionBoolean.prototype.renderElement = function () {\n        var _this = this;\n        var cssClasses = this.question.cssClasses;\n        var itemClass = this.question.getItemCss();\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: cssClasses.root, onKeyDown: this.handleOnKeyDown },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"label\", { className: itemClass, onClick: this.handleOnClick },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"input\", { ref: this.checkRef, type: \"checkbox\", name: this.question.name, value: this.question.booleanValue === null\n                        ? \"\"\n                        : this.question.booleanValue, id: this.question.inputId, className: cssClasses.control, disabled: this.question.isDisabledAttr, readOnly: this.question.isReadOnlyAttr, checked: this.question.booleanValue || false, onChange: this.handleOnChange, role: this.question.a11y_input_ariaRole, \"aria-required\": this.question.a11y_input_ariaRequired, \"aria-label\": this.question.a11y_input_ariaLabel, \"aria-labelledby\": this.question.a11y_input_ariaLabelledBy, \"aria-describedby\": this.question.a11y_input_ariaDescribedBy, \"aria-invalid\": this.question.a11y_input_ariaInvalid, \"aria-errormessage\": this.question.a11y_input_ariaErrormessage }),\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: cssClasses.sliderGhost, onClick: function (event) { return _this.handleOnLabelClick(event, _this.question.swapOrder); } },\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: this.question.getLabelCss(this.question.swapOrder) }, this.renderLocString(this.question.locLabelLeft))),\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: cssClasses.switch, onClick: this.handleOnSwitchClick },\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: cssClasses.slider }, this.question.isDeterminated && cssClasses.sliderText ?\n                        external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: cssClasses.sliderText }, this.renderLocString(this.question.getCheckedLabel()))\n                        : null)),\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: cssClasses.sliderGhost, onClick: function (event) { return _this.handleOnLabelClick(event, !_this.question.swapOrder); } },\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: this.question.getLabelCss(!this.question.swapOrder) }, this.renderLocString(this.question.locLabelRight))))));\n    };\n    return SurveyQuestionBoolean;\n}(reactquestion_element_SurveyQuestionElementBase));\n\nReactQuestionFactory.Instance.registerQuestion(\"boolean\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](boolean_SurveyQuestionBoolean, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/boolean-checkbox.tsx\nvar boolean_checkbox_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\n\nvar boolean_checkbox_SurveyQuestionBooleanCheckbox = /** @class */ (function (_super) {\n    boolean_checkbox_extends(SurveyQuestionBooleanCheckbox, _super);\n    function SurveyQuestionBooleanCheckbox(props) {\n        return _super.call(this, props) || this;\n    }\n    SurveyQuestionBooleanCheckbox.prototype.renderElement = function () {\n        var cssClasses = this.question.cssClasses;\n        var itemClass = this.question.getCheckboxItemCss();\n        var description = this.question.canRenderLabelDescription ?\n            reactquestion_element_SurveyElementBase.renderQuestionDescription(this.question) : null;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: cssClasses.rootCheckbox },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: itemClass },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"label\", { className: cssClasses.checkboxLabel },\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"input\", { ref: this.checkRef, type: \"checkbox\", name: this.question.name, value: this.question.booleanValue === null\n                            ? \"\"\n                            : this.question.booleanValue, id: this.question.inputId, className: cssClasses.controlCheckbox, disabled: this.question.isDisabledAttr, readOnly: this.question.isReadOnlyAttr, checked: this.question.booleanValue || false, onChange: this.handleOnChange, \"aria-required\": this.question.ariaRequired, \"aria-label\": this.question.ariaLabel, \"aria-invalid\": this.question.ariaInvalid, \"aria-errormessage\": this.question.ariaErrormessage }),\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: cssClasses.checkboxMaterialDecorator },\n                        this.question.svgIcon ?\n                            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"svg\", { className: cssClasses.checkboxItemDecorator },\n                                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"use\", { xlinkHref: this.question.svgIcon })) : null,\n                        external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: \"check\" })),\n                    this.question.isLabelRendered && (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: cssClasses.checkboxControlLabel, id: this.question.labelRenderedAriaID },\n                        external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](title_actions_TitleActions, { element: this.question, cssClasses: this.question.cssClasses })))),\n                description)));\n    };\n    return SurveyQuestionBooleanCheckbox;\n}(boolean_SurveyQuestionBoolean));\n\nReactQuestionFactory.Instance.registerQuestion(\"sv-boolean-checkbox\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](boolean_checkbox_SurveyQuestionBooleanCheckbox, props);\n});\nexternal_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"RendererFactory\"].Instance.registerRenderer(\"boolean\", \"checkbox\", \"sv-boolean-checkbox\");\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/boolean-radio.tsx\nvar boolean_radio_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\nvar boolean_radio_SurveyQuestionBooleanRadio = /** @class */ (function (_super) {\n    boolean_radio_extends(SurveyQuestionBooleanRadio, _super);\n    function SurveyQuestionBooleanRadio(props) {\n        var _this = _super.call(this, props) || this;\n        _this.handleOnChange = function (event) {\n            _this.question.booleanValue = event.nativeEvent.target.value == \"true\";\n        };\n        return _this;\n    }\n    SurveyQuestionBooleanRadio.prototype.renderRadioItem = function (value, locText) {\n        var cssClasses = this.question.cssClasses;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { role: \"presentation\", className: this.question.getRadioItemClass(cssClasses, value) },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"label\", { className: cssClasses.radioLabel },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"input\", { type: \"radio\", name: this.question.name, value: value, \"aria-errormessage\": this.question.ariaErrormessage, checked: value === this.question.booleanValueRendered, disabled: this.question.isDisabledAttr, readOnly: this.question.isReadOnlyAttr, className: cssClasses.itemRadioControl, onChange: this.handleOnChange }),\n                this.question.cssClasses.materialRadioDecorator ?\n                    (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: cssClasses.materialRadioDecorator }, this.question.itemSvgIcon ?\n                        (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"svg\", { className: cssClasses.itemRadioDecorator },\n                            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"use\", { xlinkHref: this.question.itemSvgIcon }))) : null)) : null,\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: cssClasses.radioControlLabel }, this.renderLocString(locText)))));\n    };\n    SurveyQuestionBooleanRadio.prototype.renderElement = function () {\n        var cssClasses = this.question.cssClasses;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: cssClasses.rootRadio },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"fieldset\", { role: \"presentation\", className: cssClasses.radioFieldset }, !this.question.swapOrder ?\n                (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Fragment\"], null,\n                    this.renderRadioItem(false, this.question.locLabelFalse),\n                    this.renderRadioItem(true, this.question.locLabelTrue)))\n                :\n                    (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Fragment\"], null,\n                        this.renderRadioItem(true, this.question.locLabelTrue),\n                        this.renderRadioItem(false, this.question.locLabelFalse))))));\n    };\n    return SurveyQuestionBooleanRadio;\n}(boolean_SurveyQuestionBoolean));\n\nReactQuestionFactory.Instance.registerQuestion(\"sv-boolean-radio\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](boolean_radio_SurveyQuestionBooleanRadio, props);\n});\nexternal_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"RendererFactory\"].Instance.registerRenderer(\"boolean\", \"radio\", \"sv-boolean-radio\");\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion_empty.tsx\nvar reactquestion_empty_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar reactquestion_empty_SurveyQuestionEmpty = /** @class */ (function (_super) {\n    reactquestion_empty_extends(SurveyQuestionEmpty, _super);\n    function SurveyQuestionEmpty(props) {\n        var _this = _super.call(this, props) || this;\n        _this.state = { value: _this.question.value };\n        return _this;\n    }\n    Object.defineProperty(SurveyQuestionEmpty.prototype, \"question\", {\n        get: function () {\n            return this.questionBase;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionEmpty.prototype.renderElement = function () {\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", null);\n    };\n    return SurveyQuestionEmpty;\n}(reactquestion_element_SurveyQuestionElementBase));\n\nReactQuestionFactory.Instance.registerQuestion(\"empty\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_empty_SurveyQuestionEmpty, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/matrix/row.tsx\nvar matrix_row_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar row_MatrixRow = /** @class */ (function (_super) {\n    matrix_row_extends(MatrixRow, _super);\n    function MatrixRow(props) {\n        var _this = _super.call(this, props) || this;\n        _this.root = external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createRef();\n        _this.onPointerDownHandler = function (event) {\n            _this.parentMatrix.onPointerDown(event.nativeEvent, _this.model.row);\n        };\n        return _this;\n    }\n    Object.defineProperty(MatrixRow.prototype, \"model\", {\n        get: function () {\n            return this.props.model;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(MatrixRow.prototype, \"parentMatrix\", {\n        get: function () {\n            return this.props.parentMatrix;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    MatrixRow.prototype.getStateElement = function () {\n        return this.model;\n    };\n    MatrixRow.prototype.componentDidMount = function () {\n        _super.prototype.componentDidMount.call(this);\n        if (this.root.current) {\n            this.model.setRootElement(this.root.current);\n        }\n    };\n    MatrixRow.prototype.componentWillUnmount = function () {\n        _super.prototype.componentWillUnmount.call(this);\n        this.model.setRootElement(undefined);\n    };\n    MatrixRow.prototype.shouldComponentUpdate = function (nextProps, nextState) {\n        if (!_super.prototype.shouldComponentUpdate.call(this, nextProps, nextState))\n            return false;\n        if (nextProps.model !== this.model) {\n            if (nextProps.element) {\n                nextProps.element.setRootElement(this.root.current);\n            }\n            if (this.model) {\n                this.model.setRootElement(undefined);\n            }\n        }\n        return true;\n    };\n    MatrixRow.prototype.render = function () {\n        var _this = this;\n        var model = this.model;\n        if (!model.visible)\n            return null;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"tr\", { ref: this.root, className: model.className, \"data-sv-drop-target-matrix-row\": model.row && model.row.id, onPointerDown: function (event) { return _this.onPointerDownHandler(event); } }, this.props.children));\n    };\n    return MatrixRow;\n}(reactquestion_element_SurveyElementBase));\n\nReactElementFactory.Instance.registerElement(\"sv-matrix-row\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(row_MatrixRow, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/matrix-actions/drag-drop-icon/drag-drop-icon.tsx\nvar drag_drop_icon_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar drag_drop_icon_SurveyQuestionMatrixDynamicDragDropIcon = /** @class */ (function (_super) {\n    drag_drop_icon_extends(SurveyQuestionMatrixDynamicDragDropIcon, _super);\n    function SurveyQuestionMatrixDynamicDragDropIcon() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(SurveyQuestionMatrixDynamicDragDropIcon.prototype, \"question\", {\n        get: function () {\n            return this.props.item.data.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionMatrixDynamicDragDropIcon.prototype.renderElement = function () {\n        if (this.question.iconDragElement) {\n            return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"svg\", { className: this.question.cssClasses.dragElementDecorator },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"use\", { xlinkHref: this.question.iconDragElement })));\n        }\n        else {\n            return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { className: this.question.cssClasses.iconDrag }));\n        }\n    };\n    return SurveyQuestionMatrixDynamicDragDropIcon;\n}(ReactSurveyElement));\n\nReactElementFactory.Instance.registerElement(\"sv-matrix-drag-drop-icon\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(drag_drop_icon_SurveyQuestionMatrixDynamicDragDropIcon, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion_matrixdropdownbase.tsx\nvar reactquestion_matrixdropdownbase_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\n\n\n\n\n\n\nvar reactquestion_matrixdropdownbase_SurveyQuestionMatrixTable = /** @class */ (function (_super) {\n    reactquestion_matrixdropdownbase_extends(SurveyQuestionMatrixTable, _super);\n    function SurveyQuestionMatrixTable() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(SurveyQuestionMatrixTable.prototype, \"question\", {\n        get: function () {\n            return this.props.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionMatrixTable.prototype, \"creator\", {\n        get: function () {\n            return this.props.creator;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionMatrixTable.prototype, \"table\", {\n        get: function () {\n            return this.question.renderedTable;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionMatrixTable.prototype.getStateElement = function () {\n        return this.table;\n    };\n    SurveyQuestionMatrixTable.prototype.wrapCell = function (cell, element, reason) {\n        return this.props.wrapCell(cell, element, reason);\n    };\n    SurveyQuestionMatrixTable.prototype.renderHeader = function () {\n        var table = this.question.renderedTable;\n        if (!table.showHeader)\n            return null;\n        var headers = [];\n        var cells = table.headerRow.cells;\n        for (var i = 0; i < cells.length; i++) {\n            var cell = cells[i];\n            var key = \"column\" + i;\n            var columnStyle = {};\n            if (!!cell.width) {\n                columnStyle.width = cell.width;\n            }\n            if (!!cell.minWidth) {\n                columnStyle.minWidth = cell.minWidth;\n            }\n            var cellContent = this.renderCellContent(cell, \"column-header\", {});\n            var header = cell.hasTitle ?\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"th\", { className: cell.className, key: key, style: columnStyle },\n                    \" \",\n                    cellContent,\n                    \" \")\n                : external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"td\", { className: cell.className, key: key, style: columnStyle });\n            headers.push(header);\n        }\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"thead\", null,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"tr\", null, headers)));\n    };\n    SurveyQuestionMatrixTable.prototype.renderFooter = function () {\n        var table = this.question.renderedTable;\n        if (!table.showFooter)\n            return null;\n        var row = this.renderRow(\"footer\", table.footerRow, this.question.cssClasses, \"row-footer\");\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"tfoot\", null, row);\n    };\n    SurveyQuestionMatrixTable.prototype.renderRows = function () {\n        var cssClasses = this.question.cssClasses;\n        var rows = [];\n        var renderedRows = this.question.renderedTable.renderedRows;\n        for (var i = 0; i < renderedRows.length; i++) {\n            rows.push(this.renderRow(renderedRows[i].id, renderedRows[i], cssClasses));\n        }\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"tbody\", null, rows);\n    };\n    SurveyQuestionMatrixTable.prototype.renderRow = function (keyValue, row, cssClasses, reason) {\n        var matrixrow = [];\n        var cells = row.cells;\n        for (var i = 0; i < cells.length; i++) {\n            matrixrow.push(this.renderCell(cells[i], i, cssClasses, reason));\n        }\n        var key = \"row\" + keyValue;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Fragment\"], { key: key }, (reason == \"row-footer\") ? external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"tr\", null, matrixrow) : external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](row_MatrixRow, { model: row, parentMatrix: this.question }, matrixrow)));\n    };\n    SurveyQuestionMatrixTable.prototype.renderCell = function (cell, index, cssClasses, reason) {\n        var key = \"cell\" + index;\n        if (cell.hasQuestion) {\n            return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_matrixdropdownbase_SurveyQuestionMatrixDropdownCell, { key: key, cssClasses: cssClasses, cell: cell, creator: this.creator, reason: reason }));\n        }\n        if (cell.isErrorsCell) {\n            if (cell.isErrorsCell) {\n                return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_matrixdropdownbase_SurveyQuestionMatrixDropdownErrorsCell, { cell: cell, key: key, keyValue: key, question: cell.question, creator: this.creator }));\n            }\n        }\n        var calcReason = reason;\n        if (!calcReason) {\n            calcReason = cell.hasTitle ? \"row-header\" : \"\";\n        }\n        var cellContent = this.renderCellContent(cell, calcReason, cssClasses);\n        var cellStyle = null;\n        if (!!cell.width || !!cell.minWidth) {\n            cellStyle = {};\n            if (!!cell.width)\n                cellStyle.width = cell.width;\n            if (!!cell.minWidth)\n                cellStyle.minWidth = cell.minWidth;\n        }\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"td\", { className: cell.className, key: key, style: cellStyle, colSpan: cell.colSpans, title: cell.getTitle() }, cellContent));\n    };\n    SurveyQuestionMatrixTable.prototype.renderCellContent = function (cell, reason, cssClasses) {\n        var cellContent = null;\n        var cellStyle = null;\n        if (!!cell.width || !!cell.minWidth) {\n            cellStyle = {};\n            if (!!cell.width)\n                cellStyle.width = cell.width;\n            if (!!cell.minWidth)\n                cellStyle.minWidth = cell.minWidth;\n        }\n        if (cell.hasTitle) {\n            reason = \"row-header\";\n            var str = this.renderLocString(cell.locTitle);\n            var require_1 = !!cell.column ? external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_matrixdropdownbase_SurveyQuestionMatrixHeaderRequired, { column: cell.column, question: this.question }) : null;\n            cellContent = (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Fragment\"], null,\n                str,\n                require_1));\n        }\n        if (cell.isDragHandlerCell) {\n            cellContent = (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Fragment\"], null,\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](drag_drop_icon_SurveyQuestionMatrixDynamicDragDropIcon, { item: { data: { row: cell.row, question: this.question } } })));\n        }\n        if (cell.isActionsCell) {\n            cellContent = (ReactElementFactory.Instance.createElement(\"sv-matrixdynamic-actions-cell\", {\n                question: this.question,\n                cssClasses: cssClasses, cell: cell,\n                model: cell.item.getData()\n            }));\n        }\n        if (cell.hasPanel) {\n            cellContent = (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](panel_SurveyPanel, { key: cell.panel.id, element: cell.panel, survey: this.question.survey, cssClasses: cssClasses, isDisplayMode: this.isDisplayMode, creator: this.creator }));\n        }\n        if (!cellContent)\n            return null;\n        var readyCell = (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Fragment\"], null, cellContent));\n        return this.wrapCell(cell, readyCell, reason);\n    };\n    SurveyQuestionMatrixTable.prototype.renderElement = function () {\n        var header = this.renderHeader();\n        var footers = this.renderFooter();\n        var rows = this.renderRows();\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"table\", { className: this.question.getTableCss() },\n            header,\n            rows,\n            footers));\n    };\n    return SurveyQuestionMatrixTable;\n}(reactquestion_element_SurveyElementBase));\nvar reactquestion_matrixdropdownbase_SurveyQuestionMatrixDropdownBase = /** @class */ (function (_super) {\n    reactquestion_matrixdropdownbase_extends(SurveyQuestionMatrixDropdownBase, _super);\n    function SurveyQuestionMatrixDropdownBase(props) {\n        var _this = _super.call(this, props) || this;\n        //Create rendered table in contructor and not on rendering\n        var table = _this.question.renderedTable;\n        _this.state = _this.getState();\n        return _this;\n    }\n    Object.defineProperty(SurveyQuestionMatrixDropdownBase.prototype, \"question\", {\n        get: function () {\n            return this.questionBase;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionMatrixDropdownBase.prototype.getState = function (prevState) {\n        if (prevState === void 0) { prevState = null; }\n        return { rowCounter: !prevState ? 0 : prevState.rowCounter + 1 };\n    };\n    SurveyQuestionMatrixDropdownBase.prototype.updateStateOnCallback = function () {\n        if (this.isRendering)\n            return;\n        this.setState(this.getState(this.state));\n    };\n    SurveyQuestionMatrixDropdownBase.prototype.componentDidMount = function () {\n        var _this = this;\n        _super.prototype.componentDidMount.call(this);\n        this.question.onRenderedTableResetCallback = function () {\n            _this.updateStateOnCallback();\n        };\n    };\n    SurveyQuestionMatrixDropdownBase.prototype.componentWillUnmount = function () {\n        _super.prototype.componentWillUnmount.call(this);\n        this.question.onRenderedTableResetCallback = function () { };\n    };\n    SurveyQuestionMatrixDropdownBase.prototype.renderElement = function () {\n        return this.renderTableDiv();\n    };\n    SurveyQuestionMatrixDropdownBase.prototype.renderTableDiv = function () {\n        var _this = this;\n        var divStyle = this.question.showHorizontalScroll\n            ? { overflowX: \"scroll\" }\n            : {};\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { style: divStyle, className: this.question.cssClasses.tableWrapper, ref: function (root) { return (_this.setControl(root)); } },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_matrixdropdownbase_SurveyQuestionMatrixTable, { question: this.question, creator: this.creator, wrapCell: function (cell, element, reason) { return _this.wrapCell(cell, element, reason); } })));\n    };\n    return SurveyQuestionMatrixDropdownBase;\n}(reactquestion_element_SurveyQuestionElementBase));\n\nvar reactquestion_matrixdropdownbase_SurveyQuestionMatrixActionsCell = /** @class */ (function (_super) {\n    reactquestion_matrixdropdownbase_extends(SurveyQuestionMatrixActionsCell, _super);\n    function SurveyQuestionMatrixActionsCell(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(SurveyQuestionMatrixActionsCell.prototype, \"model\", {\n        get: function () {\n            return this.props.model;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionMatrixActionsCell.prototype.renderElement = function () {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](action_bar_SurveyActionBar, { model: this.model, handleClick: false }));\n    };\n    return SurveyQuestionMatrixActionsCell;\n}(ReactSurveyElement));\nvar reactquestion_matrixdropdownbase_SurveyQuestionMatrixDropdownErrorsCell = /** @class */ (function (_super) {\n    reactquestion_matrixdropdownbase_extends(SurveyQuestionMatrixDropdownErrorsCell, _super);\n    function SurveyQuestionMatrixDropdownErrorsCell(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(SurveyQuestionMatrixDropdownErrorsCell.prototype, \"key\", {\n        get: function () {\n            return this.props.keyValue;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionMatrixDropdownErrorsCell.prototype, \"cell\", {\n        get: function () {\n            return this.props.cell;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionMatrixDropdownErrorsCell.prototype.render = function () {\n        if (!this.cell.isVisible)\n            return null;\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"td\", { className: this.cell.className, key: this.key, colSpan: this.cell.colSpans, title: this.cell.getTitle() }, _super.prototype.render.call(this));\n    };\n    SurveyQuestionMatrixDropdownErrorsCell.prototype.getQuestionPropertiesToTrack = function () {\n        return _super.prototype.getQuestionPropertiesToTrack.call(this).concat([\"visible\"]);\n    };\n    return SurveyQuestionMatrixDropdownErrorsCell;\n}(reactquestion_SurveyQuestionErrorCell));\nReactElementFactory.Instance.registerElement(\"sv-matrixdynamic-actions-cell\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_matrixdropdownbase_SurveyQuestionMatrixActionsCell, props);\n});\nvar reactquestion_matrixdropdownbase_SurveyQuestionMatrixHeaderRequired = /** @class */ (function (_super) {\n    reactquestion_matrixdropdownbase_extends(SurveyQuestionMatrixHeaderRequired, _super);\n    function SurveyQuestionMatrixHeaderRequired(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(SurveyQuestionMatrixHeaderRequired.prototype, \"column\", {\n        get: function () {\n            return this.props.column;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionMatrixHeaderRequired.prototype, \"question\", {\n        get: function () {\n            return this.props.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionMatrixHeaderRequired.prototype.getStateElement = function () {\n        return this.column;\n    };\n    SurveyQuestionMatrixHeaderRequired.prototype.renderElement = function () {\n        if (!this.column.isRenderedRequired)\n            return null;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Fragment\"], null,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", null, \"\\u00A0\"),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: this.question.cssClasses.cellRequiredText }, this.column.requiredText)));\n    };\n    return SurveyQuestionMatrixHeaderRequired;\n}(ReactSurveyElement));\nvar reactquestion_matrixdropdownbase_SurveyQuestionMatrixDropdownCell = /** @class */ (function (_super) {\n    reactquestion_matrixdropdownbase_extends(SurveyQuestionMatrixDropdownCell, _super);\n    function SurveyQuestionMatrixDropdownCell(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(SurveyQuestionMatrixDropdownCell.prototype, \"cell\", {\n        get: function () {\n            return this.props.cell;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionMatrixDropdownCell.prototype, \"itemCss\", {\n        get: function () {\n            return !!this.cell ? this.cell.className : \"\";\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionMatrixDropdownCell.prototype.getQuestion = function () {\n        var q = _super.prototype.getQuestion.call(this);\n        if (!!q)\n            return q;\n        return !!this.cell ? this.cell.question : null;\n    };\n    SurveyQuestionMatrixDropdownCell.prototype.doAfterRender = function () {\n        var el = this.cellRef.current;\n        if (el &&\n            this.cell &&\n            this.question &&\n            this.question.survey &&\n            el.getAttribute(\"data-rendered\") !== \"r\") {\n            el.setAttribute(\"data-rendered\", \"r\");\n            var options = {\n                cell: this.cell,\n                cellQuestion: this.question,\n                htmlElement: el,\n                row: this.cell.row,\n                column: this.cell.cell.column,\n            };\n            this.question.survey.matrixAfterCellRender(this.question, options);\n            this.question.afterRenderCore(el);\n        }\n    };\n    SurveyQuestionMatrixDropdownCell.prototype.getShowErrors = function () {\n        return (this.question.isVisible &&\n            (!this.cell.isChoice || this.cell.isFirstChoice));\n    };\n    SurveyQuestionMatrixDropdownCell.prototype.getCellStyle = function () {\n        var res = _super.prototype.getCellStyle.call(this);\n        if (!!this.cell.width || !!this.cell.minWidth) {\n            if (!res)\n                res = {};\n            if (!!this.cell.width)\n                res.width = this.cell.width;\n            if (!!this.cell.minWidth)\n                res.minWidth = this.cell.minWidth;\n        }\n        return res;\n    };\n    SurveyQuestionMatrixDropdownCell.prototype.getHeaderText = function () {\n        return this.cell.headers;\n    };\n    SurveyQuestionMatrixDropdownCell.prototype.renderElement = function () {\n        if (!this.cell.isVisible) {\n            return null;\n        }\n        return _super.prototype.renderElement.call(this);\n    };\n    SurveyQuestionMatrixDropdownCell.prototype.renderCellContent = function () {\n        var content = _super.prototype.renderCellContent.call(this);\n        var responsiveTitle = this.cell.showResponsiveTitle ? (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: this.cell.responsiveTitleCss }, this.renderLocString(this.cell.responsiveLocTitle))) : null;\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Fragment\"], null,\n            responsiveTitle,\n            content);\n    };\n    SurveyQuestionMatrixDropdownCell.prototype.renderQuestion = function () {\n        if (!this.question.isVisible)\n            return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Fragment\"], null);\n        if (!this.cell.isChoice)\n            return reactquestion_SurveyQuestion.renderQuestionBody(this.creator, this.question);\n        if (this.cell.isOtherChoice)\n            return this.renderOtherComment();\n        if (this.cell.isCheckbox)\n            return this.renderCellCheckboxButton();\n        return this.renderCellRadiogroupButton();\n    };\n    SurveyQuestionMatrixDropdownCell.prototype.renderOtherComment = function () {\n        var question = this.cell.question;\n        var cssClasses = question.cssClasses || {};\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](SurveyQuestionOtherValueItem, { question: question, cssClasses: cssClasses, otherCss: cssClasses.other, isDisplayMode: question.isInputReadOnly });\n    };\n    SurveyQuestionMatrixDropdownCell.prototype.renderCellCheckboxButton = function () {\n        var key = this.cell.question.id + \"item\" + this.cell.choiceIndex;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_checkbox_SurveyQuestionCheckboxItem, { key: key, question: this.cell.question, cssClasses: this.cell.question.cssClasses, isDisplayMode: this.cell.question.isInputReadOnly, item: this.cell.item, isFirst: this.cell.isFirstChoice, index: this.cell.choiceIndex.toString(), hideCaption: true }));\n    };\n    SurveyQuestionMatrixDropdownCell.prototype.renderCellRadiogroupButton = function () {\n        var key = this.cell.question.id + \"item\" + this.cell.choiceIndex;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_radiogroup_SurveyQuestionRadioItem, { key: key, question: this.cell.question, cssClasses: this.cell.question.cssClasses, isDisplayMode: this.cell.question.isInputReadOnly, item: this.cell.item, index: this.cell.choiceIndex.toString(), isChecked: this.cell.question.value === this.cell.item.value, isDisabled: this.cell.question.isReadOnly || !this.cell.item.isEnabled, hideCaption: true }));\n    };\n    return SurveyQuestionMatrixDropdownCell;\n}(reactquestion_SurveyQuestionAndErrorsCell));\n\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion_matrixdropdown.tsx\nvar reactquestion_matrixdropdown_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar SurveyQuestionMatrixDropdown = /** @class */ (function (_super) {\n    reactquestion_matrixdropdown_extends(SurveyQuestionMatrixDropdown, _super);\n    function SurveyQuestionMatrixDropdown(props) {\n        return _super.call(this, props) || this;\n    }\n    return SurveyQuestionMatrixDropdown;\n}(reactquestion_matrixdropdownbase_SurveyQuestionMatrixDropdownBase));\n\nReactQuestionFactory.Instance.registerQuestion(\"matrixdropdown\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](SurveyQuestionMatrixDropdown, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion_matrixdynamic.tsx\nvar reactquestion_matrixdynamic_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\nvar reactquestion_matrixdynamic_SurveyQuestionMatrixDynamic = /** @class */ (function (_super) {\n    reactquestion_matrixdynamic_extends(SurveyQuestionMatrixDynamic, _super);\n    function SurveyQuestionMatrixDynamic(props) {\n        var _this = _super.call(this, props) || this;\n        _this.handleOnRowAddClick = _this.handleOnRowAddClick.bind(_this);\n        return _this;\n    }\n    Object.defineProperty(SurveyQuestionMatrixDynamic.prototype, \"matrix\", {\n        get: function () {\n            return this.questionBase;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionMatrixDynamic.prototype.handleOnRowAddClick = function (event) {\n        this.matrix.addRowUI();\n    };\n    SurveyQuestionMatrixDynamic.prototype.renderElement = function () {\n        var cssClasses = this.question.cssClasses;\n        var showTable = this.question.renderedTable.showTable;\n        var mainDiv = showTable\n            ? this.renderTableDiv()\n            : this.renderNoRowsContent(cssClasses);\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", null,\n            this.renderAddRowButtonOnTop(cssClasses),\n            mainDiv,\n            this.renderAddRowButtonOnBottom(cssClasses)));\n    };\n    SurveyQuestionMatrixDynamic.prototype.renderAddRowButtonOnTop = function (cssClasses) {\n        if (!this.matrix.renderedTable.showAddRowOnTop)\n            return null;\n        return this.renderAddRowButton(cssClasses);\n    };\n    SurveyQuestionMatrixDynamic.prototype.renderAddRowButtonOnBottom = function (cssClasses) {\n        if (!this.matrix.renderedTable.showAddRowOnBottom)\n            return null;\n        return this.renderAddRowButton(cssClasses);\n    };\n    SurveyQuestionMatrixDynamic.prototype.renderNoRowsContent = function (cssClasses) {\n        var text = this.renderLocString(this.matrix.locEmptyRowsText);\n        var textDiv = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: cssClasses.emptyRowsText }, text);\n        var btn = this.matrix.renderedTable.showAddRow ? this.renderAddRowButton(cssClasses, true) : undefined;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: cssClasses.emptyRowsSection },\n            textDiv,\n            btn));\n    };\n    SurveyQuestionMatrixDynamic.prototype.renderAddRowButton = function (cssClasses, isEmptySection) {\n        if (isEmptySection === void 0) { isEmptySection = false; }\n        return ReactElementFactory.Instance.createElement(\"sv-matrixdynamic-add-btn\", {\n            question: this.question,\n            cssClasses: cssClasses, isEmptySection: isEmptySection\n        });\n    };\n    return SurveyQuestionMatrixDynamic;\n}(reactquestion_matrixdropdownbase_SurveyQuestionMatrixDropdownBase));\n\nReactQuestionFactory.Instance.registerQuestion(\"matrixdynamic\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_matrixdynamic_SurveyQuestionMatrixDynamic, props);\n});\nvar reactquestion_matrixdynamic_SurveyQuestionMatrixDynamicAddButton = /** @class */ (function (_super) {\n    reactquestion_matrixdynamic_extends(SurveyQuestionMatrixDynamicAddButton, _super);\n    function SurveyQuestionMatrixDynamicAddButton(props) {\n        var _this = _super.call(this, props) || this;\n        _this.handleOnRowAddClick = _this.handleOnRowAddClick.bind(_this);\n        return _this;\n    }\n    Object.defineProperty(SurveyQuestionMatrixDynamicAddButton.prototype, \"matrix\", {\n        get: function () {\n            return this.props.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionMatrixDynamicAddButton.prototype.handleOnRowAddClick = function (event) {\n        this.matrix.addRowUI();\n    };\n    SurveyQuestionMatrixDynamicAddButton.prototype.renderElement = function () {\n        var addRowText = this.renderLocString(this.matrix.locAddRowText);\n        var addButton = (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"button\", { className: this.matrix.getAddRowButtonCss(this.props.isEmptySection), type: \"button\", disabled: this.matrix.isInputReadOnly, onClick: this.matrix.isDesignMode ? undefined : this.handleOnRowAddClick },\n            addRowText,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: this.props.cssClasses.iconAdd })));\n        return (this.props.isEmptySection ? addButton : external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.props.cssClasses.footer }, addButton));\n    };\n    return SurveyQuestionMatrixDynamicAddButton;\n}(ReactSurveyElement));\n\nReactElementFactory.Instance.registerElement(\"sv-matrixdynamic-add-btn\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_matrixdynamic_SurveyQuestionMatrixDynamicAddButton, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/paneldynamic-actions/paneldynamic-add-btn.tsx\nvar paneldynamic_add_btn_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar SurveyQuestionPanelDynamicAction = /** @class */ (function (_super) {\n    paneldynamic_add_btn_extends(SurveyQuestionPanelDynamicAction, _super);\n    function SurveyQuestionPanelDynamicAction(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(SurveyQuestionPanelDynamicAction.prototype, \"data\", {\n        get: function () {\n            return (this.props.item && this.props.item.data) || this.props.data;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionPanelDynamicAction.prototype, \"question\", {\n        get: function () {\n            return (this.props.item && this.props.item.data.question) || this.props.data.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return SurveyQuestionPanelDynamicAction;\n}(ReactSurveyElement));\n\nvar paneldynamic_add_btn_SurveyQuestionPanelDynamicAddButton = /** @class */ (function (_super) {\n    paneldynamic_add_btn_extends(SurveyQuestionPanelDynamicAddButton, _super);\n    function SurveyQuestionPanelDynamicAddButton() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.handleClick = function (event) {\n            _this.question.addPanelUI();\n        };\n        return _this;\n    }\n    SurveyQuestionPanelDynamicAddButton.prototype.renderElement = function () {\n        if (!this.question.canAddPanel)\n            return null;\n        var btnText = this.renderLocString(this.question.locPanelAddText);\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"button\", { type: \"button\", className: this.question.getAddButtonCss(), onClick: this.handleClick },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { className: this.question.cssClasses.buttonAddText }, btnText)));\n    };\n    return SurveyQuestionPanelDynamicAddButton;\n}(SurveyQuestionPanelDynamicAction));\n\nReactElementFactory.Instance.registerElement(\"sv-paneldynamic-add-btn\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(paneldynamic_add_btn_SurveyQuestionPanelDynamicAddButton, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/paneldynamic-actions/paneldynamic-next-btn.tsx\nvar paneldynamic_next_btn_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\nvar paneldynamic_next_btn_SurveyQuestionPanelDynamicNextButton = /** @class */ (function (_super) {\n    paneldynamic_next_btn_extends(SurveyQuestionPanelDynamicNextButton, _super);\n    function SurveyQuestionPanelDynamicNextButton() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.handleClick = function (event) {\n            _this.question.goToNextPanel();\n        };\n        return _this;\n    }\n    SurveyQuestionPanelDynamicNextButton.prototype.renderElement = function () {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { title: this.question.panelNextText, onClick: this.handleClick, className: this.question.getNextButtonCss() },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(svg_icon_SvgIcon, { iconName: this.question.cssClasses.progressBtnIcon, size: \"auto\" })));\n    };\n    return SurveyQuestionPanelDynamicNextButton;\n}(SurveyQuestionPanelDynamicAction));\n\nReactElementFactory.Instance.registerElement(\"sv-paneldynamic-next-btn\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(paneldynamic_next_btn_SurveyQuestionPanelDynamicNextButton, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/paneldynamic-actions/paneldynamic-prev-btn.tsx\nvar paneldynamic_prev_btn_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\nvar paneldynamic_prev_btn_SurveyQuestionPanelDynamicPrevButton = /** @class */ (function (_super) {\n    paneldynamic_prev_btn_extends(SurveyQuestionPanelDynamicPrevButton, _super);\n    function SurveyQuestionPanelDynamicPrevButton() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.handleClick = function (event) {\n            _this.question.goToPrevPanel();\n        };\n        return _this;\n    }\n    SurveyQuestionPanelDynamicPrevButton.prototype.renderElement = function () {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { title: this.question.panelPrevText, onClick: this.handleClick, className: this.question.getPrevButtonCss() },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(svg_icon_SvgIcon, { iconName: this.question.cssClasses.progressBtnIcon, size: \"auto\" })));\n    };\n    return SurveyQuestionPanelDynamicPrevButton;\n}(SurveyQuestionPanelDynamicAction));\n\nReactElementFactory.Instance.registerElement(\"sv-paneldynamic-prev-btn\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(paneldynamic_prev_btn_SurveyQuestionPanelDynamicPrevButton, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/paneldynamic-actions/paneldynamic-progress-text.tsx\nvar paneldynamic_progress_text_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar paneldynamic_progress_text_SurveyQuestionPanelDynamicProgressText = /** @class */ (function (_super) {\n    paneldynamic_progress_text_extends(SurveyQuestionPanelDynamicProgressText, _super);\n    function SurveyQuestionPanelDynamicProgressText() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    SurveyQuestionPanelDynamicProgressText.prototype.renderElement = function () {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: this.question.cssClasses.progressText }, this.question.progressText));\n    };\n    return SurveyQuestionPanelDynamicProgressText;\n}(SurveyQuestionPanelDynamicAction));\n\nReactElementFactory.Instance.registerElement(\"sv-paneldynamic-progress-text\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(paneldynamic_progress_text_SurveyQuestionPanelDynamicProgressText, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion_paneldynamic.tsx\nvar reactquestion_paneldynamic_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\n\n\n\n\nvar reactquestion_paneldynamic_SurveyQuestionPanelDynamic = /** @class */ (function (_super) {\n    reactquestion_paneldynamic_extends(SurveyQuestionPanelDynamic, _super);\n    function SurveyQuestionPanelDynamic(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(SurveyQuestionPanelDynamic.prototype, \"question\", {\n        get: function () {\n            return this.questionBase;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionPanelDynamic.prototype.componentDidMount = function () {\n        _super.prototype.componentDidMount.call(this);\n        this.setState({ panelCounter: 0 });\n        var self = this;\n        this.question.panelCountChangedCallback = function () {\n            self.updateQuestionRendering();\n        };\n        this.question.currentIndexChangedCallback = function () {\n            self.updateQuestionRendering();\n        };\n        this.question.renderModeChangedCallback = function () {\n            self.updateQuestionRendering();\n        };\n    };\n    SurveyQuestionPanelDynamic.prototype.componentWillUnmount = function () {\n        _super.prototype.componentWillUnmount.call(this);\n        this.question.panelCountChangedCallback = function () { };\n        this.question.currentIndexChangedCallback = function () { };\n        this.question.renderModeChangedCallback = function () { };\n    };\n    SurveyQuestionPanelDynamic.prototype.updateQuestionRendering = function () {\n        this.setState({\n            panelCounter: this.state ? this.state.panelCounter + 1 : 1,\n        });\n    };\n    SurveyQuestionPanelDynamic.prototype.renderElement = function () {\n        var _this = this;\n        var panels = [];\n        this.question.renderedPanels.forEach(function (panel, index) {\n            panels.push(external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_paneldynamic_SurveyQuestionPanelDynamicItem, { key: panel.id, element: panel, question: _this.question, index: index, cssClasses: _this.question.cssClasses, isDisplayMode: _this.isDisplayMode, creator: _this.creator }));\n        });\n        var btnAdd = this.question.isRenderModeList && this.question[\"showLegacyNavigation\"]\n            ? this.renderAddRowButton()\n            : null;\n        var navTop = this.question.isProgressTopShowing\n            ? this.renderNavigator()\n            : null;\n        var navBottom = this.question.isProgressBottomShowing\n            ? this.renderNavigator()\n            : null;\n        var navV2 = this.renderNavigatorV2();\n        var noEntriesPlaceholder = this.renderPlaceholder();\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.root },\n            noEntriesPlaceholder,\n            navTop,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.panelsContainer }, panels),\n            navBottom,\n            btnAdd,\n            navV2));\n    };\n    SurveyQuestionPanelDynamic.prototype.renderNavigator = function () {\n        if (!this.question[\"showLegacyNavigation\"]) {\n            if (this.question.isRangeShowing && this.question.isProgressTopShowing) {\n                return this.renderRange();\n            }\n            else {\n                return null;\n            }\n        }\n        var range = this.question.isRangeShowing ? this.renderRange() : null;\n        var btnPrev = this.rendrerPrevButton();\n        var btnNext = this.rendrerNextButton();\n        var btnAdd = this.renderAddRowButton();\n        var progressClass = this.question.isProgressTopShowing\n            ? this.question.cssClasses.progressTop\n            : this.question.cssClasses.progressBottom;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: progressClass },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { style: { clear: \"both\" } },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.progressContainer },\n                    btnPrev,\n                    range,\n                    btnNext),\n                btnAdd,\n                this.renderProgressText())));\n    };\n    SurveyQuestionPanelDynamic.prototype.renderProgressText = function () {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](paneldynamic_progress_text_SurveyQuestionPanelDynamicProgressText, { data: { question: this.question } }));\n    };\n    SurveyQuestionPanelDynamic.prototype.rendrerPrevButton = function () {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](paneldynamic_prev_btn_SurveyQuestionPanelDynamicPrevButton, { data: { question: this.question } }));\n    };\n    SurveyQuestionPanelDynamic.prototype.rendrerNextButton = function () {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](paneldynamic_next_btn_SurveyQuestionPanelDynamicNextButton, { data: { question: this.question } }));\n    };\n    SurveyQuestionPanelDynamic.prototype.renderRange = function () {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.progress },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.progressBar, style: { width: this.question.progress }, role: \"progressbar\" })));\n    };\n    SurveyQuestionPanelDynamic.prototype.renderAddRowButton = function () {\n        return ReactElementFactory.Instance.createElement(\"sv-paneldynamic-add-btn\", {\n            data: { question: this.question }\n        });\n    };\n    SurveyQuestionPanelDynamic.prototype.renderNavigatorV2 = function () {\n        if (!this.question.showNavigation)\n            return null;\n        var range = this.question.isRangeShowing && this.question.isProgressBottomShowing ? this.renderRange() : null;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.footer },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"hr\", { className: this.question.cssClasses.separator }),\n            range,\n            this.question.footerToolbar.visibleActions.length ? (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.footerButtonsContainer },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](action_bar_SurveyActionBar, { model: this.question.footerToolbar }))) : null));\n    };\n    SurveyQuestionPanelDynamic.prototype.renderPlaceholder = function () {\n        if (this.question.getShowNoEntriesPlaceholder()) {\n            return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.noEntriesPlaceholder },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", null, this.renderLocString(this.question.locNoEntriesText)),\n                this.renderAddRowButton()));\n        }\n        return null;\n    };\n    return SurveyQuestionPanelDynamic;\n}(reactquestion_element_SurveyQuestionElementBase));\n\nvar reactquestion_paneldynamic_SurveyQuestionPanelDynamicItem = /** @class */ (function (_super) {\n    reactquestion_paneldynamic_extends(SurveyQuestionPanelDynamicItem, _super);\n    function SurveyQuestionPanelDynamicItem() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(SurveyQuestionPanelDynamicItem.prototype, \"question\", {\n        get: function () {\n            return this.props.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionPanelDynamicItem.prototype, \"index\", {\n        get: function () {\n            return this.props.index;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionPanelDynamicItem.prototype.getSurvey = function () {\n        return !!this.question ? this.question.survey : null;\n    };\n    SurveyQuestionPanelDynamicItem.prototype.getCss = function () {\n        var survey = this.getSurvey();\n        return !!survey ? survey.getCss() : {};\n    };\n    SurveyQuestionPanelDynamicItem.prototype.render = function () {\n        var panel = _super.prototype.render.call(this);\n        var removeButton = this.renderButton();\n        var separator = this.question.showSeparator(this.index) ?\n            (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"hr\", { className: this.question.cssClasses.separator })) : null;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Fragment\"], null,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.getPanelWrapperCss(this.panel) },\n                panel,\n                removeButton),\n            separator));\n    };\n    SurveyQuestionPanelDynamicItem.prototype.renderButton = function () {\n        if (this.question.panelRemoveButtonLocation !== \"right\" ||\n            !this.question.canRemovePanel ||\n            (this.question.isRenderModeList && this.panel.isCollapsed)) {\n            return null;\n        }\n        return ReactElementFactory.Instance.createElement(\"sv-paneldynamic-remove-btn\", {\n            data: { question: this.question, panel: this.panel }\n        });\n    };\n    return SurveyQuestionPanelDynamicItem;\n}(panel_SurveyPanel));\n\nReactQuestionFactory.Instance.registerQuestion(\"paneldynamic\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_paneldynamic_SurveyQuestionPanelDynamic, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/progress.tsx\nvar progress_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\nvar progress_SurveyProgress = /** @class */ (function (_super) {\n    progress_extends(SurveyProgress, _super);\n    function SurveyProgress(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(SurveyProgress.prototype, \"isTop\", {\n        get: function () {\n            return this.props.isTop;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyProgress.prototype, \"progress\", {\n        get: function () {\n            return this.survey.progressValue;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyProgress.prototype, \"progressText\", {\n        get: function () {\n            return this.survey.progressText;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyProgress.prototype.render = function () {\n        var progressStyle = {\n            width: this.progress + \"%\",\n        };\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.survey.getProgressCssClasses(this.props.container) },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { style: progressStyle, className: this.css.progressBar, role: \"progressbar\", \"aria-valuemin\": 0, \"aria-valuemax\": 100, \"aria-label\": \"progress\" },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"SurveyProgressModel\"].getProgressTextInBarCss(this.css) }, this.progressText)),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"SurveyProgressModel\"].getProgressTextUnderBarCss(this.css) }, this.progressText)));\n    };\n    return SurveyProgress;\n}(SurveyNavigationBase));\n\nReactElementFactory.Instance.registerElement(\"sv-progress-pages\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](progress_SurveyProgress, props);\n});\nReactElementFactory.Instance.registerElement(\"sv-progress-questions\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](progress_SurveyProgress, props);\n});\nReactElementFactory.Instance.registerElement(\"sv-progress-correctquestions\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](progress_SurveyProgress, props);\n});\nReactElementFactory.Instance.registerElement(\"sv-progress-requiredquestions\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](progress_SurveyProgress, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/progressButtons.tsx\nvar progressButtons_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\nvar progressButtons_SurveyProgressButtons = /** @class */ (function (_super) {\n    progressButtons_extends(SurveyProgressButtons, _super);\n    function SurveyProgressButtons(props) {\n        var _this = _super.call(this, props) || this;\n        _this.listContainerRef = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createRef\"]();\n        return _this;\n    }\n    Object.defineProperty(SurveyProgressButtons.prototype, \"model\", {\n        get: function () {\n            return this.props.model;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyProgressButtons.prototype, \"container\", {\n        get: function () {\n            return this.props.container;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyProgressButtons.prototype.onResize = function (canShowItemTitles) {\n        this.setState({ canShowItemTitles: canShowItemTitles });\n        this.setState({ canShowHeader: !canShowItemTitles });\n    };\n    SurveyProgressButtons.prototype.onUpdateScroller = function (hasScroller) {\n        this.setState({ hasScroller: hasScroller });\n    };\n    SurveyProgressButtons.prototype.onUpdateSettings = function () {\n        this.setState({ canShowItemTitles: this.model.showItemTitles });\n        this.setState({ canShowFooter: !this.model.showItemTitles });\n    };\n    SurveyProgressButtons.prototype.render = function () {\n        var _this = this;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.model.getRootCss(this.props.container), style: { \"maxWidth\": this.model.progressWidth }, role: \"progressbar\", \"aria-valuemin\": 0, \"aria-valuemax\": 100, \"aria-label\": \"progress\" },\n            this.state.canShowHeader ? external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.css.progressButtonsHeader },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.css.progressButtonsPageTitle, title: this.model.headerText }, this.model.headerText)) : null,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.css.progressButtonsContainer },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.model.getScrollButtonCss(this.state.hasScroller, true), role: \"button\", onClick: function () {\n                        return _this.clickScrollButton(_this.listContainerRef.current, true);\n                    } }),\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.css.progressButtonsListContainer, ref: this.listContainerRef },\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"ul\", { className: this.css.progressButtonsList }, this.getListElements())),\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.model.getScrollButtonCss(this.state.hasScroller, false), role: \"button\", onClick: function () {\n                        return _this.clickScrollButton(_this.listContainerRef.current, false);\n                    } })),\n            this.state.canShowFooter ? external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.css.progressButtonsFooter },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.css.progressButtonsPageTitle, title: this.model.footerText }, this.model.footerText)) : null));\n    };\n    SurveyProgressButtons.prototype.getListElements = function () {\n        var _this = this;\n        var buttons = [];\n        this.survey.visiblePages.forEach(function (page, index) {\n            buttons.push(_this.renderListElement(page, index));\n        });\n        return buttons;\n    };\n    SurveyProgressButtons.prototype.renderListElement = function (page, index) {\n        var _this = this;\n        var text = reactquestion_element_SurveyElementBase.renderLocString(page.locNavigationTitle);\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"li\", { key: \"listelement\" + index, className: this.model.getListElementCss(index), onClick: this.model.isListElementClickable(index)\n                ? function () { return _this.model.clickListElement(page); }\n                : undefined, \"data-page-number\": this.model.getItemNumber(page) },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.css.progressButtonsConnector }),\n            this.state.canShowItemTitles ? external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](external_root_React_commonjs2_react_commonjs_react_amd_react_[\"Fragment\"], null,\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.css.progressButtonsPageTitle, title: page.renderedNavigationTitle }, text),\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.css.progressButtonsPageDescription, title: page.navigationDescription }, page.navigationDescription)) : null,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.css.progressButtonsButton },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.css.progressButtonsButtonBackground }),\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.css.progressButtonsButtonContent }),\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", null, this.model.getItemNumber(page)))));\n    };\n    SurveyProgressButtons.prototype.clickScrollButton = function (listContainerElement, isLeftScroll) {\n        if (!!listContainerElement) {\n            listContainerElement.scrollLeft += (isLeftScroll ? -1 : 1) * 70;\n        }\n    };\n    SurveyProgressButtons.prototype.componentDidMount = function () {\n        var _this = this;\n        _super.prototype.componentDidMount.call(this);\n        setTimeout(function () {\n            _this.respManager = new external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"ProgressButtonsResponsivityManager\"](_this.model, _this.listContainerRef.current, _this);\n        }, 10);\n    };\n    SurveyProgressButtons.prototype.componentWillUnmount = function () {\n        if (!!this.respManager) {\n            this.respManager.dispose();\n        }\n        _super.prototype.componentWillUnmount.call(this);\n    };\n    return SurveyProgressButtons;\n}(SurveyNavigationBase));\n\nReactElementFactory.Instance.registerElement(\"sv-progress-buttons\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](progressButtons_SurveyProgressButtons, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/list/list-item.tsx\nvar list_item_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\nvar list_item_ListItem = /** @class */ (function (_super) {\n    list_item_extends(ListItem, _super);\n    function ListItem() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.handleKeydown = function (event) {\n            _this.model.onKeyDown(event);\n        };\n        return _this;\n    }\n    Object.defineProperty(ListItem.prototype, \"model\", {\n        get: function () {\n            return this.props.model;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ListItem.prototype, \"item\", {\n        get: function () {\n            return this.props.item;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    ListItem.prototype.getStateElement = function () {\n        return this.item;\n    };\n    ListItem.prototype.render = function () {\n        var _this = this;\n        if (!this.item)\n            return null;\n        var contentWrapStyle = {\n            paddingInlineStart: this.model.getItemIndent(this.item)\n        };\n        var className = this.model.getItemClass(this.item);\n        var itemContent = this.item.component || \"sv-list-item-content\";\n        var newElement = ReactElementFactory.Instance.createElement(itemContent, { item: this.item, key: this.item.id, model: this.model });\n        var contentWrap = external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { style: contentWrapStyle, className: this.model.cssClasses.itemBody, title: this.item.locTitle.calculatedText, onMouseOver: function (event) { _this.model.onItemHover(_this.item); }, onMouseLeave: function (event) { _this.model.onItemLeave(_this.item); } }, newElement);\n        var separator = this.item.needSeparator ? external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: this.model.cssClasses.itemSeparator }) : null;\n        var isVisible = this.model.isItemVisible(this.item);\n        var style = {\n            display: isVisible ? null : \"none\"\n        };\n        return attachKey2click(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"li\", { className: className, role: \"option\", style: style, id: this.item.elementId, \"aria-selected\": this.model.isItemSelected(this.item), onClick: function (event) {\n                _this.model.onItemClick(_this.item);\n                event.stopPropagation();\n            }, onPointerDown: function (event) { return _this.model.onPointerDown(event, _this.item); } },\n            separator,\n            contentWrap), this.item);\n    };\n    ListItem.prototype.componentDidMount = function () {\n        _super.prototype.componentDidMount.call(this);\n        this.model.onLastItemRended(this.item);\n    };\n    return ListItem;\n}(reactquestion_element_SurveyElementBase));\n\nReactElementFactory.Instance.registerElement(\"sv-list-item\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(list_item_ListItem, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/list/list.tsx\nvar list_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\n\nvar list_List = /** @class */ (function (_super) {\n    list_extends(List, _super);\n    function List(props) {\n        var _this = _super.call(this, props) || this;\n        _this.handleKeydown = function (event) {\n            _this.model.onKeyDown(event);\n        };\n        _this.handleMouseMove = function (event) {\n            _this.model.onMouseMove(event);\n        };\n        _this.state = {\n            filterString: _this.model.filterString || \"\"\n        };\n        _this.listContainerRef = external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createRef();\n        return _this;\n    }\n    Object.defineProperty(List.prototype, \"model\", {\n        get: function () {\n            return this.props.model;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    List.prototype.getStateElement = function () {\n        return this.model;\n    };\n    List.prototype.componentDidMount = function () {\n        _super.prototype.componentDidMount.call(this);\n        if (!!this.listContainerRef && !!this.listContainerRef.current) {\n            this.model.initListContainerHtmlElement(this.listContainerRef.current);\n        }\n    };\n    List.prototype.componentDidUpdate = function (prevProps, prevState) {\n        var _a;\n        _super.prototype.componentDidUpdate.call(this, prevProps, prevState);\n        if (this.model !== prevProps.model) {\n            if (this.model && !!((_a = this.listContainerRef) === null || _a === void 0 ? void 0 : _a.current)) {\n                this.model.initListContainerHtmlElement(this.listContainerRef.current);\n            }\n            if (prevProps.model) {\n                prevProps.model.initListContainerHtmlElement(undefined);\n            }\n        }\n    };\n    List.prototype.componentWillUnmount = function () {\n        _super.prototype.componentWillUnmount.call(this);\n        if (!!this.model) {\n            this.model.initListContainerHtmlElement(undefined);\n        }\n    };\n    List.prototype.renderElement = function () {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: this.model.cssClasses.root, ref: this.listContainerRef },\n            this.searchElementContent(),\n            this.emptyContent(),\n            this.renderList()));\n    };\n    List.prototype.renderList = function () {\n        if (!this.model.renderElements)\n            return null;\n        var items = this.renderItems();\n        var ulStyle = { display: this.model.isEmpty ? \"none\" : null };\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"ul\", { className: this.model.getListClass(), style: ulStyle, role: \"listbox\", id: this.model.elementId, onMouseDown: function (e) {\n                e.preventDefault();\n            }, onKeyDown: this.handleKeydown, onMouseMove: this.handleMouseMove }, items));\n    };\n    List.prototype.renderItems = function () {\n        var _this = this;\n        if (!this.model) {\n            return null;\n        }\n        var items = this.model.renderedActions;\n        if (!items) {\n            return null;\n        }\n        return items.map(function (item, itemIndex) {\n            return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(list_item_ListItem, { model: _this.model, item: item, key: \"item\" + itemIndex }));\n        });\n    };\n    List.prototype.searchElementContent = function () {\n        var _this = this;\n        if (!this.model.showFilter)\n            return null;\n        else {\n            var onChange = function (e) {\n                var root = external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"settings\"].environment.root;\n                if (e.target === root.activeElement) {\n                    _this.model.filterString = e.target.value;\n                }\n            };\n            var onKeyUp = function (e) {\n                _this.model.goToItems(e);\n            };\n            var clearButton = this.model.showSearchClearButton && !!this.model.filterString ?\n                external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"button\", { className: this.model.cssClasses.searchClearButtonIcon, onClick: function (event) { _this.model.onClickSearchClearButton(event); } },\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(svg_icon_SvgIcon, { iconName: \"icon-searchclear\", size: \"auto\" })) : null;\n            return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: this.model.cssClasses.filter },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: this.model.cssClasses.filterIcon },\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(svg_icon_SvgIcon, { iconName: \"icon-search\", size: \"auto\" })),\n                external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"input\", { type: \"text\", className: this.model.cssClasses.filterInput, \"aria-label\": this.model.filterStringPlaceholder, placeholder: this.model.filterStringPlaceholder, value: this.state.filterString, onKeyUp: onKeyUp, onChange: onChange }),\n                clearButton));\n        }\n    };\n    List.prototype.emptyContent = function () {\n        var style = { display: this.model.isEmpty ? null : \"none\" };\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: this.model.cssClasses.emptyContainer, style: style },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: this.model.cssClasses.emptyText, \"aria-label\": this.model.emptyMessage }, this.model.emptyMessage)));\n    };\n    return List;\n}(reactquestion_element_SurveyElementBase));\n\nReactElementFactory.Instance.registerElement(\"sv-list\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(list_List, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/progressToc.tsx\nvar progressToc_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\n\nvar progressToc_SurveyProgressToc = /** @class */ (function (_super) {\n    progressToc_extends(SurveyProgressToc, _super);\n    function SurveyProgressToc() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    SurveyProgressToc.prototype.render = function () {\n        var tocModel = this.props.model;\n        var content;\n        if (tocModel.isMobile) {\n            content = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { onClick: tocModel.togglePopup },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](svg_icon_SvgIcon, { iconName: tocModel.icon, size: 24 }),\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](popup_Popup, { model: tocModel.popupModel }));\n        }\n        else {\n            content = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](list_List, { model: tocModel.listModel });\n        }\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: tocModel.containerCss }, content));\n    };\n    return SurveyProgressToc;\n}(SurveyNavigationBase));\n\nReactElementFactory.Instance.registerElement(\"sv-navigation-toc\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](progressToc_SurveyProgressToc, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion_rating.tsx\nvar reactquestion_rating_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\nvar reactquestion_rating_SurveyQuestionRating = /** @class */ (function (_super) {\n    reactquestion_rating_extends(SurveyQuestionRating, _super);\n    function SurveyQuestionRating(props) {\n        var _this = _super.call(this, props) || this;\n        _this.handleOnClick = _this.handleOnClick.bind(_this);\n        return _this;\n    }\n    Object.defineProperty(SurveyQuestionRating.prototype, \"question\", {\n        get: function () {\n            return this.questionBase;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionRating.prototype.handleOnClick = function (event) {\n        this.question.setValueFromClick(event.target.value);\n        this.setState({ value: this.question.value });\n    };\n    SurveyQuestionRating.prototype.renderItem = function (item, index) {\n        var renderedItem = ReactElementFactory.Instance.createElement(this.question.itemComponent, {\n            question: this.question,\n            item: item,\n            index: index,\n            key: \"value\" + index,\n            handleOnClick: this.handleOnClick,\n            isDisplayMode: this.isDisplayMode\n        });\n        return renderedItem;\n    };\n    SurveyQuestionRating.prototype.renderElement = function () {\n        var _this = this;\n        var cssClasses = this.question.cssClasses;\n        var minText = this.question.minRateDescription\n            ? this.renderLocString(this.question.locMinRateDescription)\n            : null;\n        var maxText = this.question.maxRateDescription\n            ? this.renderLocString(this.question.locMaxRateDescription)\n            : null;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.ratingRootCss, ref: function (div) { return (_this.setControl(div)); } },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"fieldset\", { role: \"radiogroup\" },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"legend\", { role: \"presentation\", className: \"sv-hidden\" }),\n                !!this.question.hasMinLabel ? external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: cssClasses.minText }, minText) : null,\n                this.question.renderedRateItems.map(function (item, index) { return _this.renderItem(item, index); }),\n                !!this.question.hasMaxLabel ? external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: cssClasses.maxText }, maxText) : null)));\n    };\n    return SurveyQuestionRating;\n}(reactquestion_element_SurveyQuestionElementBase));\n\nReactQuestionFactory.Instance.registerQuestion(\"rating\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_rating_SurveyQuestionRating, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/rating-dropdown.tsx\nvar rating_dropdown_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\nvar rating_dropdown_SurveyQuestionRatingDropdown = /** @class */ (function (_super) {\n    rating_dropdown_extends(SurveyQuestionRatingDropdown, _super);\n    function SurveyQuestionRatingDropdown(props) {\n        return _super.call(this, props) || this;\n    }\n    SurveyQuestionRatingDropdown.prototype.renderElement = function () {\n        var cssClasses = this.question.cssClasses;\n        var select = this.renderSelect(cssClasses);\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.rootDropdown }, select));\n    };\n    return SurveyQuestionRatingDropdown;\n}(dropdown_base_SurveyQuestionDropdownBase));\n\nReactQuestionFactory.Instance.registerQuestion(\"sv-rating-dropdown\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](rating_dropdown_SurveyQuestionRatingDropdown, props);\n});\nexternal_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"RendererFactory\"].Instance.registerRenderer(\"rating\", \"dropdown\", \"sv-rating-dropdown\");\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion_expression.tsx\nvar reactquestion_expression_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar reactquestion_expression_SurveyQuestionExpression = /** @class */ (function (_super) {\n    reactquestion_expression_extends(SurveyQuestionExpression, _super);\n    function SurveyQuestionExpression(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(SurveyQuestionExpression.prototype, \"question\", {\n        get: function () {\n            return this.questionBase;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionExpression.prototype.renderElement = function () {\n        var _this = this;\n        var cssClasses = this.question.cssClasses;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { id: this.question.inputId, className: cssClasses.root, ref: function (div) { return (_this.setControl(div)); } }, this.question.formatedValue));\n    };\n    return SurveyQuestionExpression;\n}(reactquestion_element_SurveyQuestionElementBase));\n\nReactQuestionFactory.Instance.registerQuestion(\"expression\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_expression_SurveyQuestionExpression, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/react-popup-survey.tsx\nvar react_popup_survey_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\nvar react_popup_survey_PopupSurvey = /** @class */ (function (_super) {\n    react_popup_survey_extends(PopupSurvey, _super);\n    function PopupSurvey(props) {\n        var _this = _super.call(this, props) || this;\n        _this.handleOnExpanded = _this.handleOnExpanded.bind(_this);\n        return _this;\n    }\n    PopupSurvey.prototype.getStateElements = function () {\n        return [this.popup, this.popup.survey];\n    };\n    PopupSurvey.prototype.handleOnExpanded = function (event) {\n        this.popup.changeExpandCollapse();\n    };\n    PopupSurvey.prototype.canRender = function () {\n        return _super.prototype.canRender.call(this) && this.popup.isShowing;\n    };\n    PopupSurvey.prototype.renderElement = function () {\n        var _this = this;\n        var header = this.renderWindowHeader();\n        var body = this.renderBody();\n        var style = {};\n        if (!!this.popup.renderedWidth) {\n            style.width = this.popup.renderedWidth;\n            style.maxWidth = this.popup.renderedWidth;\n        }\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.popup.cssRoot, style: style, onScroll: function () { return _this.popup.onScroll(); } },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.popup.cssRootContent },\n                header,\n                body)));\n    };\n    PopupSurvey.prototype.renderWindowHeader = function () {\n        var popup = this.popup;\n        var headerCss = popup.cssHeaderRoot;\n        var titleCollapsed = null;\n        var expandCollapseIcon;\n        var closeButton = null;\n        var allowFullScreenButon = null;\n        if (popup.isCollapsed) {\n            headerCss += \" \" + popup.cssRootCollapsedMod;\n            titleCollapsed = this.renderTitleCollapsed(popup);\n            expandCollapseIcon = this.renderExpandIcon();\n        }\n        else {\n            expandCollapseIcon = this.renderCollapseIcon();\n        }\n        if (popup.allowClose) {\n            closeButton = this.renderCloseButton(this.popup);\n        }\n        if (popup.allowFullScreen) {\n            allowFullScreenButon = this.renderAllowFullScreenButon(this.popup);\n        }\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: popup.cssHeaderRoot },\n            titleCollapsed,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: popup.cssHeaderButtonsContainer },\n                allowFullScreenButon,\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: popup.cssHeaderCollapseButton, onClick: this.handleOnExpanded }, expandCollapseIcon),\n                closeButton)));\n    };\n    PopupSurvey.prototype.renderTitleCollapsed = function (popup) {\n        if (!popup.locTitle)\n            return null;\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: popup.cssHeaderTitleCollapsed }, popup.locTitle.renderedHtml);\n    };\n    PopupSurvey.prototype.renderExpandIcon = function () {\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](svg_icon_SvgIcon, { iconName: \"icon-restore_16x16\", size: 16 });\n    };\n    PopupSurvey.prototype.renderCollapseIcon = function () {\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](svg_icon_SvgIcon, { iconName: \"icon-minimize_16x16\", size: 16 });\n    };\n    PopupSurvey.prototype.renderCloseButton = function (popup) {\n        var _this = this;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: popup.cssHeaderCloseButton, onClick: function () {\n                popup.hide();\n                if (typeof _this.props.onClose == \"function\") {\n                    _this.props.onClose();\n                }\n            } },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](svg_icon_SvgIcon, { iconName: \"icon-close_16x16\", size: 16 })));\n    };\n    PopupSurvey.prototype.renderAllowFullScreenButon = function (popup) {\n        var Icon;\n        if (popup.isFullScreen) {\n            Icon = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](svg_icon_SvgIcon, { iconName: \"icon-back-to-panel_16x16\", size: 16 });\n        }\n        else {\n            Icon = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](svg_icon_SvgIcon, { iconName: \"icon-full-screen_16x16\", size: 16 });\n        }\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: popup.cssHeaderFullScreenButton, onClick: function () { popup.toggleFullScreen(); } }, Icon));\n    };\n    PopupSurvey.prototype.renderBody = function () {\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.popup.cssBody }, this.doRender());\n    };\n    PopupSurvey.prototype.createSurvey = function (newProps) {\n        if (!newProps)\n            newProps = {};\n        _super.prototype.createSurvey.call(this, newProps);\n        this.popup = new external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"PopupSurveyModel\"](null, this.survey);\n        if (newProps.closeOnCompleteTimeout) {\n            this.popup.closeOnCompleteTimeout = newProps.closeOnCompleteTimeout;\n        }\n        this.popup.allowClose = newProps.allowClose;\n        this.popup.allowFullScreen = newProps.allowFullScreen;\n        this.popup.isShowing = true;\n        if (!this.popup.isExpanded && (newProps.expanded || newProps.isExpanded))\n            this.popup.expand();\n    };\n    return PopupSurvey;\n}(reactSurvey_Survey));\n\n/**\n * Obsolete. Please use PopupSurvey\n */\nvar SurveyWindow = /** @class */ (function (_super) {\n    react_popup_survey_extends(SurveyWindow, _super);\n    function SurveyWindow() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return SurveyWindow;\n}(react_popup_survey_PopupSurvey));\n\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/imagepicker.tsx\nvar imagepicker_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\nvar imagepicker_SurveyQuestionImagePicker = /** @class */ (function (_super) {\n    imagepicker_extends(SurveyQuestionImagePicker, _super);\n    function SurveyQuestionImagePicker(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(SurveyQuestionImagePicker.prototype, \"question\", {\n        get: function () {\n            return this.questionBase;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionImagePicker.prototype.renderElement = function () {\n        var cssClasses = this.question.cssClasses;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"fieldset\", { className: this.question.getSelectBaseRootCss() },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"legend\", { className: \"sv-hidden\" }, this.question.locTitle.renderedHtml),\n            this.question.hasColumns ? this.getColumns(cssClasses) : this.getItems(cssClasses)));\n    };\n    SurveyQuestionImagePicker.prototype.getColumns = function (cssClasses) {\n        var _this = this;\n        return this.question.columns.map(function (column, ci) {\n            var items = column.map(function (item, ii) {\n                return _this.renderItem(\"item\" + ii, item, cssClasses);\n            });\n            return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { key: \"column\" + ci + _this.question.getItemsColumnKey(column), className: _this.question.getColumnClass(), role: \"presentation\" }, items));\n        });\n    };\n    SurveyQuestionImagePicker.prototype.getItems = function (cssClasses) {\n        var items = [];\n        for (var i = 0; i < this.question.visibleChoices.length; i++) {\n            var item = this.question.visibleChoices[i];\n            var key = \"item\" + i;\n            items.push(this.renderItem(key, item, cssClasses));\n        }\n        return items;\n    };\n    Object.defineProperty(SurveyQuestionImagePicker.prototype, \"textStyle\", {\n        get: function () {\n            return { marginLeft: \"3px\", display: \"inline\", position: \"static\" };\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionImagePicker.prototype.renderItem = function (key, item, cssClasses) {\n        var renderedItem = external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](imagepicker_SurveyQuestionImagePickerItem, { key: key, question: this.question, item: item, cssClasses: cssClasses });\n        var survey = this.question.survey;\n        var wrappedItem = null;\n        if (!!survey) {\n            wrappedItem = reactsurveymodel_ReactSurveyElementsWrapper.wrapItemValue(survey, renderedItem, this.question, item);\n        }\n        return wrappedItem !== null && wrappedItem !== void 0 ? wrappedItem : renderedItem;\n    };\n    return SurveyQuestionImagePicker;\n}(reactquestion_element_SurveyQuestionElementBase));\n\nvar imagepicker_SurveyQuestionImagePickerItem = /** @class */ (function (_super) {\n    imagepicker_extends(SurveyQuestionImagePickerItem, _super);\n    function SurveyQuestionImagePickerItem(props) {\n        var _this = _super.call(this, props) || this;\n        _this.handleOnChange = _this.handleOnChange.bind(_this);\n        return _this;\n    }\n    SurveyQuestionImagePickerItem.prototype.getStateElement = function () {\n        return this.item;\n    };\n    SurveyQuestionImagePickerItem.prototype.componentDidMount = function () {\n        _super.prototype.componentDidMount.call(this);\n        this.reactOnStrChanged();\n    };\n    SurveyQuestionImagePickerItem.prototype.componentWillUnmount = function () {\n        _super.prototype.componentWillUnmount.call(this);\n        this.item.locImageLink.onChanged = function () { };\n    };\n    SurveyQuestionImagePickerItem.prototype.componentDidUpdate = function (prevProps, prevState) {\n        _super.prototype.componentDidUpdate.call(this, prevProps, prevState);\n        this.reactOnStrChanged();\n    };\n    SurveyQuestionImagePickerItem.prototype.reactOnStrChanged = function () {\n        var _this = this;\n        this.item.locImageLink.onChanged = function () {\n            _this.setState({ locImageLinkchanged: !!_this.state && _this.state.locImageLink ? _this.state.locImageLink + 1 : 1 });\n        };\n    };\n    Object.defineProperty(SurveyQuestionImagePickerItem.prototype, \"cssClasses\", {\n        get: function () {\n            return this.props.cssClasses;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionImagePickerItem.prototype, \"item\", {\n        get: function () {\n            return this.props.item;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionImagePickerItem.prototype, \"question\", {\n        get: function () {\n            return this.props.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionImagePickerItem.prototype.handleOnChange = function (event) {\n        if (this.question.isReadOnlyAttr)\n            return;\n        if (this.question.multiSelect) {\n            if (event.target.checked) {\n                this.question.value = this.question.value.concat(event.target.value);\n            }\n            else {\n                var currValue = this.question.value;\n                currValue.splice(this.question.value.indexOf(event.target.value), 1);\n                this.question.value = currValue;\n            }\n        }\n        else {\n            this.question.value = event.target.value;\n        }\n        this.setState({ value: this.question.value });\n    };\n    SurveyQuestionImagePickerItem.prototype.renderElement = function () {\n        var _this = this;\n        var item = this.item;\n        var question = this.question;\n        var cssClasses = this.cssClasses;\n        var isChecked = question.isItemSelected(item);\n        var itemClass = question.getItemClass(item);\n        var text = null;\n        if (question.showLabel) {\n            text = (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: question.cssClasses.itemText }, item.text ? reactquestion_element_SurveyElementBase.renderLocString(item.locText) : item.value));\n        }\n        var style = { objectFit: this.question.imageFit };\n        var control = null;\n        if (item.locImageLink.renderedHtml && this.question.contentMode === \"image\") {\n            control = (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"img\", { className: cssClasses.image, src: item.locImageLink.renderedHtml, width: this.question.renderedImageWidth, height: this.question.renderedImageHeight, alt: item.locText.renderedHtml, style: style, onLoad: function (event) { _this.question[\"onContentLoaded\"](item, event.nativeEvent); }, onError: function (event) { item.onErrorHandler(item, event.nativeEvent); } }));\n        }\n        if (item.locImageLink.renderedHtml && this.question.contentMode === \"video\") {\n            control = (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"video\", { controls: true, className: cssClasses.image, src: item.locImageLink.renderedHtml, width: this.question.renderedImageWidth, height: this.question.renderedImageHeight, style: style, onLoadedMetadata: function (event) { _this.question[\"onContentLoaded\"](item, event.nativeEvent); }, onError: function (event) { item.onErrorHandler(item, event.nativeEvent); } }));\n        }\n        if (!item.locImageLink.renderedHtml || item.contentNotLoaded) {\n            var style_1 = {\n                width: this.question.renderedImageWidth,\n                height: this.question.renderedImageHeight,\n                objectFit: this.question.imageFit\n            };\n            control = (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: cssClasses.itemNoImage, style: style_1 }, cssClasses.itemNoImageSvgIcon ?\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](svg_icon_SvgIcon, { className: cssClasses.itemNoImageSvgIcon, iconName: this.question.cssClasses.itemNoImageSvgIconId, size: 48 }) :\n                null));\n        }\n        var renderedItem = (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: itemClass },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"label\", { className: cssClasses.label },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"input\", { className: cssClasses.itemControl, id: this.question.getItemId(item), type: this.question.inputType, name: this.question.questionName, checked: isChecked, value: item.value, disabled: !this.question.getItemEnabled(item), readOnly: this.question.isReadOnlyAttr, onChange: this.handleOnChange, \"aria-required\": this.question.ariaRequired, \"aria-label\": this.question.ariaLabel, \"aria-invalid\": this.question.ariaInvalid, \"aria-errormessage\": this.question.ariaErrormessage }),\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.itemDecorator },\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.imageContainer },\n                        !!this.question.cssClasses.checkedItemDecorator ?\n                            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", { className: this.question.cssClasses.checkedItemDecorator }, !!this.question.cssClasses.checkedItemSvgIconId ? external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](svg_icon_SvgIcon, { size: \"auto\", className: this.question.cssClasses.checkedItemSvgIcon, iconName: this.question.cssClasses.checkedItemSvgIconId }) : null) : null,\n                        control),\n                    text))));\n        return renderedItem;\n    };\n    return SurveyQuestionImagePickerItem;\n}(ReactSurveyElement));\n\nReactQuestionFactory.Instance.registerQuestion(\"imagepicker\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](imagepicker_SurveyQuestionImagePicker, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/image.tsx\nvar image_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\nvar image_SurveyQuestionImage = /** @class */ (function (_super) {\n    image_extends(SurveyQuestionImage, _super);\n    function SurveyQuestionImage(props) {\n        return _super.call(this, props) || this;\n    }\n    SurveyQuestionImage.prototype.componentDidMount = function () {\n        var _this = this;\n        _super.prototype.componentDidMount.call(this);\n        this.question.locImageLink.onChanged = function () {\n            _this.forceUpdate();\n        };\n    };\n    SurveyQuestionImage.prototype.componentWillUnmount = function () {\n        _super.prototype.componentWillUnmount.call(this);\n        this.question.locImageLink.onChanged = function () { };\n    };\n    Object.defineProperty(SurveyQuestionImage.prototype, \"question\", {\n        get: function () {\n            return this.questionBase;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionImage.prototype.renderElement = function () {\n        var _this = this;\n        var cssClasses = this.question.getImageCss();\n        var style = { objectFit: this.question.imageFit, width: this.question.renderedStyleWidth, height: this.question.renderedStyleHeight };\n        if (!this.question.imageLink || this.question.contentNotLoaded) {\n            style[\"display\"] = \"none\";\n        }\n        var control = null;\n        if (this.question.renderedMode === \"image\") {\n            control = (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"img\", { className: cssClasses, src: this.question.locImageLink.renderedHtml, alt: this.question.altText || this.question.title, width: this.question.renderedWidth, height: this.question.renderedHeight, \n                //alt={item.text || item.value}\n                style: style, onLoad: function (event) { _this.question.onLoadHandler(); }, onError: function (event) { _this.question.onErrorHandler(); } }));\n        }\n        if (this.question.renderedMode === \"video\") {\n            control = (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"video\", { controls: true, className: cssClasses, src: this.question.locImageLink.renderedHtml, width: this.question.renderedWidth, height: this.question.renderedHeight, style: style, onLoadedMetadata: function (event) { _this.question.onLoadHandler(); }, onError: function (event) { _this.question.onErrorHandler(); } }));\n        }\n        if (this.question.renderedMode === \"youtube\") {\n            control = (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"iframe\", { className: cssClasses, src: this.question.locImageLink.renderedHtml, width: this.question.renderedWidth, height: this.question.renderedHeight, style: style }));\n        }\n        var noImage = null;\n        if (!this.question.imageLink || this.question.contentNotLoaded) {\n            noImage = (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.noImage },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](svg_icon_SvgIcon, { iconName: this.question.cssClasses.noImageSvgIconId, size: 48 })));\n        }\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.root },\n            control,\n            noImage);\n    };\n    return SurveyQuestionImage;\n}(reactquestion_element_SurveyQuestionElementBase));\n\nReactQuestionFactory.Instance.registerQuestion(\"image\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](image_SurveyQuestionImage, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/signaturepad.tsx\nvar signaturepad_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\nvar signaturepad_SurveyQuestionSignaturePad = /** @class */ (function (_super) {\n    signaturepad_extends(SurveyQuestionSignaturePad, _super);\n    function SurveyQuestionSignaturePad(props) {\n        var _this = _super.call(this, props) || this;\n        _this.state = { value: _this.question.value };\n        return _this;\n    }\n    Object.defineProperty(SurveyQuestionSignaturePad.prototype, \"question\", {\n        get: function () {\n            return this.questionBase;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionSignaturePad.prototype.renderElement = function () {\n        var _this = this;\n        var cssClasses = this.question.cssClasses;\n        var loadingIndicator = this.question.showLoadingIndicator ? this.renderLoadingIndicator() : null;\n        var clearButton = this.renderCleanButton();\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: cssClasses.root, ref: function (root) { return (_this.setControl(root)); }, style: { width: this.question.renderedCanvasWidth } },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: cssClasses.placeholder, style: { display: this.question.needShowPlaceholder() ? \"\" : \"none\" } }, this.renderLocString(this.question.locRenderedPlaceholder)),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", null,\n                this.renderBackgroundImage(),\n                external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"canvas\", { tabIndex: -1, className: this.question.cssClasses.canvas, onBlur: function (event) { _this.question.onBlur(event); } })),\n            clearButton,\n            loadingIndicator));\n    };\n    SurveyQuestionSignaturePad.prototype.renderBackgroundImage = function () {\n        if (!this.question.backgroundImage)\n            return null;\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"img\", { className: this.question.cssClasses.backgroundImage, src: this.question.backgroundImage, style: { width: this.question.renderedCanvasWidth } });\n    };\n    SurveyQuestionSignaturePad.prototype.renderLoadingIndicator = function () {\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: this.question.cssClasses.loadingIndicator },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](loading_indicator_LoadingIndicatorComponent, null));\n    };\n    SurveyQuestionSignaturePad.prototype.renderCleanButton = function () {\n        var _this = this;\n        if (!this.question.canShowClearButton)\n            return null;\n        var cssClasses = this.question.cssClasses;\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"div\", { className: cssClasses.controls },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"button\", { type: \"button\", className: cssClasses.clearButton, title: this.question.clearButtonCaption, onClick: function () { return _this.question.clearValue(true); } }, this.question.cssClasses.clearButtonIconId ? external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](svg_icon_SvgIcon, { iconName: this.question.cssClasses.clearButtonIconId, size: \"auto\" }) : external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](\"span\", null, \"\\u2716\")));\n    };\n    return SurveyQuestionSignaturePad;\n}(reactquestion_element_SurveyQuestionElementBase));\n\nReactQuestionFactory.Instance.registerQuestion(\"signaturepad\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](signaturepad_SurveyQuestionSignaturePad, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion_buttongroup.tsx\nvar reactquestion_buttongroup_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\nvar reactquestion_buttongroup_SurveyQuestionButtonGroup = /** @class */ (function (_super) {\n    reactquestion_buttongroup_extends(SurveyQuestionButtonGroup, _super);\n    function SurveyQuestionButtonGroup(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(SurveyQuestionButtonGroup.prototype, \"question\", {\n        get: function () {\n            return this.questionBase;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionButtonGroup.prototype.getStateElement = function () {\n        return this.question;\n    };\n    SurveyQuestionButtonGroup.prototype.renderElement = function () {\n        var items = this.renderItems();\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: this.question.cssClasses.root }, items);\n    };\n    SurveyQuestionButtonGroup.prototype.renderItems = function () {\n        var _this = this;\n        return this.question.visibleChoices.map(function (item, index) {\n            return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(reactquestion_buttongroup_SurveyButtonGroupItem, { key: _this.question.inputId + \"_\" + index, item: item, question: _this.question, index: index }));\n        });\n    };\n    return SurveyQuestionButtonGroup;\n}(reactquestion_element_SurveyQuestionElementBase));\n\nvar reactquestion_buttongroup_SurveyButtonGroupItem = /** @class */ (function (_super) {\n    reactquestion_buttongroup_extends(SurveyButtonGroupItem, _super);\n    function SurveyButtonGroupItem(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(SurveyButtonGroupItem.prototype, \"index\", {\n        get: function () {\n            return this.props.index;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyButtonGroupItem.prototype, \"question\", {\n        get: function () {\n            return this.props.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyButtonGroupItem.prototype, \"item\", {\n        get: function () {\n            return this.props.item;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyButtonGroupItem.prototype.getStateElement = function () {\n        return this.item;\n    };\n    SurveyButtonGroupItem.prototype.renderElement = function () {\n        this.model = new external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"ButtonGroupItemModel\"](this.question, this.item, this.index);\n        var icon = this.renderIcon();\n        var input = this.renderInput();\n        var caption = this.renderCaption();\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"label\", { role: \"radio\", className: this.model.css.label, title: this.model.caption.renderedHtml },\n            input,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: this.model.css.decorator },\n                icon,\n                caption)));\n    };\n    SurveyButtonGroupItem.prototype.renderIcon = function () {\n        if (!!this.model.iconName) {\n            return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(svg_icon_SvgIcon, { className: this.model.css.icon, iconName: this.model.iconName, size: this.model.iconSize || 24 }));\n        }\n        return null;\n    };\n    SurveyButtonGroupItem.prototype.renderInput = function () {\n        var _this = this;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"input\", { className: this.model.css.control, id: this.model.id, type: \"radio\", name: this.model.name, checked: this.model.selected, value: this.model.value, disabled: this.model.readOnly, onChange: function () {\n                _this.model.onChange();\n            }, \"aria-required\": this.model.isRequired, \"aria-label\": this.model.caption.renderedHtml, \"aria-invalid\": this.model.hasErrors, \"aria-errormessage\": this.model.describedBy, role: \"radio\" }));\n    };\n    SurveyButtonGroupItem.prototype.renderCaption = function () {\n        if (!this.model.showCaption)\n            return null;\n        var caption = this.renderLocString(this.model.caption);\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { className: this.model.css.caption, title: this.model.caption.renderedHtml }, caption));\n    };\n    return SurveyButtonGroupItem;\n}(reactquestion_element_SurveyElementBase));\n\n// ReactQuestionFactory.Instance.registerQuestion(\"buttongroup\", props => {\n//   return React.createElement(SurveyQuestionButtonGroup, props);\n// });\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/reactquestion_custom.tsx\nvar reactquestion_custom_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\n\nvar reactquestion_custom_SurveyQuestionCustom = /** @class */ (function (_super) {\n    reactquestion_custom_extends(SurveyQuestionCustom, _super);\n    function SurveyQuestionCustom(props) {\n        return _super.call(this, props) || this;\n    }\n    SurveyQuestionCustom.prototype.getStateElements = function () {\n        var res = _super.prototype.getStateElements.call(this);\n        if (!!this.question.contentQuestion) {\n            res.push(this.question.contentQuestion);\n        }\n        return res;\n    };\n    SurveyQuestionCustom.prototype.renderElement = function () {\n        return reactquestion_SurveyQuestion.renderQuestionBody(this.creator, this.question.contentQuestion);\n    };\n    return SurveyQuestionCustom;\n}(reactquestion_element_SurveyQuestionUncontrolledElement));\n\nvar reactquestion_custom_SurveyQuestionComposite = /** @class */ (function (_super) {\n    reactquestion_custom_extends(SurveyQuestionComposite, _super);\n    function SurveyQuestionComposite(props) {\n        return _super.call(this, props) || this;\n    }\n    SurveyQuestionComposite.prototype.canRender = function () {\n        return !!this.question.contentPanel;\n    };\n    SurveyQuestionComposite.prototype.renderElement = function () {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](panel_SurveyPanel, { element: this.question.contentPanel, creator: this.creator, survey: this.question.survey }));\n    };\n    return SurveyQuestionComposite;\n}(reactquestion_element_SurveyQuestionUncontrolledElement));\n\nReactQuestionFactory.Instance.registerQuestion(\"custom\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_custom_SurveyQuestionCustom, props);\n});\nReactQuestionFactory.Instance.registerQuestion(\"composite\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_[\"createElement\"](reactquestion_custom_SurveyQuestionComposite, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/list/list-item-content.tsx\nvar list_item_content_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\nvar list_item_content_ListItemContent = /** @class */ (function (_super) {\n    list_item_content_extends(ListItemContent, _super);\n    function ListItemContent() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(ListItemContent.prototype, \"model\", {\n        get: function () {\n            return this.props.model;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ListItemContent.prototype, \"item\", {\n        get: function () {\n            return this.props.item;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    ListItemContent.prototype.getStateElement = function () {\n        return this.item;\n    };\n    ListItemContent.prototype.render = function () {\n        if (!this.item)\n            return null;\n        var content = [];\n        var text = this.renderLocString(this.item.locTitle, undefined, \"locString\");\n        if (this.item.iconName) {\n            var icon = external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(svg_icon_SvgIcon, { key: \"icon\", className: this.model.cssClasses.itemIcon, iconName: this.item.iconName, size: this.item.iconSize, \"aria-label\": this.item.title });\n            content.push(icon);\n            content.push(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { key: \"text\" }, text));\n        }\n        else {\n            content.push(text);\n        }\n        if (this.item.markerIconName) {\n            var icon = external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(svg_icon_SvgIcon, { key: \"marker\", className: this.item.cssClasses.itemMarkerIcon, iconName: this.item.markerIconName, size: this.item.markerIconSize });\n            content.push(icon);\n        }\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Fragment, null, content);\n    };\n    return ListItemContent;\n}(reactquestion_element_SurveyElementBase));\n\nReactElementFactory.Instance.registerElement(\"sv-list-item-content\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(list_item_content_ListItemContent, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/list/list-item-group.tsx\nvar list_item_group_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\nvar list_item_group_ListItemGroup = /** @class */ (function (_super) {\n    list_item_group_extends(ListItemGroup, _super);\n    function ListItemGroup() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(ListItemGroup.prototype, \"model\", {\n        get: function () {\n            return this.props.model;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ListItemGroup.prototype, \"item\", {\n        get: function () {\n            return this.props.item;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    ListItemGroup.prototype.getStateElement = function () {\n        return this.item;\n    };\n    ListItemGroup.prototype.render = function () {\n        var _a;\n        if (!this.item)\n            return null;\n        var newElement = ReactElementFactory.Instance.createElement(\"sv-list-item-content\", { item: this.item, key: \"content\" + this.item.id, model: this.model });\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Fragment, null,\n            newElement,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(popup_Popup, { model: (_a = this.item) === null || _a === void 0 ? void 0 : _a.popupModel }));\n    };\n    return ListItemGroup;\n}(reactquestion_element_SurveyElementBase));\n\nReactElementFactory.Instance.registerElement(\"sv-list-item-group\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(list_item_group_ListItemGroup, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/survey-header/logo-image.tsx\nvar logo_image_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\nvar logo_image_LogoImage = /** @class */ (function (_super) {\n    logo_image_extends(LogoImage, _super);\n    function LogoImage(props) {\n        return _super.call(this, props) || this;\n    }\n    Object.defineProperty(LogoImage.prototype, \"survey\", {\n        get: function () {\n            return this.props.data;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    LogoImage.prototype.render = function () {\n        var content = [];\n        content.push(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { key: \"logo-image\", className: this.survey.logoClassNames },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"img\", { className: this.survey.css.logoImage, src: this.survey.locLogo.renderedHtml, alt: this.survey.locTitle.renderedHtml, width: this.survey.renderedLogoWidth, height: this.survey.renderedLogoHeight, style: { objectFit: this.survey.logoFit, width: this.survey.renderedStyleLogoWidth, height: this.survey.renderedStyleLogoHeight } })));\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Fragment, null, content);\n    };\n    return LogoImage;\n}(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Component));\n\nReactElementFactory.Instance.registerElement(\"sv-logo-image\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(logo_image_LogoImage, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/matrix-actions/remove-button/remove-button.tsx\nvar remove_button_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar remove_button_SurveyQuestionMatrixDynamicRemoveButton = /** @class */ (function (_super) {\n    remove_button_extends(SurveyQuestionMatrixDynamicRemoveButton, _super);\n    function SurveyQuestionMatrixDynamicRemoveButton(props) {\n        var _this = _super.call(this, props) || this;\n        _this.handleOnRowRemoveClick = _this.handleOnRowRemoveClick.bind(_this);\n        return _this;\n    }\n    Object.defineProperty(SurveyQuestionMatrixDynamicRemoveButton.prototype, \"question\", {\n        get: function () {\n            return this.props.item.data.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionMatrixDynamicRemoveButton.prototype, \"row\", {\n        get: function () {\n            return this.props.item.data.row;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionMatrixDynamicRemoveButton.prototype.handleOnRowRemoveClick = function (event) {\n        this.question.removeRowUI(this.row);\n    };\n    SurveyQuestionMatrixDynamicRemoveButton.prototype.renderElement = function () {\n        var removeRowText = this.renderLocString(this.question.locRemoveRowText);\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"button\", { className: this.question.getRemoveRowButtonCss(), type: \"button\", onClick: this.handleOnRowRemoveClick, disabled: this.question.isInputReadOnly },\n            removeRowText,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { className: this.question.cssClasses.iconRemove })));\n    };\n    return SurveyQuestionMatrixDynamicRemoveButton;\n}(ReactSurveyElement));\n\nReactElementFactory.Instance.registerElement(\"sv-matrix-remove-button\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(remove_button_SurveyQuestionMatrixDynamicRemoveButton, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/matrix-actions/detail-button/detail-button.tsx\nvar detail_button_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\nvar detail_button_SurveyQuestionMatrixDetailButton = /** @class */ (function (_super) {\n    detail_button_extends(SurveyQuestionMatrixDetailButton, _super);\n    function SurveyQuestionMatrixDetailButton(props) {\n        var _this = _super.call(this, props) || this;\n        _this.handleOnShowHideClick = _this.handleOnShowHideClick.bind(_this);\n        return _this;\n    }\n    SurveyQuestionMatrixDetailButton.prototype.getStateElement = function () {\n        return this.props.item;\n    };\n    Object.defineProperty(SurveyQuestionMatrixDetailButton.prototype, \"item\", {\n        get: function () {\n            return this.props.item;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionMatrixDetailButton.prototype, \"question\", {\n        get: function () {\n            return this.props.item.data.question;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyQuestionMatrixDetailButton.prototype, \"row\", {\n        get: function () {\n            return this.props.item.data.row;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyQuestionMatrixDetailButton.prototype.handleOnShowHideClick = function (event) {\n        this.row.showHideDetailPanelClick();\n    };\n    SurveyQuestionMatrixDetailButton.prototype.renderElement = function () {\n        var isExpanded = this.row.isDetailPanelShowing;\n        var ariaExpanded = isExpanded;\n        var ariaControls = isExpanded ? this.row.detailPanelId : undefined;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"button\", { type: \"button\", onClick: this.handleOnShowHideClick, className: this.question.getDetailPanelButtonCss(this.row), \"aria-expanded\": ariaExpanded, \"aria-controls\": ariaControls },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(svg_icon_SvgIcon, { className: this.question.getDetailPanelIconCss(this.row), iconName: this.question.getDetailPanelIconId(this.row), size: \"auto\" })));\n    };\n    return SurveyQuestionMatrixDetailButton;\n}(ReactSurveyElement));\n\nReactElementFactory.Instance.registerElement(\"sv-matrix-detail-button\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(detail_button_SurveyQuestionMatrixDetailButton, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/paneldynamic-actions/paneldynamic-remove-btn.tsx\nvar paneldynamic_remove_btn_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar paneldynamic_remove_btn_SurveyQuestionPanelDynamicRemoveButton = /** @class */ (function (_super) {\n    paneldynamic_remove_btn_extends(SurveyQuestionPanelDynamicRemoveButton, _super);\n    function SurveyQuestionPanelDynamicRemoveButton() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.handleClick = function (event) {\n            _this.question.removePanelUI(_this.data.panel);\n        };\n        return _this;\n    }\n    SurveyQuestionPanelDynamicRemoveButton.prototype.renderElement = function () {\n        var btnText = this.renderLocString(this.question.locPanelRemoveText);\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"button\", { className: this.question.getPanelRemoveButtonCss(), onClick: this.handleClick, type: \"button\" },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { className: this.question.cssClasses.buttonRemoveText }, btnText),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { className: this.question.cssClasses.iconRemove })));\n    };\n    return SurveyQuestionPanelDynamicRemoveButton;\n}(SurveyQuestionPanelDynamicAction));\n\nReactElementFactory.Instance.registerElement(\"sv-paneldynamic-remove-btn\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(paneldynamic_remove_btn_SurveyQuestionPanelDynamicRemoveButton, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/survey-actions/survey-nav-button.tsx\nvar survey_nav_button_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar survey_nav_button_SurveyNavigationButton = /** @class */ (function (_super) {\n    survey_nav_button_extends(SurveyNavigationButton, _super);\n    function SurveyNavigationButton() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(SurveyNavigationButton.prototype, \"item\", {\n        get: function () {\n            return this.props.item;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyNavigationButton.prototype.canRender = function () {\n        return this.item.isVisible;\n    };\n    SurveyNavigationButton.prototype.renderElement = function () {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"input\", { className: this.item.innerCss, type: \"button\", disabled: this.item.disabled, onMouseDown: this.item.data && this.item.data.mouseDown, onClick: this.item.action, title: this.item.getTooltip(), value: this.item.title }));\n    };\n    return SurveyNavigationButton;\n}(ReactSurveyElement));\n\nReactElementFactory.Instance.registerElement(\"sv-nav-btn\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(survey_nav_button_SurveyNavigationButton, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/string-viewer.tsx\nvar string_viewer_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar string_viewer_SurveyLocStringViewer = /** @class */ (function (_super) {\n    string_viewer_extends(SurveyLocStringViewer, _super);\n    function SurveyLocStringViewer(props) {\n        var _this = _super.call(this, props) || this;\n        _this.onChangedHandler = function (sender, options) {\n            if (_this.isRendering)\n                return;\n            _this.setState({ changed: !!_this.state && _this.state.changed ? _this.state.changed + 1 : 1 });\n        };\n        _this.rootRef = external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createRef();\n        return _this;\n    }\n    Object.defineProperty(SurveyLocStringViewer.prototype, \"locStr\", {\n        get: function () {\n            return this.props.locStr;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyLocStringViewer.prototype, \"style\", {\n        get: function () {\n            return this.props.style;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyLocStringViewer.prototype.componentDidMount = function () {\n        this.reactOnStrChanged();\n    };\n    SurveyLocStringViewer.prototype.componentWillUnmount = function () {\n        if (!this.locStr)\n            return;\n        this.locStr.onStringChanged.remove(this.onChangedHandler);\n    };\n    SurveyLocStringViewer.prototype.componentDidUpdate = function (prevProps, prevState) {\n        if (!!prevProps.locStr) {\n            prevProps.locStr.onStringChanged.remove(this.onChangedHandler);\n        }\n        this.reactOnStrChanged();\n    };\n    SurveyLocStringViewer.prototype.reactOnStrChanged = function () {\n        if (!this.locStr)\n            return;\n        this.locStr.onStringChanged.add(this.onChangedHandler);\n    };\n    SurveyLocStringViewer.prototype.render = function () {\n        if (!this.locStr)\n            return null;\n        this.isRendering = true;\n        var strEl = this.renderString();\n        this.isRendering = false;\n        return strEl;\n    };\n    SurveyLocStringViewer.prototype.renderString = function () {\n        var className = this.locStr.allowLineBreaks ? \"sv-string-viewer sv-string-viewer--multiline\" : \"sv-string-viewer\";\n        if (this.locStr.hasHtml) {\n            var htmlValue = { __html: this.locStr.renderedHtml };\n            return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { ref: this.rootRef, className: className, style: this.style, dangerouslySetInnerHTML: htmlValue });\n        }\n        return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { ref: this.rootRef, className: className, style: this.style }, this.locStr.renderedHtml);\n    };\n    return SurveyLocStringViewer;\n}(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Component));\n\nReactElementFactory.Instance.registerElement(external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"LocalizableString\"].defaultRenderer, function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(string_viewer_SurveyLocStringViewer, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/question-error.tsx\nvar question_error_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar question_error_QuestionErrorComponent = /** @class */ (function (_super) {\n    question_error_extends(QuestionErrorComponent, _super);\n    function QuestionErrorComponent() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    QuestionErrorComponent.prototype.render = function () {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", null,\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { className: this.props.cssClasses.error.icon || undefined, \"aria-hidden\": \"true\" }),\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { className: this.props.cssClasses.error.item || undefined },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(string_viewer_SurveyLocStringViewer, { locStr: this.props.error.locText }))));\n    };\n    return QuestionErrorComponent;\n}(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Component));\n\nReactElementFactory.Instance.registerElement(\"sv-question-error\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(question_error_QuestionErrorComponent, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/skeleton.tsx\nvar skeleton_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\nvar skeleton_Skeleton = /** @class */ (function (_super) {\n    skeleton_extends(Skeleton, _super);\n    function Skeleton() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Skeleton.prototype.render = function () {\n        var _a;\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sv-skeleton-element\", id: (_a = this.props.element) === null || _a === void 0 ? void 0 : _a.id }));\n    };\n    return Skeleton;\n}(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Component));\n\nReactElementFactory.Instance.registerElement(\"sv-skeleton\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(skeleton_Skeleton, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/components/header.tsx\nvar header_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\n\nvar header_HeaderMobile = /** @class */ (function (_super) {\n    header_extends(HeaderMobile, _super);\n    function HeaderMobile() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(HeaderMobile.prototype, \"model\", {\n        get: function () {\n            return this.props.model;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    HeaderMobile.prototype.renderLogoImage = function () {\n        var componentName = this.model.survey.getElementWrapperComponentName(this.model.survey, \"logo-image\");\n        var componentData = this.model.survey.getElementWrapperComponentData(this.model.survey, \"logo-image\");\n        return ReactElementFactory.Instance.createElement(componentName, {\n            data: componentData,\n        });\n    };\n    HeaderMobile.prototype.render = function () {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sv-header--mobile\" },\n            this.model.survey.hasLogo ? (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sv-header__logo\" }, this.renderLogoImage())) : null,\n            this.model.survey.hasTitle ? (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sv-header__title\", style: { maxWidth: this.model.textAreaWidth } },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(title_element_TitleElement, { element: this.model.survey }))) : null,\n            this.model.survey.renderedHasDescription ? (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sv-header__description\", style: { maxWidth: this.model.textAreaWidth } },\n                external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: this.model.survey.css.description }, reactquestion_element_SurveyElementBase.renderLocString(this.model.survey.locDescription)))) : null));\n    };\n    return HeaderMobile;\n}(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Component));\n\nvar header_HeaderCell = /** @class */ (function (_super) {\n    header_extends(HeaderCell, _super);\n    function HeaderCell() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(HeaderCell.prototype, \"model\", {\n        get: function () {\n            return this.props.model;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    HeaderCell.prototype.renderLogoImage = function () {\n        var componentName = this.model.survey.getElementWrapperComponentName(this.model.survey, \"logo-image\");\n        var componentData = this.model.survey.getElementWrapperComponentData(this.model.survey, \"logo-image\");\n        return ReactElementFactory.Instance.createElement(componentName, {\n            data: componentData,\n        });\n    };\n    HeaderCell.prototype.render = function () {\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: this.model.css, style: this.model.style },\n            external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sv-header__cell-content\", style: this.model.contentStyle },\n                this.model.showLogo ? (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sv-header__logo\" }, this.renderLogoImage())) : null,\n                this.model.showTitle ? (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sv-header__title\", style: { maxWidth: this.model.textAreaWidth } },\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(title_element_TitleElement, { element: this.model.survey }))) : null,\n                this.model.showDescription ? (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: \"sv-header__description\", style: { maxWidth: this.model.textAreaWidth } },\n                    external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: this.model.survey.css.description }, reactquestion_element_SurveyElementBase.renderLocString(this.model.survey.locDescription)))) : null)));\n    };\n    return HeaderCell;\n}(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Component));\n\nvar header_Header = /** @class */ (function (_super) {\n    header_extends(Header, _super);\n    function Header() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(Header.prototype, \"model\", {\n        get: function () {\n            return this.props.model;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Header.prototype.getStateElement = function () {\n        return this.model;\n    };\n    Header.prototype.renderElement = function () {\n        this.model.survey = this.props.survey;\n        if (!(this.props.survey.headerView === \"advanced\")) {\n            return null;\n        }\n        var headerContent = null;\n        if (this.props.survey.isMobile) {\n            headerContent = external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(header_HeaderMobile, { model: this.model });\n        }\n        else {\n            headerContent = (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: this.model.contentClasses, style: { maxWidth: this.model.maxWidth } }, this.model.cells.map(function (cell, index) { return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(header_HeaderCell, { key: index, model: cell }); })));\n        }\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { className: this.model.headerClasses, style: { height: this.model.renderedHeight } },\n            this.model.backgroundImage ? external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"div\", { style: this.model.backgroundImageStyle, className: this.model.backgroundImageClasses }) : null,\n            headerContent));\n    };\n    return Header;\n}(reactquestion_element_SurveyElementBase));\n\nReactElementFactory.Instance.registerElement(\"sv-header\", function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(header_Header, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/src/string-editor.tsx\nvar string_editor_extends = ( false) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n\n\n\nvar string_editor_SurveyLocStringEditor = /** @class */ (function (_super) {\n    string_editor_extends(SurveyLocStringEditor, _super);\n    function SurveyLocStringEditor(props) {\n        var _this = _super.call(this, props) || this;\n        _this.onInput = function (event) {\n            _this.locStr.text = event.target.innerText;\n        };\n        _this.onClick = function (event) {\n            event.preventDefault();\n            event.stopPropagation();\n        };\n        _this.state = { changed: 0 };\n        return _this;\n    }\n    Object.defineProperty(SurveyLocStringEditor.prototype, \"locStr\", {\n        get: function () {\n            return this.props.locStr;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(SurveyLocStringEditor.prototype, \"style\", {\n        get: function () {\n            return this.props.style;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    SurveyLocStringEditor.prototype.componentDidMount = function () {\n        if (!this.locStr)\n            return;\n        var self = this;\n        this.locStr.onChanged = function () {\n            self.setState({ changed: self.state.changed + 1 });\n        };\n    };\n    SurveyLocStringEditor.prototype.componentWillUnmount = function () {\n        if (!this.locStr)\n            return;\n        this.locStr.onChanged = function () { };\n    };\n    SurveyLocStringEditor.prototype.render = function () {\n        if (!this.locStr) {\n            return null;\n        }\n        if (this.locStr.hasHtml) {\n            var htmlValue = { __html: this.locStr.renderedHtml };\n            return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { className: \"sv-string-editor\", contentEditable: \"true\", suppressContentEditableWarning: true, style: this.style, dangerouslySetInnerHTML: htmlValue, onBlur: this.onInput, onClick: this.onClick }));\n        }\n        return (external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(\"span\", { className: \"sv-string-editor\", contentEditable: \"true\", suppressContentEditableWarning: true, style: this.style, onBlur: this.onInput, onClick: this.onClick }, this.locStr.renderedHtml));\n    };\n    return SurveyLocStringEditor;\n}(external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.Component));\n\nReactElementFactory.Instance.registerElement(external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"LocalizableString\"].editableRenderer, function (props) {\n    return external_root_React_commonjs2_react_commonjs_react_amd_react_default.a.createElement(string_editor_SurveyLocStringEditor, props);\n});\n\n// CONCATENATED MODULE: ./packages/survey-react-ui/entries/react-ui-model.ts\n// react\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n//Uncomment to include the \"date\" question type.\n//export {default as SurveyQuestionDate} from \"../plugins/react/reactquestiondate\";\n\n// CONCATENATED MODULE: ./src/entries/react-ui.ts\n\n\n\nObject(external_root_Survey_commonjs2_survey_core_commonjs_survey_core_amd_survey_core_[\"checkLibraryVersion\"])(\"\" + \"1.11.13\", \"survey-react-ui\");\n\n\n/***/ }),\n\n/***/ \"react\":\n/*!**************************************************************************************!*\\\n  !*** external {\"root\":\"React\",\"commonjs2\":\"react\",\"commonjs\":\"react\",\"amd\":\"react\"} ***!\n  \\**************************************************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_react__;\n\n/***/ }),\n\n/***/ \"react-dom\":\n/*!*****************************************************************************************************!*\\\n  !*** external {\"root\":\"ReactDOM\",\"commonjs2\":\"react-dom\",\"commonjs\":\"react-dom\",\"amd\":\"react-dom\"} ***!\n  \\*****************************************************************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_react_dom__;\n\n/***/ }),\n\n/***/ \"survey-core\":\n/*!*********************************************************************************************************!*\\\n  !*** external {\"root\":\"Survey\",\"commonjs2\":\"survey-core\",\"commonjs\":\"survey-core\",\"amd\":\"survey-core\"} ***!\n  \\*********************************************************************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_survey_core__;\n\n/***/ })\n\n/******/ });\n});\n//# sourceMappingURL=survey-react-ui.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvLnBucG0vc3VydmV5LXJlYWN0LXVpQDEuMTEuMTNfcmVhY3QtZG9tQDE4LjMuMV9yZWFjdEAxOC4zLjFfX3JlYWN0QDE4LjMuMV9zdXJ2ZXktY29yZUAxLjExLjEzL25vZGVfbW9kdWxlcy9zdXJ2ZXktcmVhY3QtdWkvc3VydmV5LXJlYWN0LXVpLmpzIiwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUksSUFBeUQ7QUFDN0QsMkJBQTJCLG1CQUFPLENBQUMsbUxBQU8sR0FBRyxtQkFBTyxDQUFDLDJMQUFXLEdBQUcsbUJBQU8sQ0FBQywyR0FBYTtBQUN4RixNQUFNLEVBSzJFO0FBQ2pGLENBQUM7QUFDRCxxQ0FBcUM7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsK0JBQW1CO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEVBQTBFLCtCQUFtQjtBQUM3RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsK0JBQW1CO0FBQzdCO0FBQ0E7QUFDQSxVQUFVLCtCQUFtQjtBQUM3QjtBQUNBO0FBQ0EsVUFBVSwrQkFBbUI7QUFDN0IsZUFBZSwrQkFBbUI7QUFDbEMsbURBQW1ELCtCQUErQjtBQUNsRjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsK0JBQW1CO0FBQzdCO0FBQ0EsaUVBQWlFLGlCQUFpQjtBQUNsRjtBQUNBLDBEQUEwRCxhQUFhO0FBQ3ZFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSwrQkFBbUI7QUFDN0IsZ0NBQWdDLCtCQUFtQjtBQUNuRDtBQUNBO0FBQ0E7QUFDQSxXQUFXLCtCQUFtQjtBQUM5QixrREFBa0QsZ0NBQWdDO0FBQ2xGLDBFQUEwRSwrQkFBbUIsNEJBQTRCLG9CQUFvQjtBQUM3STtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsK0JBQW1CO0FBQzdCO0FBQ0Esb0NBQW9DLDRCQUE0QjtBQUNoRSwwQ0FBMEM7QUFDMUMsV0FBVywrQkFBbUI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLCtCQUFtQixrQ0FBa0M7QUFDL0Q7QUFDQTtBQUNBLFVBQVUsK0JBQW1CO0FBQzdCO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQiwrQkFBbUIsQ0FBQywrQkFBbUI7QUFDeEQsVUFBVTtBQUNWO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhEQUE4RCxxRUFBcUU7QUFDbkksOERBQThELG9GQUFvRjtBQUNsSiw4REFBOEQsd0ZBQXdGO0FBQ3RKLHdCQUF3QiwwQkFBbUIsRUFBRSwrQkFBbUI7O0FBRWhFO0FBQ0E7QUFDQSwrQkFBbUIsR0FBRywwQkFBbUI7O0FBRXpDO0FBQ0EsK0JBQW1CLEdBQUcsMEJBQW1CLHlCQUF5QiwyQ0FBMkM7QUFDN0csK0JBQW1CLEdBQUcsMEJBQW1CLGtDQUFrQyx3Q0FBd0M7QUFDbkgsK0JBQW1CLEdBQUcsMEJBQW1CLDZDQUE2QyxvRUFBb0U7QUFDMUosK0JBQW1CLEdBQUcsMEJBQW1CLHVDQUF1Qyw2Q0FBNkM7QUFDN0gsK0JBQW1CLEdBQUcsMEJBQW1CLG1DQUFtQyx5REFBeUQ7QUFDckksK0JBQW1CLEdBQUcsMEJBQW1CLDZCQUE2Qix3Q0FBd0M7QUFDOUcsK0JBQW1CLEdBQUcsMEJBQW1CLDRCQUE0QixzQ0FBc0M7QUFDM0csK0JBQW1CLEdBQUcsMEJBQW1CLDhCQUE4QiwwQ0FBMEM7QUFDakgsK0JBQW1CLEdBQUcsMEJBQW1CLGtDQUFrQyxtREFBbUQ7QUFDOUgsK0JBQW1CLEdBQUcsMEJBQW1CLGlDQUFpQyxxREFBcUQ7QUFDL0gsK0JBQW1CLEdBQUcsMEJBQW1CLHNDQUFzQywwREFBMEQ7QUFDekksK0JBQW1CLEdBQUcsMEJBQW1CLDhDQUE4QyxrRUFBa0U7QUFDekosK0JBQW1CLEdBQUcsMEJBQW1CLHFDQUFxQywyQ0FBMkM7QUFDekgsK0JBQW1CLEdBQUcsMEJBQW1CLG9DQUFvQyxnRUFBZ0U7QUFDN0ksK0JBQW1CLEdBQUcsMEJBQW1CLDRDQUE0Qyx3RUFBd0U7QUFDN0osK0JBQW1CLEdBQUcsMEJBQW1CLDRDQUE0Qyx3RUFBd0U7QUFDN0osK0JBQW1CLEdBQUcsMEJBQW1CLHdDQUF3QyxvRUFBb0U7QUFDckosK0JBQW1CLEdBQUcsMEJBQW1CLHlDQUF5QyxzRUFBc0U7QUFDeEosK0JBQW1CLEdBQUcsMEJBQW1CLDZDQUE2QywwRUFBMEU7QUFDaEssK0JBQW1CLEdBQUcsMEJBQW1CLHdDQUF3QyxvRUFBb0U7QUFDckosK0JBQW1CLEdBQUcsMEJBQW1CLDRDQUE0Qyx3RUFBd0U7QUFDN0osK0JBQW1CLEdBQUcsMEJBQW1CLG1EQUFtRCwrRUFBK0U7QUFDM0ssK0JBQW1CLEdBQUcsMEJBQW1CLDZCQUE2QiwrQ0FBK0M7QUFDckgsK0JBQW1CLEdBQUcsMEJBQW1CLGlDQUFpQyx3REFBd0Q7QUFDbEksK0JBQW1CLEdBQUcsMEJBQW1CLG1DQUFtQyw0REFBNEQ7QUFDeEksK0JBQW1CLEdBQUcsMEJBQW1CLHFDQUFxQyxnRUFBZ0U7QUFDOUksK0JBQW1CLEdBQUcsMEJBQW1CLHFDQUFxQyx5REFBeUQ7QUFDdkksK0JBQW1CLEdBQUcsMEJBQW1CLDJDQUEyQywrREFBK0Q7QUFDbkosK0JBQW1CLEdBQUcsMEJBQW1CLDZDQUE2QyxpRUFBaUU7QUFDdkosK0JBQW1CLEdBQUcsMEJBQW1CLHlDQUF5QyxzRUFBc0U7QUFDeEosK0JBQW1CLEdBQUcsMEJBQW1CLDJDQUEyQyw2REFBNkQ7QUFDakosK0JBQW1CLEdBQUcsMEJBQW1CLHVDQUF1QyxrRUFBa0U7QUFDbEosK0JBQW1CLEdBQUcsMEJBQW1CLCtDQUErQyxxRUFBcUU7QUFDN0osK0JBQW1CLEdBQUcsMEJBQW1CLHVDQUF1QyxrRUFBa0U7QUFDbEosK0JBQW1CLEdBQUcsMEJBQW1CLDBDQUEwQyxxRUFBcUU7QUFDeEosK0JBQW1CLEdBQUcsMEJBQW1CLDJDQUEyQyxzRUFBc0U7QUFDMUosK0JBQW1CLEdBQUcsMEJBQW1CLHFDQUFxQyw4REFBOEQ7QUFDNUksK0JBQW1CLEdBQUcsMEJBQW1CLHFDQUFxQyw4REFBOEQ7QUFDNUksK0JBQW1CLEdBQUcsMEJBQW1CLHlDQUF5QyxrRUFBa0U7QUFDcEosK0JBQW1CLEdBQUcsMEJBQW1CLG9DQUFvQyx1REFBdUQ7QUFDcEksK0JBQW1CLEdBQUcsMEJBQW1CLDZDQUE2Qyw4RUFBOEU7QUFDcEssK0JBQW1CLEdBQUcsMEJBQW1CLDJDQUEyQywwRUFBMEU7QUFDOUosK0JBQW1CLEdBQUcsMEJBQW1CLDBDQUEwQyx5RUFBeUU7QUFDNUosK0JBQW1CLEdBQUcsMEJBQW1CLHFDQUFxQyw4REFBOEQ7QUFDNUksK0JBQW1CLEdBQUcsMEJBQW1CLHdDQUF3QyxzREFBc0Q7QUFDdkksK0JBQW1CLEdBQUcsMEJBQW1CLGdEQUFnRCx1RUFBdUU7QUFDaEssK0JBQW1CLEdBQUcsMEJBQW1CLDZDQUE2QyxpRUFBaUU7QUFDdkosK0JBQW1CLEdBQUcsMEJBQW1CLHNDQUFzQyxnRUFBZ0U7QUFDL0ksK0JBQW1CLEdBQUcsMEJBQW1CLG1EQUFtRCwwRkFBMEY7QUFDdEwsK0JBQW1CLEdBQUcsMEJBQW1CLG1EQUFtRCwwRkFBMEY7QUFDdEwsK0JBQW1CLEdBQUcsMEJBQW1CLCtDQUErQyxxREFBcUQ7QUFDN0ksK0JBQW1CLEdBQUcsMEJBQW1CLDhDQUE4QyxnRkFBZ0Y7QUFDdkssK0JBQW1CLEdBQUcsMEJBQW1CLHVEQUF1RCx5RkFBeUY7QUFDekwsK0JBQW1CLEdBQUcsMEJBQW1CLDZDQUE2Qyw4RUFBOEU7QUFDcEssK0JBQW1CLEdBQUcsMEJBQW1CLGlDQUFpQyxnREFBZ0Q7QUFDMUgsK0JBQW1CLEdBQUcsMEJBQW1CLHdDQUF3Qyw4REFBOEQ7QUFDL0ksK0JBQW1CLEdBQUcsMEJBQW1CLG9DQUFvQyxzREFBc0Q7QUFDbkksK0JBQW1CLEdBQUcsMEJBQW1CLHVDQUF1QyxrRUFBa0U7QUFDbEosK0JBQW1CLEdBQUcsMEJBQW1CLCtDQUErQyxxRUFBcUU7QUFDN0osK0JBQW1CLEdBQUcsMEJBQW1CLDJDQUEyQywwRUFBMEU7QUFDOUosK0JBQW1CLEdBQUcsMEJBQW1CLDhCQUE4Qix1REFBdUQ7QUFDOUgsK0JBQW1CLEdBQUcsMEJBQW1CLCtCQUErQixxQ0FBcUM7QUFDN0csK0JBQW1CLEdBQUcsMEJBQW1CLHVDQUF1Qyw2Q0FBNkM7QUFDN0gsK0JBQW1CLEdBQUcsMEJBQW1CLHNDQUFzQyw0Q0FBNEM7QUFDM0gsK0JBQW1CLEdBQUcsMEJBQW1CLDRDQUE0Qyw4REFBOEQ7QUFDbkosK0JBQW1CLEdBQUcsMEJBQW1CLHNDQUFzQyxrREFBa0Q7QUFDakksK0JBQW1CLEdBQUcsMEJBQW1CLDZDQUE2QyxnRUFBZ0U7QUFDdEosK0JBQW1CLEdBQUcsMEJBQW1CLDRDQUE0Qyw0RUFBNEU7QUFDakssK0JBQW1CLEdBQUcsMEJBQW1CLHVDQUF1QyxrRUFBa0U7QUFDbEosK0JBQW1CLEdBQUcsMEJBQW1CLDBDQUEwQyxxRUFBcUU7QUFDeEosK0JBQW1CLEdBQUcsMEJBQW1CLHdCQUF3QixvQ0FBb0M7QUFDckcsK0JBQW1CLEdBQUcsMEJBQW1CLGtDQUFrQywwREFBMEQ7QUFDckksK0JBQW1CLEdBQUcsMEJBQW1CLGdDQUFnQyxzREFBc0Q7QUFDL0gsK0JBQW1CLEdBQUcsMEJBQW1CLHVCQUF1QixrQ0FBa0M7QUFDbEcsK0JBQW1CLEdBQUcsMEJBQW1CLCtCQUErQixtREFBbUQ7QUFDM0gsK0JBQW1CLEdBQUcsMEJBQW1CLCtCQUErQixtREFBbUQ7QUFDM0gsK0JBQW1CLEdBQUcsMEJBQW1CLGtDQUFrQyxtREFBbUQ7QUFDOUgsK0JBQW1CLEdBQUcsMEJBQW1CLDRCQUE0Qiw2Q0FBNkM7QUFDbEgsK0JBQW1CLEdBQUcsMEJBQW1CLCtCQUErQixtREFBbUQ7QUFDM0gsK0JBQW1CLEdBQUcsMEJBQW1CLDBCQUEwQix5Q0FBeUM7QUFDNUcsK0JBQW1CLEdBQUcsMEJBQW1CLDBEQUEwRCw4RUFBOEU7QUFDakwsK0JBQW1CLEdBQUcsMEJBQW1CLG1EQUFtRCx1RUFBdUU7QUFDbkssK0JBQW1CLEdBQUcsMEJBQW1CLDBEQUEwRCwrRUFBK0U7QUFDbEwsK0JBQW1CLEdBQUcsMEJBQW1CLHNEQUFzRCxpRkFBaUY7QUFDaEwsK0JBQW1CLEdBQUcsMEJBQW1CLHlEQUF5RCx1RkFBdUY7QUFDekwsK0JBQW1CLEdBQUcsMEJBQW1CLHVEQUF1RCxtRkFBbUY7QUFDbkwsK0JBQW1CLEdBQUcsMEJBQW1CLHVEQUF1RCxtRkFBbUY7QUFDbkwsK0JBQW1CLEdBQUcsMEJBQW1CLHlEQUF5RCwwRkFBMEY7QUFDNUwsK0JBQW1CLEdBQUcsMEJBQW1CLHlDQUF5QyxpRUFBaUU7QUFDbkosK0JBQW1CLEdBQUcsMEJBQW1CLHlDQUF5Qyw4REFBOEQ7QUFDaEosK0JBQW1CLEdBQUcsMEJBQW1CLDRCQUE0QixzQ0FBc0M7QUFDM0csK0JBQW1CLEdBQUcsMEJBQW1CLDJCQUEyQiwwQ0FBMEM7QUFDOUcsK0JBQW1CLEdBQUcsMEJBQW1CLG9DQUFvQyxtREFBbUQ7QUFDaEksK0JBQW1CLEdBQUcsMEJBQW1CLHNDQUFzQyxpRUFBaUU7QUFDaEosK0JBQW1CLEdBQUcsMEJBQW1CLDRDQUE0QyxvRUFBb0U7QUFDekosK0JBQW1CLEdBQUcsMEJBQW1CLCtCQUErQiw0Q0FBNEM7QUFDcEgsK0JBQW1CLEdBQUcsMEJBQW1CLDZCQUE2QiwwQ0FBMEM7QUFDaEgsK0JBQW1CLEdBQUcsMEJBQW1CLHlCQUF5QixzQ0FBc0M7QUFDeEcsK0JBQW1CLEdBQUcsMEJBQW1CLHdDQUF3Qyw0REFBNEQ7QUFDN0ksK0JBQW1CLEdBQUcsMEJBQW1CLHdDQUF3Qyw0REFBNEQ7QUFDN0ksK0JBQW1CLEdBQUcsMEJBQW1CLDRDQUE0QyxvRUFBb0U7QUFDekosK0JBQW1CLEdBQUcsMEJBQW1CLHFDQUFxQyxxREFBcUQ7QUFDbkksK0JBQW1CLEdBQUcsMEJBQW1CLDhCQUE4Qix3SEFBd0g7QUFDL0wsK0JBQW1CLEdBQUcsMEJBQW1CLG9DQUFvQyw4SEFBOEg7QUFDM00sK0JBQW1CLEdBQUcsMEJBQW1CLHdCQUF3Qix3SEFBd0g7QUFDekwsK0JBQW1CLEdBQUcsMEJBQW1CLDJCQUEyQixxSEFBcUg7QUFDekwsK0JBQW1CLEdBQUcsMEJBQW1CLHFDQUFxQywrSEFBK0g7QUFDN00sK0JBQW1CLEdBQUcsMEJBQW1CLGdDQUFnQywwSEFBMEg7O0FBRW5NLDhCQUE4QjtBQUM5Qix1RkFBdUYsK0JBQW1COztBQUUxRyw4QkFBOEI7QUFDOUIsb0VBQW9FLCtCQUFtQjtBQUN2Rix3RkFBd0YsK0JBQW1COztBQUUzRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7O0FBR0Q7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsaUNBQWlDO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsQ0FBQzs7QUFFRDs7QUFFQTtBQUNBLGlCQUFpQixNQUFnQztBQUNqRDtBQUNBO0FBQ0EsZUFBZSxnQkFBZ0Isc0NBQXNDLGtCQUFrQjtBQUN2Riw4QkFBOEI7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCO0FBQ3hCO0FBQ0E7QUFDQSxDQUFDOzs7OztBQUtEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0EsdUdBQXVHLCtDQUErQyxpQkFBaUIsc0VBQXNFO0FBQzdPO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9ELHdCQUF3QjtBQUM1RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCx3QkFBd0I7QUFDeEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLHdCQUF3QixnQkFBZ0I7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdCQUFnQjtBQUN4QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGdDQUFnQztBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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OztBQUVBLE9BQU87O0FBRVAsVUFBVTtBQUNWLENBQUM7QUFDRCIsInNvdXJjZXMiOlsid2VicGFjazovL3BmbGVnZS1yZWNobmVyLy4vbm9kZV9tb2R1bGVzLy5wbnBtL3N1cnZleS1yZWFjdC11aUAxLjExLjEzX3JlYWN0LWRvbUAxOC4zLjFfcmVhY3RAMTguMy4xX19yZWFjdEAxOC4zLjFfc3VydmV5LWNvcmVAMS4xMS4xMy9ub2RlX21vZHVsZXMvc3VydmV5LXJlYWN0LXVpL3N1cnZleS1yZWFjdC11aS5qcz81YzYxIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogc3VydmV5anMgLSBTdXJ2ZXkgSmF2YVNjcmlwdCBsaWJyYXJ5IHYxLjExLjEzXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTUtMjAyNCBEZXZzb2Z0IEJhbHRpYyBPw5wgIC0gaHR0cDovL3N1cnZleWpzLmlvL1xuICogTGljZW5zZTogTUlUIChodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocClcbiAqL1xuKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeShyZXF1aXJlKFwicmVhY3RcIiksIHJlcXVpcmUoXCJyZWFjdC1kb21cIiksIHJlcXVpcmUoXCJzdXJ2ZXktY29yZVwiKSk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShcInN1cnZleS1yZWFjdC11aVwiLCBbXCJyZWFjdFwiLCBcInJlYWN0LWRvbVwiLCBcInN1cnZleS1jb3JlXCJdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcInN1cnZleS1yZWFjdC11aVwiXSA9IGZhY3RvcnkocmVxdWlyZShcInJlYWN0XCIpLCByZXF1aXJlKFwicmVhY3QtZG9tXCIpLCByZXF1aXJlKFwic3VydmV5LWNvcmVcIikpO1xuXHRlbHNlXG5cdFx0cm9vdFtcIlN1cnZleVJlYWN0XCJdID0gZmFjdG9yeShyb290W1wiUmVhY3RcIl0sIHJvb3RbXCJSZWFjdERPTVwiXSwgcm9vdFtcIlN1cnZleVwiXSk7XG59KSh0aGlzLCBmdW5jdGlvbihfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX3JlYWN0X18sIF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfcmVhY3RfZG9tX18sIF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfc3VydmV5X2NvcmVfXykge1xucmV0dXJuIC8qKioqKiovIChmdW5jdGlvbihtb2R1bGVzKSB7IC8vIHdlYnBhY2tCb290c3RyYXBcbi8qKioqKiovIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuLyoqKioqKi8gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbi8qKioqKiovIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuLyoqKioqKi9cbi8qKioqKiovIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbi8qKioqKiovIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0aTogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsOiBmYWxzZSxcbi8qKioqKiovIFx0XHRcdGV4cG9ydHM6IHt9XG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubCA9IHRydWU7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4vKioqKioqLyBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuLyoqKioqKi8gXHR9XG4vKioqKioqL1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kID0gZnVuY3Rpb24oZXhwb3J0cywgbmFtZSwgZ2V0dGVyKSB7XG4vKioqKioqLyBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuLyoqKioqKi8gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4vKioqKioqLyBcdFx0fVxuLyoqKioqKi8gXHR9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4vKioqKioqLyBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4vKioqKioqLyBcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcbi8qKioqKiovIFx0XHR9XG4vKioqKioqLyBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuLyoqKioqKi8gXHQvLyBtb2RlICYgMTogdmFsdWUgaXMgYSBtb2R1bGUgaWQsIHJlcXVpcmUgaXRcbi8qKioqKiovIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4vKioqKioqLyBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuLyoqKioqKi8gXHQvLyBtb2RlICYgOHwxOiBiZWhhdmUgbGlrZSByZXF1aXJlXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4vKioqKioqLyBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4vKioqKioqLyBcdFx0aWYobW9kZSAmIDgpIHJldHVybiB2YWx1ZTtcbi8qKioqKiovIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuLyoqKioqKi8gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4vKioqKioqLyBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5yKG5zKTtcbi8qKioqKiovIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4vKioqKioqLyBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuLyoqKioqKi8gXHRcdHJldHVybiBucztcbi8qKioqKiovIFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIGdldERlZmF1bHRFeHBvcnQgZnVuY3Rpb24gZm9yIGNvbXBhdGliaWxpdHkgd2l0aCBub24taGFybW9ueSBtb2R1bGVzXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuLyoqKioqKi8gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuLyoqKioqKi8gXHRcdFx0ZnVuY3Rpb24gZ2V0RGVmYXVsdCgpIHsgcmV0dXJuIG1vZHVsZVsnZGVmYXVsdCddOyB9IDpcbi8qKioqKiovIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4vKioqKioqLyBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuLyoqKioqKi8gXHRcdHJldHVybiBnZXR0ZXI7XG4vKioqKioqLyBcdH07XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGxcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcbi8qKioqKiovXG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8qKioqKiovIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gXCIuL3NyYy9lbnRyaWVzL3JlYWN0LXVpLnRzXCIpO1xuLyoqKioqKi8gfSlcbi8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKioqKioqLyAoe1xuXG4vKioqLyBcIi4vc3JjL2VudHJpZXMvcmVhY3QtdWkudHNcIjpcbi8qISoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogLi9zcmMvZW50cmllcy9yZWFjdC11aS50cyArIDk1IG1vZHVsZXMgKioqIVxuICBcXCoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKiEgZXhwb3J0cyBwcm92aWRlZDogU3VydmV5LCBhdHRhY2hLZXkyY2xpY2ssIFJlYWN0U3VydmV5RWxlbWVudHNXcmFwcGVyLCBTdXJ2ZXlOYXZpZ2F0aW9uQmFzZSwgU3VydmV5VGltZXJQYW5lbCwgU3VydmV5UGFnZSwgU3VydmV5Um93LCBTdXJ2ZXlQYW5lbCwgU3VydmV5Rmxvd1BhbmVsLCBTdXJ2ZXlRdWVzdGlvbiwgU3VydmV5RWxlbWVudEVycm9ycywgU3VydmV5UXVlc3Rpb25BbmRFcnJvcnNDZWxsLCBSZWFjdFN1cnZleUVsZW1lbnQsIFN1cnZleUVsZW1lbnRCYXNlLCBTdXJ2ZXlRdWVzdGlvbkVsZW1lbnRCYXNlLCBTdXJ2ZXlRdWVzdGlvbkNvbW1lbnRJdGVtLCBTdXJ2ZXlRdWVzdGlvbkNvbW1lbnQsIFN1cnZleVF1ZXN0aW9uQ2hlY2tib3gsIFN1cnZleVF1ZXN0aW9uQ2hlY2tib3hJdGVtLCBTdXJ2ZXlRdWVzdGlvblJhbmtpbmcsIFN1cnZleVF1ZXN0aW9uUmFua2luZ0l0ZW0sIFN1cnZleVF1ZXN0aW9uUmFua2luZ0l0ZW1Db250ZW50LCBSYXRpbmdJdGVtLCBSYXRpbmdJdGVtU3RhciwgUmF0aW5nSXRlbVNtaWxleSwgUmF0aW5nRHJvcGRvd25JdGVtLCBUYWdib3hGaWx0ZXJTdHJpbmcsIFN1cnZleVF1ZXN0aW9uT3B0aW9uSXRlbSwgU3VydmV5UXVlc3Rpb25Ecm9wZG93bkJhc2UsIFN1cnZleVF1ZXN0aW9uRHJvcGRvd24sIFN1cnZleVF1ZXN0aW9uVGFnYm94SXRlbSwgU3VydmV5UXVlc3Rpb25UYWdib3gsIFN1cnZleVF1ZXN0aW9uRHJvcGRvd25TZWxlY3QsIFN1cnZleVF1ZXN0aW9uTWF0cml4LCBTdXJ2ZXlRdWVzdGlvbk1hdHJpeFJvdywgU3VydmV5UXVlc3Rpb25NYXRyaXhDZWxsLCBTdXJ2ZXlRdWVzdGlvbkh0bWwsIFN1cnZleVF1ZXN0aW9uRmlsZSwgU3VydmV5RmlsZUNob29zZUJ1dHRvbiwgU3VydmV5RmlsZVByZXZpZXcsIFN1cnZleVF1ZXN0aW9uTXVsdGlwbGVUZXh0LCBTdXJ2ZXlRdWVzdGlvblJhZGlvZ3JvdXAsIFN1cnZleVF1ZXN0aW9uUmFkaW9JdGVtLCBTdXJ2ZXlRdWVzdGlvblRleHQsIFN1cnZleVF1ZXN0aW9uQm9vbGVhbiwgU3VydmV5UXVlc3Rpb25Cb29sZWFuQ2hlY2tib3gsIFN1cnZleVF1ZXN0aW9uQm9vbGVhblJhZGlvLCBTdXJ2ZXlRdWVzdGlvbkVtcHR5LCBTdXJ2ZXlRdWVzdGlvbk1hdHJpeERyb3Bkb3duQ2VsbCwgU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkJhc2UsIFN1cnZleVF1ZXN0aW9uTWF0cml4RHJvcGRvd24sIFN1cnZleVF1ZXN0aW9uTWF0cml4RHluYW1pYywgU3VydmV5UXVlc3Rpb25NYXRyaXhEeW5hbWljQWRkQnV0dG9uLCBTdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pYywgU3VydmV5UHJvZ3Jlc3MsIFN1cnZleVByb2dyZXNzQnV0dG9ucywgU3VydmV5UHJvZ3Jlc3NUb2MsIFN1cnZleVF1ZXN0aW9uUmF0aW5nLCBTdXJ2ZXlRdWVzdGlvblJhdGluZ0Ryb3Bkb3duLCBTdXJ2ZXlRdWVzdGlvbkV4cHJlc3Npb24sIFBvcHVwU3VydmV5LCBTdXJ2ZXlXaW5kb3csIFJlYWN0UXVlc3Rpb25GYWN0b3J5LCBSZWFjdEVsZW1lbnRGYWN0b3J5LCBTdXJ2ZXlRdWVzdGlvbkltYWdlUGlja2VyLCBTdXJ2ZXlRdWVzdGlvbkltYWdlLCBTdXJ2ZXlRdWVzdGlvblNpZ25hdHVyZVBhZCwgU3VydmV5UXVlc3Rpb25CdXR0b25Hcm91cCwgU3VydmV5UXVlc3Rpb25DdXN0b20sIFN1cnZleVF1ZXN0aW9uQ29tcG9zaXRlLCBQb3B1cCwgTGlzdEl0ZW1Db250ZW50LCBMaXN0SXRlbUdyb3VwLCBMaXN0LCBUaXRsZUFjdGlvbnMsIFRpdGxlRWxlbWVudCwgU3VydmV5QWN0aW9uQmFyLCBMb2dvSW1hZ2UsIFN1cnZleUhlYWRlciwgU3ZnSWNvbiwgU3VydmV5UXVlc3Rpb25NYXRyaXhEeW5hbWljUmVtb3ZlQnV0dG9uLCBTdXJ2ZXlRdWVzdGlvbk1hdHJpeERldGFpbEJ1dHRvbiwgU3VydmV5UXVlc3Rpb25NYXRyaXhEeW5hbWljRHJhZ0Ryb3BJY29uLCBTdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY0FkZEJ1dHRvbiwgU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNSZW1vdmVCdXR0b24sIFN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljUHJldkJ1dHRvbiwgU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNOZXh0QnV0dG9uLCBTdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY1Byb2dyZXNzVGV4dCwgU3VydmV5TmF2aWdhdGlvbkJ1dHRvbiwgUXVlc3Rpb25FcnJvckNvbXBvbmVudCwgTWF0cml4Um93LCBTa2VsZXRvbiwgTm90aWZpZXJDb21wb25lbnQsIENvbXBvbmVudHNDb250YWluZXIsIENoYXJhY3RlckNvdW50ZXJDb21wb25lbnQsIEhlYWRlck1vYmlsZSwgSGVhZGVyQ2VsbCwgSGVhZGVyLCBTdXJ2ZXlMb2NTdHJpbmdWaWV3ZXIsIFN1cnZleUxvY1N0cmluZ0VkaXRvciwgTG9hZGluZ0luZGljYXRvckNvbXBvbmVudCwgU3ZnQnVuZGxlQ29tcG9uZW50LCBTdXJ2ZXlNb2RlbCwgU3VydmV5V2luZG93TW9kZWwsIE1vZGVsLCBzZXR0aW5ncywgc3VydmV5TG9jYWxpemF0aW9uLCBzdXJ2ZXlTdHJpbmdzICovXG4vKiEgTW9kdWxlQ29uY2F0ZW5hdGlvbiBiYWlsb3V0OiBDYW5ub3QgY29uY2F0IHdpdGggZXh0ZXJuYWwge1wicm9vdFwiOlwiUmVhY3RcIixcImNvbW1vbmpzMlwiOlwicmVhY3RcIixcImNvbW1vbmpzXCI6XCJyZWFjdFwiLFwiYW1kXCI6XCJyZWFjdFwifSAoPC0gTW9kdWxlIGlzIG5vdCBhbiBFQ01BU2NyaXB0IG1vZHVsZSkgKi9cbi8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IENhbm5vdCBjb25jYXQgd2l0aCBleHRlcm5hbCB7XCJyb290XCI6XCJSZWFjdERPTVwiLFwiY29tbW9uanMyXCI6XCJyZWFjdC1kb21cIixcImNvbW1vbmpzXCI6XCJyZWFjdC1kb21cIixcImFtZFwiOlwicmVhY3QtZG9tXCJ9ICg8LSBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlKSAqL1xuLyohIE1vZHVsZUNvbmNhdGVuYXRpb24gYmFpbG91dDogQ2Fubm90IGNvbmNhdCB3aXRoIGV4dGVybmFsIHtcInJvb3RcIjpcIlN1cnZleVwiLFwiY29tbW9uanMyXCI6XCJzdXJ2ZXktY29yZVwiLFwiY29tbW9uanNcIjpcInN1cnZleS1jb3JlXCIsXCJhbWRcIjpcInN1cnZleS1jb3JlXCJ9ICg8LSBNb2R1bGUgaXMgbm90IGFuIEVDTUFTY3JpcHQgbW9kdWxlKSAqL1xuLyoqKi8gKGZ1bmN0aW9uKG1vZHVsZSwgX193ZWJwYWNrX2V4cG9ydHNfXywgX193ZWJwYWNrX3JlcXVpcmVfXykge1xuXG5cInVzZSBzdHJpY3RcIjtcbi8vIEVTTSBDT01QQVQgRkxBR1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yKF9fd2VicGFja19leHBvcnRzX18pO1xuXG4vLyBFWFBPUlRTXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyByZWFjdFN1cnZleV9TdXJ2ZXk7IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiYXR0YWNoS2V5MmNsaWNrXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gYXR0YWNoS2V5MmNsaWNrOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlJlYWN0U3VydmV5RWxlbWVudHNXcmFwcGVyXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gcmVhY3RzdXJ2ZXltb2RlbF9SZWFjdFN1cnZleUVsZW1lbnRzV3JhcHBlcjsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlOYXZpZ2F0aW9uQmFzZVwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIFN1cnZleU5hdmlnYXRpb25CYXNlOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVRpbWVyUGFuZWxcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyByZWFjdHRpbWVycGFuZWxfU3VydmV5VGltZXJQYW5lbDsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlQYWdlXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gcGFnZV9TdXJ2ZXlQYWdlOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVJvd1wiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHJvd19TdXJ2ZXlSb3c7IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU3VydmV5UGFuZWxcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyBwYW5lbF9TdXJ2ZXlQYW5lbDsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlGbG93UGFuZWxcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyBmbG93X3BhbmVsX1N1cnZleUZsb3dQYW5lbDsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlRdWVzdGlvblwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHJlYWN0cXVlc3Rpb25fU3VydmV5UXVlc3Rpb247IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU3VydmV5RWxlbWVudEVycm9yc1wiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHJlYWN0cXVlc3Rpb25fU3VydmV5RWxlbWVudEVycm9yczsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlRdWVzdGlvbkFuZEVycm9yc0NlbGxcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyByZWFjdHF1ZXN0aW9uX1N1cnZleVF1ZXN0aW9uQW5kRXJyb3JzQ2VsbDsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJSZWFjdFN1cnZleUVsZW1lbnRcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyBSZWFjdFN1cnZleUVsZW1lbnQ7IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU3VydmV5RWxlbWVudEJhc2VcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyByZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5RWxlbWVudEJhc2U7IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU3VydmV5UXVlc3Rpb25FbGVtZW50QmFzZVwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHJlYWN0cXVlc3Rpb25fZWxlbWVudF9TdXJ2ZXlRdWVzdGlvbkVsZW1lbnRCYXNlOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uQ29tbWVudEl0ZW1cIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyByZWFjdHF1ZXN0aW9uX2NvbW1lbnRfU3VydmV5UXVlc3Rpb25Db21tZW50SXRlbTsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlRdWVzdGlvbkNvbW1lbnRcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyByZWFjdHF1ZXN0aW9uX2NvbW1lbnRfU3VydmV5UXVlc3Rpb25Db21tZW50OyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uQ2hlY2tib3hcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyByZWFjdHF1ZXN0aW9uX2NoZWNrYm94X1N1cnZleVF1ZXN0aW9uQ2hlY2tib3g7IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU3VydmV5UXVlc3Rpb25DaGVja2JveEl0ZW1cIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyByZWFjdHF1ZXN0aW9uX2NoZWNrYm94X1N1cnZleVF1ZXN0aW9uQ2hlY2tib3hJdGVtOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uUmFua2luZ1wiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHJlYWN0cXVlc3Rpb25fcmFua2luZ19TdXJ2ZXlRdWVzdGlvblJhbmtpbmc7IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU3VydmV5UXVlc3Rpb25SYW5raW5nSXRlbVwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHJlYWN0cXVlc3Rpb25fcmFua2luZ19TdXJ2ZXlRdWVzdGlvblJhbmtpbmdJdGVtOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uUmFua2luZ0l0ZW1Db250ZW50XCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gcmVhY3RxdWVzdGlvbl9yYW5raW5nX1N1cnZleVF1ZXN0aW9uUmFua2luZ0l0ZW1Db250ZW50OyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlJhdGluZ0l0ZW1cIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyByYXRpbmdfaXRlbV9SYXRpbmdJdGVtOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlJhdGluZ0l0ZW1TdGFyXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gcmF0aW5nX2l0ZW1fc3Rhcl9SYXRpbmdJdGVtU3RhcjsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJSYXRpbmdJdGVtU21pbGV5XCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gcmF0aW5nX2l0ZW1fc21pbGV5X1JhdGluZ0l0ZW1TbWlsZXk7IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiUmF0aW5nRHJvcGRvd25JdGVtXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gcmF0aW5nX2Ryb3Bkb3duX2l0ZW1fUmF0aW5nRHJvcGRvd25JdGVtOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlRhZ2JveEZpbHRlclN0cmluZ1wiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHRhZ2JveF9maWx0ZXJfVGFnYm94RmlsdGVyU3RyaW5nOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uT3B0aW9uSXRlbVwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIGRyb3Bkb3duX2l0ZW1fU3VydmV5UXVlc3Rpb25PcHRpb25JdGVtOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uRHJvcGRvd25CYXNlXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gZHJvcGRvd25fYmFzZV9TdXJ2ZXlRdWVzdGlvbkRyb3Bkb3duQmFzZTsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlRdWVzdGlvbkRyb3Bkb3duXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gcmVhY3RxdWVzdGlvbl9kcm9wZG93bl9TdXJ2ZXlRdWVzdGlvbkRyb3Bkb3duOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uVGFnYm94SXRlbVwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHRhZ2JveF9pdGVtX1N1cnZleVF1ZXN0aW9uVGFnYm94SXRlbTsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlRdWVzdGlvblRhZ2JveFwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHJlYWN0cXVlc3Rpb25fdGFnYm94X1N1cnZleVF1ZXN0aW9uVGFnYm94OyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uRHJvcGRvd25TZWxlY3RcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyBkcm9wZG93bl9zZWxlY3RfU3VydmV5UXVlc3Rpb25Ecm9wZG93blNlbGVjdDsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlRdWVzdGlvbk1hdHJpeFwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHJlYWN0cXVlc3Rpb25fbWF0cml4X1N1cnZleVF1ZXN0aW9uTWF0cml4OyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uTWF0cml4Um93XCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gcmVhY3RxdWVzdGlvbl9tYXRyaXhfU3VydmV5UXVlc3Rpb25NYXRyaXhSb3c7IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU3VydmV5UXVlc3Rpb25NYXRyaXhDZWxsXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gcmVhY3RxdWVzdGlvbl9tYXRyaXhfU3VydmV5UXVlc3Rpb25NYXRyaXhDZWxsOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uSHRtbFwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHJlYWN0cXVlc3Rpb25faHRtbF9TdXJ2ZXlRdWVzdGlvbkh0bWw7IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU3VydmV5UXVlc3Rpb25GaWxlXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gcmVhY3RxdWVzdGlvbl9maWxlX1N1cnZleVF1ZXN0aW9uRmlsZTsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlGaWxlQ2hvb3NlQnV0dG9uXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gZmlsZV9jaG9vc2VfYnV0dG9uX1N1cnZleUZpbGVDaG9vc2VCdXR0b247IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU3VydmV5RmlsZVByZXZpZXdcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyBmaWxlX3ByZXZpZXdfU3VydmV5RmlsZVByZXZpZXc7IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU3VydmV5UXVlc3Rpb25NdWx0aXBsZVRleHRcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyByZWFjdHF1ZXN0aW9uX211bHRpcGxldGV4dF9TdXJ2ZXlRdWVzdGlvbk11bHRpcGxlVGV4dDsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlRdWVzdGlvblJhZGlvZ3JvdXBcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyByZWFjdHF1ZXN0aW9uX3JhZGlvZ3JvdXBfU3VydmV5UXVlc3Rpb25SYWRpb2dyb3VwOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uUmFkaW9JdGVtXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gcmVhY3RxdWVzdGlvbl9yYWRpb2dyb3VwX1N1cnZleVF1ZXN0aW9uUmFkaW9JdGVtOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uVGV4dFwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHJlYWN0cXVlc3Rpb25fdGV4dF9TdXJ2ZXlRdWVzdGlvblRleHQ7IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU3VydmV5UXVlc3Rpb25Cb29sZWFuXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gYm9vbGVhbl9TdXJ2ZXlRdWVzdGlvbkJvb2xlYW47IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU3VydmV5UXVlc3Rpb25Cb29sZWFuQ2hlY2tib3hcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyBib29sZWFuX2NoZWNrYm94X1N1cnZleVF1ZXN0aW9uQm9vbGVhbkNoZWNrYm94OyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uQm9vbGVhblJhZGlvXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gYm9vbGVhbl9yYWRpb19TdXJ2ZXlRdWVzdGlvbkJvb2xlYW5SYWRpbzsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlRdWVzdGlvbkVtcHR5XCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gcmVhY3RxdWVzdGlvbl9lbXB0eV9TdXJ2ZXlRdWVzdGlvbkVtcHR5OyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uTWF0cml4RHJvcGRvd25DZWxsXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gcmVhY3RxdWVzdGlvbl9tYXRyaXhkcm9wZG93bmJhc2VfU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkNlbGw7IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkJhc2VcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyByZWFjdHF1ZXN0aW9uX21hdHJpeGRyb3Bkb3duYmFzZV9TdXJ2ZXlRdWVzdGlvbk1hdHJpeERyb3Bkb3duQmFzZTsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlRdWVzdGlvbk1hdHJpeERyb3Bkb3duXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bjsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlRdWVzdGlvbk1hdHJpeER5bmFtaWNcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyByZWFjdHF1ZXN0aW9uX21hdHJpeGR5bmFtaWNfU3VydmV5UXVlc3Rpb25NYXRyaXhEeW5hbWljOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uTWF0cml4RHluYW1pY0FkZEJ1dHRvblwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHJlYWN0cXVlc3Rpb25fbWF0cml4ZHluYW1pY19TdXJ2ZXlRdWVzdGlvbk1hdHJpeER5bmFtaWNBZGRCdXR0b247IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyByZWFjdHF1ZXN0aW9uX3BhbmVsZHluYW1pY19TdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pYzsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlQcm9ncmVzc1wiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHByb2dyZXNzX1N1cnZleVByb2dyZXNzOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVByb2dyZXNzQnV0dG9uc1wiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHByb2dyZXNzQnV0dG9uc19TdXJ2ZXlQcm9ncmVzc0J1dHRvbnM7IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU3VydmV5UHJvZ3Jlc3NUb2NcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyBwcm9ncmVzc1RvY19TdXJ2ZXlQcm9ncmVzc1RvYzsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlRdWVzdGlvblJhdGluZ1wiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHJlYWN0cXVlc3Rpb25fcmF0aW5nX1N1cnZleVF1ZXN0aW9uUmF0aW5nOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uUmF0aW5nRHJvcGRvd25cIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyByYXRpbmdfZHJvcGRvd25fU3VydmV5UXVlc3Rpb25SYXRpbmdEcm9wZG93bjsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlRdWVzdGlvbkV4cHJlc3Npb25cIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyByZWFjdHF1ZXN0aW9uX2V4cHJlc3Npb25fU3VydmV5UXVlc3Rpb25FeHByZXNzaW9uOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlBvcHVwU3VydmV5XCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gcmVhY3RfcG9wdXBfc3VydmV5X1BvcHVwU3VydmV5OyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVdpbmRvd1wiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIFN1cnZleVdpbmRvdzsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJSZWFjdFF1ZXN0aW9uRmFjdG9yeVwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIFJlYWN0UXVlc3Rpb25GYWN0b3J5OyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlJlYWN0RWxlbWVudEZhY3RvcnlcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyBSZWFjdEVsZW1lbnRGYWN0b3J5OyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uSW1hZ2VQaWNrZXJcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyBpbWFnZXBpY2tlcl9TdXJ2ZXlRdWVzdGlvbkltYWdlUGlja2VyOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uSW1hZ2VcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyBpbWFnZV9TdXJ2ZXlRdWVzdGlvbkltYWdlOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uU2lnbmF0dXJlUGFkXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gc2lnbmF0dXJlcGFkX1N1cnZleVF1ZXN0aW9uU2lnbmF0dXJlUGFkOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uQnV0dG9uR3JvdXBcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyByZWFjdHF1ZXN0aW9uX2J1dHRvbmdyb3VwX1N1cnZleVF1ZXN0aW9uQnV0dG9uR3JvdXA7IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU3VydmV5UXVlc3Rpb25DdXN0b21cIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyByZWFjdHF1ZXN0aW9uX2N1c3RvbV9TdXJ2ZXlRdWVzdGlvbkN1c3RvbTsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlRdWVzdGlvbkNvbXBvc2l0ZVwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHJlYWN0cXVlc3Rpb25fY3VzdG9tX1N1cnZleVF1ZXN0aW9uQ29tcG9zaXRlOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlBvcHVwXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gcG9wdXBfUG9wdXA7IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiTGlzdEl0ZW1Db250ZW50XCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gbGlzdF9pdGVtX2NvbnRlbnRfTGlzdEl0ZW1Db250ZW50OyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIkxpc3RJdGVtR3JvdXBcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyBsaXN0X2l0ZW1fZ3JvdXBfTGlzdEl0ZW1Hcm91cDsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJMaXN0XCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gbGlzdF9MaXN0OyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlRpdGxlQWN0aW9uc1wiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHRpdGxlX2FjdGlvbnNfVGl0bGVBY3Rpb25zOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlRpdGxlRWxlbWVudFwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHRpdGxlX2VsZW1lbnRfVGl0bGVFbGVtZW50OyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleUFjdGlvbkJhclwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIGFjdGlvbl9iYXJfU3VydmV5QWN0aW9uQmFyOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIkxvZ29JbWFnZVwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIGxvZ29faW1hZ2VfTG9nb0ltYWdlOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleUhlYWRlclwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHN1cnZleV9oZWFkZXJfU3VydmV5SGVhZGVyOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN2Z0ljb25cIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyBzdmdfaWNvbl9TdmdJY29uOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uTWF0cml4RHluYW1pY1JlbW92ZUJ1dHRvblwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHJlbW92ZV9idXR0b25fU3VydmV5UXVlc3Rpb25NYXRyaXhEeW5hbWljUmVtb3ZlQnV0dG9uOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uTWF0cml4RGV0YWlsQnV0dG9uXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gZGV0YWlsX2J1dHRvbl9TdXJ2ZXlRdWVzdGlvbk1hdHJpeERldGFpbEJ1dHRvbjsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlRdWVzdGlvbk1hdHJpeER5bmFtaWNEcmFnRHJvcEljb25cIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyBkcmFnX2Ryb3BfaWNvbl9TdXJ2ZXlRdWVzdGlvbk1hdHJpeER5bmFtaWNEcmFnRHJvcEljb247IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNBZGRCdXR0b25cIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyBwYW5lbGR5bmFtaWNfYWRkX2J0bl9TdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY0FkZEJ1dHRvbjsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY1JlbW92ZUJ1dHRvblwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHBhbmVsZHluYW1pY19yZW1vdmVfYnRuX1N1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljUmVtb3ZlQnV0dG9uOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljUHJldkJ1dHRvblwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHBhbmVsZHluYW1pY19wcmV2X2J0bl9TdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY1ByZXZCdXR0b247IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNOZXh0QnV0dG9uXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gcGFuZWxkeW5hbWljX25leHRfYnRuX1N1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljTmV4dEJ1dHRvbjsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY1Byb2dyZXNzVGV4dFwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHBhbmVsZHluYW1pY19wcm9ncmVzc190ZXh0X1N1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljUHJvZ3Jlc3NUZXh0OyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlN1cnZleU5hdmlnYXRpb25CdXR0b25cIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyBzdXJ2ZXlfbmF2X2J1dHRvbl9TdXJ2ZXlOYXZpZ2F0aW9uQnV0dG9uOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIlF1ZXN0aW9uRXJyb3JDb21wb25lbnRcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyBxdWVzdGlvbl9lcnJvcl9RdWVzdGlvbkVycm9yQ29tcG9uZW50OyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIk1hdHJpeFJvd1wiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIHJvd19NYXRyaXhSb3c7IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU2tlbGV0b25cIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyBza2VsZXRvbl9Ta2VsZXRvbjsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJOb3RpZmllckNvbXBvbmVudFwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIG5vdGlmaWVyX05vdGlmaWVyQ29tcG9uZW50OyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIkNvbXBvbmVudHNDb250YWluZXJcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyBjb21wb25lbnRzX2NvbnRhaW5lcl9Db21wb25lbnRzQ29udGFpbmVyOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIkNoYXJhY3RlckNvdW50ZXJDb21wb25lbnRcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyBjaGFyYWN0ZXJfY291bnRlcl9DaGFyYWN0ZXJDb3VudGVyQ29tcG9uZW50OyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIkhlYWRlck1vYmlsZVwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIGhlYWRlcl9IZWFkZXJNb2JpbGU7IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiSGVhZGVyQ2VsbFwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIGhlYWRlcl9IZWFkZXJDZWxsOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIkhlYWRlclwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIGhlYWRlcl9IZWFkZXI7IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU3VydmV5TG9jU3RyaW5nVmlld2VyXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gc3RyaW5nX3ZpZXdlcl9TdXJ2ZXlMb2NTdHJpbmdWaWV3ZXI7IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU3VydmV5TG9jU3RyaW5nRWRpdG9yXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gc3RyaW5nX2VkaXRvcl9TdXJ2ZXlMb2NTdHJpbmdFZGl0b3I7IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiTG9hZGluZ0luZGljYXRvckNvbXBvbmVudFwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIGxvYWRpbmdfaW5kaWNhdG9yX0xvYWRpbmdJbmRpY2F0b3JDb21wb25lbnQ7IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU3ZnQnVuZGxlQ29tcG9uZW50XCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gc3ZnYnVuZGxlX1N2Z0J1bmRsZUNvbXBvbmVudDsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJTdXJ2ZXlNb2RlbFwiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIGV4dGVybmFsX3Jvb3RfU3VydmV5X2NvbW1vbmpzMl9zdXJ2ZXlfY29yZV9jb21tb25qc19zdXJ2ZXlfY29yZV9hbWRfc3VydmV5X2NvcmVfW1wiU3VydmV5TW9kZWxcIl07IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwiU3VydmV5V2luZG93TW9kZWxcIiwgZnVuY3Rpb24oKSB7IHJldHVybiAvKiByZWV4cG9ydCAqLyBleHRlcm5hbF9yb290X1N1cnZleV9jb21tb25qczJfc3VydmV5X2NvcmVfY29tbW9uanNfc3VydmV5X2NvcmVfYW1kX3N1cnZleV9jb3JlX1tcIlN1cnZleVdpbmRvd01vZGVsXCJdOyB9KTtcbl9fd2VicGFja19yZXF1aXJlX18uZChfX3dlYnBhY2tfZXhwb3J0c19fLCBcIk1vZGVsXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gZXh0ZXJuYWxfcm9vdF9TdXJ2ZXlfY29tbW9uanMyX3N1cnZleV9jb3JlX2NvbW1vbmpzX3N1cnZleV9jb3JlX2FtZF9zdXJ2ZXlfY29yZV9bXCJTdXJ2ZXlNb2RlbFwiXTsgfSk7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQoX193ZWJwYWNrX2V4cG9ydHNfXywgXCJzZXR0aW5nc1wiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIGV4dGVybmFsX3Jvb3RfU3VydmV5X2NvbW1vbmpzMl9zdXJ2ZXlfY29yZV9jb21tb25qc19zdXJ2ZXlfY29yZV9hbWRfc3VydmV5X2NvcmVfW1wic2V0dGluZ3NcIl07IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwic3VydmV5TG9jYWxpemF0aW9uXCIsIGZ1bmN0aW9uKCkgeyByZXR1cm4gLyogcmVleHBvcnQgKi8gZXh0ZXJuYWxfcm9vdF9TdXJ2ZXlfY29tbW9uanMyX3N1cnZleV9jb3JlX2NvbW1vbmpzX3N1cnZleV9jb3JlX2FtZF9zdXJ2ZXlfY29yZV9bXCJzdXJ2ZXlMb2NhbGl6YXRpb25cIl07IH0pO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kKF9fd2VicGFja19leHBvcnRzX18sIFwic3VydmV5U3RyaW5nc1wiLCBmdW5jdGlvbigpIHsgcmV0dXJuIC8qIHJlZXhwb3J0ICovIGV4dGVybmFsX3Jvb3RfU3VydmV5X2NvbW1vbmpzMl9zdXJ2ZXlfY29yZV9jb21tb25qc19zdXJ2ZXlfY29yZV9hbWRfc3VydmV5X2NvcmVfW1wic3VydmV5U3RyaW5nc1wiXTsgfSk7XG5cbi8vIEVYVEVSTkFMIE1PRFVMRTogZXh0ZXJuYWwge1wicm9vdFwiOlwiU3VydmV5XCIsXCJjb21tb25qczJcIjpcInN1cnZleS1jb3JlXCIsXCJjb21tb25qc1wiOlwic3VydmV5LWNvcmVcIixcImFtZFwiOlwic3VydmV5LWNvcmVcIn1cbnZhciBleHRlcm5hbF9yb290X1N1cnZleV9jb21tb25qczJfc3VydmV5X2NvcmVfY29tbW9uanNfc3VydmV5X2NvcmVfYW1kX3N1cnZleV9jb3JlXyA9IF9fd2VicGFja19yZXF1aXJlX18oXCJzdXJ2ZXktY29yZVwiKTtcblxuLy8gRVhURVJOQUwgTU9EVUxFOiBleHRlcm5hbCB7XCJyb290XCI6XCJSZWFjdFwiLFwiY29tbW9uanMyXCI6XCJyZWFjdFwiLFwiY29tbW9uanNcIjpcInJlYWN0XCIsXCJhbWRcIjpcInJlYWN0XCJ9XG52YXIgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0XyA9IF9fd2VicGFja19yZXF1aXJlX18oXCJyZWFjdFwiKTtcbnZhciBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdCA9IC8qI19fUFVSRV9fKi9fX3dlYnBhY2tfcmVxdWlyZV9fLm4oZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0Xyk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9lbGVtZW50LWZhY3RvcnkudHN4XG52YXIgUmVhY3RFbGVtZW50RmFjdG9yeSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uICgpIHtcbiAgICBmdW5jdGlvbiBSZWFjdEVsZW1lbnRGYWN0b3J5KCkge1xuICAgICAgICB0aGlzLmNyZWF0b3JIYXNoID0ge307XG4gICAgfVxuICAgIFJlYWN0RWxlbWVudEZhY3RvcnkucHJvdG90eXBlLnJlZ2lzdGVyRWxlbWVudCA9IGZ1bmN0aW9uIChlbGVtZW50VHlwZSwgZWxlbWVudENyZWF0b3IpIHtcbiAgICAgICAgdGhpcy5jcmVhdG9ySGFzaFtlbGVtZW50VHlwZV0gPSBlbGVtZW50Q3JlYXRvcjtcbiAgICB9O1xuICAgIFJlYWN0RWxlbWVudEZhY3RvcnkucHJvdG90eXBlLmdldEFsbFR5cGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IEFycmF5KCk7XG4gICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLmNyZWF0b3JIYXNoKSB7XG4gICAgICAgICAgICByZXN1bHQucHVzaChrZXkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQuc29ydCgpO1xuICAgIH07XG4gICAgUmVhY3RFbGVtZW50RmFjdG9yeS5wcm90b3R5cGUuaXNFbGVtZW50UmVnaXN0ZXJlZCA9IGZ1bmN0aW9uIChlbGVtZW50VHlwZSkge1xuICAgICAgICByZXR1cm4gISF0aGlzLmNyZWF0b3JIYXNoW2VsZW1lbnRUeXBlXTtcbiAgICB9O1xuICAgIFJlYWN0RWxlbWVudEZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZUVsZW1lbnQgPSBmdW5jdGlvbiAoZWxlbWVudFR5cGUsIHBhcmFtcykge1xuICAgICAgICB2YXIgY3JlYXRvciA9IHRoaXMuY3JlYXRvckhhc2hbZWxlbWVudFR5cGVdO1xuICAgICAgICBpZiAoY3JlYXRvciA9PSBudWxsKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIHJldHVybiBjcmVhdG9yKHBhcmFtcyk7XG4gICAgfTtcbiAgICBSZWFjdEVsZW1lbnRGYWN0b3J5Lkluc3RhbmNlID0gbmV3IFJlYWN0RWxlbWVudEZhY3RvcnkoKTtcbiAgICByZXR1cm4gUmVhY3RFbGVtZW50RmFjdG9yeTtcbn0oKSk7XG5cblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL3JlYWN0c3VydmV5bW9kZWwudHN4XG5cblxudmFyIHJlYWN0c3VydmV5bW9kZWxfUmVhY3RTdXJ2ZXlFbGVtZW50c1dyYXBwZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUmVhY3RTdXJ2ZXlFbGVtZW50c1dyYXBwZXIoKSB7XG4gICAgfVxuICAgIFJlYWN0U3VydmV5RWxlbWVudHNXcmFwcGVyLndyYXBSb3cgPSBmdW5jdGlvbiAoc3VydmV5LCBlbGVtZW50LCByb3cpIHtcbiAgICAgICAgdmFyIGNvbXBvbmVudE5hbWUgPSBzdXJ2ZXkuZ2V0Um93V3JhcHBlckNvbXBvbmVudE5hbWUocm93KTtcbiAgICAgICAgdmFyIGNvbXBvbmVudERhdGEgPSBzdXJ2ZXkuZ2V0Um93V3JhcHBlckNvbXBvbmVudERhdGEocm93KTtcbiAgICAgICAgcmV0dXJuIFJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UuY3JlYXRlRWxlbWVudChjb21wb25lbnROYW1lLCB7XG4gICAgICAgICAgICBlbGVtZW50OiBlbGVtZW50LFxuICAgICAgICAgICAgcm93OiByb3csXG4gICAgICAgICAgICBjb21wb25lbnREYXRhOiBjb21wb25lbnREYXRhLFxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFJlYWN0U3VydmV5RWxlbWVudHNXcmFwcGVyLndyYXBFbGVtZW50ID0gZnVuY3Rpb24gKHN1cnZleSwgZWxlbWVudCwgcXVlc3Rpb24pIHtcbiAgICAgICAgdmFyIGNvbXBvbmVudE5hbWUgPSBzdXJ2ZXkuZ2V0RWxlbWVudFdyYXBwZXJDb21wb25lbnROYW1lKHF1ZXN0aW9uKTtcbiAgICAgICAgdmFyIGNvbXBvbmVudERhdGEgPSBzdXJ2ZXkuZ2V0RWxlbWVudFdyYXBwZXJDb21wb25lbnREYXRhKHF1ZXN0aW9uKTtcbiAgICAgICAgcmV0dXJuIFJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UuY3JlYXRlRWxlbWVudChjb21wb25lbnROYW1lLCB7XG4gICAgICAgICAgICBlbGVtZW50OiBlbGVtZW50LFxuICAgICAgICAgICAgcXVlc3Rpb246IHF1ZXN0aW9uLFxuICAgICAgICAgICAgY29tcG9uZW50RGF0YTogY29tcG9uZW50RGF0YSxcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBSZWFjdFN1cnZleUVsZW1lbnRzV3JhcHBlci53cmFwUXVlc3Rpb25Db250ZW50ID0gZnVuY3Rpb24gKHN1cnZleSwgZWxlbWVudCwgcXVlc3Rpb24pIHtcbiAgICAgICAgdmFyIGNvbXBvbmVudE5hbWUgPSBzdXJ2ZXkuZ2V0UXVlc3Rpb25Db250ZW50V3JhcHBlckNvbXBvbmVudE5hbWUocXVlc3Rpb24pO1xuICAgICAgICB2YXIgY29tcG9uZW50RGF0YSA9IHN1cnZleS5nZXRFbGVtZW50V3JhcHBlckNvbXBvbmVudERhdGEocXVlc3Rpb24pO1xuICAgICAgICByZXR1cm4gUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5jcmVhdGVFbGVtZW50KGNvbXBvbmVudE5hbWUsIHtcbiAgICAgICAgICAgIGVsZW1lbnQ6IGVsZW1lbnQsXG4gICAgICAgICAgICBxdWVzdGlvbjogcXVlc3Rpb24sXG4gICAgICAgICAgICBjb21wb25lbnREYXRhOiBjb21wb25lbnREYXRhLFxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFJlYWN0U3VydmV5RWxlbWVudHNXcmFwcGVyLndyYXBJdGVtVmFsdWUgPSBmdW5jdGlvbiAoc3VydmV5LCBlbGVtZW50LCBxdWVzdGlvbiwgaXRlbSkge1xuICAgICAgICB2YXIgY29tcG9uZW50TmFtZSA9IHN1cnZleS5nZXRJdGVtVmFsdWVXcmFwcGVyQ29tcG9uZW50TmFtZShpdGVtLCBxdWVzdGlvbik7XG4gICAgICAgIHZhciBjb21wb25lbnREYXRhID0gc3VydmV5LmdldEl0ZW1WYWx1ZVdyYXBwZXJDb21wb25lbnREYXRhKGl0ZW0sIHF1ZXN0aW9uKTtcbiAgICAgICAgcmV0dXJuIFJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UuY3JlYXRlRWxlbWVudChjb21wb25lbnROYW1lLCB7XG4gICAgICAgICAgICBrZXk6IGVsZW1lbnQgPT09IG51bGwgfHwgZWxlbWVudCA9PT0gdm9pZCAwID8gdm9pZCAwIDogZWxlbWVudC5rZXksXG4gICAgICAgICAgICBlbGVtZW50OiBlbGVtZW50LFxuICAgICAgICAgICAgcXVlc3Rpb246IHF1ZXN0aW9uLFxuICAgICAgICAgICAgaXRlbTogaXRlbSxcbiAgICAgICAgICAgIGNvbXBvbmVudERhdGE6IGNvbXBvbmVudERhdGEsXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgUmVhY3RTdXJ2ZXlFbGVtZW50c1dyYXBwZXIud3JhcE1hdHJpeENlbGwgPSBmdW5jdGlvbiAoc3VydmV5LCBlbGVtZW50LCBjZWxsLCByZWFzb24pIHtcbiAgICAgICAgaWYgKHJlYXNvbiA9PT0gdm9pZCAwKSB7IHJlYXNvbiA9IFwiY2VsbFwiOyB9XG4gICAgICAgIHZhciBjb21wb25lbnROYW1lID0gc3VydmV5LmdldEVsZW1lbnRXcmFwcGVyQ29tcG9uZW50TmFtZShjZWxsLCByZWFzb24pO1xuICAgICAgICB2YXIgY29tcG9uZW50RGF0YSA9IHN1cnZleS5nZXRFbGVtZW50V3JhcHBlckNvbXBvbmVudERhdGEoY2VsbCwgcmVhc29uKTtcbiAgICAgICAgcmV0dXJuIFJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UuY3JlYXRlRWxlbWVudChjb21wb25lbnROYW1lLCB7XG4gICAgICAgICAgICBlbGVtZW50OiBlbGVtZW50LFxuICAgICAgICAgICAgY2VsbDogY2VsbCxcbiAgICAgICAgICAgIGNvbXBvbmVudERhdGE6IGNvbXBvbmVudERhdGEsXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIFJlYWN0U3VydmV5RWxlbWVudHNXcmFwcGVyO1xufSgpKTtcblxuZXh0ZXJuYWxfcm9vdF9TdXJ2ZXlfY29tbW9uanMyX3N1cnZleV9jb3JlX2NvbW1vbmpzX3N1cnZleV9jb3JlX2FtZF9zdXJ2ZXlfY29yZV9bXCJTdXJ2ZXlNb2RlbFwiXS5wbGF0Zm9ybSA9IFwicmVhY3RcIjtcblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL3JlYWN0cXVlc3Rpb25fZWxlbWVudC50c3hcbnZhciBfX2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cblxuXG52YXIgcmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleUVsZW1lbnRCYXNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTdXJ2ZXlFbGVtZW50QmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlFbGVtZW50QmFzZShwcm9wcykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuX2FsbG93Q29tcG9uZW50VXBkYXRlID0gdHJ1ZTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBTdXJ2ZXlFbGVtZW50QmFzZS5yZW5kZXJMb2NTdHJpbmcgPSBmdW5jdGlvbiAobG9jU3RyLCBzdHlsZSwga2V5KSB7XG4gICAgICAgIGlmIChzdHlsZSA9PT0gdm9pZCAwKSB7IHN0eWxlID0gbnVsbDsgfVxuICAgICAgICByZXR1cm4gUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5jcmVhdGVFbGVtZW50KGxvY1N0ci5yZW5kZXJBcywge1xuICAgICAgICAgICAgbG9jU3RyOiBsb2NTdHIucmVuZGVyQXNEYXRhLFxuICAgICAgICAgICAgc3R5bGU6IHN0eWxlLFxuICAgICAgICAgICAga2V5OiBrZXksXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgU3VydmV5RWxlbWVudEJhc2UucmVuZGVyUXVlc3Rpb25EZXNjcmlwdGlvbiA9IGZ1bmN0aW9uIChxdWVzdGlvbikge1xuICAgICAgICB2YXIgZGVzY3JpcHRpb25UZXh0ID0gU3VydmV5RWxlbWVudEJhc2UucmVuZGVyTG9jU3RyaW5nKHF1ZXN0aW9uLmxvY0Rlc2NyaXB0aW9uKTtcbiAgICAgICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgc3R5bGU6IHF1ZXN0aW9uLmhhc0Rlc2NyaXB0aW9uID8gdW5kZWZpbmVkIDogeyBkaXNwbGF5OiBcIm5vbmVcIiB9LCBpZDogcXVlc3Rpb24uYXJpYURlc2NyaXB0aW9uSWQsIGNsYXNzTmFtZTogcXVlc3Rpb24uY3NzRGVzY3JpcHRpb24gfSwgZGVzY3JpcHRpb25UZXh0KTtcbiAgICB9O1xuICAgIFN1cnZleUVsZW1lbnRCYXNlLnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5tYWtlQmFzZUVsZW1lbnRzUmVhY3QoKTtcbiAgICB9O1xuICAgIFN1cnZleUVsZW1lbnRCYXNlLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy51bk1ha2VCYXNlRWxlbWVudHNSZWFjdCgpO1xuICAgIH07XG4gICAgU3VydmV5RWxlbWVudEJhc2UucHJvdG90eXBlLmNvbXBvbmVudERpZFVwZGF0ZSA9IGZ1bmN0aW9uIChwcmV2UHJvcHMsIHByZXZTdGF0ZSkge1xuICAgICAgICB0aGlzLm1ha2VCYXNlRWxlbWVudHNSZWFjdCgpO1xuICAgICAgICB0aGlzLmdldFN0YXRlRWxlbWVudHMoKS5mb3JFYWNoKGZ1bmN0aW9uIChlbCkge1xuICAgICAgICAgICAgZWwuYWZ0ZXJSZXJlbmRlcigpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFN1cnZleUVsZW1lbnRCYXNlLnByb3RvdHlwZS5hbGxvd0NvbXBvbmVudFVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fYWxsb3dDb21wb25lbnRVcGRhdGUgPSB0cnVlO1xuICAgICAgICB0aGlzLmZvcmNlVXBkYXRlKCk7XG4gICAgfTtcbiAgICBTdXJ2ZXlFbGVtZW50QmFzZS5wcm90b3R5cGUuZGVueUNvbXBvbmVudFVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5fYWxsb3dDb21wb25lbnRVcGRhdGUgPSBmYWxzZTtcbiAgICB9O1xuICAgIFN1cnZleUVsZW1lbnRCYXNlLnByb3RvdHlwZS5zaG91bGRDb21wb25lbnRVcGRhdGUgPSBmdW5jdGlvbiAobmV4dFByb3BzLCBuZXh0U3RhdGUpIHtcbiAgICAgICAgaWYgKHRoaXMuX2FsbG93Q29tcG9uZW50VXBkYXRlKSB7XG4gICAgICAgICAgICB0aGlzLnVuTWFrZUJhc2VFbGVtZW50c1JlYWN0KCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2FsbG93Q29tcG9uZW50VXBkYXRlO1xuICAgIH07XG4gICAgU3VydmV5RWxlbWVudEJhc2UucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmNhblJlbmRlcigpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnN0YXJ0RW5kUmVuZGVyaW5nKDEpO1xuICAgICAgICB2YXIgcmVzID0gdGhpcy5yZW5kZXJFbGVtZW50KCk7XG4gICAgICAgIHRoaXMuc3RhcnRFbmRSZW5kZXJpbmcoLTEpO1xuICAgICAgICBpZiAoISFyZXMpIHtcbiAgICAgICAgICAgIHJlcyA9IHRoaXMud3JhcEVsZW1lbnQocmVzKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNoYW5nZWRTdGF0ZVByb3BOYW1lVmFsdWUgPSB1bmRlZmluZWQ7XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfTtcbiAgICBTdXJ2ZXlFbGVtZW50QmFzZS5wcm90b3R5cGUud3JhcEVsZW1lbnQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlFbGVtZW50QmFzZS5wcm90b3R5cGUsIFwiaXNSZW5kZXJpbmdcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBzdGF0ZUVscyA9IHRoaXMuZ2V0UmVuZGVyZWRFbGVtZW50cygpO1xuICAgICAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBzdGF0ZUVsc18xID0gc3RhdGVFbHM7IF9pIDwgc3RhdGVFbHNfMS5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGVFbCA9IHN0YXRlRWxzXzFbX2ldO1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZUVsLnJlYWN0UmVuZGVyaW5nID4gMClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlFbGVtZW50QmFzZS5wcm90b3R5cGUuZ2V0UmVuZGVyZWRFbGVtZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0U3RhdGVFbGVtZW50cygpO1xuICAgIH07XG4gICAgU3VydmV5RWxlbWVudEJhc2UucHJvdG90eXBlLnN0YXJ0RW5kUmVuZGVyaW5nID0gZnVuY3Rpb24gKHZhbCkge1xuICAgICAgICB2YXIgc3RhdGVFbHMgPSB0aGlzLmdldFJlbmRlcmVkRWxlbWVudHMoKTtcbiAgICAgICAgZm9yICh2YXIgX2kgPSAwLCBzdGF0ZUVsc18yID0gc3RhdGVFbHM7IF9pIDwgc3RhdGVFbHNfMi5sZW5ndGg7IF9pKyspIHtcbiAgICAgICAgICAgIHZhciBzdGF0ZUVsID0gc3RhdGVFbHNfMltfaV07XG4gICAgICAgICAgICBpZiAoIXN0YXRlRWwucmVhY3RSZW5kZXJpbmcpXG4gICAgICAgICAgICAgICAgc3RhdGVFbC5yZWFjdFJlbmRlcmluZyA9IDA7XG4gICAgICAgICAgICBzdGF0ZUVsLnJlYWN0UmVuZGVyaW5nICs9IHZhbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3VydmV5RWxlbWVudEJhc2UucHJvdG90eXBlLmNhblJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBTdXJ2ZXlFbGVtZW50QmFzZS5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5RWxlbWVudEJhc2UucHJvdG90eXBlLCBcImNoYW5nZWRTdGF0ZVByb3BOYW1lXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5jaGFuZ2VkU3RhdGVQcm9wTmFtZVZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3VydmV5RWxlbWVudEJhc2UucHJvdG90eXBlLm1ha2VCYXNlRWxlbWVudHNSZWFjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGVscyA9IHRoaXMuZ2V0U3RhdGVFbGVtZW50cygpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVscy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgZWxzW2ldLmVuYWJsZU9uRWxlbWVudFJlbmRlcmVkRXZlbnQoKTtcbiAgICAgICAgICAgIHRoaXMubWFrZUJhc2VFbGVtZW50UmVhY3QoZWxzW2ldKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3VydmV5RWxlbWVudEJhc2UucHJvdG90eXBlLnVuTWFrZUJhc2VFbGVtZW50c1JlYWN0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZWxzID0gdGhpcy5nZXRTdGF0ZUVsZW1lbnRzKCk7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBlbHNbaV0uZGlzYWJsZU9uRWxlbWVudFJlbmRlcmVkRXZlbnQoKTtcbiAgICAgICAgICAgIHRoaXMudW5NYWtlQmFzZUVsZW1lbnRSZWFjdChlbHNbaV0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTdXJ2ZXlFbGVtZW50QmFzZS5wcm90b3R5cGUuZ2V0U3RhdGVFbGVtZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGVsID0gdGhpcy5nZXRTdGF0ZUVsZW1lbnQoKTtcbiAgICAgICAgcmV0dXJuICEhZWwgPyBbZWxdIDogW107XG4gICAgfTtcbiAgICBTdXJ2ZXlFbGVtZW50QmFzZS5wcm90b3R5cGUuZ2V0U3RhdGVFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlFbGVtZW50QmFzZS5wcm90b3R5cGUsIFwiaXNEaXNwbGF5TW9kZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHByb3BzID0gdGhpcy5wcm9wcztcbiAgICAgICAgICAgIHJldHVybiBwcm9wcy5pc0Rpc3BsYXlNb2RlIHx8IGZhbHNlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3VydmV5RWxlbWVudEJhc2UucHJvdG90eXBlLnJlbmRlckxvY1N0cmluZyA9IGZ1bmN0aW9uIChsb2NTdHIsIHN0eWxlLCBrZXkpIHtcbiAgICAgICAgaWYgKHN0eWxlID09PSB2b2lkIDApIHsgc3R5bGUgPSBudWxsOyB9XG4gICAgICAgIHJldHVybiBTdXJ2ZXlFbGVtZW50QmFzZS5yZW5kZXJMb2NTdHJpbmcobG9jU3RyLCBzdHlsZSwga2V5KTtcbiAgICB9O1xuICAgIFN1cnZleUVsZW1lbnRCYXNlLnByb3RvdHlwZS5jYW5NYWtlUmVhY3QgPSBmdW5jdGlvbiAoc3RhdGVFbGVtZW50KSB7XG4gICAgICAgIHJldHVybiAhIXN0YXRlRWxlbWVudCAmJiAhIXN0YXRlRWxlbWVudC5pdGVyYXRlUHJvcGVydGllc0hhc2g7XG4gICAgfTtcbiAgICBTdXJ2ZXlFbGVtZW50QmFzZS5wcm90b3R5cGUubWFrZUJhc2VFbGVtZW50UmVhY3QgPSBmdW5jdGlvbiAoc3RhdGVFbGVtZW50KSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghdGhpcy5jYW5NYWtlUmVhY3Qoc3RhdGVFbGVtZW50KSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgc3RhdGVFbGVtZW50Lml0ZXJhdGVQcm9wZXJ0aWVzSGFzaChmdW5jdGlvbiAoaGFzaCwga2V5KSB7XG4gICAgICAgICAgICBpZiAoIV90aGlzLmNhblVzZVByb3BJblN0YXRlKGtleSkpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgdmFyIHZhbCA9IGhhc2hba2V5XTtcbiAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbCkpIHtcbiAgICAgICAgICAgICAgICB2YXIgdmFsID0gdmFsO1xuICAgICAgICAgICAgICAgIHZhbFtcIm9uQXJyYXlDaGFuZ2VkXCJdID0gZnVuY3Rpb24gKGFycmF5Q2hhbmdlcykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoX3RoaXMuaXNSZW5kZXJpbmcpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLmNoYW5nZWRTdGF0ZVByb3BOYW1lVmFsdWUgPSBrZXk7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKGZ1bmN0aW9uIChzdGF0ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld1N0YXRlID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdTdGF0ZVtrZXldID0gdmFsO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG5ld1N0YXRlO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgc3RhdGVFbGVtZW50LnNldFByb3BlcnR5VmFsdWVDb3JlSGFuZGxlciA9IGZ1bmN0aW9uIChoYXNoLCBrZXksIHZhbCkge1xuICAgICAgICAgICAgaWYgKGhhc2hba2V5XSAhPT0gdmFsKSB7XG4gICAgICAgICAgICAgICAgaGFzaFtrZXldID0gdmFsO1xuICAgICAgICAgICAgICAgIGlmICghX3RoaXMuY2FuVXNlUHJvcEluU3RhdGUoa2V5KSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIGlmIChfdGhpcy5pc1JlbmRlcmluZylcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIF90aGlzLmNoYW5nZWRTdGF0ZVByb3BOYW1lVmFsdWUgPSBrZXk7XG4gICAgICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdTdGF0ZSA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBuZXdTdGF0ZVtrZXldID0gdmFsO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3U3RhdGU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBTdXJ2ZXlFbGVtZW50QmFzZS5wcm90b3R5cGUuY2FuVXNlUHJvcEluU3RhdGUgPSBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgU3VydmV5RWxlbWVudEJhc2UucHJvdG90eXBlLnVuTWFrZUJhc2VFbGVtZW50UmVhY3QgPSBmdW5jdGlvbiAoc3RhdGVFbGVtZW50KSB7XG4gICAgICAgIGlmICghdGhpcy5jYW5NYWtlUmVhY3Qoc3RhdGVFbGVtZW50KSlcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgc3RhdGVFbGVtZW50LnNldFByb3BlcnR5VmFsdWVDb3JlSGFuZGxlciA9IHVuZGVmaW5lZDtcbiAgICAgICAgc3RhdGVFbGVtZW50Lml0ZXJhdGVQcm9wZXJ0aWVzSGFzaChmdW5jdGlvbiAoaGFzaCwga2V5KSB7XG4gICAgICAgICAgICB2YXIgdmFsID0gaGFzaFtrZXldO1xuICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsKSkge1xuICAgICAgICAgICAgICAgIHZhciB2YWwgPSB2YWw7XG4gICAgICAgICAgICAgICAgdmFsW1wib25BcnJheUNoYW5nZWRcIl0gPSBmdW5jdGlvbiAoKSB7IH07XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleUVsZW1lbnRCYXNlO1xufShleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiQ29tcG9uZW50XCJdKSk7XG5cbnZhciBSZWFjdFN1cnZleUVsZW1lbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgX19leHRlbmRzKFJlYWN0U3VydmV5RWxlbWVudCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBSZWFjdFN1cnZleUVsZW1lbnQocHJvcHMpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmVhY3RTdXJ2ZXlFbGVtZW50LnByb3RvdHlwZSwgXCJjc3NDbGFzc2VzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5jc3NDbGFzc2VzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIFJlYWN0U3VydmV5RWxlbWVudDtcbn0ocmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleUVsZW1lbnRCYXNlKSk7XG5cbnZhciByZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5UXVlc3Rpb25FbGVtZW50QmFzZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBfX2V4dGVuZHMoU3VydmV5UXVlc3Rpb25FbGVtZW50QmFzZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlRdWVzdGlvbkVsZW1lbnRCYXNlKHByb3BzKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICB9XG4gICAgU3VydmV5UXVlc3Rpb25FbGVtZW50QmFzZS5wcm90b3R5cGUuY29tcG9uZW50RGlkVXBkYXRlID0gZnVuY3Rpb24gKHByZXZQcm9wcywgcHJldlN0YXRlKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50RGlkVXBkYXRlLmNhbGwodGhpcywgcHJldlByb3BzLCBwcmV2U3RhdGUpO1xuICAgICAgICB0aGlzLnVwZGF0ZURvbUVsZW1lbnQoKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uRWxlbWVudEJhc2UucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMudXBkYXRlRG9tRWxlbWVudCgpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25FbGVtZW50QmFzZS5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKCEhdGhpcy5xdWVzdGlvbkJhc2UpIHtcbiAgICAgICAgICAgIHZhciBjb250ZW50RWxlbWVudCA9IHRoaXMuY29udGVudCB8fCB0aGlzLmNvbnRyb2w7XG4gICAgICAgICAgICB0aGlzLnF1ZXN0aW9uQmFzZS5iZWZvcmVEZXN0cm95UXVlc3Rpb25FbGVtZW50KGNvbnRlbnRFbGVtZW50KTtcbiAgICAgICAgICAgIGlmICghIWNvbnRlbnRFbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgY29udGVudEVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1yZW5kZXJlZFwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25FbGVtZW50QmFzZS5wcm90b3R5cGUudXBkYXRlRG9tRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNvbnRlbnRFbGVtZW50ID0gdGhpcy5jb250ZW50IHx8IHRoaXMuY29udHJvbDtcbiAgICAgICAgaWYgKCEhY29udGVudEVsZW1lbnQpIHtcbiAgICAgICAgICAgIGlmIChjb250ZW50RWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJkYXRhLXJlbmRlcmVkXCIpICE9PSBcInJcIikge1xuICAgICAgICAgICAgICAgIGNvbnRlbnRFbGVtZW50LnNldEF0dHJpYnV0ZShcImRhdGEtcmVuZGVyZWRcIiwgXCJyXCIpO1xuICAgICAgICAgICAgICAgIHRoaXMucXVlc3Rpb25CYXNlLmFmdGVyUmVuZGVyUXVlc3Rpb25FbGVtZW50KGNvbnRlbnRFbGVtZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uRWxlbWVudEJhc2UucHJvdG90eXBlLCBcInF1ZXN0aW9uQmFzZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMucXVlc3Rpb247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkVsZW1lbnRCYXNlLnByb3RvdHlwZS5nZXRSZW5kZXJlZEVsZW1lbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gW3RoaXMucXVlc3Rpb25CYXNlXTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbkVsZW1lbnRCYXNlLnByb3RvdHlwZSwgXCJjcmVhdG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5jcmVhdG9yO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3VydmV5UXVlc3Rpb25FbGVtZW50QmFzZS5wcm90b3R5cGUuY2FuUmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gISF0aGlzLnF1ZXN0aW9uQmFzZSAmJiAhIXRoaXMuY3JlYXRvcjtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uRWxlbWVudEJhc2UucHJvdG90eXBlLnNob3VsZENvbXBvbmVudFVwZGF0ZSA9IGZ1bmN0aW9uIChuZXh0UHJvcHMsIG5leHRTdGF0ZSkge1xuICAgICAgICBpZiAoIV9zdXBlci5wcm90b3R5cGUuc2hvdWxkQ29tcG9uZW50VXBkYXRlLmNhbGwodGhpcywgbmV4dFByb3BzLCBuZXh0U3RhdGUpKVxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICByZXR1cm4gKCF0aGlzLnF1ZXN0aW9uQmFzZS5jdXN0b21XaWRnZXQgfHxcbiAgICAgICAgICAgICEhdGhpcy5xdWVzdGlvbkJhc2UuY3VzdG9tV2lkZ2V0RGF0YS5pc05lZWRSZW5kZXIgfHxcbiAgICAgICAgICAgICEhdGhpcy5xdWVzdGlvbkJhc2UuY3VzdG9tV2lkZ2V0LndpZGdldEpzb24uaXNEZWZhdWx0UmVuZGVyIHx8XG4gICAgICAgICAgICAhIXRoaXMucXVlc3Rpb25CYXNlLmN1c3RvbVdpZGdldC53aWRnZXRKc29uLnJlbmRlcik7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25FbGVtZW50QmFzZS5wcm90b3R5cGUsIFwiaXNEaXNwbGF5TW9kZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHByb3BzID0gdGhpcy5wcm9wcztcbiAgICAgICAgICAgIHJldHVybiAocHJvcHMuaXNEaXNwbGF5TW9kZSB8fFxuICAgICAgICAgICAgICAgICghIXRoaXMucXVlc3Rpb25CYXNlICYmIHRoaXMucXVlc3Rpb25CYXNlLmlzSW5wdXRSZWFkT25seSkgfHwgZmFsc2UpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3VydmV5UXVlc3Rpb25FbGVtZW50QmFzZS5wcm90b3R5cGUud3JhcENlbGwgPSBmdW5jdGlvbiAoY2VsbCwgZWxlbWVudCwgcmVhc29uKSB7XG4gICAgICAgIGlmICghcmVhc29uKSB7XG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc3VydmV5ID0gdGhpcy5xdWVzdGlvbkJhc2VcbiAgICAgICAgICAgIC5zdXJ2ZXk7XG4gICAgICAgIHZhciB3cmFwcGVyID0gbnVsbDtcbiAgICAgICAgaWYgKHN1cnZleSkge1xuICAgICAgICAgICAgd3JhcHBlciA9IHJlYWN0c3VydmV5bW9kZWxfUmVhY3RTdXJ2ZXlFbGVtZW50c1dyYXBwZXIud3JhcE1hdHJpeENlbGwoc3VydmV5LCBlbGVtZW50LCBjZWxsLCByZWFzb24pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB3cmFwcGVyICE9PSBudWxsICYmIHdyYXBwZXIgIT09IHZvaWQgMCA/IHdyYXBwZXIgOiBlbGVtZW50O1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25FbGVtZW50QmFzZS5wcm90b3R5cGUuc2V0Q29udHJvbCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgIGlmICghIWVsZW1lbnQpIHtcbiAgICAgICAgICAgIHRoaXMuY29udHJvbCA9IGVsZW1lbnQ7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uRWxlbWVudEJhc2UucHJvdG90eXBlLnNldENvbnRlbnQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICBpZiAoISFlbGVtZW50KSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRlbnQgPSBlbGVtZW50O1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5UXVlc3Rpb25FbGVtZW50QmFzZTtcbn0ocmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleUVsZW1lbnRCYXNlKSk7XG5cbnZhciByZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5UXVlc3Rpb25VbmNvbnRyb2xsZWRFbGVtZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIF9fZXh0ZW5kcyhTdXJ2ZXlRdWVzdGlvblVuY29udHJvbGxlZEVsZW1lbnQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UXVlc3Rpb25VbmNvbnRyb2xsZWRFbGVtZW50KHByb3BzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy51cGRhdGVWYWx1ZU9uRXZlbnQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIGlmICghZXh0ZXJuYWxfcm9vdF9TdXJ2ZXlfY29tbW9uanMyX3N1cnZleV9jb3JlX2NvbW1vbmpzX3N1cnZleV9jb3JlX2FtZF9zdXJ2ZXlfY29yZV9bXCJIZWxwZXJzXCJdLmlzVHdvVmFsdWVFcXVhbHMoX3RoaXMucXVlc3Rpb25CYXNlLnZhbHVlLCBldmVudC50YXJnZXQudmFsdWUsIGZhbHNlLCB0cnVlLCBmYWxzZSkpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5zZXRWYWx1ZUNvcmUoZXZlbnQudGFyZ2V0LnZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMudXBkYXRlVmFsdWVPbkV2ZW50ID0gX3RoaXMudXBkYXRlVmFsdWVPbkV2ZW50LmJpbmQoX3RoaXMpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvblVuY29udHJvbGxlZEVsZW1lbnQucHJvdG90eXBlLCBcInF1ZXN0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5xdWVzdGlvbkJhc2U7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlRdWVzdGlvblVuY29udHJvbGxlZEVsZW1lbnQucHJvdG90eXBlLnNldFZhbHVlQ29yZSA9IGZ1bmN0aW9uIChuZXdWYWx1ZSkge1xuICAgICAgICB0aGlzLnF1ZXN0aW9uQmFzZS52YWx1ZSA9IG5ld1ZhbHVlO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25VbmNvbnRyb2xsZWRFbGVtZW50LnByb3RvdHlwZS5nZXRWYWx1ZUNvcmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnF1ZXN0aW9uQmFzZS52YWx1ZTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uVW5jb250cm9sbGVkRWxlbWVudC5wcm90b3R5cGUudXBkYXRlRG9tRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCEhdGhpcy5jb250cm9sKSB7XG4gICAgICAgICAgICB2YXIgY29udHJvbCA9IHRoaXMuY29udHJvbDtcbiAgICAgICAgICAgIHZhciBuZXdWYWx1ZSA9IHRoaXMuZ2V0VmFsdWVDb3JlKCk7XG4gICAgICAgICAgICBpZiAoIWV4dGVybmFsX3Jvb3RfU3VydmV5X2NvbW1vbmpzMl9zdXJ2ZXlfY29yZV9jb21tb25qc19zdXJ2ZXlfY29yZV9hbWRfc3VydmV5X2NvcmVfW1wiSGVscGVyc1wiXS5pc1R3b1ZhbHVlRXF1YWxzKG5ld1ZhbHVlLCBjb250cm9sLnZhbHVlLCBmYWxzZSwgdHJ1ZSwgZmFsc2UpKSB7XG4gICAgICAgICAgICAgICAgY29udHJvbC52YWx1ZSA9IHRoaXMuZ2V0VmFsdWUobmV3VmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUudXBkYXRlRG9tRWxlbWVudC5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25VbmNvbnRyb2xsZWRFbGVtZW50LnByb3RvdHlwZS5nZXRWYWx1ZSA9IGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgaWYgKGV4dGVybmFsX3Jvb3RfU3VydmV5X2NvbW1vbmpzMl9zdXJ2ZXlfY29yZV9jb21tb25qc19zdXJ2ZXlfY29yZV9hbWRfc3VydmV5X2NvcmVfW1wiSGVscGVyc1wiXS5pc1ZhbHVlRW1wdHkodmFsKSlcbiAgICAgICAgICAgIHJldHVybiBcIlwiO1xuICAgICAgICByZXR1cm4gdmFsO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVF1ZXN0aW9uVW5jb250cm9sbGVkRWxlbWVudDtcbn0ocmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleVF1ZXN0aW9uRWxlbWVudEJhc2UpKTtcblxuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvZWxlbWVudC50c3hcbnZhciBlbGVtZW50X2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cblxudmFyIGVsZW1lbnRfU3VydmV5Um93RWxlbWVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBlbGVtZW50X2V4dGVuZHMoU3VydmV5Um93RWxlbWVudCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlSb3dFbGVtZW50KHByb3BzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5lbGVtZW50LmNzc0NsYXNzZXM7XG4gICAgICAgIF90aGlzLnJvb3RSZWYgPSBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlUmVmXCJdKCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgU3VydmV5Um93RWxlbWVudC5wcm90b3R5cGUuZ2V0U3RhdGVFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5lbGVtZW50O1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVJvd0VsZW1lbnQucHJvdG90eXBlLCBcImVsZW1lbnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLmVsZW1lbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5Um93RWxlbWVudC5wcm90b3R5cGUsIFwiaW5kZXhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLmluZGV4O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVJvd0VsZW1lbnQucHJvdG90eXBlLCBcInJvd1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMucm93O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVJvd0VsZW1lbnQucHJvdG90eXBlLCBcInN1cnZleVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuc3VydmV5O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVJvd0VsZW1lbnQucHJvdG90eXBlLCBcImNyZWF0b3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLmNyZWF0b3I7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5Um93RWxlbWVudC5wcm90b3R5cGUsIFwiY3NzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5jc3M7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlSb3dFbGVtZW50LnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudC5jYWxsKHRoaXMpO1xuICAgICAgICBpZiAodGhpcy5yb290UmVmLmN1cnJlbnQpIHtcbiAgICAgICAgICAgICh0aGlzLmVsZW1lbnQpLnNldFdyYXBwZXJFbGVtZW50KHRoaXMucm9vdFJlZi5jdXJyZW50KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3VydmV5Um93RWxlbWVudC5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5lbGVtZW50LnNldFdyYXBwZXJFbGVtZW50KHVuZGVmaW5lZCk7XG4gICAgfTtcbiAgICBTdXJ2ZXlSb3dFbGVtZW50LnByb3RvdHlwZS5zaG91bGRDb21wb25lbnRVcGRhdGUgPSBmdW5jdGlvbiAobmV4dFByb3BzLCBuZXh0U3RhdGUpIHtcbiAgICAgICAgaWYgKCFfc3VwZXIucHJvdG90eXBlLnNob3VsZENvbXBvbmVudFVwZGF0ZS5jYWxsKHRoaXMsIG5leHRQcm9wcywgbmV4dFN0YXRlKSlcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgaWYgKG5leHRQcm9wcy5lbGVtZW50ICE9PSB0aGlzLmVsZW1lbnQpIHtcbiAgICAgICAgICAgIGlmIChuZXh0UHJvcHMuZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIG5leHRQcm9wcy5lbGVtZW50LnNldFdyYXBwZXJFbGVtZW50KHRoaXMucm9vdFJlZi5jdXJyZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmVsZW1lbnQuc2V0V3JhcHBlckVsZW1lbnQodW5kZWZpbmVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aGlzLmVsZW1lbnQuY3NzQ2xhc3NlcztcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBTdXJ2ZXlSb3dFbGVtZW50LnByb3RvdHlwZS5yZW5kZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZWxlbWVudCA9IHRoaXMuZWxlbWVudDtcbiAgICAgICAgdmFyIGlubmVyRWxlbWVudCA9IHRoaXMuY3JlYXRlRWxlbWVudChlbGVtZW50LCB0aGlzLmluZGV4KTtcbiAgICAgICAgdmFyIGNzcyA9IGVsZW1lbnQuY3NzQ2xhc3Nlc1ZhbHVlO1xuICAgICAgICB2YXIgZm9jdXNJbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHZhciBlbCA9IGVsZW1lbnQ7XG4gICAgICAgICAgICBpZiAoZWwgJiYgZWwuaXNRdWVzdGlvbikge1xuICAgICAgICAgICAgICAgIGVsLmZvY3VzSW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogY3NzLnF1ZXN0aW9uV3JhcHBlciwgc3R5bGU6IGVsZW1lbnQucm9vdFN0eWxlLCBcImRhdGEta2V5XCI6IGlubmVyRWxlbWVudC5rZXksIGtleTogaW5uZXJFbGVtZW50LmtleSwgb25Gb2N1czogZm9jdXNJbiwgcmVmOiB0aGlzLnJvb3RSZWYgfSwgdGhpcy5yb3cuaXNOZWVkUmVuZGVyID8gaW5uZXJFbGVtZW50IDogUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5jcmVhdGVFbGVtZW50KGVsZW1lbnQuc2tlbGV0b25Db21wb25lbnROYW1lLCB7IGVsZW1lbnQ6IGVsZW1lbnQsIGNzczogdGhpcy5jc3MsIH0pKSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlSb3dFbGVtZW50LnByb3RvdHlwZS5jcmVhdGVFbGVtZW50ID0gZnVuY3Rpb24gKGVsZW1lbnQsIGVsZW1lbnRJbmRleCkge1xuICAgICAgICB2YXIgaW5kZXggPSBlbGVtZW50SW5kZXggPyBcIi1cIiArIGVsZW1lbnRJbmRleCA6IDA7XG4gICAgICAgIHZhciBlbGVtZW50VHlwZSA9IGVsZW1lbnQuZ2V0VHlwZSgpO1xuICAgICAgICBpZiAoIVJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UuaXNFbGVtZW50UmVnaXN0ZXJlZChlbGVtZW50VHlwZSkpIHtcbiAgICAgICAgICAgIGVsZW1lbnRUeXBlID0gXCJxdWVzdGlvblwiO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBSZWFjdEVsZW1lbnRGYWN0b3J5Lkluc3RhbmNlLmNyZWF0ZUVsZW1lbnQoZWxlbWVudFR5cGUsIHtcbiAgICAgICAgICAgIGtleTogZWxlbWVudC5uYW1lICsgaW5kZXgsXG4gICAgICAgICAgICBlbGVtZW50OiBlbGVtZW50LFxuICAgICAgICAgICAgY3JlYXRvcjogdGhpcy5jcmVhdG9yLFxuICAgICAgICAgICAgc3VydmV5OiB0aGlzLnN1cnZleSxcbiAgICAgICAgICAgIGNzczogdGhpcy5jc3MsXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVJvd0VsZW1lbnQ7XG59KHJlYWN0cXVlc3Rpb25fZWxlbWVudF9TdXJ2ZXlFbGVtZW50QmFzZSkpO1xuXG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9yb3cudHN4XG52YXIgcm93X2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cblxuXG5cbnZhciByb3dfU3VydmV5Um93ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJvd19leHRlbmRzKFN1cnZleVJvdywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlSb3cocHJvcHMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnJvb3RSZWYgPSBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlUmVmXCJdKCk7XG4gICAgICAgIF90aGlzLnJlY2FsY3VsYXRlQ3NzKCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgU3VydmV5Um93LnByb3RvdHlwZS5yZWNhbGN1bGF0ZUNzcyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5yb3cudmlzaWJsZUVsZW1lbnRzLm1hcChmdW5jdGlvbiAoZWxlbWVudCkgeyByZXR1cm4gZWxlbWVudC5jc3NDbGFzc2VzOyB9KTtcbiAgICB9O1xuICAgIFN1cnZleVJvdy5wcm90b3R5cGUuZ2V0U3RhdGVFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yb3c7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5Um93LnByb3RvdHlwZSwgXCJyb3dcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLnJvdztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlSb3cucHJvdG90eXBlLCBcInN1cnZleVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuc3VydmV5O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVJvdy5wcm90b3R5cGUsIFwiY3JlYXRvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuY3JlYXRvcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlSb3cucHJvdG90eXBlLCBcImNzc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuY3NzO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3VydmV5Um93LnByb3RvdHlwZS5jYW5SZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAhIXRoaXMucm93ICYmICEhdGhpcy5zdXJ2ZXkgJiYgISF0aGlzLmNyZWF0b3I7XG4gICAgfTtcbiAgICBTdXJ2ZXlSb3cucHJvdG90eXBlLnJlbmRlckVsZW1lbnRDb250ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgZWxlbWVudHMgPSB0aGlzLnJvdy52aXNpYmxlRWxlbWVudHMubWFwKGZ1bmN0aW9uIChlbGVtZW50LCBlbGVtZW50SW5kZXgpIHtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IGVsZW1lbnRJbmRleCA/IFwiLVwiICsgZWxlbWVudEluZGV4IDogMDtcbiAgICAgICAgICAgIHZhciBrZXkgPSBlbGVtZW50Lm5hbWUgKyBpbmRleDtcbiAgICAgICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oZWxlbWVudF9TdXJ2ZXlSb3dFbGVtZW50LCB7IGVsZW1lbnQ6IGVsZW1lbnQsIGluZGV4OiBlbGVtZW50SW5kZXgsIHJvdzogX3RoaXMucm93LCBzdXJ2ZXk6IF90aGlzLnN1cnZleSwgY3JlYXRvcjogX3RoaXMuY3JlYXRvciwgY3NzOiBfdGhpcy5jc3MsIGtleToga2V5IH0pKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyByZWY6IHRoaXMucm9vdFJlZiwgY2xhc3NOYW1lOiB0aGlzLnJvdy5nZXRSb3dDc3MoKSB9LCBlbGVtZW50cykpO1xuICAgIH07XG4gICAgU3VydmV5Um93LnByb3RvdHlwZS5yZW5kZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc3VydmV5ID0gdGhpcy5zdXJ2ZXk7XG4gICAgICAgIHZhciBjb250ZW50ID0gdGhpcy5yZW5kZXJFbGVtZW50Q29udGVudCgpO1xuICAgICAgICB2YXIgd3JhcHBlciA9IHJlYWN0c3VydmV5bW9kZWxfUmVhY3RTdXJ2ZXlFbGVtZW50c1dyYXBwZXIud3JhcFJvdyhzdXJ2ZXksIGNvbnRlbnQsIHRoaXMucm93KTtcbiAgICAgICAgcmV0dXJuIHdyYXBwZXIgfHwgY29udGVudDtcbiAgICB9O1xuICAgIFN1cnZleVJvdy5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQuY2FsbCh0aGlzKTtcbiAgICAgICAgdmFyIGVsID0gdGhpcy5yb290UmVmLmN1cnJlbnQ7XG4gICAgICAgIGlmICh0aGlzLnJvb3RSZWYuY3VycmVudCkge1xuICAgICAgICAgICAgdGhpcy5yb3cuc2V0Um9vdEVsZW1lbnQodGhpcy5yb290UmVmLmN1cnJlbnQpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghIWVsICYmICF0aGlzLnJvdy5pc05lZWRSZW5kZXIpIHtcbiAgICAgICAgICAgIHZhciByb3dDb250YWluZXJEaXYgPSBlbDtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIF90aGlzLnJvdy5zdGFydExhenlSZW5kZXJpbmcocm93Q29udGFpbmVyRGl2KTtcbiAgICAgICAgICAgIH0sIDEwKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3VydmV5Um93LnByb3RvdHlwZS5zaG91bGRDb21wb25lbnRVcGRhdGUgPSBmdW5jdGlvbiAobmV4dFByb3BzLCBuZXh0U3RhdGUpIHtcbiAgICAgICAgaWYgKCFfc3VwZXIucHJvdG90eXBlLnNob3VsZENvbXBvbmVudFVwZGF0ZS5jYWxsKHRoaXMsIG5leHRQcm9wcywgbmV4dFN0YXRlKSlcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgaWYgKG5leHRQcm9wcy5yb3cgIT09IHRoaXMucm93KSB7XG4gICAgICAgICAgICBuZXh0UHJvcHMucm93LmlzTmVlZFJlbmRlciA9IHRoaXMucm93LmlzTmVlZFJlbmRlcjtcbiAgICAgICAgICAgIG5leHRQcm9wcy5yb3cuc2V0Um9vdEVsZW1lbnQodGhpcy5yb290UmVmLmN1cnJlbnQpO1xuICAgICAgICAgICAgdGhpcy5yb3cuc2V0Um9vdEVsZW1lbnQodW5kZWZpbmVkKTtcbiAgICAgICAgICAgIHRoaXMuc3RvcExhenlSZW5kZXJpbmcoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlY2FsY3VsYXRlQ3NzKCk7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgU3VydmV5Um93LnByb3RvdHlwZS5zdG9wTGF6eVJlbmRlcmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5yb3cuc3RvcExhenlSZW5kZXJpbmcoKTtcbiAgICAgICAgdGhpcy5yb3cuaXNOZWVkUmVuZGVyID0gIXRoaXMucm93LmlzTGF6eVJlbmRlcmluZygpO1xuICAgIH07XG4gICAgU3VydmV5Um93LnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudC5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLnJvdy5zZXRSb290RWxlbWVudCh1bmRlZmluZWQpO1xuICAgICAgICB0aGlzLnN0b3BMYXp5UmVuZGVyaW5nKCk7XG4gICAgfTtcbiAgICBTdXJ2ZXlSb3cucHJvdG90eXBlLmNyZWF0ZUVsZW1lbnQgPSBmdW5jdGlvbiAoZWxlbWVudCwgZWxlbWVudEluZGV4KSB7XG4gICAgICAgIHZhciBpbmRleCA9IGVsZW1lbnRJbmRleCA/IFwiLVwiICsgZWxlbWVudEluZGV4IDogMDtcbiAgICAgICAgdmFyIGVsZW1lbnRUeXBlID0gZWxlbWVudC5nZXRUeXBlKCk7XG4gICAgICAgIGlmICghUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5pc0VsZW1lbnRSZWdpc3RlcmVkKGVsZW1lbnRUeXBlKSkge1xuICAgICAgICAgICAgZWxlbWVudFR5cGUgPSBcInF1ZXN0aW9uXCI7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UuY3JlYXRlRWxlbWVudChlbGVtZW50VHlwZSwge1xuICAgICAgICAgICAga2V5OiBlbGVtZW50Lm5hbWUgKyBpbmRleCxcbiAgICAgICAgICAgIGVsZW1lbnQ6IGVsZW1lbnQsXG4gICAgICAgICAgICBjcmVhdG9yOiB0aGlzLmNyZWF0b3IsXG4gICAgICAgICAgICBzdXJ2ZXk6IHRoaXMuc3VydmV5LFxuICAgICAgICAgICAgY3NzOiB0aGlzLmNzcyxcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5Um93O1xufShyZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5RWxlbWVudEJhc2UpKTtcblxuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvcGFuZWwtYmFzZS50c3hcbnZhciBwYW5lbF9iYXNlX2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cblxudmFyIHBhbmVsX2Jhc2VfU3VydmV5UGFuZWxCYXNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHBhbmVsX2Jhc2VfZXh0ZW5kcyhTdXJ2ZXlQYW5lbEJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UGFuZWxCYXNlKHByb3BzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5yb290UmVmID0gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZVJlZlwiXSgpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFN1cnZleVBhbmVsQmFzZS5wcm90b3R5cGUuZ2V0U3RhdGVFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wYW5lbEJhc2U7XG4gICAgfTtcbiAgICBTdXJ2ZXlQYW5lbEJhc2UucHJvdG90eXBlLmNhblVzZVByb3BJblN0YXRlID0gZnVuY3Rpb24gKGtleSkge1xuICAgICAgICByZXR1cm4ga2V5ICE9PSBcImVsZW1lbnRzXCIgJiYgX3N1cGVyLnByb3RvdHlwZS5jYW5Vc2VQcm9wSW5TdGF0ZS5jYWxsKHRoaXMsIGtleSk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UGFuZWxCYXNlLnByb3RvdHlwZSwgXCJzdXJ2ZXlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFN1cnZleSgpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVBhbmVsQmFzZS5wcm90b3R5cGUsIFwiY3JlYXRvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuY3JlYXRvcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlQYW5lbEJhc2UucHJvdG90eXBlLCBcImNzc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q3NzKCk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UGFuZWxCYXNlLnByb3RvdHlwZSwgXCJwYW5lbEJhc2VcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmdldFBhbmVsQmFzZSgpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3VydmV5UGFuZWxCYXNlLnByb3RvdHlwZS5nZXRQYW5lbEJhc2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BzLmVsZW1lbnQgfHwgdGhpcy5wcm9wcy5xdWVzdGlvbjtcbiAgICB9O1xuICAgIFN1cnZleVBhbmVsQmFzZS5wcm90b3R5cGUuZ2V0U3VydmV5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKHRoaXMucHJvcHMuc3VydmV5IHx8ICghIXRoaXMucGFuZWxCYXNlID8gdGhpcy5wYW5lbEJhc2Uuc3VydmV5IDogbnVsbCkpO1xuICAgIH07XG4gICAgU3VydmV5UGFuZWxCYXNlLnByb3RvdHlwZS5nZXRDc3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BzLmNzcztcbiAgICB9O1xuICAgIFN1cnZleVBhbmVsQmFzZS5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5kb0FmdGVyUmVuZGVyKCk7XG4gICAgfTtcbiAgICBTdXJ2ZXlQYW5lbEJhc2UucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50LmNhbGwodGhpcyk7XG4gICAgICAgIHZhciBlbCA9IHRoaXMucm9vdFJlZi5jdXJyZW50O1xuICAgICAgICBpZiAoISFlbCkge1xuICAgICAgICAgICAgZWwucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1yZW5kZXJlZFwiKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3VydmV5UGFuZWxCYXNlLnByb3RvdHlwZS5jb21wb25lbnREaWRVcGRhdGUgPSBmdW5jdGlvbiAocHJldlByb3BzLCBwcmV2U3RhdGUpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jb21wb25lbnREaWRVcGRhdGUuY2FsbCh0aGlzLCBwcmV2UHJvcHMsIHByZXZTdGF0ZSk7XG4gICAgICAgIGlmICghIXByZXZQcm9wcy5wYWdlICYmXG4gICAgICAgICAgICAhIXRoaXMuc3VydmV5ICYmXG4gICAgICAgICAgICAhIXRoaXMuc3VydmV5LmFjdGl2ZVBhZ2UgJiZcbiAgICAgICAgICAgIHByZXZQcm9wcy5wYWdlLmlkID09PSB0aGlzLnN1cnZleS5hY3RpdmVQYWdlLmlkKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLmRvQWZ0ZXJSZW5kZXIoKTtcbiAgICB9O1xuICAgIFN1cnZleVBhbmVsQmFzZS5wcm90b3R5cGUuZG9BZnRlclJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGVsID0gdGhpcy5yb290UmVmLmN1cnJlbnQ7XG4gICAgICAgIGlmIChlbCAmJiB0aGlzLnN1cnZleSkge1xuICAgICAgICAgICAgaWYgKHRoaXMucGFuZWxCYXNlLmlzUGFuZWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN1cnZleS5hZnRlclJlbmRlclBhbmVsKHRoaXMucGFuZWxCYXNlLCBlbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN1cnZleS5hZnRlclJlbmRlclBhZ2UoZWwpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBTdXJ2ZXlQYW5lbEJhc2UucHJvdG90eXBlLmdldElzVmlzaWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucGFuZWxCYXNlLmlzVmlzaWJsZTtcbiAgICB9O1xuICAgIFN1cnZleVBhbmVsQmFzZS5wcm90b3R5cGUuY2FuUmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKF9zdXBlci5wcm90b3R5cGUuY2FuUmVuZGVyLmNhbGwodGhpcykgJiYgISF0aGlzLnN1cnZleSAmJiAhIXRoaXMucGFuZWxCYXNlICYmICEhdGhpcy5wYW5lbEJhc2Uuc3VydmV5ICYmIHRoaXMuZ2V0SXNWaXNpYmxlKCkpO1xuICAgIH07XG4gICAgU3VydmV5UGFuZWxCYXNlLnByb3RvdHlwZS5yZW5kZXJSb3dzID0gZnVuY3Rpb24gKGNzcykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gdGhpcy5wYW5lbEJhc2UudmlzaWJsZVJvd3MubWFwKGZ1bmN0aW9uIChyb3cpIHsgcmV0dXJuIF90aGlzLmNyZWF0ZVJvdyhyb3csIGNzcyk7IH0pO1xuICAgIH07XG4gICAgU3VydmV5UGFuZWxCYXNlLnByb3RvdHlwZS5jcmVhdGVSb3cgPSBmdW5jdGlvbiAocm93LCBjc3MpIHtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyb3dfU3VydmV5Um93LCB7IGtleTogcm93LmlkLCByb3c6IHJvdywgc3VydmV5OiB0aGlzLnN1cnZleSwgY3JlYXRvcjogdGhpcy5jcmVhdG9yLCBjc3M6IGNzcyB9KSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5UGFuZWxCYXNlO1xufShyZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5RWxlbWVudEJhc2UpKTtcblxuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvY29tcG9uZW50cy9zdmctaWNvbi9zdmctaWNvbi50c3hcbnZhciBzdmdfaWNvbl9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cbnZhciBzdmdfaWNvbl9TdmdJY29uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHN2Z19pY29uX2V4dGVuZHMoU3ZnSWNvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdmdJY29uKHByb3BzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5zdmdJY29uUmVmID0gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVSZWYoKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBTdmdJY29uLnByb3RvdHlwZS51cGRhdGVTdmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnByb3BzLmljb25OYW1lKVxuICAgICAgICAgICAgT2JqZWN0KGV4dGVybmFsX3Jvb3RfU3VydmV5X2NvbW1vbmpzMl9zdXJ2ZXlfY29yZV9jb21tb25qc19zdXJ2ZXlfY29yZV9hbWRfc3VydmV5X2NvcmVfW1wiY3JlYXRlU3ZnXCJdKSh0aGlzLnByb3BzLnNpemUsIHRoaXMucHJvcHMud2lkdGgsIHRoaXMucHJvcHMuaGVpZ2h0LCB0aGlzLnByb3BzLmljb25OYW1lLCB0aGlzLnN2Z0ljb25SZWYuY3VycmVudCwgdGhpcy5wcm9wcy50aXRsZSk7XG4gICAgfTtcbiAgICBTdmdJY29uLnByb3RvdHlwZS5jb21wb25lbnREaWRVcGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMudXBkYXRlU3ZnKCk7XG4gICAgfTtcbiAgICBTdmdJY29uLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjbGFzc05hbWUgPSBcInN2LXN2Zy1pY29uXCI7XG4gICAgICAgIGlmICh0aGlzLnByb3BzLmNsYXNzTmFtZSkge1xuICAgICAgICAgICAgY2xhc3NOYW1lICs9IFwiIFwiICsgdGhpcy5wcm9wcy5jbGFzc05hbWU7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuICh0aGlzLnByb3BzLmljb25OYW1lID9cbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcInN2Z1wiLCB7IGNsYXNzTmFtZTogY2xhc3NOYW1lLCBzdHlsZTogdGhpcy5wcm9wcy5zdHlsZSwgb25DbGljazogdGhpcy5wcm9wcy5vbkNsaWNrLCByZWY6IHRoaXMuc3ZnSWNvblJlZiwgcm9sZTogXCJpbWdcIiB9LFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcInVzZVwiLCBudWxsKSlcbiAgICAgICAgICAgIDogbnVsbCk7XG4gICAgfTtcbiAgICBTdmdJY29uLnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy51cGRhdGVTdmcoKTtcbiAgICB9O1xuICAgIHJldHVybiBTdmdJY29uO1xufShleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLkNvbXBvbmVudCkpO1xuXG5SZWFjdEVsZW1lbnRGYWN0b3J5Lkluc3RhbmNlLnJlZ2lzdGVyRWxlbWVudChcInN2LXN2Zy1pY29uXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoc3ZnX2ljb25fU3ZnSWNvbiwgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9jb21wb25lbnRzL2FjdGlvbi1iYXIvYWN0aW9uLWJhci1zZXBhcmF0b3IudHN4XG52YXIgYWN0aW9uX2Jhcl9zZXBhcmF0b3JfZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxudmFyIGFjdGlvbl9iYXJfc2VwYXJhdG9yX1N1cnZleUFjdGlvbkJhclNlcGFyYXRvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBhY3Rpb25fYmFyX3NlcGFyYXRvcl9leHRlbmRzKFN1cnZleUFjdGlvbkJhclNlcGFyYXRvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlBY3Rpb25CYXJTZXBhcmF0b3IocHJvcHMpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTdXJ2ZXlBY3Rpb25CYXJTZXBhcmF0b3IucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNsYXNzTmFtZSA9IFwic3YtYWN0aW9uLWJhci1zZXBhcmF0b3IgXCIgKyB0aGlzLnByb3BzLmNzc0NsYXNzZXM7XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IGNsYXNzTmFtZSB9KTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlBY3Rpb25CYXJTZXBhcmF0b3I7XG59KGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuQ29tcG9uZW50KSk7XG5cblJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJFbGVtZW50KFwic3YtYWN0aW9uLWJhci1zZXBhcmF0b3JcIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChhY3Rpb25fYmFyX3NlcGFyYXRvcl9TdXJ2ZXlBY3Rpb25CYXJTZXBhcmF0b3IsIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvY29tcG9uZW50cy9hY3Rpb24tYmFyL2FjdGlvbi1iYXItaXRlbS50c3hcbnZhciBhY3Rpb25fYmFyX2l0ZW1fZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG5cblxuXG52YXIgYWN0aW9uX2Jhcl9pdGVtX1N1cnZleUFjdGlvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBhY3Rpb25fYmFyX2l0ZW1fZXh0ZW5kcyhTdXJ2ZXlBY3Rpb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5QWN0aW9uKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlBY3Rpb24ucHJvdG90eXBlLCBcIml0ZW1cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLml0ZW07XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlBY3Rpb24ucHJvdG90eXBlLmdldFN0YXRlRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlbTtcbiAgICB9O1xuICAgIFN1cnZleUFjdGlvbi5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgLy9yZWZhY3RvclxuICAgICAgICB2YXIgaXRlbUNsYXNzID0gdGhpcy5pdGVtLmdldEFjdGlvblJvb3RDc3MoKTtcbiAgICAgICAgdmFyIHNlcGFyYXRvciA9IHRoaXMuaXRlbS5uZWVkU2VwYXJhdG9yID8gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChhY3Rpb25fYmFyX3NlcGFyYXRvcl9TdXJ2ZXlBY3Rpb25CYXJTZXBhcmF0b3IsIG51bGwpKSA6IG51bGw7XG4gICAgICAgIHZhciBpdGVtQ29tcG9uZW50ID0gUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5jcmVhdGVFbGVtZW50KHRoaXMuaXRlbS5jb21wb25lbnQgfHwgXCJzdi1hY3Rpb24tYmFyLWl0ZW1cIiwge1xuICAgICAgICAgICAgaXRlbTogdGhpcy5pdGVtLFxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IGl0ZW1DbGFzcywgaWQ6IHRoaXMuaXRlbS5pZCB9LFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN2LWFjdGlvbl9fY29udGVudFwiIH0sXG4gICAgICAgICAgICAgICAgc2VwYXJhdG9yLFxuICAgICAgICAgICAgICAgIGl0ZW1Db21wb25lbnQpKSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5QWN0aW9uO1xufShyZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5RWxlbWVudEJhc2UpKTtcblxudmFyIGFjdGlvbl9iYXJfaXRlbV9TdXJ2ZXlBY3Rpb25CYXJJdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIGFjdGlvbl9iYXJfaXRlbV9leHRlbmRzKFN1cnZleUFjdGlvbkJhckl0ZW0sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5QWN0aW9uQmFySXRlbSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5QWN0aW9uQmFySXRlbS5wcm90b3R5cGUsIFwiaXRlbVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuaXRlbTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleUFjdGlvbkJhckl0ZW0ucHJvdG90eXBlLmdldFN0YXRlRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlbTtcbiAgICB9O1xuICAgIFN1cnZleUFjdGlvbkJhckl0ZW0ucHJvdG90eXBlLnJlbmRlckVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5GcmFnbWVudCwgbnVsbCwgdGhpcy5yZW5kZXJJbm5lckJ1dHRvbigpKTtcbiAgICB9O1xuICAgIFN1cnZleUFjdGlvbkJhckl0ZW0ucHJvdG90eXBlLnJlbmRlclRleHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5pdGVtLmhhc1RpdGxlKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIHZhciB0aXRsZUNsYXNzID0gdGhpcy5pdGVtLmdldEFjdGlvbkJhckl0ZW1UaXRsZUNzcygpO1xuICAgICAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwic3BhblwiLCB7IGNsYXNzTmFtZTogdGl0bGVDbGFzcyB9LCB0aGlzLml0ZW0udGl0bGUpO1xuICAgIH07XG4gICAgU3VydmV5QWN0aW9uQmFySXRlbS5wcm90b3R5cGUucmVuZGVyQnV0dG9uQ29udGVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRleHQgPSB0aGlzLnJlbmRlclRleHQoKTtcbiAgICAgICAgdmFyIHN2Z0ljb24gPSAhIXRoaXMuaXRlbS5pY29uTmFtZSA/IChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoc3ZnX2ljb25fU3ZnSWNvbiwgeyBjbGFzc05hbWU6IHRoaXMuaXRlbS5jc3NDbGFzc2VzLml0ZW1JY29uLCBzaXplOiB0aGlzLml0ZW0uaWNvblNpemUsIGljb25OYW1lOiB0aGlzLml0ZW0uaWNvbk5hbWUsIHRpdGxlOiB0aGlzLml0ZW0udG9vbHRpcCB8fCB0aGlzLml0ZW0udGl0bGUgfSkpIDogbnVsbDtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5GcmFnbWVudCwgbnVsbCxcbiAgICAgICAgICAgIHN2Z0ljb24sXG4gICAgICAgICAgICB0ZXh0KSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlBY3Rpb25CYXJJdGVtLnByb3RvdHlwZS5yZW5kZXJJbm5lckJ1dHRvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGNsYXNzTmFtZSA9IHRoaXMuaXRlbS5nZXRBY3Rpb25CYXJJdGVtQ3NzKCk7XG4gICAgICAgIHZhciB0aXRsZSA9IHRoaXMuaXRlbS50b29sdGlwIHx8IHRoaXMuaXRlbS50aXRsZTtcbiAgICAgICAgdmFyIGJ1dHRvbkNvbnRlbnQgPSB0aGlzLnJlbmRlckJ1dHRvbkNvbnRlbnQoKTtcbiAgICAgICAgdmFyIHRhYkluZGV4ID0gdGhpcy5pdGVtLmRpc2FibGVUYWJTdG9wID8gLTEgOiB1bmRlZmluZWQ7XG4gICAgICAgIHZhciBidXR0b24gPSBhdHRhY2hLZXkyY2xpY2soZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIsIHsgY2xhc3NOYW1lOiBjbGFzc05hbWUsIHR5cGU6IFwiYnV0dG9uXCIsIGRpc2FibGVkOiB0aGlzLml0ZW0uZGlzYWJsZWQsIG9uTW91c2VEb3duOiBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5pdGVtLmRvTW91c2VEb3duKCk7IH0sIG9uRm9jdXM6IGZ1bmN0aW9uIChhcmdzKSB7IHJldHVybiBfdGhpcy5pdGVtLmRvRm9jdXMoYXJncyk7IH0sIG9uQ2xpY2s6IGZ1bmN0aW9uIChhcmdzKSB7IHJldHVybiBfdGhpcy5pdGVtLmRvQWN0aW9uKGFyZ3MpOyB9LCB0aXRsZTogdGl0bGUsIHRhYkluZGV4OiB0YWJJbmRleCwgXCJhcmlhLWNoZWNrZWRcIjogdGhpcy5pdGVtLmFyaWFDaGVja2VkLCBcImFyaWEtZXhwYW5kZWRcIjogdGhpcy5pdGVtLmFyaWFFeHBhbmRlZCwgcm9sZTogdGhpcy5pdGVtLmFyaWFSb2xlIH0sIGJ1dHRvbkNvbnRlbnQpLCB0aGlzLml0ZW0sIHsgcHJvY2Vzc0VzYzogZmFsc2UgfSk7XG4gICAgICAgIHJldHVybiBidXR0b247XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5QWN0aW9uQmFySXRlbTtcbn0ocmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleUVsZW1lbnRCYXNlKSk7XG5cblJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJFbGVtZW50KFwic3YtYWN0aW9uLWJhci1pdGVtXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoYWN0aW9uX2Jhcl9pdGVtX1N1cnZleUFjdGlvbkJhckl0ZW0sIHByb3BzKTtcbn0pO1xuXG4vLyBFWFRFUk5BTCBNT0RVTEU6IGV4dGVybmFsIHtcInJvb3RcIjpcIlJlYWN0RE9NXCIsXCJjb21tb25qczJcIjpcInJlYWN0LWRvbVwiLFwiY29tbW9uanNcIjpcInJlYWN0LWRvbVwiLFwiYW1kXCI6XCJyZWFjdC1kb21cIn1cbnZhciBleHRlcm5hbF9yb290X1JlYWN0RE9NX2NvbW1vbmpzMl9yZWFjdF9kb21fY29tbW9uanNfcmVhY3RfZG9tX2FtZF9yZWFjdF9kb21fID0gX193ZWJwYWNrX3JlcXVpcmVfXyhcInJlYWN0LWRvbVwiKTtcbnZhciBleHRlcm5hbF9yb290X1JlYWN0RE9NX2NvbW1vbmpzMl9yZWFjdF9kb21fY29tbW9uanNfcmVhY3RfZG9tX2FtZF9yZWFjdF9kb21fZGVmYXVsdCA9IC8qI19fUFVSRV9fKi9fX3dlYnBhY2tfcmVxdWlyZV9fLm4oZXh0ZXJuYWxfcm9vdF9SZWFjdERPTV9jb21tb25qczJfcmVhY3RfZG9tX2NvbW1vbmpzX3JlYWN0X2RvbV9hbWRfcmVhY3RfZG9tXyk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9jb21wb25lbnRzL3BvcHVwL3BvcHVwLnRzeFxudmFyIHBvcHVwX2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cblxuXG5cblxudmFyIHBvcHVwX1BvcHVwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHBvcHVwX2V4dGVuZHMoUG9wdXAsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gUG9wdXAocHJvcHMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmNvbnRhaW5lclJlZiA9IGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlUmVmKCk7XG4gICAgICAgIF90aGlzLmNyZWF0ZU1vZGVsKCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFBvcHVwLnByb3RvdHlwZSwgXCJtb2RlbFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMubW9kZWw7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBQb3B1cC5wcm90b3R5cGUuZ2V0U3RhdGVFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5tb2RlbDtcbiAgICB9O1xuICAgIFBvcHVwLnByb3RvdHlwZS5jcmVhdGVNb2RlbCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5wb3B1cCA9IE9iamVjdChleHRlcm5hbF9yb290X1N1cnZleV9jb21tb25qczJfc3VydmV5X2NvcmVfY29tbW9uanNfc3VydmV5X2NvcmVfYW1kX3N1cnZleV9jb3JlX1tcImNyZWF0ZVBvcHVwVmlld01vZGVsXCJdKSh0aGlzLnByb3BzLm1vZGVsLCB1bmRlZmluZWQpO1xuICAgIH07XG4gICAgUG9wdXAucHJvdG90eXBlLnNldFRhcmdldEVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjb250YWluZXIgPSB0aGlzLmNvbnRhaW5lclJlZi5jdXJyZW50O1xuICAgICAgICB0aGlzLnBvcHVwLnNldENvbXBvbmVudEVsZW1lbnQoY29udGFpbmVyLCB0aGlzLnByb3BzLmdldFRhcmdldCA/IHRoaXMucHJvcHMuZ2V0VGFyZ2V0KGNvbnRhaW5lcikgOiB1bmRlZmluZWQsIHRoaXMucHJvcHMuZ2V0QXJlYSA/IHRoaXMucHJvcHMuZ2V0QXJlYShjb250YWluZXIpIDogdW5kZWZpbmVkKTtcbiAgICB9O1xuICAgIFBvcHVwLnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudC5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLnNldFRhcmdldEVsZW1lbnQoKTtcbiAgICB9O1xuICAgIFBvcHVwLnByb3RvdHlwZS5jb21wb25lbnREaWRVcGRhdGUgPSBmdW5jdGlvbiAocHJldlByb3BzLCBwcmV2U3RhdGUpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jb21wb25lbnREaWRVcGRhdGUuY2FsbCh0aGlzLCBwcmV2UHJvcHMsIHByZXZTdGF0ZSk7XG4gICAgICAgIHRoaXMuc2V0VGFyZ2V0RWxlbWVudCgpO1xuICAgIH07XG4gICAgUG9wdXAucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMucG9wdXAucmVzZXRDb21wb25lbnRFbGVtZW50KCk7XG4gICAgfTtcbiAgICBQb3B1cC5wcm90b3R5cGUuc2hvdWxkQ29tcG9uZW50VXBkYXRlID0gZnVuY3Rpb24gKG5leHRQcm9wcywgbmV4dFN0YXRlKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgaWYgKCFfc3VwZXIucHJvdG90eXBlLnNob3VsZENvbXBvbmVudFVwZGF0ZS5jYWxsKHRoaXMsIG5leHRQcm9wcywgbmV4dFN0YXRlKSlcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgdmFyIGlzTmVlZFVwZGF0ZSA9IG5leHRQcm9wcy5tb2RlbCAhPT0gdGhpcy5wb3B1cC5tb2RlbDtcbiAgICAgICAgaWYgKGlzTmVlZFVwZGF0ZSkge1xuICAgICAgICAgICAgKF9hID0gdGhpcy5wb3B1cCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlTW9kZWwoKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXNOZWVkVXBkYXRlO1xuICAgIH07XG4gICAgUG9wdXAucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5wb3B1cC5tb2RlbCA9IHRoaXMubW9kZWw7XG4gICAgICAgIHZhciBwb3B1cENvbnRhaW5lcjtcbiAgICAgICAgaWYgKHRoaXMubW9kZWwuaXNNb2RhbCkge1xuICAgICAgICAgICAgcG9wdXBDb250YWluZXIgPSBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQocG9wdXBfUG9wdXBDb250YWluZXIsIHsgbW9kZWw6IHRoaXMucG9wdXAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwb3B1cENvbnRhaW5lciA9IGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChwb3B1cF9Qb3B1cERyb3Bkb3duQ29udGFpbmVyLCB7IG1vZGVsOiB0aGlzLnBvcHVwIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyByZWY6IHRoaXMuY29udGFpbmVyUmVmIH0sIHBvcHVwQ29udGFpbmVyKTtcbiAgICB9O1xuICAgIHJldHVybiBQb3B1cDtcbn0ocmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleUVsZW1lbnRCYXNlKSk7XG5cblJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJFbGVtZW50KFwic3YtcG9wdXBcIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChwb3B1cF9Qb3B1cCwgcHJvcHMpO1xufSk7XG52YXIgcG9wdXBfUG9wdXBDb250YWluZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcG9wdXBfZXh0ZW5kcyhQb3B1cENvbnRhaW5lciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBQb3B1cENvbnRhaW5lcihwcm9wcykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuaGFuZGxlS2V5ZG93biA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgX3RoaXMubW9kZWwub25LZXlEb3duKGV2ZW50KTtcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMuY2xpY2tJbnNpZGUgPSBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgICAgIGV2LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQb3B1cENvbnRhaW5lci5wcm90b3R5cGUsIFwibW9kZWxcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLm1vZGVsO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgUG9wdXBDb250YWluZXIucHJvdG90eXBlLmdldFN0YXRlRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubW9kZWw7XG4gICAgfTtcbiAgICBQb3B1cENvbnRhaW5lci5wcm90b3R5cGUuY29tcG9uZW50RGlkVXBkYXRlID0gZnVuY3Rpb24gKHByZXZQcm9wcywgcHJldlN0YXRlKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50RGlkVXBkYXRlLmNhbGwodGhpcywgcHJldlByb3BzLCBwcmV2U3RhdGUpO1xuICAgICAgICBpZiAoIXRoaXMubW9kZWwuaXNQb3NpdGlvblNldCAmJiB0aGlzLm1vZGVsLmlzVmlzaWJsZSkge1xuICAgICAgICAgICAgdGhpcy5tb2RlbC51cGRhdGVPblNob3dpbmcoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgUG9wdXBDb250YWluZXIucHJvdG90eXBlLnJlbmRlckNvbnRhaW5lciA9IGZ1bmN0aW9uIChwb3B1cEJhc2VWaWV3TW9kZWwpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGhlYWRlclBvcHVwID0gcG9wdXBCYXNlVmlld01vZGVsLnNob3dIZWFkZXIgPyB0aGlzLnJlbmRlckhlYWRlclBvcHVwKHBvcHVwQmFzZVZpZXdNb2RlbCkgOiBudWxsO1xuICAgICAgICB2YXIgaGVhZGVyQ29udGVudCA9ICEhcG9wdXBCYXNlVmlld01vZGVsLnRpdGxlID8gdGhpcy5yZW5kZXJIZWFkZXJDb250ZW50KCkgOiBudWxsO1xuICAgICAgICB2YXIgY29udGVudCA9IHRoaXMucmVuZGVyQ29udGVudCgpO1xuICAgICAgICB2YXIgZm9vdGVyQ29udGVudCA9IHBvcHVwQmFzZVZpZXdNb2RlbC5zaG93Rm9vdGVyID8gdGhpcy5yZW5kZXJGb290ZXIodGhpcy5tb2RlbCkgOiBudWxsO1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzdi1wb3B1cF9fY29udGFpbmVyXCIsIHN0eWxlOiB7XG4gICAgICAgICAgICAgICAgbGVmdDogcG9wdXBCYXNlVmlld01vZGVsLmxlZnQsXG4gICAgICAgICAgICAgICAgdG9wOiBwb3B1cEJhc2VWaWV3TW9kZWwudG9wLFxuICAgICAgICAgICAgICAgIGhlaWdodDogcG9wdXBCYXNlVmlld01vZGVsLmhlaWdodCxcbiAgICAgICAgICAgICAgICB3aWR0aDogcG9wdXBCYXNlVmlld01vZGVsLndpZHRoLFxuICAgICAgICAgICAgICAgIG1pbldpZHRoOiBwb3B1cEJhc2VWaWV3TW9kZWwubWluV2lkdGgsXG4gICAgICAgICAgICB9LCBvbkNsaWNrOiBmdW5jdGlvbiAoZXYpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5jbGlja0luc2lkZShldik7XG4gICAgICAgICAgICB9IH0sXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3YtcG9wdXBfX3NoYWRvd1wiIH0sXG4gICAgICAgICAgICAgICAgaGVhZGVyUG9wdXAsXG4gICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN2LXBvcHVwX19ib2R5LWNvbnRlbnRcIiB9LFxuICAgICAgICAgICAgICAgICAgICBoZWFkZXJDb250ZW50LFxuICAgICAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3YtcG9wdXBfX3Njcm9sbGluZy1jb250ZW50XCIgfSwgY29udGVudCksXG4gICAgICAgICAgICAgICAgICAgIGZvb3RlckNvbnRlbnQpKSkpO1xuICAgIH07XG4gICAgUG9wdXBDb250YWluZXIucHJvdG90eXBlLnJlbmRlckhlYWRlckNvbnRlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3YtcG9wdXBfX2JvZHktaGVhZGVyXCIgfSwgdGhpcy5tb2RlbC50aXRsZSk7XG4gICAgfTtcbiAgICBQb3B1cENvbnRhaW5lci5wcm90b3R5cGUucmVuZGVyQ29udGVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNvbnRlbnRDb21wb25lbnQgPSBSZWFjdEVsZW1lbnRGYWN0b3J5Lkluc3RhbmNlLmNyZWF0ZUVsZW1lbnQodGhpcy5tb2RlbC5jb250ZW50Q29tcG9uZW50TmFtZSwgdGhpcy5tb2RlbC5jb250ZW50Q29tcG9uZW50RGF0YSk7XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3YtcG9wdXBfX2NvbnRlbnRcIiB9LCBjb250ZW50Q29tcG9uZW50KTtcbiAgICB9O1xuICAgIFBvcHVwQ29udGFpbmVyLnByb3RvdHlwZS5yZW5kZXJIZWFkZXJQb3B1cCA9IGZ1bmN0aW9uIChwb3B1cE1vZGVsKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgUG9wdXBDb250YWluZXIucHJvdG90eXBlLnJlbmRlckZvb3RlciA9IGZ1bmN0aW9uIChwb3B1TW9kZWwpIHtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3YtcG9wdXBfX2JvZHktZm9vdGVyXCIgfSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChhY3Rpb25fYmFyX1N1cnZleUFjdGlvbkJhciwgeyBtb2RlbDogcG9wdU1vZGVsLmZvb3RlclRvb2xiYXIgfSkpKTtcbiAgICB9O1xuICAgIFBvcHVwQ29udGFpbmVyLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBjb250YWluZXIgPSB0aGlzLnJlbmRlckNvbnRhaW5lcih0aGlzLm1vZGVsKTtcbiAgICAgICAgdmFyIGNsYXNzTmFtZSA9IG5ldyBleHRlcm5hbF9yb290X1N1cnZleV9jb21tb25qczJfc3VydmV5X2NvcmVfY29tbW9uanNfc3VydmV5X2NvcmVfYW1kX3N1cnZleV9jb3JlX1tcIkNzc0NsYXNzQnVpbGRlclwiXSgpXG4gICAgICAgICAgICAuYXBwZW5kKFwic3YtcG9wdXBcIilcbiAgICAgICAgICAgIC5hcHBlbmQodGhpcy5tb2RlbC5zdHlsZUNsYXNzKVxuICAgICAgICAgICAgLnRvU3RyaW5nKCk7XG4gICAgICAgIHZhciBzdHlsZSA9IHsgZGlzcGxheTogdGhpcy5tb2RlbC5pc1Zpc2libGUgPyBcIlwiIDogXCJub25lXCIsIH07XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgdGFiSW5kZXg6IC0xLCBjbGFzc05hbWU6IGNsYXNzTmFtZSwgc3R5bGU6IHN0eWxlLCBvbkNsaWNrOiBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIF90aGlzLm1vZGVsLmNsaWNrT3V0c2lkZShlKTtcbiAgICAgICAgICAgIH0sIG9uS2V5RG93bjogdGhpcy5oYW5kbGVLZXlkb3duIH0sIGNvbnRhaW5lcikpO1xuICAgIH07XG4gICAgcmV0dXJuIFBvcHVwQ29udGFpbmVyO1xufShyZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5RWxlbWVudEJhc2UpKTtcblxudmFyIHBvcHVwX1BvcHVwRHJvcGRvd25Db250YWluZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcG9wdXBfZXh0ZW5kcyhQb3B1cERyb3Bkb3duQ29udGFpbmVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFBvcHVwRHJvcGRvd25Db250YWluZXIoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgUG9wdXBEcm9wZG93bkNvbnRhaW5lci5wcm90b3R5cGUucmVuZGVySGVhZGVyUG9wdXAgPSBmdW5jdGlvbiAocG9wdXBNb2RlbCkge1xuICAgICAgICB2YXIgcG9wdXBEcm9wZG93bk1vZGVsID0gcG9wdXBNb2RlbDtcbiAgICAgICAgaWYgKCFwb3B1cERyb3Bkb3duTW9kZWwpXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIHsgc3R5bGU6IHtcbiAgICAgICAgICAgICAgICBsZWZ0OiBwb3B1cERyb3Bkb3duTW9kZWwucG9pbnRlclRhcmdldC5sZWZ0LFxuICAgICAgICAgICAgICAgIHRvcDogcG9wdXBEcm9wZG93bk1vZGVsLnBvaW50ZXJUYXJnZXQudG9wLFxuICAgICAgICAgICAgfSwgY2xhc3NOYW1lOiBcInN2LXBvcHVwX19wb2ludGVyXCIgfSkpO1xuICAgIH07XG4gICAgcmV0dXJuIFBvcHVwRHJvcGRvd25Db250YWluZXI7XG59KHBvcHVwX1BvcHVwQ29udGFpbmVyKSk7XG5cbi8vIHJlcGxhY2UgdG8gc2hvd0RpYWxvZyB0aGVuIGRlbGV0ZVxuZnVuY3Rpb24gc2hvd01vZGFsKGNvbXBvbmVudE5hbWUsIGRhdGEsIG9uQXBwbHksIG9uQ2FuY2VsLCBjc3NDbGFzcywgdGl0bGUsIGRpc3BsYXlNb2RlKSB7XG4gICAgaWYgKGRpc3BsYXlNb2RlID09PSB2b2lkIDApIHsgZGlzcGxheU1vZGUgPSBcInBvcHVwXCI7IH1cbiAgICB2YXIgb3B0aW9ucyA9IE9iamVjdChleHRlcm5hbF9yb290X1N1cnZleV9jb21tb25qczJfc3VydmV5X2NvcmVfY29tbW9uanNfc3VydmV5X2NvcmVfYW1kX3N1cnZleV9jb3JlX1tcImNyZWF0ZURpYWxvZ09wdGlvbnNcIl0pKGNvbXBvbmVudE5hbWUsIGRhdGEsIG9uQXBwbHksIG9uQ2FuY2VsLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgY3NzQ2xhc3MsIHRpdGxlLCBkaXNwbGF5TW9kZSk7XG4gICAgcmV0dXJuIHNob3dEaWFsb2cob3B0aW9ucyk7XG59XG5mdW5jdGlvbiBzaG93RGlhbG9nKGRpYWxvZ09wdGlvbnMsIHJvb3RFbGVtZW50KSB7XG4gICAgdmFyIHBvcHVwVmlld01vZGVsID0gT2JqZWN0KGV4dGVybmFsX3Jvb3RfU3VydmV5X2NvbW1vbmpzMl9zdXJ2ZXlfY29yZV9jb21tb25qc19zdXJ2ZXlfY29yZV9hbWRfc3VydmV5X2NvcmVfW1wiY3JlYXRlUG9wdXBNb2RhbFZpZXdNb2RlbFwiXSkoZGlhbG9nT3B0aW9ucywgcm9vdEVsZW1lbnQpO1xuICAgIHZhciBvblZpc2liaWxpdHlDaGFuZ2VkQ2FsbGJhY2sgPSBmdW5jdGlvbiAoXywgb3B0aW9ucykge1xuICAgICAgICBpZiAoIW9wdGlvbnMuaXNWaXNpYmxlKSB7XG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0RE9NX2NvbW1vbmpzMl9yZWFjdF9kb21fY29tbW9uanNfcmVhY3RfZG9tX2FtZF9yZWFjdF9kb21fZGVmYXVsdC5hLnVubW91bnRDb21wb25lbnRBdE5vZGUocG9wdXBWaWV3TW9kZWwuY29udGFpbmVyKTtcbiAgICAgICAgICAgIHBvcHVwVmlld01vZGVsLmRpc3Bvc2UoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcG9wdXBWaWV3TW9kZWwub25WaXNpYmlsaXR5Q2hhbmdlZC5hZGQob25WaXNpYmlsaXR5Q2hhbmdlZENhbGxiYWNrKTtcbiAgICBleHRlcm5hbF9yb290X1JlYWN0RE9NX2NvbW1vbmpzMl9yZWFjdF9kb21fY29tbW9uanNfcmVhY3RfZG9tX2FtZF9yZWFjdF9kb21fZGVmYXVsdC5hLnJlbmRlcihleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQocG9wdXBfUG9wdXBDb250YWluZXIsIHsgbW9kZWw6IHBvcHVwVmlld01vZGVsIH0pLCBwb3B1cFZpZXdNb2RlbC5jb250YWluZXIpO1xuICAgIHBvcHVwVmlld01vZGVsLm1vZGVsLmlzVmlzaWJsZSA9IHRydWU7XG4gICAgcmV0dXJuIHBvcHVwVmlld01vZGVsO1xufVxuZXh0ZXJuYWxfcm9vdF9TdXJ2ZXlfY29tbW9uanMyX3N1cnZleV9jb3JlX2NvbW1vbmpzX3N1cnZleV9jb3JlX2FtZF9zdXJ2ZXlfY29yZV9bXCJzZXR0aW5nc1wiXS5zaG93TW9kYWwgPSBzaG93TW9kYWw7XG5leHRlcm5hbF9yb290X1N1cnZleV9jb21tb25qczJfc3VydmV5X2NvcmVfY29tbW9uanNfc3VydmV5X2NvcmVfYW1kX3N1cnZleV9jb3JlX1tcInNldHRpbmdzXCJdLnNob3dEaWFsb2cgPSBzaG93RGlhbG9nO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvY29tcG9uZW50cy9hY3Rpb24tYmFyL2FjdGlvbi1iYXItaXRlbS1kcm9wZG93bi50c3hcbnZhciBhY3Rpb25fYmFyX2l0ZW1fZHJvcGRvd25fZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG5cblxudmFyIGFjdGlvbl9iYXJfaXRlbV9kcm9wZG93bl9TdXJ2ZXlBY3Rpb25CYXJJdGVtRHJvcGRvd24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgYWN0aW9uX2Jhcl9pdGVtX2Ryb3Bkb3duX2V4dGVuZHMoU3VydmV5QWN0aW9uQmFySXRlbURyb3Bkb3duLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleUFjdGlvbkJhckl0ZW1Ecm9wZG93bihwcm9wcykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMudmlld01vZGVsID0gbmV3IGV4dGVybmFsX3Jvb3RfU3VydmV5X2NvbW1vbmpzMl9zdXJ2ZXlfY29yZV9jb21tb25qc19zdXJ2ZXlfY29yZV9hbWRfc3VydmV5X2NvcmVfW1wiQWN0aW9uRHJvcGRvd25WaWV3TW9kZWxcIl0oX3RoaXMuaXRlbSk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgU3VydmV5QWN0aW9uQmFySXRlbURyb3Bkb3duLnByb3RvdHlwZS5yZW5kZXJJbm5lckJ1dHRvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGJ1dHRvbiA9IF9zdXBlci5wcm90b3R5cGUucmVuZGVySW5uZXJCdXR0b24uY2FsbCh0aGlzKTtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5GcmFnbWVudCwgbnVsbCxcbiAgICAgICAgICAgIGJ1dHRvbixcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChwb3B1cF9Qb3B1cCwgeyBtb2RlbDogdGhpcy5pdGVtLnBvcHVwTW9kZWwsIGdldFRhcmdldDogZXh0ZXJuYWxfcm9vdF9TdXJ2ZXlfY29tbW9uanMyX3N1cnZleV9jb3JlX2NvbW1vbmpzX3N1cnZleV9jb3JlX2FtZF9zdXJ2ZXlfY29yZV9bXCJnZXRBY3Rpb25Ecm9wZG93bkJ1dHRvblRhcmdldFwiXSB9KSkpO1xuICAgIH07XG4gICAgU3VydmV5QWN0aW9uQmFySXRlbURyb3Bkb3duLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudC5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLnZpZXdNb2RlbC5kaXNwb3NlKCk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5QWN0aW9uQmFySXRlbURyb3Bkb3duO1xufShhY3Rpb25fYmFyX2l0ZW1fU3VydmV5QWN0aW9uQmFySXRlbSkpO1xuXG5SZWFjdEVsZW1lbnRGYWN0b3J5Lkluc3RhbmNlLnJlZ2lzdGVyRWxlbWVudChcInN2LWFjdGlvbi1iYXItaXRlbS1kcm9wZG93blwiLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KGFjdGlvbl9iYXJfaXRlbV9kcm9wZG93bl9TdXJ2ZXlBY3Rpb25CYXJJdGVtRHJvcGRvd24sIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvY29tcG9uZW50cy9hY3Rpb24tYmFyL2FjdGlvbi1iYXIudHN4XG52YXIgYWN0aW9uX2Jhcl9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cblxuXG5cbnZhciBhY3Rpb25fYmFyX1N1cnZleUFjdGlvbkJhciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBhY3Rpb25fYmFyX2V4dGVuZHMoU3VydmV5QWN0aW9uQmFyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleUFjdGlvbkJhcihwcm9wcykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMucm9vdFJlZiA9IGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlUmVmKCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleUFjdGlvbkJhci5wcm90b3R5cGUsIFwiaGFuZGxlQ2xpY2tcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLmhhbmRsZUNsaWNrICE9PSB1bmRlZmluZWQgPyB0aGlzLnByb3BzLmhhbmRsZUNsaWNrIDogdHJ1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlBY3Rpb25CYXIucHJvdG90eXBlLCBcIm1vZGVsXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5tb2RlbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleUFjdGlvbkJhci5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKCF0aGlzLm1vZGVsLmhhc0FjdGlvbnMpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHZhciBjb250YWluZXIgPSB0aGlzLnJvb3RSZWYuY3VycmVudDtcbiAgICAgICAgaWYgKCEhY29udGFpbmVyKSB7XG4gICAgICAgICAgICB0aGlzLm1vZGVsLmluaXRSZXNwb25zaXZpdHlNYW5hZ2VyKGNvbnRhaW5lciwgZnVuY3Rpb24gKGNhbGxiYWNrKSB7IHNldFRpbWVvdXQoY2FsbGJhY2spOyB9KTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3VydmV5QWN0aW9uQmFyLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudC5jYWxsKHRoaXMpO1xuICAgICAgICBpZiAoISF0aGlzLm1vZGVsLmhhc0FjdGlvbnMpIHtcbiAgICAgICAgICAgIHRoaXMubW9kZWwucmVzZXRSZXNwb25zaXZpdHlNYW5hZ2VyKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN1cnZleUFjdGlvbkJhci5wcm90b3R5cGUuY29tcG9uZW50RGlkVXBkYXRlID0gZnVuY3Rpb24gKHByZXZQcm9wcywgcHJldlN0YXRlKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50RGlkVXBkYXRlLmNhbGwodGhpcywgcHJldlByb3BzLCBwcmV2U3RhdGUpO1xuICAgICAgICBpZiAocHJldlByb3BzLm1vZGVsID09IHRoaXMucHJvcHMubW9kZWwpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoISF0aGlzLm1vZGVsLmhhc0FjdGlvbnMpIHtcbiAgICAgICAgICAgIHRoaXMubW9kZWwucmVzZXRSZXNwb25zaXZpdHlNYW5hZ2VyKCk7XG4gICAgICAgICAgICB2YXIgY29udGFpbmVyID0gdGhpcy5yb290UmVmLmN1cnJlbnQ7XG4gICAgICAgICAgICBpZiAoISFjb250YWluZXIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGVsLmluaXRSZXNwb25zaXZpdHlNYW5hZ2VyKGNvbnRhaW5lciwgZnVuY3Rpb24gKGNhbGxiYWNrKSB7IHNldFRpbWVvdXQoY2FsbGJhY2spOyB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU3VydmV5QWN0aW9uQmFyLnByb3RvdHlwZS5nZXRTdGF0ZUVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1vZGVsO1xuICAgIH07XG4gICAgU3VydmV5QWN0aW9uQmFyLnByb3RvdHlwZS5yZW5kZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMubW9kZWwuaGFzQWN0aW9ucylcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLnJlbmRlckl0ZW1zKCk7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgcmVmOiB0aGlzLnJvb3RSZWYsIGNsYXNzTmFtZTogdGhpcy5tb2RlbC5nZXRSb290Q3NzKCksIG9uQ2xpY2s6IHRoaXMuaGFuZGxlQ2xpY2sgPyBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIH0gOiB1bmRlZmluZWQgfSwgaXRlbXMpKTtcbiAgICB9O1xuICAgIFN1cnZleUFjdGlvbkJhci5wcm90b3R5cGUucmVuZGVySXRlbXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1vZGVsLnJlbmRlcmVkQWN0aW9ucy5tYXAoZnVuY3Rpb24gKGl0ZW0sIGl0ZW1JbmRleCkge1xuICAgICAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoYWN0aW9uX2Jhcl9pdGVtX1N1cnZleUFjdGlvbiwgeyBpdGVtOiBpdGVtLCBrZXk6IFwiaXRlbVwiICsgaXRlbUluZGV4IH0pKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5QWN0aW9uQmFyO1xufShyZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5RWxlbWVudEJhc2UpKTtcblxuUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlckVsZW1lbnQoXCJzdi1hY3Rpb24tYmFyXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoYWN0aW9uX2Jhcl9TdXJ2ZXlBY3Rpb25CYXIsIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvY29tcG9uZW50cy90aXRsZS90aXRsZS1jb250ZW50LnRzeFxudmFyIHRpdGxlX2NvbnRlbnRfZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxudmFyIHRpdGxlX2NvbnRlbnRfVGl0bGVDb250ZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRpdGxlX2NvbnRlbnRfZXh0ZW5kcyhUaXRsZUNvbnRlbnQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gVGl0bGVDb250ZW50KHByb3BzKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRpdGxlQ29udGVudC5wcm90b3R5cGUsIFwiY3NzQ2xhc3Nlc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuY3NzQ2xhc3NlcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUaXRsZUNvbnRlbnQucHJvdG90eXBlLCBcImVsZW1lbnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLmVsZW1lbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBUaXRsZUNvbnRlbnQucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuZWxlbWVudC5pc1RpdGxlUmVuZGVyZWRBc1N0cmluZylcbiAgICAgICAgICAgIHJldHVybiByZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5RWxlbWVudEJhc2UucmVuZGVyTG9jU3RyaW5nKHRoaXMuZWxlbWVudC5sb2NUaXRsZSk7XG4gICAgICAgIHZhciBzcGFucyA9IHRoaXMucmVuZGVyVGl0bGVTcGFucyh0aGlzLmVsZW1lbnQuZ2V0VGl0bGVPd25lcigpLCB0aGlzLmNzc0NsYXNzZXMpO1xuICAgICAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuRnJhZ21lbnQsIG51bGwsIHNwYW5zKTtcbiAgICB9O1xuICAgIFRpdGxlQ29udGVudC5wcm90b3R5cGUucmVuZGVyVGl0bGVTcGFucyA9IGZ1bmN0aW9uIChlbGVtZW50LCBjc3NDbGFzc2VzKSB7XG4gICAgICAgIHZhciBnZXRTcGFjZVNwYW4gPSBmdW5jdGlvbiAoa2V5KSB7XG4gICAgICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcInNwYW5cIiwgeyBcImRhdGEta2V5XCI6IGtleSwga2V5OiBrZXkgfSwgXCJcXHUwMEEwXCIpKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHNwYW5zID0gW107XG4gICAgICAgIGlmIChlbGVtZW50LmlzUmVxdWlyZVRleHRPblN0YXJ0KSB7XG4gICAgICAgICAgICBzcGFucy5wdXNoKHRoaXMucmVuZGVyUmVxdWlyZVRleHQoZWxlbWVudCwgY3NzQ2xhc3NlcykpO1xuICAgICAgICAgICAgc3BhbnMucHVzaChnZXRTcGFjZVNwYW4oXCJyZXEtc3BcIikpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBxdWVzdGlvbk51bWJlciA9IGVsZW1lbnQubm87XG4gICAgICAgIGlmIChxdWVzdGlvbk51bWJlcikge1xuICAgICAgICAgICAgdmFyIHBhbmVsTnVtYmVyID0gISFjc3NDbGFzc2VzLnBhbmVsID8gY3NzQ2xhc3Nlcy5wYW5lbC5udW1iZXIgOiB1bmRlZmluZWQ7XG4gICAgICAgICAgICBzcGFucy5wdXNoKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcInNwYW5cIiwgeyBcImRhdGEta2V5XCI6IFwicV9udW1cIiwga2V5OiBcInFfbnVtXCIsIGNsYXNzTmFtZTogY3NzQ2xhc3Nlcy5udW1iZXIgfHwgcGFuZWxOdW1iZXIsIHN0eWxlOiB7IHBvc2l0aW9uOiBcInN0YXRpY1wiIH0sIFwiYXJpYS1oaWRkZW5cIjogdHJ1ZSB9LCBxdWVzdGlvbk51bWJlcikpO1xuICAgICAgICAgICAgc3BhbnMucHVzaChnZXRTcGFjZVNwYW4oXCJudW0tc3BcIikpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlbGVtZW50LmlzUmVxdWlyZVRleHRCZWZvcmVUaXRsZSkge1xuICAgICAgICAgICAgc3BhbnMucHVzaCh0aGlzLnJlbmRlclJlcXVpcmVUZXh0KGVsZW1lbnQsIGNzc0NsYXNzZXMpKTtcbiAgICAgICAgICAgIHNwYW5zLnB1c2goZ2V0U3BhY2VTcGFuKFwicmVxLXNwXCIpKTtcbiAgICAgICAgfVxuICAgICAgICBzcGFucy5wdXNoKHJlYWN0cXVlc3Rpb25fZWxlbWVudF9TdXJ2ZXlFbGVtZW50QmFzZS5yZW5kZXJMb2NTdHJpbmcoZWxlbWVudC5sb2NUaXRsZSwgbnVsbCwgXCJxX3RpdGxlXCIpKTtcbiAgICAgICAgaWYgKGVsZW1lbnQuaXNSZXF1aXJlVGV4dEFmdGVyVGl0bGUpIHtcbiAgICAgICAgICAgIHNwYW5zLnB1c2goZ2V0U3BhY2VTcGFuKFwicmVxLXNwXCIpKTtcbiAgICAgICAgICAgIHNwYW5zLnB1c2godGhpcy5yZW5kZXJSZXF1aXJlVGV4dChlbGVtZW50LCBjc3NDbGFzc2VzKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNwYW5zO1xuICAgIH07XG4gICAgVGl0bGVDb250ZW50LnByb3RvdHlwZS5yZW5kZXJSZXF1aXJlVGV4dCA9IGZ1bmN0aW9uIChlbGVtZW50LCBjc3NDbGFzc2VzKSB7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwic3BhblwiLCB7IFwiZGF0YS1rZXlcIjogXCJyZXEtdGV4dFwiLCBrZXk6IFwicmVxLXRleHRcIiwgY2xhc3NOYW1lOiBjc3NDbGFzc2VzLnJlcXVpcmVkVGV4dCB8fCBjc3NDbGFzc2VzLnBhbmVsLnJlcXVpcmVkVGV4dCwgXCJhcmlhLWhpZGRlblwiOiB0cnVlIH0sIGVsZW1lbnQucmVxdWlyZWRUZXh0KSk7XG4gICAgfTtcbiAgICByZXR1cm4gVGl0bGVDb250ZW50O1xufShleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLkNvbXBvbmVudCkpO1xuXG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9jb21wb25lbnRzL3RpdGxlL3RpdGxlLWFjdGlvbnMudHN4XG52YXIgdGl0bGVfYWN0aW9uc19leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cblxuXG52YXIgdGl0bGVfYWN0aW9uc19UaXRsZUFjdGlvbnMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdGl0bGVfYWN0aW9uc19leHRlbmRzKFRpdGxlQWN0aW9ucywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUaXRsZUFjdGlvbnMoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFRpdGxlQWN0aW9ucy5wcm90b3R5cGUsIFwiY3NzQ2xhc3Nlc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuY3NzQ2xhc3NlcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUaXRsZUFjdGlvbnMucHJvdG90eXBlLCBcImVsZW1lbnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLmVsZW1lbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBUaXRsZUFjdGlvbnMucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRpdGxlQ29udGVudCA9IGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudCh0aXRsZV9jb250ZW50X1RpdGxlQ29udGVudCwgeyBlbGVtZW50OiB0aGlzLmVsZW1lbnQsIGNzc0NsYXNzZXM6IHRoaXMuY3NzQ2xhc3NlcyB9KTtcbiAgICAgICAgaWYgKCF0aGlzLmVsZW1lbnQuaGFzVGl0bGVBY3Rpb25zKVxuICAgICAgICAgICAgcmV0dXJuIHRpdGxlQ29udGVudDtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3YtdGl0bGUtYWN0aW9uc1wiIH0sXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIHsgY2xhc3NOYW1lOiBcInN2LXRpdGxlLWFjdGlvbnNfX3RpdGxlXCIgfSwgdGl0bGVDb250ZW50KSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChhY3Rpb25fYmFyX1N1cnZleUFjdGlvbkJhciwgeyBtb2RlbDogdGhpcy5lbGVtZW50LmdldFRpdGxlVG9vbGJhcigpIH0pKSk7XG4gICAgfTtcbiAgICByZXR1cm4gVGl0bGVBY3Rpb25zO1xufShleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLkNvbXBvbmVudCkpO1xuXG5leHRlcm5hbF9yb290X1N1cnZleV9jb21tb25qczJfc3VydmV5X2NvcmVfY29tbW9uanNfc3VydmV5X2NvcmVfYW1kX3N1cnZleV9jb3JlX1tcIlJlbmRlcmVyRmFjdG9yeVwiXS5JbnN0YW5jZS5yZWdpc3RlclJlbmRlcmVyKFwiZWxlbWVudFwiLCBcInRpdGxlLWFjdGlvbnNcIiwgXCJzdi10aXRsZS1hY3Rpb25zXCIpO1xuUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlckVsZW1lbnQoXCJzdi10aXRsZS1hY3Rpb25zXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQodGl0bGVfYWN0aW9uc19UaXRsZUFjdGlvbnMsIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvY29tcG9uZW50cy90aXRsZS90aXRsZS1lbGVtZW50LnRzeFxudmFyIHRpdGxlX2VsZW1lbnRfZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG52YXIgdGl0bGVfZWxlbWVudF9UaXRsZUVsZW1lbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgdGl0bGVfZWxlbWVudF9leHRlbmRzKFRpdGxlRWxlbWVudCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBUaXRsZUVsZW1lbnQocHJvcHMpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoVGl0bGVFbGVtZW50LnByb3RvdHlwZSwgXCJlbGVtZW50XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5lbGVtZW50O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgVGl0bGVFbGVtZW50LnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBlbGVtZW50ID0gdGhpcy5lbGVtZW50O1xuICAgICAgICBpZiAoIWVsZW1lbnQgfHwgIWVsZW1lbnQuaGFzVGl0bGUpXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgdmFyIGFyaWFMYWJlbCA9IGVsZW1lbnQudGl0bGVBcmlhTGFiZWwgfHwgdW5kZWZpbmVkO1xuICAgICAgICB2YXIgdGl0bGVDb250ZW50ID0gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudCh0aXRsZV9hY3Rpb25zX1RpdGxlQWN0aW9ucywgeyBlbGVtZW50OiBlbGVtZW50LCBjc3NDbGFzc2VzOiBlbGVtZW50LmNzc0NsYXNzZXMgfSkpO1xuICAgICAgICB2YXIgb25DbGljayA9IHVuZGVmaW5lZDtcbiAgICAgICAgdmFyIG9uS2V5VXAgPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmIChlbGVtZW50Lmhhc1RpdGxlRXZlbnRzKSB7XG4gICAgICAgICAgICBvbktleVVwID0gZnVuY3Rpb24gKGV2dCkge1xuICAgICAgICAgICAgICAgIE9iamVjdChleHRlcm5hbF9yb290X1N1cnZleV9jb21tb25qczJfc3VydmV5X2NvcmVfY29tbW9uanNfc3VydmV5X2NvcmVfYW1kX3N1cnZleV9jb3JlX1tcImRvS2V5MkNsaWNrVXBcIl0pKGV2dC5uYXRpdmVFdmVudCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHZhciBDdXN0b21UYWcgPSBlbGVtZW50LnRpdGxlVGFnTmFtZTtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoQ3VzdG9tVGFnLCB7IGNsYXNzTmFtZTogZWxlbWVudC5jc3NUaXRsZSwgaWQ6IGVsZW1lbnQuYXJpYVRpdGxlSWQsIFwiYXJpYS1sYWJlbFwiOiBhcmlhTGFiZWwsIHRhYkluZGV4OiBlbGVtZW50LnRpdGxlVGFiSW5kZXgsIFwiYXJpYS1leHBhbmRlZFwiOiBlbGVtZW50LnRpdGxlQXJpYUV4cGFuZGVkLCByb2xlOiBlbGVtZW50LnRpdGxlQXJpYVJvbGUsIG9uQ2xpY2s6IG9uQ2xpY2ssIG9uS2V5VXA6IG9uS2V5VXAgfSwgdGl0bGVDb250ZW50KSk7XG4gICAgfTtcbiAgICByZXR1cm4gVGl0bGVFbGVtZW50O1xufShleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLkNvbXBvbmVudCkpO1xuXG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9yZWFjdHF1ZXN0aW9uX2ZhY3RvcnkudHN4XG52YXIgUmVhY3RRdWVzdGlvbkZhY3RvcnkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoKSB7XG4gICAgZnVuY3Rpb24gUmVhY3RRdWVzdGlvbkZhY3RvcnkoKSB7XG4gICAgICAgIHRoaXMuY3JlYXRvckhhc2ggPSB7fTtcbiAgICB9XG4gICAgUmVhY3RRdWVzdGlvbkZhY3RvcnkucHJvdG90eXBlLnJlZ2lzdGVyUXVlc3Rpb24gPSBmdW5jdGlvbiAocXVlc3Rpb25UeXBlLCBxdWVzdGlvbkNyZWF0b3IpIHtcbiAgICAgICAgdGhpcy5jcmVhdG9ySGFzaFtxdWVzdGlvblR5cGVdID0gcXVlc3Rpb25DcmVhdG9yO1xuICAgIH07XG4gICAgUmVhY3RRdWVzdGlvbkZhY3RvcnkucHJvdG90eXBlLmdldEFsbFR5cGVzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcmVzdWx0ID0gbmV3IEFycmF5KCk7XG4gICAgICAgIGZvciAodmFyIGtleSBpbiB0aGlzLmNyZWF0b3JIYXNoKSB7XG4gICAgICAgICAgICByZXN1bHQucHVzaChrZXkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQuc29ydCgpO1xuICAgIH07XG4gICAgUmVhY3RRdWVzdGlvbkZhY3RvcnkucHJvdG90eXBlLmNyZWF0ZVF1ZXN0aW9uID0gZnVuY3Rpb24gKHF1ZXN0aW9uVHlwZSwgcGFyYW1zKSB7XG4gICAgICAgIHZhciBjcmVhdG9yID0gdGhpcy5jcmVhdG9ySGFzaFtxdWVzdGlvblR5cGVdO1xuICAgICAgICBpZiAoY3JlYXRvciA9PSBudWxsKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIHJldHVybiBjcmVhdG9yKHBhcmFtcyk7XG4gICAgfTtcbiAgICBSZWFjdFF1ZXN0aW9uRmFjdG9yeS5JbnN0YW5jZSA9IG5ldyBSZWFjdFF1ZXN0aW9uRmFjdG9yeSgpO1xuICAgIHJldHVybiBSZWFjdFF1ZXN0aW9uRmFjdG9yeTtcbn0oKSk7XG5cblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL2NvbXBvbmVudHMvY2hhcmFjdGVyLWNvdW50ZXIudHN4XG52YXIgY2hhcmFjdGVyX2NvdW50ZXJfZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG52YXIgY2hhcmFjdGVyX2NvdW50ZXJfQ2hhcmFjdGVyQ291bnRlckNvbXBvbmVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBjaGFyYWN0ZXJfY291bnRlcl9leHRlbmRzKENoYXJhY3RlckNvdW50ZXJDb21wb25lbnQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gQ2hhcmFjdGVyQ291bnRlckNvbXBvbmVudCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBDaGFyYWN0ZXJDb3VudGVyQ29tcG9uZW50LnByb3RvdHlwZS5nZXRTdGF0ZUVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BzLmNvdW50ZXI7XG4gICAgfTtcbiAgICBDaGFyYWN0ZXJDb3VudGVyQ29tcG9uZW50LnByb3RvdHlwZS5yZW5kZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5wcm9wcy5yZW1haW5pbmdDaGFyYWN0ZXJDb3VudGVyIH0sIHRoaXMucHJvcHMuY291bnRlci5yZW1haW5pbmdDaGFyYWN0ZXJDb3VudGVyKSk7XG4gICAgfTtcbiAgICByZXR1cm4gQ2hhcmFjdGVyQ291bnRlckNvbXBvbmVudDtcbn0ocmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleUVsZW1lbnRCYXNlKSk7XG5cblJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJFbGVtZW50KFwic3YtY2hhcmFjdGVyLWNvdW50ZXJcIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChjaGFyYWN0ZXJfY291bnRlcl9DaGFyYWN0ZXJDb3VudGVyQ29tcG9uZW50LCBwcm9wcyk7XG59KTtcblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL3JlYWN0cXVlc3Rpb25fY29tbWVudC50c3hcbnZhciByZWFjdHF1ZXN0aW9uX2NvbW1lbnRfZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG5cblxudmFyIHJlYWN0cXVlc3Rpb25fY29tbWVudF9TdXJ2ZXlRdWVzdGlvbkNvbW1lbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcmVhY3RxdWVzdGlvbl9jb21tZW50X2V4dGVuZHMoU3VydmV5UXVlc3Rpb25Db21tZW50LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uQ29tbWVudChwcm9wcykge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFN1cnZleVF1ZXN0aW9uQ29tbWVudC5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIG9uQmx1ciA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBpZiAoIV90aGlzLnF1ZXN0aW9uLmlzSW5wdXRUZXh0VXBkYXRlKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMudXBkYXRlVmFsdWVPbkV2ZW50KGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgX3RoaXMucXVlc3Rpb24ub25CbHVyKGUpO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgb25JbnB1dCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgaWYgKF90aGlzLnF1ZXN0aW9uLmlzSW5wdXRUZXh0VXBkYXRlKSB7XG4gICAgICAgICAgICAgICAgX3RoaXMudXBkYXRlVmFsdWVPbkV2ZW50KGV2ZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIF90aGlzLnF1ZXN0aW9uLnVwZGF0ZUVsZW1lbnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhciBuZXdWYWx1ZSA9IGV2ZW50LnRhcmdldC52YWx1ZTtcbiAgICAgICAgICAgIF90aGlzLnF1ZXN0aW9uLnVwZGF0ZVJlbWFpbmluZ0NoYXJhY3RlckNvdW50ZXIobmV3VmFsdWUpO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgcGxhY2Vob2xkZXIgPSB0aGlzLnF1ZXN0aW9uLnJlbmRlcmVkUGxhY2Vob2xkZXI7XG4gICAgICAgIGlmICh0aGlzLnF1ZXN0aW9uLmlzUmVhZE9ubHlSZW5kZXJEaXYoKSkge1xuICAgICAgICAgICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIG51bGwsIHRoaXMucXVlc3Rpb24udmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjb3VudGVyID0gISF0aGlzLnF1ZXN0aW9uLmdldE1heExlbmd0aCgpID8gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKGNoYXJhY3Rlcl9jb3VudGVyX0NoYXJhY3RlckNvdW50ZXJDb21wb25lbnQsIHsgY291bnRlcjogdGhpcy5xdWVzdGlvbi5jaGFyYWN0ZXJDb3VudGVyLCByZW1haW5pbmdDaGFyYWN0ZXJDb3VudGVyOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMucmVtYWluaW5nQ2hhcmFjdGVyQ291bnRlciB9KSkgOiBudWxsO1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJGcmFnbWVudFwiXSwgbnVsbCxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwidGV4dGFyZWFcIiwgeyBpZDogdGhpcy5xdWVzdGlvbi5pbnB1dElkLCBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uY2xhc3NOYW1lLCBkaXNhYmxlZDogdGhpcy5xdWVzdGlvbi5pc0Rpc2FibGVkQXR0ciwgcmVhZE9ubHk6IHRoaXMucXVlc3Rpb24uaXNSZWFkT25seUF0dHIsIHJlZjogZnVuY3Rpb24gKHRleHRhcmVhKSB7IHJldHVybiAoX3RoaXMuc2V0Q29udHJvbCh0ZXh0YXJlYSkpOyB9LCBtYXhMZW5ndGg6IHRoaXMucXVlc3Rpb24uZ2V0TWF4TGVuZ3RoKCksIHBsYWNlaG9sZGVyOiBwbGFjZWhvbGRlciwgb25Gb2N1czogZnVuY3Rpb24gKGV2ZW50KSB7IF90aGlzLnF1ZXN0aW9uLm9uRm9jdXMoZXZlbnQpOyB9LCBvbkJsdXI6IG9uQmx1ciwgb25JbnB1dDogb25JbnB1dCwgb25LZXlEb3duOiBmdW5jdGlvbiAoZXZlbnQpIHsgX3RoaXMucXVlc3Rpb24ub25LZXlEb3duKGV2ZW50KTsgfSwgY29sczogdGhpcy5xdWVzdGlvbi5jb2xzLCByb3dzOiB0aGlzLnF1ZXN0aW9uLnJvd3MsIFwiYXJpYS1yZXF1aXJlZFwiOiB0aGlzLnF1ZXN0aW9uLmExMXlfaW5wdXRfYXJpYVJlcXVpcmVkLCBcImFyaWEtbGFiZWxcIjogdGhpcy5xdWVzdGlvbi5hMTF5X2lucHV0X2FyaWFMYWJlbCwgXCJhcmlhLWxhYmVsbGVkYnlcIjogdGhpcy5xdWVzdGlvbi5hMTF5X2lucHV0X2FyaWFMYWJlbGxlZEJ5LCBcImFyaWEtZGVzY3JpYmVkYnlcIjogdGhpcy5xdWVzdGlvbi5hMTF5X2lucHV0X2FyaWFEZXNjcmliZWRCeSwgXCJhcmlhLWludmFsaWRcIjogdGhpcy5xdWVzdGlvbi5hMTF5X2lucHV0X2FyaWFJbnZhbGlkLCBcImFyaWEtZXJyb3JtZXNzYWdlXCI6IHRoaXMucXVlc3Rpb24uYTExeV9pbnB1dF9hcmlhRXJyb3JtZXNzYWdlLCBzdHlsZTogeyByZXNpemU6IHRoaXMucXVlc3Rpb24ucmVzaXplU3R5bGUgfSB9KSxcbiAgICAgICAgICAgIGNvdW50ZXIpKTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvbkNvbW1lbnQ7XG59KHJlYWN0cXVlc3Rpb25fZWxlbWVudF9TdXJ2ZXlRdWVzdGlvblVuY29udHJvbGxlZEVsZW1lbnQpKTtcblxudmFyIHJlYWN0cXVlc3Rpb25fY29tbWVudF9TdXJ2ZXlRdWVzdGlvbkNvbW1lbnRJdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJlYWN0cXVlc3Rpb25fY29tbWVudF9leHRlbmRzKFN1cnZleVF1ZXN0aW9uQ29tbWVudEl0ZW0sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UXVlc3Rpb25Db21tZW50SXRlbShwcm9wcykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuc3RhdGUgPSB7IGNvbW1lbnQ6IF90aGlzLmdldENvbW1lbnQoKSB8fCBcIlwiIH07XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgU3VydmV5UXVlc3Rpb25Db21tZW50SXRlbS5wcm90b3R5cGUuY29tcG9uZW50RGlkVXBkYXRlID0gZnVuY3Rpb24gKHByZXZQcm9wcywgcHJldlN0YXRlKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50RGlkVXBkYXRlLmNhbGwodGhpcywgcHJldlByb3BzLCBwcmV2U3RhdGUpO1xuICAgICAgICB0aGlzLnVwZGF0ZURvbUVsZW1lbnQoKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uQ29tbWVudEl0ZW0ucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMudXBkYXRlRG9tRWxlbWVudCgpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25Db21tZW50SXRlbS5wcm90b3R5cGUudXBkYXRlRG9tRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCEhdGhpcy5jb250cm9sKSB7XG4gICAgICAgICAgICB2YXIgY29udHJvbCA9IHRoaXMuY29udHJvbDtcbiAgICAgICAgICAgIHZhciBuZXdWYWx1ZSA9IHRoaXMuZ2V0Q29tbWVudCgpIHx8IFwiXCI7XG4gICAgICAgICAgICBpZiAoIWV4dGVybmFsX3Jvb3RfU3VydmV5X2NvbW1vbmpzMl9zdXJ2ZXlfY29yZV9jb21tb25qc19zdXJ2ZXlfY29yZV9hbWRfc3VydmV5X2NvcmVfW1wiSGVscGVyc1wiXS5pc1R3b1ZhbHVlRXF1YWxzKG5ld1ZhbHVlLCBjb250cm9sLnZhbHVlLCBmYWxzZSwgdHJ1ZSwgZmFsc2UpKSB7XG4gICAgICAgICAgICAgICAgY29udHJvbC52YWx1ZSA9IG5ld1ZhbHVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkNvbW1lbnRJdGVtLnByb3RvdHlwZS5zZXRDb250cm9sID0gZnVuY3Rpb24gKGVsZW1lbnQpIHtcbiAgICAgICAgaWYgKCEhZWxlbWVudCkge1xuICAgICAgICAgICAgdGhpcy5jb250cm9sID0gZWxlbWVudDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25Db21tZW50SXRlbS5wcm90b3R5cGUuY2FuUmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gISF0aGlzLnByb3BzLnF1ZXN0aW9uO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25Db21tZW50SXRlbS5wcm90b3R5cGUub25Db21tZW50Q2hhbmdlID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHRoaXMucHJvcHMucXVlc3Rpb24ub25Db21tZW50Q2hhbmdlKGV2ZW50KTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uQ29tbWVudEl0ZW0ucHJvdG90eXBlLm9uQ29tbWVudElucHV0ID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHRoaXMucHJvcHMucXVlc3Rpb24ub25Db21tZW50SW5wdXQoZXZlbnQpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25Db21tZW50SXRlbS5wcm90b3R5cGUuZ2V0Q29tbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMucXVlc3Rpb24uY29tbWVudDtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uQ29tbWVudEl0ZW0ucHJvdG90eXBlLnNldENvbW1lbnQgPSBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5wcm9wcy5xdWVzdGlvbi5jb21tZW50ID0gdmFsdWU7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkNvbW1lbnRJdGVtLnByb3RvdHlwZS5nZXRJZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMucXVlc3Rpb24uY29tbWVudElkO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25Db21tZW50SXRlbS5wcm90b3R5cGUuZ2V0UGxhY2Vob2xkZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BzLnF1ZXN0aW9uLnJlbmRlcmVkQ29tbWVudFBsYWNlaG9sZGVyO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25Db21tZW50SXRlbS5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHF1ZXN0aW9uID0gdGhpcy5wcm9wcy5xdWVzdGlvbjtcbiAgICAgICAgdmFyIGNsYXNzTmFtZSA9IHRoaXMucHJvcHMub3RoZXJDc3MgfHwgdGhpcy5jc3NDbGFzc2VzLmNvbW1lbnQ7XG4gICAgICAgIGlmIChxdWVzdGlvbi5pc1JlYWRPbmx5UmVuZGVyRGl2KCkpIHtcbiAgICAgICAgICAgIHZhciBjb21tZW50ID0gdGhpcy5nZXRDb21tZW50KCkgfHwgXCJcIjtcbiAgICAgICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCBudWxsLCBjb21tZW50KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwidGV4dGFyZWFcIiwgeyBpZDogdGhpcy5nZXRJZCgpLCBjbGFzc05hbWU6IGNsYXNzTmFtZSwgcmVmOiBmdW5jdGlvbiAodGV4dGFyZWEpIHsgcmV0dXJuIChfdGhpcy5zZXRDb250cm9sKHRleHRhcmVhKSk7IH0sIGRpc2FibGVkOiB0aGlzLmlzRGlzcGxheU1vZGUsIG1heExlbmd0aDogcXVlc3Rpb24uZ2V0T3RoZXJzTWF4TGVuZ3RoKCksIHJvd3M6IHF1ZXN0aW9uLmNvbW1lbnRBcmVhUm93cywgcGxhY2Vob2xkZXI6IHRoaXMuZ2V0UGxhY2Vob2xkZXIoKSwgb25CbHVyOiBmdW5jdGlvbiAoZSkgeyBfdGhpcy5vbkNvbW1lbnRDaGFuZ2UoZSk7IH0sIG9uSW5wdXQ6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBfdGhpcy5vbkNvbW1lbnRJbnB1dChlKTsgfSwgXCJhcmlhLXJlcXVpcmVkXCI6IHF1ZXN0aW9uLmlzUmVxdWlyZWQgfHwgcXVlc3Rpb24uYTExeV9pbnB1dF9hcmlhUmVxdWlyZWQsIFwiYXJpYS1sYWJlbFwiOiBxdWVzdGlvbi5hcmlhTGFiZWwgfHwgcXVlc3Rpb24uYTExeV9pbnB1dF9hcmlhTGFiZWwsIHN0eWxlOiB7IHJlc2l6ZTogcXVlc3Rpb24ucmVzaXplU3R5bGUgfSB9KSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5UXVlc3Rpb25Db21tZW50SXRlbTtcbn0oUmVhY3RTdXJ2ZXlFbGVtZW50KSk7XG5cbnZhciBTdXJ2ZXlRdWVzdGlvbk90aGVyVmFsdWVJdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJlYWN0cXVlc3Rpb25fY29tbWVudF9leHRlbmRzKFN1cnZleVF1ZXN0aW9uT3RoZXJWYWx1ZUl0ZW0sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UXVlc3Rpb25PdGhlclZhbHVlSXRlbSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTdXJ2ZXlRdWVzdGlvbk90aGVyVmFsdWVJdGVtLnByb3RvdHlwZS5vbkNvbW1lbnRDaGFuZ2UgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5wcm9wcy5xdWVzdGlvbi5vbk90aGVyVmFsdWVDaGFuZ2UoZXZlbnQpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25PdGhlclZhbHVlSXRlbS5wcm90b3R5cGUub25Db21tZW50SW5wdXQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5wcm9wcy5xdWVzdGlvbi5vbk90aGVyVmFsdWVJbnB1dChldmVudCk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbk90aGVyVmFsdWVJdGVtLnByb3RvdHlwZS5nZXRDb21tZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5xdWVzdGlvbi5vdGhlclZhbHVlO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25PdGhlclZhbHVlSXRlbS5wcm90b3R5cGUuc2V0Q29tbWVudCA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnByb3BzLnF1ZXN0aW9uLm90aGVyVmFsdWUgPSB2YWx1ZTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uT3RoZXJWYWx1ZUl0ZW0ucHJvdG90eXBlLmdldElkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5xdWVzdGlvbi5vdGhlcklkO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25PdGhlclZhbHVlSXRlbS5wcm90b3R5cGUuZ2V0UGxhY2Vob2xkZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BzLnF1ZXN0aW9uLm90aGVyUGxhY2Vob2xkZXI7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5UXVlc3Rpb25PdGhlclZhbHVlSXRlbTtcbn0ocmVhY3RxdWVzdGlvbl9jb21tZW50X1N1cnZleVF1ZXN0aW9uQ29tbWVudEl0ZW0pKTtcblxuUmVhY3RRdWVzdGlvbkZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJRdWVzdGlvbihcImNvbW1lbnRcIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHJlYWN0cXVlc3Rpb25fY29tbWVudF9TdXJ2ZXlRdWVzdGlvbkNvbW1lbnQsIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvY3VzdG9tLXdpZGdldC50c3hcbnZhciBjdXN0b21fd2lkZ2V0X2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cbnZhciBjdXN0b21fd2lkZ2V0X1N1cnZleUN1c3RvbVdpZGdldCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBjdXN0b21fd2lkZ2V0X2V4dGVuZHMoU3VydmV5Q3VzdG9tV2lkZ2V0LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleUN1c3RvbVdpZGdldChwcm9wcykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMud2lkZ2V0UmVmID0gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZVJlZlwiXSgpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFN1cnZleUN1c3RvbVdpZGdldC5wcm90b3R5cGUuX2FmdGVyUmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5xdWVzdGlvbkJhc2UuY3VzdG9tV2lkZ2V0KSB7XG4gICAgICAgICAgICB2YXIgZWwgPSB0aGlzLndpZGdldFJlZi5jdXJyZW50O1xuICAgICAgICAgICAgaWYgKCEhZWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnF1ZXN0aW9uQmFzZS5jdXN0b21XaWRnZXQuYWZ0ZXJSZW5kZXIodGhpcy5xdWVzdGlvbkJhc2UsIGVsKTtcbiAgICAgICAgICAgICAgICB0aGlzLnF1ZXN0aW9uQmFzZS5jdXN0b21XaWRnZXREYXRhLmlzTmVlZFJlbmRlciA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBTdXJ2ZXlDdXN0b21XaWRnZXQucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50LmNhbGwodGhpcyk7XG4gICAgICAgIGlmICh0aGlzLnF1ZXN0aW9uQmFzZSkge1xuICAgICAgICAgICAgdGhpcy5fYWZ0ZXJSZW5kZXIoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3VydmV5Q3VzdG9tV2lkZ2V0LnByb3RvdHlwZS5jb21wb25lbnREaWRVcGRhdGUgPSBmdW5jdGlvbiAocHJldlByb3BzLCBwcmV2U3RhdGUpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jb21wb25lbnREaWRVcGRhdGUuY2FsbCh0aGlzLCBwcmV2UHJvcHMsIHByZXZTdGF0ZSk7XG4gICAgICAgIHZhciBpc0RlZmF1bHRSZW5kZXIgPSAhIXRoaXMucXVlc3Rpb25CYXNlLmN1c3RvbVdpZGdldCAmJlxuICAgICAgICAgICAgdGhpcy5xdWVzdGlvbkJhc2UuY3VzdG9tV2lkZ2V0LmlzRGVmYXVsdFJlbmRlcjtcbiAgICAgICAgaWYgKHRoaXMucXVlc3Rpb25CYXNlICYmICFpc0RlZmF1bHRSZW5kZXIpIHtcbiAgICAgICAgICAgIHRoaXMuX2FmdGVyUmVuZGVyKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN1cnZleUN1c3RvbVdpZGdldC5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKHRoaXMucXVlc3Rpb25CYXNlLmN1c3RvbVdpZGdldCkge1xuICAgICAgICAgICAgdmFyIGVsID0gdGhpcy53aWRnZXRSZWYuY3VycmVudDtcbiAgICAgICAgICAgIGlmICghIWVsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5xdWVzdGlvbkJhc2UuY3VzdG9tV2lkZ2V0LndpbGxVbm1vdW50KHRoaXMucXVlc3Rpb25CYXNlLCBlbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN1cnZleUN1c3RvbVdpZGdldC5wcm90b3R5cGUuY2FuUmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyLnByb3RvdHlwZS5jYW5SZW5kZXIuY2FsbCh0aGlzKSAmJiB0aGlzLnF1ZXN0aW9uQmFzZS52aXNpYmxlO1xuICAgIH07XG4gICAgU3VydmV5Q3VzdG9tV2lkZ2V0LnByb3RvdHlwZS5yZW5kZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY3VzdG9tV2lkZ2V0ID0gdGhpcy5xdWVzdGlvbkJhc2UuY3VzdG9tV2lkZ2V0O1xuICAgICAgICBpZiAoY3VzdG9tV2lkZ2V0LmlzRGVmYXVsdFJlbmRlcikge1xuICAgICAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IHJlZjogdGhpcy53aWRnZXRSZWYgfSwgdGhpcy5jcmVhdG9yLmNyZWF0ZVF1ZXN0aW9uRWxlbWVudCh0aGlzLnF1ZXN0aW9uQmFzZSkpKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgd2lkZ2V0ID0gbnVsbDtcbiAgICAgICAgaWYgKGN1c3RvbVdpZGdldC53aWRnZXRKc29uLnJlbmRlcikge1xuICAgICAgICAgICAgd2lkZ2V0ID0gY3VzdG9tV2lkZ2V0LndpZGdldEpzb24ucmVuZGVyKHRoaXMucXVlc3Rpb25CYXNlKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGlmIChjdXN0b21XaWRnZXQuaHRtbFRlbXBsYXRlKSB7XG4gICAgICAgICAgICAgICAgdmFyIGh0bWxWYWx1ZSA9IHsgX19odG1sOiBjdXN0b21XaWRnZXQuaHRtbFRlbXBsYXRlIH07XG4gICAgICAgICAgICAgICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgcmVmOiB0aGlzLndpZGdldFJlZiwgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw6IGh0bWxWYWx1ZSB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyByZWY6IHRoaXMud2lkZ2V0UmVmIH0sIHdpZGdldCk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5Q3VzdG9tV2lkZ2V0O1xufShyZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5UXVlc3Rpb25FbGVtZW50QmFzZSkpO1xuXG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9lbGVtZW50LWhlYWRlci50c3hcbnZhciBlbGVtZW50X2hlYWRlcl9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cblxuXG52YXIgZWxlbWVudF9oZWFkZXJfU3VydmV5RWxlbWVudEhlYWRlciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBlbGVtZW50X2hlYWRlcl9leHRlbmRzKFN1cnZleUVsZW1lbnRIZWFkZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5RWxlbWVudEhlYWRlcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5RWxlbWVudEhlYWRlci5wcm90b3R5cGUsIFwiZWxlbWVudFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuZWxlbWVudDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleUVsZW1lbnRIZWFkZXIucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGVsZW1lbnQgPSB0aGlzLmVsZW1lbnQ7XG4gICAgICAgIHZhciB0aXRsZSA9IGVsZW1lbnQuaGFzVGl0bGUgPyAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KHRpdGxlX2VsZW1lbnRfVGl0bGVFbGVtZW50LCB7IGVsZW1lbnQ6IGVsZW1lbnQgfSkpIDogbnVsbDtcbiAgICAgICAgdmFyIGRlc2NyaXB0aW9uID0gZWxlbWVudC5oYXNEZXNjcmlwdGlvblVuZGVyVGl0bGVcbiAgICAgICAgICAgID8gcmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleUVsZW1lbnRCYXNlLnJlbmRlclF1ZXN0aW9uRGVzY3JpcHRpb24odGhpcy5lbGVtZW50KVxuICAgICAgICAgICAgOiBudWxsO1xuICAgICAgICB2YXIgYWRkaXRpb25hbFRpdGxlVG9vbGJhckVsZW1lbnQgPSBlbGVtZW50Lmhhc0FkZGl0aW9uYWxUaXRsZVRvb2xiYXIgPyBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoYWN0aW9uX2Jhcl9TdXJ2ZXlBY3Rpb25CYXIsIHsgbW9kZWw6IGVsZW1lbnQuYWRkaXRpb25hbFRpdGxlVG9vbGJhciB9KSA6IG51bGw7XG4gICAgICAgIHZhciBoZWFkZXJTdHlsZSA9IHsgd2lkdGg6IHVuZGVmaW5lZCB9O1xuICAgICAgICBpZiAoZWxlbWVudCBpbnN0YW5jZW9mIGV4dGVybmFsX3Jvb3RfU3VydmV5X2NvbW1vbmpzMl9zdXJ2ZXlfY29yZV9jb21tb25qc19zdXJ2ZXlfY29yZV9hbWRfc3VydmV5X2NvcmVfW1wiUXVlc3Rpb25cIl0pIHtcbiAgICAgICAgICAgIGhlYWRlclN0eWxlLndpZHRoID0gZWxlbWVudC50aXRsZVdpZHRoO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBlbGVtZW50LmNzc0hlYWRlciwgb25DbGljazogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIGVsZW1lbnQuY2xpY2tUaXRsZUZ1bmN0aW9uICYmIGVsZW1lbnQuY2xpY2tUaXRsZUZ1bmN0aW9uKGUubmF0aXZlRXZlbnQpOyB9LCBzdHlsZTogaGVhZGVyU3R5bGUgfSxcbiAgICAgICAgICAgIHRpdGxlLFxuICAgICAgICAgICAgZGVzY3JpcHRpb24sXG4gICAgICAgICAgICBhZGRpdGlvbmFsVGl0bGVUb29sYmFyRWxlbWVudCkpO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleUVsZW1lbnRIZWFkZXI7XG59KGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuQ29tcG9uZW50KSk7XG5cblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL3JlYWN0cXVlc3Rpb24udHN4XG52YXIgcmVhY3RxdWVzdGlvbl9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cblxuXG5cblxudmFyIHJlYWN0cXVlc3Rpb25fU3VydmV5UXVlc3Rpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcmVhY3RxdWVzdGlvbl9leHRlbmRzKFN1cnZleVF1ZXN0aW9uLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uKHByb3BzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5pc05lZWRGb2N1cyA9IGZhbHNlO1xuICAgICAgICBfdGhpcy5yb290UmVmID0gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZVJlZlwiXSgpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFN1cnZleVF1ZXN0aW9uLnJlbmRlclF1ZXN0aW9uQm9keSA9IGZ1bmN0aW9uIChjcmVhdG9yLCBxdWVzdGlvbikge1xuICAgICAgICAvLyBpZiAoIXF1ZXN0aW9uLmlzVmlzaWJsZSkgcmV0dXJuIG51bGw7XG4gICAgICAgIHZhciBjdXN0b21XaWRnZXQgPSBxdWVzdGlvbi5jdXN0b21XaWRnZXQ7XG4gICAgICAgIGlmICghY3VzdG9tV2lkZ2V0KSB7XG4gICAgICAgICAgICByZXR1cm4gY3JlYXRvci5jcmVhdGVRdWVzdGlvbkVsZW1lbnQocXVlc3Rpb24pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShjdXN0b21fd2lkZ2V0X1N1cnZleUN1c3RvbVdpZGdldCwgeyBjcmVhdG9yOiBjcmVhdG9yLCBxdWVzdGlvbjogcXVlc3Rpb24gfSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbi5wcm90b3R5cGUuZ2V0U3RhdGVFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5xdWVzdGlvbjtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbi5wcm90b3R5cGUsIFwicXVlc3Rpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLmVsZW1lbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb24ucHJvdG90eXBlLCBcImNyZWF0b3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLmNyZWF0b3I7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlRdWVzdGlvbi5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKCEhdGhpcy5xdWVzdGlvbikge1xuICAgICAgICAgICAgdGhpcy5xdWVzdGlvbltcInJlYWN0XCJdID0gdGhpcztcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmRvQWZ0ZXJSZW5kZXIoKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudC5jYWxsKHRoaXMpO1xuICAgICAgICBpZiAoISF0aGlzLnF1ZXN0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLnF1ZXN0aW9uW1wicmVhY3RcIl0gPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBlbCA9IHRoaXMucm9vdFJlZi5jdXJyZW50O1xuICAgICAgICBpZiAoISFlbCkge1xuICAgICAgICAgICAgZWwucmVtb3ZlQXR0cmlidXRlKFwiZGF0YS1yZW5kZXJlZFwiKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb24ucHJvdG90eXBlLmNvbXBvbmVudERpZFVwZGF0ZSA9IGZ1bmN0aW9uIChwcmV2UHJvcHMsIHByZXZTdGF0ZSkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNvbXBvbmVudERpZFVwZGF0ZS5jYWxsKHRoaXMsIHByZXZQcm9wcywgcHJldlN0YXRlKTtcbiAgICAgICAgdGhpcy5kb0FmdGVyUmVuZGVyKCk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbi5wcm90b3R5cGUuZG9BZnRlclJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNOZWVkRm9jdXMpIHtcbiAgICAgICAgICAgIGlmICghdGhpcy5xdWVzdGlvbi5pc0NvbGxhcHNlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMucXVlc3Rpb24uY2xpY2tUaXRsZUZ1bmN0aW9uKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmlzTmVlZEZvY3VzID0gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucXVlc3Rpb24pIHtcbiAgICAgICAgICAgIHZhciBlbCA9IHRoaXMucm9vdFJlZi5jdXJyZW50O1xuICAgICAgICAgICAgaWYgKGVsICYmIGVsLmdldEF0dHJpYnV0ZShcImRhdGEtcmVuZGVyZWRcIikgIT09IFwiclwiKSB7XG4gICAgICAgICAgICAgICAgZWwuc2V0QXR0cmlidXRlKFwiZGF0YS1yZW5kZXJlZFwiLCBcInJcIik7XG4gICAgICAgICAgICAgICAgZWwuc2V0QXR0cmlidXRlKFwiZGF0YS1uYW1lXCIsIHRoaXMucXVlc3Rpb24ubmFtZSk7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMucXVlc3Rpb24uYWZ0ZXJSZW5kZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWVzdGlvbi5hZnRlclJlbmRlcihlbCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbi5wcm90b3R5cGUuY2FuUmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKF9zdXBlci5wcm90b3R5cGUuY2FuUmVuZGVyLmNhbGwodGhpcykgJiZcbiAgICAgICAgICAgICEhdGhpcy5xdWVzdGlvbiAmJlxuICAgICAgICAgICAgISF0aGlzLmNyZWF0b3IpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb24ucHJvdG90eXBlLnJlbmRlclF1ZXN0aW9uQ29udGVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHF1ZXN0aW9uID0gdGhpcy5xdWVzdGlvbjtcbiAgICAgICAgdmFyIGNvbnRlbnRTdHlsZSA9IHtcbiAgICAgICAgICAgIGRpc3BsYXk6IHRoaXMucXVlc3Rpb24ucmVuZGVyZWRJc0V4cGFuZGVkID8gXCJcIiA6IFwibm9uZVwiLFxuICAgICAgICB9O1xuICAgICAgICB2YXIgY3NzQ2xhc3NlcyA9IHF1ZXN0aW9uLmNzc0NsYXNzZXM7XG4gICAgICAgIHZhciBxdWVzdGlvblJlbmRlciA9IHRoaXMucmVuZGVyUXVlc3Rpb24oKTtcbiAgICAgICAgdmFyIGVycm9yc1RvcCA9IHRoaXMucXVlc3Rpb24uc2hvd0Vycm9yT25Ub3BcbiAgICAgICAgICAgID8gdGhpcy5yZW5kZXJFcnJvcnMoY3NzQ2xhc3NlcywgXCJ0b3BcIilcbiAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgdmFyIGVycm9yc0JvdHRvbSA9IHRoaXMucXVlc3Rpb24uc2hvd0Vycm9yT25Cb3R0b21cbiAgICAgICAgICAgID8gdGhpcy5yZW5kZXJFcnJvcnMoY3NzQ2xhc3NlcywgXCJib3R0b21cIilcbiAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgdmFyIGNvbW1lbnQgPSBxdWVzdGlvbiAmJiBxdWVzdGlvbi5oYXNDb21tZW50ID8gdGhpcy5yZW5kZXJDb21tZW50KGNzc0NsYXNzZXMpIDogbnVsbDtcbiAgICAgICAgdmFyIGRlc2NyaXB0aW9uVW5kZXJJbnB1dCA9IHF1ZXN0aW9uLmhhc0Rlc2NyaXB0aW9uVW5kZXJJbnB1dFxuICAgICAgICAgICAgPyB0aGlzLnJlbmRlckRlc2NyaXB0aW9uKClcbiAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogcXVlc3Rpb24uY3NzQ29udGVudCB8fCB1bmRlZmluZWQsIHN0eWxlOiBjb250ZW50U3R5bGUsIHJvbGU6IFwicHJlc2VudGF0aW9uXCIgfSxcbiAgICAgICAgICAgIGVycm9yc1RvcCxcbiAgICAgICAgICAgIHF1ZXN0aW9uUmVuZGVyLFxuICAgICAgICAgICAgY29tbWVudCxcbiAgICAgICAgICAgIGVycm9yc0JvdHRvbSxcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uVW5kZXJJbnB1dCkpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb24ucHJvdG90eXBlLnJlbmRlckVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBxdWVzdGlvbiA9IHRoaXMucXVlc3Rpb247XG4gICAgICAgIHZhciBjc3NDbGFzc2VzID0gcXVlc3Rpb24uY3NzQ2xhc3NlcztcbiAgICAgICAgdmFyIGhlYWRlciA9IHRoaXMucmVuZGVySGVhZGVyKHF1ZXN0aW9uKTtcbiAgICAgICAgdmFyIGhlYWRlclRvcCA9IHF1ZXN0aW9uLmhhc1RpdGxlT25MZWZ0VG9wID8gaGVhZGVyIDogbnVsbDtcbiAgICAgICAgdmFyIGhlYWRlckJvdHRvbSA9IHF1ZXN0aW9uLmhhc1RpdGxlT25Cb3R0b20gPyBoZWFkZXIgOiBudWxsO1xuICAgICAgICB2YXIgZXJyb3JzQWJvdmVRdWVzdGlvbiA9IHRoaXMucXVlc3Rpb24uc2hvd0Vycm9yc0Fib3ZlUXVlc3Rpb25cbiAgICAgICAgICAgID8gdGhpcy5yZW5kZXJFcnJvcnMoY3NzQ2xhc3NlcywgXCJcIilcbiAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgdmFyIGVycm9yc0JlbG93UXVlc3Rpb24gPSB0aGlzLnF1ZXN0aW9uLnNob3dFcnJvcnNCZWxvd1F1ZXN0aW9uXG4gICAgICAgICAgICA/IHRoaXMucmVuZGVyRXJyb3JzKGNzc0NsYXNzZXMsIFwiXCIpXG4gICAgICAgICAgICA6IG51bGw7XG4gICAgICAgIHZhciByb290U3R5bGUgPSBxdWVzdGlvbi5nZXRSb290U3R5bGUoKTtcbiAgICAgICAgdmFyIHF1ZXN0aW9uQ29udGVudCA9IHRoaXMud3JhcFF1ZXN0aW9uQ29udGVudCh0aGlzLnJlbmRlclF1ZXN0aW9uQ29udGVudCgpKTtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiRnJhZ21lbnRcIl0sIG51bGwsXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IHJlZjogdGhpcy5yb290UmVmLCBpZDogcXVlc3Rpb24uaWQsIGNsYXNzTmFtZTogcXVlc3Rpb24uZ2V0Um9vdENzcygpLCBzdHlsZTogcm9vdFN0eWxlLCByb2xlOiBxdWVzdGlvbi5hcmlhUm9sZSwgXCJhcmlhLXJlcXVpcmVkXCI6IHRoaXMucXVlc3Rpb24uYXJpYVJlcXVpcmVkLCBcImFyaWEtaW52YWxpZFwiOiB0aGlzLnF1ZXN0aW9uLmFyaWFJbnZhbGlkLCBcImFyaWEtbGFiZWxsZWRieVwiOiBxdWVzdGlvbi5hcmlhTGFiZWxsZWRCeSwgXCJhcmlhLWRlc2NyaWJlZGJ5XCI6IHF1ZXN0aW9uLmFyaWFEZXNjcmliZWRCeSwgXCJhcmlhLWV4cGFuZGVkXCI6IHF1ZXN0aW9uLmFyaWFFeHBhbmRlZCB9LFxuICAgICAgICAgICAgICAgIGVycm9yc0Fib3ZlUXVlc3Rpb24sXG4gICAgICAgICAgICAgICAgaGVhZGVyVG9wLFxuICAgICAgICAgICAgICAgIHF1ZXN0aW9uQ29udGVudCxcbiAgICAgICAgICAgICAgICBoZWFkZXJCb3R0b20sXG4gICAgICAgICAgICAgICAgZXJyb3JzQmVsb3dRdWVzdGlvbikpKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uLnByb3RvdHlwZS53cmFwRWxlbWVudCA9IGZ1bmN0aW9uIChlbGVtZW50KSB7XG4gICAgICAgIHZhciBzdXJ2ZXkgPSB0aGlzLnF1ZXN0aW9uLnN1cnZleTtcbiAgICAgICAgdmFyIHdyYXBwZXIgPSBudWxsO1xuICAgICAgICBpZiAoc3VydmV5KSB7XG4gICAgICAgICAgICB3cmFwcGVyID0gcmVhY3RzdXJ2ZXltb2RlbF9SZWFjdFN1cnZleUVsZW1lbnRzV3JhcHBlci53cmFwRWxlbWVudChzdXJ2ZXksIGVsZW1lbnQsIHRoaXMucXVlc3Rpb24pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB3cmFwcGVyICE9PSBudWxsICYmIHdyYXBwZXIgIT09IHZvaWQgMCA/IHdyYXBwZXIgOiBlbGVtZW50O1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb24ucHJvdG90eXBlLndyYXBRdWVzdGlvbkNvbnRlbnQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICB2YXIgc3VydmV5ID0gdGhpcy5xdWVzdGlvbi5zdXJ2ZXk7XG4gICAgICAgIHZhciB3cmFwcGVyID0gbnVsbDtcbiAgICAgICAgaWYgKHN1cnZleSkge1xuICAgICAgICAgICAgd3JhcHBlciA9IHJlYWN0c3VydmV5bW9kZWxfUmVhY3RTdXJ2ZXlFbGVtZW50c1dyYXBwZXIud3JhcFF1ZXN0aW9uQ29udGVudChzdXJ2ZXksIGVsZW1lbnQsIHRoaXMucXVlc3Rpb24pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB3cmFwcGVyICE9PSBudWxsICYmIHdyYXBwZXIgIT09IHZvaWQgMCA/IHdyYXBwZXIgOiBlbGVtZW50O1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb24ucHJvdG90eXBlLnJlbmRlclF1ZXN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gU3VydmV5UXVlc3Rpb24ucmVuZGVyUXVlc3Rpb25Cb2R5KHRoaXMuY3JlYXRvciwgdGhpcy5xdWVzdGlvbik7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbi5wcm90b3R5cGUucmVuZGVyRGVzY3JpcHRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiByZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5RWxlbWVudEJhc2UucmVuZGVyUXVlc3Rpb25EZXNjcmlwdGlvbih0aGlzLnF1ZXN0aW9uKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uLnByb3RvdHlwZS5yZW5kZXJDb21tZW50ID0gZnVuY3Rpb24gKGNzc0NsYXNzZXMpIHtcbiAgICAgICAgdmFyIGNvbW1lbnRUZXh0ID0gcmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleUVsZW1lbnRCYXNlLnJlbmRlckxvY1N0cmluZyh0aGlzLnF1ZXN0aW9uLmxvY0NvbW1lbnRUZXh0KTtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5nZXRDb21tZW50QXJlYUNzcygpIH0sXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCBudWxsLCBjb21tZW50VGV4dCksXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyZWFjdHF1ZXN0aW9uX2NvbW1lbnRfU3VydmV5UXVlc3Rpb25Db21tZW50SXRlbSwgeyBxdWVzdGlvbjogdGhpcy5xdWVzdGlvbiwgY3NzQ2xhc3NlczogY3NzQ2xhc3Nlcywgb3RoZXJDc3M6IGNzc0NsYXNzZXMub3RoZXIsIGlzRGlzcGxheU1vZGU6IHRoaXMucXVlc3Rpb24uaXNJbnB1dFJlYWRPbmx5IH0pKSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbi5wcm90b3R5cGUucmVuZGVySGVhZGVyID0gZnVuY3Rpb24gKHF1ZXN0aW9uKSB7XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShlbGVtZW50X2hlYWRlcl9TdXJ2ZXlFbGVtZW50SGVhZGVyLCB7IGVsZW1lbnQ6IHF1ZXN0aW9uIH0pO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb24ucHJvdG90eXBlLnJlbmRlckVycm9ycyA9IGZ1bmN0aW9uIChjc3NDbGFzc2VzLCBsb2NhdGlvbikge1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHJlYWN0cXVlc3Rpb25fU3VydmV5RWxlbWVudEVycm9ycywgeyBlbGVtZW50OiB0aGlzLnF1ZXN0aW9uLCBjc3NDbGFzc2VzOiBjc3NDbGFzc2VzLCBjcmVhdG9yOiB0aGlzLmNyZWF0b3IsIGxvY2F0aW9uOiBsb2NhdGlvbiwgaWQ6IHRoaXMucXVlc3Rpb24uaWQgKyBcIl9lcnJvcnNcIiB9KSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5UXVlc3Rpb247XG59KHJlYWN0cXVlc3Rpb25fZWxlbWVudF9TdXJ2ZXlFbGVtZW50QmFzZSkpO1xuXG5SZWFjdEVsZW1lbnRGYWN0b3J5Lkluc3RhbmNlLnJlZ2lzdGVyRWxlbWVudChcInF1ZXN0aW9uXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyZWFjdHF1ZXN0aW9uX1N1cnZleVF1ZXN0aW9uLCBwcm9wcyk7XG59KTtcbnZhciByZWFjdHF1ZXN0aW9uX1N1cnZleUVsZW1lbnRFcnJvcnMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcmVhY3RxdWVzdGlvbl9leHRlbmRzKFN1cnZleUVsZW1lbnRFcnJvcnMsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5RWxlbWVudEVycm9ycyhwcm9wcykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuc3RhdGUgPSBfdGhpcy5nZXRTdGF0ZSgpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlFbGVtZW50RXJyb3JzLnByb3RvdHlwZSwgXCJpZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuZWxlbWVudC5pZCArIFwiX2Vycm9yc1wiO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleUVsZW1lbnRFcnJvcnMucHJvdG90eXBlLCBcImVsZW1lbnRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLmVsZW1lbnQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5RWxlbWVudEVycm9ycy5wcm90b3R5cGUsIFwiY3JlYXRvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuY3JlYXRvcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlFbGVtZW50RXJyb3JzLnByb3RvdHlwZSwgXCJsb2NhdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMubG9jYXRpb247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlFbGVtZW50RXJyb3JzLnByb3RvdHlwZS5nZXRTdGF0ZSA9IGZ1bmN0aW9uIChwcmV2U3RhdGUpIHtcbiAgICAgICAgaWYgKHByZXZTdGF0ZSA9PT0gdm9pZCAwKSB7IHByZXZTdGF0ZSA9IG51bGw7IH1cbiAgICAgICAgcmV0dXJuICFwcmV2U3RhdGUgPyB7IGVycm9yOiAwIH0gOiB7IGVycm9yOiBwcmV2U3RhdGUuZXJyb3IgKyAxIH07XG4gICAgfTtcbiAgICBTdXJ2ZXlFbGVtZW50RXJyb3JzLnByb3RvdHlwZS5jYW5SZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAhIXRoaXMuZWxlbWVudCAmJiB0aGlzLmVsZW1lbnQuaGFzVmlzaWJsZUVycm9ycztcbiAgICB9O1xuICAgIFN1cnZleUVsZW1lbnRFcnJvcnMucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgIH07XG4gICAgU3VydmV5RWxlbWVudEVycm9ycy5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGVycm9ycyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuZWxlbWVudC5lcnJvcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBrZXkgPSBcImVycm9yXCIgKyBpO1xuICAgICAgICAgICAgZXJyb3JzLnB1c2godGhpcy5jcmVhdG9yLnJlbmRlckVycm9yKGtleSwgdGhpcy5lbGVtZW50LmVycm9yc1tpXSwgdGhpcy5jc3NDbGFzc2VzLCB0aGlzLmVsZW1lbnQpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgcm9sZTogXCJhbGVydFwiLCBcImFyaWEtbGl2ZVwiOiBcInBvbGl0ZVwiLCBjbGFzc05hbWU6IHRoaXMuZWxlbWVudC5jc3NFcnJvciwgaWQ6IHRoaXMuaWQgfSwgZXJyb3JzKSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5RWxlbWVudEVycm9ycztcbn0oUmVhY3RTdXJ2ZXlFbGVtZW50KSk7XG5cbnZhciByZWFjdHF1ZXN0aW9uX1N1cnZleVF1ZXN0aW9uQW5kRXJyb3JzV3JhcHBlZCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICByZWFjdHF1ZXN0aW9uX2V4dGVuZHMoU3VydmV5UXVlc3Rpb25BbmRFcnJvcnNXcmFwcGVkLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uQW5kRXJyb3JzV3JhcHBlZChwcm9wcykge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFN1cnZleVF1ZXN0aW9uQW5kRXJyb3JzV3JhcHBlZC5wcm90b3R5cGUuZ2V0U3RhdGVFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5xdWVzdGlvbjtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbkFuZEVycm9yc1dyYXBwZWQucHJvdG90eXBlLCBcInF1ZXN0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRRdWVzdGlvbigpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uQW5kRXJyb3JzV3JhcHBlZC5wcm90b3R5cGUsIFwiY3JlYXRvclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuY3JlYXRvcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleVF1ZXN0aW9uQW5kRXJyb3JzV3JhcHBlZC5wcm90b3R5cGUuZ2V0UXVlc3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BzLnF1ZXN0aW9uO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uQW5kRXJyb3JzV3JhcHBlZC5wcm90b3R5cGUsIFwiaXRlbUNzc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuaXRlbUNzcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleVF1ZXN0aW9uQW5kRXJyb3JzV3JhcHBlZC5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5kb0FmdGVyUmVuZGVyKCk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkFuZEVycm9yc1dyYXBwZWQucHJvdG90eXBlLmNvbXBvbmVudERpZFVwZGF0ZSA9IGZ1bmN0aW9uIChwcmV2UHJvcHMsIHByZXZTdGF0ZSkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNvbXBvbmVudERpZFVwZGF0ZS5jYWxsKHRoaXMsIHByZXZQcm9wcywgcHJldlN0YXRlKTtcbiAgICAgICAgdGhpcy5kb0FmdGVyUmVuZGVyKCk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkFuZEVycm9yc1dyYXBwZWQucHJvdG90eXBlLmRvQWZ0ZXJSZW5kZXIgPSBmdW5jdGlvbiAoKSB7IH07XG4gICAgU3VydmV5UXVlc3Rpb25BbmRFcnJvcnNXcmFwcGVkLnByb3RvdHlwZS5jYW5SZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAhIXRoaXMucXVlc3Rpb247XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkFuZEVycm9yc1dyYXBwZWQucHJvdG90eXBlLnJlbmRlckNvbnRlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciByZW5kZXJlZFF1ZXN0aW9uID0gdGhpcy5yZW5kZXJRdWVzdGlvbigpO1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJGcmFnbWVudFwiXSwgbnVsbCwgcmVuZGVyZWRRdWVzdGlvbikpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25BbmRFcnJvcnNXcmFwcGVkLnByb3RvdHlwZS5nZXRTaG93RXJyb3JzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5xdWVzdGlvbi5pc1Zpc2libGU7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkFuZEVycm9yc1dyYXBwZWQucHJvdG90eXBlLnJlbmRlclF1ZXN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gcmVhY3RxdWVzdGlvbl9TdXJ2ZXlRdWVzdGlvbi5yZW5kZXJRdWVzdGlvbkJvZHkodGhpcy5jcmVhdG9yLCB0aGlzLnF1ZXN0aW9uKTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvbkFuZEVycm9yc1dyYXBwZWQ7XG59KFJlYWN0U3VydmV5RWxlbWVudCkpO1xuXG52YXIgcmVhY3RxdWVzdGlvbl9TdXJ2ZXlRdWVzdGlvbkFuZEVycm9yc0NlbGwgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcmVhY3RxdWVzdGlvbl9leHRlbmRzKFN1cnZleVF1ZXN0aW9uQW5kRXJyb3JzQ2VsbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlRdWVzdGlvbkFuZEVycm9yc0NlbGwocHJvcHMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmNlbGxSZWYgPSBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlUmVmXCJdKCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgU3VydmV5UXVlc3Rpb25BbmRFcnJvcnNDZWxsLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudC5jYWxsKHRoaXMpO1xuICAgICAgICBpZiAodGhpcy5xdWVzdGlvbikge1xuICAgICAgICAgICAgdmFyIGVsID0gdGhpcy5jZWxsUmVmLmN1cnJlbnQ7XG4gICAgICAgICAgICBpZiAoISFlbCkge1xuICAgICAgICAgICAgICAgIGVsLnJlbW92ZUF0dHJpYnV0ZShcImRhdGEtcmVuZGVyZWRcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uQW5kRXJyb3JzQ2VsbC5wcm90b3R5cGUucmVuZGVyQ2VsbENvbnRlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMucHJvcHMuY2VsbC5jZWxsUXVlc3Rpb25XcmFwcGVyQ2xhc3NOYW1lIH0sIHRoaXMucmVuZGVyUXVlc3Rpb24oKSkpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25BbmRFcnJvcnNDZWxsLnByb3RvdHlwZS5yZW5kZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc3R5bGUgPSB0aGlzLmdldENlbGxTdHlsZSgpO1xuICAgICAgICB2YXIgY2VsbCA9IHRoaXMucHJvcHMuY2VsbDtcbiAgICAgICAgdmFyIGZvY3VzSW4gPSBmdW5jdGlvbiAoKSB7IGNlbGwuZm9jdXNJbigpOyB9O1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwidGRcIiwgeyByZWY6IHRoaXMuY2VsbFJlZiwgY2xhc3NOYW1lOiB0aGlzLml0ZW1Dc3MsIGNvbFNwYW46IGNlbGwuY29sU3BhbnMsIHRpdGxlOiBjZWxsLmdldFRpdGxlKCksIHN0eWxlOiBzdHlsZSwgb25Gb2N1czogZm9jdXNJbiB9LCB0aGlzLndyYXBDZWxsKHRoaXMucHJvcHMuY2VsbCwgdGhpcy5yZW5kZXJDZWxsQ29udGVudCgpKSkpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25BbmRFcnJvcnNDZWxsLnByb3RvdHlwZS5nZXRDZWxsU3R5bGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25BbmRFcnJvcnNDZWxsLnByb3RvdHlwZS5nZXRIZWFkZXJUZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gXCJcIjtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uQW5kRXJyb3JzQ2VsbC5wcm90b3R5cGUud3JhcENlbGwgPSBmdW5jdGlvbiAoY2VsbCwgZWxlbWVudCkge1xuICAgICAgICBpZiAoIWNlbGwpIHtcbiAgICAgICAgICAgIHJldHVybiBlbGVtZW50O1xuICAgICAgICB9XG4gICAgICAgIHZhciBzdXJ2ZXkgPSB0aGlzLnF1ZXN0aW9uLnN1cnZleTtcbiAgICAgICAgdmFyIHdyYXBwZXIgPSBudWxsO1xuICAgICAgICBpZiAoc3VydmV5KSB7XG4gICAgICAgICAgICB3cmFwcGVyID0gcmVhY3RzdXJ2ZXltb2RlbF9SZWFjdFN1cnZleUVsZW1lbnRzV3JhcHBlci53cmFwTWF0cml4Q2VsbChzdXJ2ZXksIGVsZW1lbnQsIGNlbGwsIHRoaXMucHJvcHMucmVhc29uKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gd3JhcHBlciAhPT0gbnVsbCAmJiB3cmFwcGVyICE9PSB2b2lkIDAgPyB3cmFwcGVyIDogZWxlbWVudDtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvbkFuZEVycm9yc0NlbGw7XG59KHJlYWN0cXVlc3Rpb25fU3VydmV5UXVlc3Rpb25BbmRFcnJvcnNXcmFwcGVkKSk7XG5cbnZhciByZWFjdHF1ZXN0aW9uX1N1cnZleVF1ZXN0aW9uRXJyb3JDZWxsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJlYWN0cXVlc3Rpb25fZXh0ZW5kcyhTdXJ2ZXlRdWVzdGlvbkVycm9yQ2VsbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlRdWVzdGlvbkVycm9yQ2VsbChwcm9wcykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBjaGFuZ2VkOiAwXG4gICAgICAgIH07XG4gICAgICAgIGlmIChfdGhpcy5xdWVzdGlvbikge1xuICAgICAgICAgICAgX3RoaXMucmVnaXN0ZXJDYWxsYmFjayhfdGhpcy5xdWVzdGlvbik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25FcnJvckNlbGwucHJvdG90eXBlLCBcInF1ZXN0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5xdWVzdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleVF1ZXN0aW9uRXJyb3JDZWxsLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBjaGFuZ2VkOiB0aGlzLnN0YXRlLmNoYW5nZWQgKyAxIH0pO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25FcnJvckNlbGwucHJvdG90eXBlLmdldFF1ZXN0aW9uUHJvcGVydGllc1RvVHJhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBbXCJlcnJvcnNcIl07XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkVycm9yQ2VsbC5wcm90b3R5cGUucmVnaXN0ZXJDYWxsYmFjayA9IGZ1bmN0aW9uIChxdWVzdGlvbikge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBxdWVzdGlvbi5yZWdpc3RlckZ1bmN0aW9uT25Qcm9wZXJ0aWVzVmFsdWVDaGFuZ2VkKHRoaXMuZ2V0UXVlc3Rpb25Qcm9wZXJ0aWVzVG9UcmFjaygpLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfdGhpcy51cGRhdGUoKTtcbiAgICAgICAgfSwgXCJfX3JlYWN0U3Vic2NyaXB0aW9uXCIpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25FcnJvckNlbGwucHJvdG90eXBlLnVuUmVnaXN0ZXJDYWxsYmFjayA9IGZ1bmN0aW9uIChxdWVzdGlvbikge1xuICAgICAgICBxdWVzdGlvbi51blJlZ2lzdGVyRnVuY3Rpb25PblByb3BlcnRpZXNWYWx1ZUNoYW5nZWQodGhpcy5nZXRRdWVzdGlvblByb3BlcnRpZXNUb1RyYWNrKCksIFwiX19yZWFjdFN1YnNjcmlwdGlvblwiKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uRXJyb3JDZWxsLnByb3RvdHlwZS5jb21wb25lbnREaWRVcGRhdGUgPSBmdW5jdGlvbiAocHJldlByb3BzKSB7XG4gICAgICAgIGlmIChwcmV2UHJvcHMucXVlc3Rpb24gJiYgcHJldlByb3BzLnF1ZXN0aW9uICE9PSB0aGlzLnF1ZXN0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLnVuUmVnaXN0ZXJDYWxsYmFjayhwcmV2UHJvcHMuY2VsbCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucXVlc3Rpb24pIHtcbiAgICAgICAgICAgIHRoaXMucmVnaXN0ZXJDYWxsYmFjayh0aGlzLnF1ZXN0aW9uKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25FcnJvckNlbGwucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAodGhpcy5xdWVzdGlvbikge1xuICAgICAgICAgICAgdGhpcy51blJlZ2lzdGVyQ2FsbGJhY2sodGhpcy5xdWVzdGlvbik7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uRXJyb3JDZWxsLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyZWFjdHF1ZXN0aW9uX1N1cnZleUVsZW1lbnRFcnJvcnMsIHsgZWxlbWVudDogdGhpcy5xdWVzdGlvbiwgY3JlYXRvcjogdGhpcy5wcm9wcy5jcmVhdG9yLCBjc3NDbGFzc2VzOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5UXVlc3Rpb25FcnJvckNlbGw7XG59KGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJDb21wb25lbnRcIl0pKTtcblxuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvcGFnZS50c3hcbnZhciBwYWdlX2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cblxuXG5cbnZhciBwYWdlX1N1cnZleVBhZ2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcGFnZV9leHRlbmRzKFN1cnZleVBhZ2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UGFnZShwcm9wcykge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFN1cnZleVBhZ2UucHJvdG90eXBlLmdldFBhbmVsQmFzZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMucGFnZTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlQYWdlLnByb3RvdHlwZSwgXCJwYWdlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYW5lbEJhc2U7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICAvLyBzaG91bGRDb21wb25lbnRVcGRhdGUobmV4dFByb3BzOiBhbnksIG5leHRTdGF0ZTogYW55KTogYm9vbGVhbiB7XG4gICAgLy8gICBpZighc3VwZXIuc2hvdWxkQ29tcG9uZW50VXBkYXRlKG5leHRQcm9wcywgbmV4dFN0YXRlKSkgcmV0dXJuIGZhbHNlO1xuICAgIC8vICAgcmV0dXJuIHRydWU7XG4gICAgLy8gfVxuICAgIFN1cnZleVBhZ2UucHJvdG90eXBlLnJlbmRlckVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciB0aXRsZSA9IHRoaXMucmVuZGVyVGl0bGUoKTtcbiAgICAgICAgdmFyIGRlc2NyaXB0aW9uID0gdGhpcy5yZW5kZXJEZXNjcmlwdGlvbigpO1xuICAgICAgICB2YXIgcm93cyA9IHRoaXMucmVuZGVyUm93cyh0aGlzLnBhbmVsQmFzZS5jc3NDbGFzc2VzKTtcbiAgICAgICAgdmFyIGVycm9ycyA9IChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyZWFjdHF1ZXN0aW9uX1N1cnZleUVsZW1lbnRFcnJvcnMsIHsgZWxlbWVudDogdGhpcy5wYW5lbEJhc2UsIGNzc0NsYXNzZXM6IHRoaXMucGFuZWxCYXNlLmNzc0NsYXNzZXMsIGNyZWF0b3I6IHRoaXMuY3JlYXRvciB9KSk7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyByZWY6IHRoaXMucm9vdFJlZiwgY2xhc3NOYW1lOiB0aGlzLnBhZ2UuY3NzUm9vdCB9LFxuICAgICAgICAgICAgdGl0bGUsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbixcbiAgICAgICAgICAgIGVycm9ycyxcbiAgICAgICAgICAgIHJvd3MpKTtcbiAgICB9O1xuICAgIFN1cnZleVBhZ2UucHJvdG90eXBlLnJlbmRlclRpdGxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0odGl0bGVfZWxlbWVudF9UaXRsZUVsZW1lbnQsIHsgZWxlbWVudDogdGhpcy5wYWdlIH0pO1xuICAgIH07XG4gICAgU3VydmV5UGFnZS5wcm90b3R5cGUucmVuZGVyRGVzY3JpcHRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5wYWdlLl9zaG93RGVzY3JpcHRpb24pXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgdmFyIHRleHQgPSByZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5RWxlbWVudEJhc2UucmVuZGVyTG9jU3RyaW5nKHRoaXMucGFnZS5sb2NEZXNjcmlwdGlvbik7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMucGFuZWxCYXNlLmNzc0NsYXNzZXMucGFnZS5kZXNjcmlwdGlvbiB9LCB0ZXh0KSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5UGFnZTtcbn0ocGFuZWxfYmFzZV9TdXJ2ZXlQYW5lbEJhc2UpKTtcblxuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvY29tcG9uZW50cy9zdXJ2ZXktaGVhZGVyL3N1cnZleS1oZWFkZXIudHN4XG52YXIgc3VydmV5X2hlYWRlcl9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cblxudmFyIHN1cnZleV9oZWFkZXJfU3VydmV5SGVhZGVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHN1cnZleV9oZWFkZXJfZXh0ZW5kcyhTdXJ2ZXlIZWFkZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5SGVhZGVyKHByb3BzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5zdGF0ZSA9IHsgY2hhbmdlZDogMCB9O1xuICAgICAgICBfdGhpcy5yb290UmVmID0gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVSZWYoKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5SGVhZGVyLnByb3RvdHlwZSwgXCJzdXJ2ZXlcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLnN1cnZleTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlIZWFkZXIucHJvdG90eXBlLCBcImNzc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuc3VydmV5LmNzcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleUhlYWRlci5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5zdXJ2ZXkuYWZ0ZXJSZW5kZXJIZWFkZXIodGhpcy5yb290UmVmLmN1cnJlbnQpO1xuICAgICAgICB0aGlzLnN1cnZleS5sb2NMb2dvLm9uQ2hhbmdlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHNlbGYuc2V0U3RhdGUoeyBjaGFuZ2VkOiBzZWxmLnN0YXRlLmNoYW5nZWQgKyAxIH0pO1xuICAgICAgICB9O1xuICAgIH07XG4gICAgU3VydmV5SGVhZGVyLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zdXJ2ZXkubG9jTG9nby5vbkNoYW5nZWQgPSBmdW5jdGlvbiAoKSB7IH07XG4gICAgfTtcbiAgICBTdXJ2ZXlIZWFkZXIucHJvdG90eXBlLnJlbmRlclRpdGxlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuc3VydmV5LnJlbmRlcmVkSGFzVGl0bGUpXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgdmFyIGRlc2NyaXB0aW9uID0gcmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleUVsZW1lbnRCYXNlLnJlbmRlckxvY1N0cmluZyh0aGlzLnN1cnZleS5sb2NEZXNjcmlwdGlvbik7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLmNzcy5oZWFkZXJUZXh0LCBzdHlsZTogeyBtYXhXaWR0aDogdGhpcy5zdXJ2ZXkudGl0bGVNYXhXaWR0aCB9IH0sXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQodGl0bGVfZWxlbWVudF9UaXRsZUVsZW1lbnQsIHsgZWxlbWVudDogdGhpcy5zdXJ2ZXkgfSksXG4gICAgICAgICAgICB0aGlzLnN1cnZleS5yZW5kZXJlZEhhc0Rlc2NyaXB0aW9uID8gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLmNzcy5kZXNjcmlwdGlvbiB9LCBkZXNjcmlwdGlvbikgOiBudWxsKSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlIZWFkZXIucHJvdG90eXBlLnJlbmRlckxvZ29JbWFnZSA9IGZ1bmN0aW9uIChpc1JlbmRlcikge1xuICAgICAgICBpZiAoIWlzUmVuZGVyKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIHZhciBjb21wb25lbnROYW1lID0gdGhpcy5zdXJ2ZXkuZ2V0RWxlbWVudFdyYXBwZXJDb21wb25lbnROYW1lKHRoaXMuc3VydmV5LCBcImxvZ28taW1hZ2VcIik7XG4gICAgICAgIHZhciBjb21wb25lbnREYXRhID0gdGhpcy5zdXJ2ZXkuZ2V0RWxlbWVudFdyYXBwZXJDb21wb25lbnREYXRhKHRoaXMuc3VydmV5LCBcImxvZ28taW1hZ2VcIik7XG4gICAgICAgIHJldHVybiBSZWFjdEVsZW1lbnRGYWN0b3J5Lkluc3RhbmNlLmNyZWF0ZUVsZW1lbnQoY29tcG9uZW50TmFtZSwge1xuICAgICAgICAgICAgZGF0YTogY29tcG9uZW50RGF0YSxcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlIZWFkZXIucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnN1cnZleS5yZW5kZXJlZEhhc0hlYWRlcilcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5jc3MuaGVhZGVyLCByZWY6IHRoaXMucm9vdFJlZiB9LFxuICAgICAgICAgICAgdGhpcy5yZW5kZXJMb2dvSW1hZ2UodGhpcy5zdXJ2ZXkuaXNMb2dvQmVmb3JlKSxcbiAgICAgICAgICAgIHRoaXMucmVuZGVyVGl0bGUoKSxcbiAgICAgICAgICAgIHRoaXMucmVuZGVyTG9nb0ltYWdlKHRoaXMuc3VydmV5LmlzTG9nb0FmdGVyKSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5jc3MuaGVhZGVyQ2xvc2UgfSkpKTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlIZWFkZXI7XG59KGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuQ29tcG9uZW50KSk7XG5cblJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJFbGVtZW50KFwic3VydmV5LWhlYWRlclwiLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KHN1cnZleV9oZWFkZXJfU3VydmV5SGVhZGVyLCBwcm9wcyk7XG59KTtcblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL2NvbXBvbmVudHMvYnJhbmQtaW5mby50c3hcbnZhciBicmFuZF9pbmZvX2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG52YXIgYnJhbmRfaW5mb19CcmFuZEluZm8gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgYnJhbmRfaW5mb19leHRlbmRzKEJyYW5kSW5mbywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBCcmFuZEluZm8oKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgQnJhbmRJbmZvLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN2LWJyYW5kLWluZm9cIiB9LFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiYVwiLCB7IGNsYXNzTmFtZTogXCJzdi1icmFuZC1pbmZvX19sb2dvXCIsIGhyZWY6IFwiaHR0cHM6Ly9zdXJ2ZXlqcy5pby8/dXRtX3NvdXJjZT1idWlsdC1pbl9saW5rcyZ1dG1fbWVkaXVtPW9ubGluZV9zdXJ2ZXlfdG9vbCZ1dG1fY2FtcGFpZ249bGFuZGluZ19wYWdlXCIgfSxcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJpbWdcIiwgeyBzcmM6IFwiaHR0cHM6Ly9zdXJ2ZXlqcy5pby9Db250ZW50L0ltYWdlcy9wb3dlcmVkYnkuc3ZnXCIgfSkpLFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN2LWJyYW5kLWluZm9fX3RleHRcIiB9LFxuICAgICAgICAgICAgICAgIFwiVHJ5IGFuZCBzZWUgaG93IGVhc3kgaXQgaXMgdG8gXCIsXG4gICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiYVwiLCB7IGhyZWY6IFwiaHR0cHM6Ly9zdXJ2ZXlqcy5pby9jcmVhdGUtc3VydmV5P3V0bV9zb3VyY2U9YnVpbHQtaW5fbGlua3MmdXRtX21lZGl1bT1vbmxpbmVfc3VydmV5X3Rvb2wmdXRtX2NhbXBhaWduPWNyZWF0ZV9zdXJ2ZXlcIiB9LCBcImNyZWF0ZSBhIHN1cnZleVwiKSksXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3YtYnJhbmQtaW5mb19fdGVybXNcIiB9LFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcImFcIiwgeyBocmVmOiBcImh0dHBzOi8vc3VydmV5anMuaW8vVGVybXNPZlVzZVwiIH0sIFwiVGVybXMgb2YgVXNlICYgUHJpdmFjeSBTdGF0ZW1lbnRcIikpKSk7XG4gICAgfTtcbiAgICByZXR1cm4gQnJhbmRJbmZvO1xufShleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLkNvbXBvbmVudCkpO1xuXG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9jb21wb25lbnRzL25vdGlmaWVyLnRzeFxudmFyIG5vdGlmaWVyX2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cblxuXG52YXIgbm90aWZpZXJfTm90aWZpZXJDb21wb25lbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgbm90aWZpZXJfZXh0ZW5kcyhOb3RpZmllckNvbXBvbmVudCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBOb3RpZmllckNvbXBvbmVudCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTm90aWZpZXJDb21wb25lbnQucHJvdG90eXBlLCBcIm5vdGlmaWVyXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5ub3RpZmllcjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE5vdGlmaWVyQ29tcG9uZW50LnByb3RvdHlwZS5nZXRTdGF0ZUVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5vdGlmaWVyO1xuICAgIH07XG4gICAgTm90aWZpZXJDb21wb25lbnQucHJvdG90eXBlLnJlbmRlckVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5ub3RpZmllci5pc0Rpc3BsYXllZClcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB2YXIgc3R5bGUgPSB7IHZpc2liaWxpdHk6IHRoaXMubm90aWZpZXIuYWN0aXZlID8gXCJ2aXNpYmxlXCIgOiBcImhpZGRlblwiIH07XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLm5vdGlmaWVyLmNzcywgc3R5bGU6IHN0eWxlLCByb2xlOiBcImFsZXJ0XCIsIFwiYXJpYS1saXZlXCI6IFwicG9saXRlXCIgfSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcInNwYW5cIiwgbnVsbCwgdGhpcy5ub3RpZmllci5tZXNzYWdlKSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChhY3Rpb25fYmFyX1N1cnZleUFjdGlvbkJhciwgeyBtb2RlbDogdGhpcy5ub3RpZmllci5hY3Rpb25CYXIgfSkpKTtcbiAgICB9O1xuICAgIHJldHVybiBOb3RpZmllckNvbXBvbmVudDtcbn0ocmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleUVsZW1lbnRCYXNlKSk7XG5cblJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJFbGVtZW50KFwic3Ytbm90aWZpZXJcIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChub3RpZmllcl9Ob3RpZmllckNvbXBvbmVudCwgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9jb21wb25lbnRzL2NvbXBvbmVudHMtY29udGFpbmVyLnRzeFxudmFyIGNvbXBvbmVudHNfY29udGFpbmVyX2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cbnZhciBjb21wb25lbnRzX2NvbnRhaW5lcl9Db21wb25lbnRzQ29udGFpbmVyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIGNvbXBvbmVudHNfY29udGFpbmVyX2V4dGVuZHMoQ29tcG9uZW50c0NvbnRhaW5lciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBDb21wb25lbnRzQ29udGFpbmVyKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIENvbXBvbmVudHNDb250YWluZXIucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGNvbXBvbmVudHMgPSB0aGlzLnByb3BzLnN1cnZleS5nZXRDb250YWluZXJDb250ZW50KHRoaXMucHJvcHMuY29udGFpbmVyKTtcbiAgICAgICAgdmFyIG5lZWRSZW5kZXJXcmFwcGVyID0gdGhpcy5wcm9wcy5uZWVkUmVuZGVyV3JhcHBlciA9PT0gZmFsc2UgPyBmYWxzZSA6IHRydWU7XG4gICAgICAgIGlmIChjb21wb25lbnRzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIW5lZWRSZW5kZXJXcmFwcGVyKSB7XG4gICAgICAgICAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuRnJhZ21lbnQsIG51bGwsIGNvbXBvbmVudHMubWFwKGZ1bmN0aW9uIChjb21wb25lbnQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5jcmVhdGVFbGVtZW50KGNvbXBvbmVudC5jb21wb25lbnQsIHsgc3VydmV5OiBfdGhpcy5wcm9wcy5zdXJ2ZXksIG1vZGVsOiBjb21wb25lbnQuZGF0YSwgY29udGFpbmVyOiBfdGhpcy5wcm9wcy5jb250YWluZXIsIGtleTogY29tcG9uZW50LmlkIH0pO1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3YtY29tcG9uZW50cy1jb2x1bW5cIiArIFwiIHN2LWNvbXBvbmVudHMtY29udGFpbmVyLVwiICsgdGhpcy5wcm9wcy5jb250YWluZXIgfSwgY29tcG9uZW50cy5tYXAoZnVuY3Rpb24gKGNvbXBvbmVudCkge1xuICAgICAgICAgICAgcmV0dXJuIFJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UuY3JlYXRlRWxlbWVudChjb21wb25lbnQuY29tcG9uZW50LCB7IHN1cnZleTogX3RoaXMucHJvcHMuc3VydmV5LCBtb2RlbDogY29tcG9uZW50LmRhdGEsIGNvbnRhaW5lcjogX3RoaXMucHJvcHMuY29udGFpbmVyLCBrZXk6IGNvbXBvbmVudC5pZCB9KTtcbiAgICAgICAgfSkpO1xuICAgIH07XG4gICAgcmV0dXJuIENvbXBvbmVudHNDb250YWluZXI7XG59KGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuQ29tcG9uZW50KSk7XG5cblJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJFbGVtZW50KFwic3YtY29tcG9uZW50cy1jb250YWluZXJcIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChjb21wb25lbnRzX2NvbnRhaW5lcl9Db21wb25lbnRzQ29udGFpbmVyLCBwcm9wcyk7XG59KTtcblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL3N2Z2J1bmRsZS50c3hcbnZhciBzdmdidW5kbGVfZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxudmFyIHN2Z2J1bmRsZV9TdmdCdW5kbGVDb21wb25lbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgc3ZnYnVuZGxlX2V4dGVuZHMoU3ZnQnVuZGxlQ29tcG9uZW50LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN2Z0J1bmRsZUNvbXBvbmVudChwcm9wcykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuY29udGFpbmVyUmVmID0gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVSZWYoKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBTdmdCdW5kbGVDb21wb25lbnQucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoISF0aGlzLmNvbnRhaW5lclJlZi5jdXJyZW50KSB7XG4gICAgICAgICAgICB0aGlzLmNvbnRhaW5lclJlZi5jdXJyZW50LmlubmVySFRNTCA9IGV4dGVybmFsX3Jvb3RfU3VydmV5X2NvbW1vbmpzMl9zdXJ2ZXlfY29yZV9jb21tb25qc19zdXJ2ZXlfY29yZV9hbWRfc3VydmV5X2NvcmVfW1wiU3ZnUmVnaXN0cnlcIl0uaWNvbnNSZW5kZXJlZEh0bWwoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3ZnQnVuZGxlQ29tcG9uZW50LnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzdmdTdHlsZSA9IHtcbiAgICAgICAgICAgIGRpc3BsYXk6IFwibm9uZVwiXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJzdmdcIiwgeyBzdHlsZTogc3ZnU3R5bGUsIGlkOiBcInN2LWljb24taG9sZGVyLWdsb2JhbC1jb250YWluZXJcIiwgcmVmOiB0aGlzLmNvbnRhaW5lclJlZiB9KTtcbiAgICB9O1xuICAgIHJldHVybiBTdmdCdW5kbGVDb21wb25lbnQ7XG59KGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuQ29tcG9uZW50KSk7XG5cblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL3JlYWN0U3VydmV5LnRzeFxudmFyIHJlYWN0U3VydmV5X2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xudmFyIF9fYXNzaWduID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19hc3NpZ24pIHx8IGZ1bmN0aW9uICgpIHtcbiAgICBfX2Fzc2lnbiA9IE9iamVjdC5hc3NpZ24gfHwgZnVuY3Rpb24odCkge1xuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcbiAgICAgICAgICAgIHMgPSBhcmd1bWVudHNbaV07XG4gICAgICAgICAgICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkpXG4gICAgICAgICAgICAgICAgdFtwXSA9IHNbcF07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHQ7XG4gICAgfTtcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbn07XG5cblxuXG5cblxuXG5cblxuXG5cblxudmFyIHJlYWN0U3VydmV5X1N1cnZleSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICByZWFjdFN1cnZleV9leHRlbmRzKFN1cnZleSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXkocHJvcHMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnByZXZpb3VzSlNPTiA9IHt9O1xuICAgICAgICBfdGhpcy5pc1N1cnZleVVwZGF0ZWQgPSBmYWxzZTtcbiAgICAgICAgX3RoaXMuY3JlYXRlU3VydmV5KHByb3BzKTtcbiAgICAgICAgX3RoaXMudXBkYXRlU3VydmV5KHByb3BzLCB7fSk7XG4gICAgICAgIF90aGlzLnJvb3RSZWYgPSBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlUmVmXCJdKCk7XG4gICAgICAgIF90aGlzLnJvb3ROb2RlSWQgPSBwcm9wcy5pZCB8fCBudWxsO1xuICAgICAgICBfdGhpcy5yb290Tm9kZUNsYXNzTmFtZSA9IHByb3BzLmNsYXNzTmFtZSB8fCBcIlwiO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXksIFwiY3NzVHlwZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfU3VydmV5X2NvbW1vbmpzMl9zdXJ2ZXlfY29yZV9jb21tb25qc19zdXJ2ZXlfY29yZV9hbWRfc3VydmV5X2NvcmVfW1wic3VydmV5Q3NzXCJdLmN1cnJlbnRUeXBlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9TdXJ2ZXlfY29tbW9uanMyX3N1cnZleV9jb3JlX2NvbW1vbmpzX3N1cnZleV9jb3JlX2FtZF9zdXJ2ZXlfY29yZV9bXCJTdHlsZXNNYW5hZ2VyXCJdLmFwcGx5VGhlbWUodmFsdWUpO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3VydmV5LnByb3RvdHlwZS5nZXRTdGF0ZUVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN1cnZleTtcbiAgICB9O1xuICAgIFN1cnZleS5wcm90b3R5cGUub25TdXJ2ZXlVcGRhdGVkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoISF0aGlzLnN1cnZleSkge1xuICAgICAgICAgICAgdmFyIGVsID0gdGhpcy5yb290UmVmLmN1cnJlbnQ7XG4gICAgICAgICAgICBpZiAoISFlbClcbiAgICAgICAgICAgICAgICB0aGlzLnN1cnZleS5hZnRlclJlbmRlclN1cnZleShlbCk7XG4gICAgICAgICAgICB0aGlzLnN1cnZleS5zdGFydFRpbWVyRnJvbVVJKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN1cnZleS5wcm90b3R5cGUuc2hvdWxkQ29tcG9uZW50VXBkYXRlID0gZnVuY3Rpb24gKG5leHRQcm9wcywgbmV4dFN0YXRlKSB7XG4gICAgICAgIGlmICghX3N1cGVyLnByb3RvdHlwZS5zaG91bGRDb21wb25lbnRVcGRhdGUuY2FsbCh0aGlzLCBuZXh0UHJvcHMsIG5leHRTdGF0ZSkpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIGlmICh0aGlzLmlzTW9kZWxKU09OQ2hhbmdlZChuZXh0UHJvcHMpKSB7XG4gICAgICAgICAgICB0aGlzLmRlc3Ryb3lTdXJ2ZXkoKTtcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlU3VydmV5KG5leHRQcm9wcyk7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN1cnZleShuZXh0UHJvcHMsIHt9KTtcbiAgICAgICAgICAgIHRoaXMuaXNTdXJ2ZXlVcGRhdGVkID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIFN1cnZleS5wcm90b3R5cGUuY29tcG9uZW50RGlkVXBkYXRlID0gZnVuY3Rpb24gKHByZXZQcm9wcywgcHJldlN0YXRlKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50RGlkVXBkYXRlLmNhbGwodGhpcywgcHJldlByb3BzLCBwcmV2U3RhdGUpO1xuICAgICAgICB0aGlzLnVwZGF0ZVN1cnZleSh0aGlzLnByb3BzLCBwcmV2UHJvcHMpO1xuICAgICAgICBpZiAodGhpcy5pc1N1cnZleVVwZGF0ZWQpIHtcbiAgICAgICAgICAgIHRoaXMub25TdXJ2ZXlVcGRhdGVkKCk7XG4gICAgICAgICAgICB0aGlzLmlzU3VydmV5VXBkYXRlZCA9IGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTdXJ2ZXkucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMub25TdXJ2ZXlVcGRhdGVkKCk7XG4gICAgfTtcbiAgICBTdXJ2ZXkucHJvdG90eXBlLmRlc3Ryb3lTdXJ2ZXkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnN1cnZleSkge1xuICAgICAgICAgICAgdGhpcy5zdXJ2ZXkucmVuZGVyQ2FsbGJhY2sgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB0aGlzLnN1cnZleS5vblBhcnRpYWxTZW5kLmNsZWFyKCk7XG4gICAgICAgICAgICB0aGlzLnN1cnZleS5zdG9wVGltZXIoKTtcbiAgICAgICAgICAgIHRoaXMuc3VydmV5LmRlc3Ryb3lSZXNpemVPYnNlcnZlcigpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTdXJ2ZXkucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuZGVzdHJveVN1cnZleSgpO1xuICAgIH07XG4gICAgU3VydmV5LnByb3RvdHlwZS5kb1JlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJlbmRlclJlc3VsdDtcbiAgICAgICAgaWYgKHRoaXMuc3VydmV5LnN0YXRlID09IFwiY29tcGxldGVkXCIpIHtcbiAgICAgICAgICAgIHJlbmRlclJlc3VsdCA9IHRoaXMucmVuZGVyQ29tcGxldGVkKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5zdXJ2ZXkuc3RhdGUgPT0gXCJjb21wbGV0ZWRiZWZvcmVcIikge1xuICAgICAgICAgICAgcmVuZGVyUmVzdWx0ID0gdGhpcy5yZW5kZXJDb21wbGV0ZWRCZWZvcmUoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLnN1cnZleS5zdGF0ZSA9PSBcImxvYWRpbmdcIikge1xuICAgICAgICAgICAgcmVuZGVyUmVzdWx0ID0gdGhpcy5yZW5kZXJMb2FkaW5nKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodGhpcy5zdXJ2ZXkuc3RhdGUgPT0gXCJlbXB0eVwiKSB7XG4gICAgICAgICAgICByZW5kZXJSZXN1bHQgPSB0aGlzLnJlbmRlckVtcHR5U3VydmV5KCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZW5kZXJSZXN1bHQgPSB0aGlzLnJlbmRlclN1cnZleSgpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBiYWNrZ3JvdW5kSW1hZ2UgPSAhIXRoaXMuc3VydmV5LmJhY2tncm91bmRJbWFnZSA/IGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLmNzcy5yb290QmFja2dyb3VuZEltYWdlLCBzdHlsZTogdGhpcy5zdXJ2ZXkuYmFja2dyb3VuZEltYWdlU3R5bGUgfSkgOiBudWxsO1xuICAgICAgICB2YXIgaGVhZGVyID0gdGhpcy5zdXJ2ZXkuaGVhZGVyVmlldyA9PT0gXCJiYXNpY1wiID8gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oc3VydmV5X2hlYWRlcl9TdXJ2ZXlIZWFkZXIsIHsgc3VydmV5OiB0aGlzLnN1cnZleSB9KSA6IG51bGw7XG4gICAgICAgIHZhciBvblN1Ym1pdCA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGN1c3RvbUhlYWRlciA9IGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN2X2N1c3RvbV9oZWFkZXJcIiB9KTtcbiAgICAgICAgaWYgKHRoaXMuc3VydmV5Lmhhc0xvZ28pIHtcbiAgICAgICAgICAgIGN1c3RvbUhlYWRlciA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJvb3RDc3MgPSB0aGlzLnN1cnZleS5nZXRSb290Q3NzKCk7XG4gICAgICAgIHZhciBjc3NDbGFzc2VzID0gdGhpcy5yb290Tm9kZUNsYXNzTmFtZSA/IHRoaXMucm9vdE5vZGVDbGFzc05hbWUgKyBcIiBcIiArIHJvb3RDc3MgOiByb290Q3NzO1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgaWQ6IHRoaXMucm9vdE5vZGVJZCwgcmVmOiB0aGlzLnJvb3RSZWYsIGNsYXNzTmFtZTogY3NzQ2xhc3Nlcywgc3R5bGU6IHRoaXMuc3VydmV5LnRoZW1lVmFyaWFibGVzLCBsYW5nOiB0aGlzLnN1cnZleS5sb2NhbGUgfHwgXCJlblwiLCBkaXI6IHRoaXMuc3VydmV5LmxvY2FsZURpciB9LFxuICAgICAgICAgICAgdGhpcy5zdXJ2ZXkubmVlZFJlbmRlckljb25zID8gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oc3ZnYnVuZGxlX1N2Z0J1bmRsZUNvbXBvbmVudCwgbnVsbCkgOiBudWxsLFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMuc3VydmV5LndyYXBwZXJGb3JtQ3NzIH0sXG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZEltYWdlLFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZm9ybVwiLCB7IG9uU3VibWl0OiBvblN1Ym1pdCB9LFxuICAgICAgICAgICAgICAgICAgICBjdXN0b21IZWFkZXIsXG4gICAgICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLmNzcy5jb250YWluZXIgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcixcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKGNvbXBvbmVudHNfY29udGFpbmVyX0NvbXBvbmVudHNDb250YWluZXIsIHsgc3VydmV5OiB0aGlzLnN1cnZleSwgY29udGFpbmVyOiBcImhlYWRlclwiLCBuZWVkUmVuZGVyV3JhcHBlcjogZmFsc2UgfSksXG4gICAgICAgICAgICAgICAgICAgICAgICByZW5kZXJSZXN1bHQsXG4gICAgICAgICAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShjb21wb25lbnRzX2NvbnRhaW5lcl9Db21wb25lbnRzQ29udGFpbmVyLCB7IHN1cnZleTogdGhpcy5zdXJ2ZXksIGNvbnRhaW5lcjogXCJmb290ZXJcIiwgbmVlZFJlbmRlcldyYXBwZXI6IGZhbHNlIH0pKSksXG4gICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0obm90aWZpZXJfTm90aWZpZXJDb21wb25lbnQsIHsgbm90aWZpZXI6IHRoaXMuc3VydmV5Lm5vdGlmaWVyIH0pKSkpO1xuICAgIH07XG4gICAgU3VydmV5LnByb3RvdHlwZS5yZW5kZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5kb1JlbmRlcigpO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleS5wcm90b3R5cGUsIFwiY3NzXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdXJ2ZXkuY3NzO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5zdXJ2ZXkuY3NzID0gdmFsdWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXkucHJvdG90eXBlLnJlbmRlckNvbXBsZXRlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnN1cnZleS5zaG93Q29tcGxldGVkUGFnZSlcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB2YXIgaHRtbFZhbHVlID0geyBfX2h0bWw6IHRoaXMuc3VydmV5LnByb2Nlc3NlZENvbXBsZXRlZEh0bWwgfTtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiRnJhZ21lbnRcIl0sIG51bGwsXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MOiBodG1sVmFsdWUsIGNsYXNzTmFtZTogdGhpcy5zdXJ2ZXkuY29tcGxldGVkQ3NzIH0pLFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oY29tcG9uZW50c19jb250YWluZXJfQ29tcG9uZW50c0NvbnRhaW5lciwgeyBzdXJ2ZXk6IHRoaXMuc3VydmV5LCBjb250YWluZXI6IFwiY29tcGxldGVQYWdlXCIsIG5lZWRSZW5kZXJXcmFwcGVyOiBmYWxzZSB9KSkpO1xuICAgIH07XG4gICAgU3VydmV5LnByb3RvdHlwZS5yZW5kZXJDb21wbGV0ZWRCZWZvcmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBodG1sVmFsdWUgPSB7IF9faHRtbDogdGhpcy5zdXJ2ZXkucHJvY2Vzc2VkQ29tcGxldGVkQmVmb3JlSHRtbCB9O1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgZGFuZ2Vyb3VzbHlTZXRJbm5lckhUTUw6IGh0bWxWYWx1ZSwgY2xhc3NOYW1lOiB0aGlzLnN1cnZleS5jb21wbGV0ZWRCZWZvcmVDc3MgfSkpO1xuICAgIH07XG4gICAgU3VydmV5LnByb3RvdHlwZS5yZW5kZXJMb2FkaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaHRtbFZhbHVlID0geyBfX2h0bWw6IHRoaXMuc3VydmV5LnByb2Nlc3NlZExvYWRpbmdIdG1sIH07XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBkYW5nZXJvdXNseVNldElubmVySFRNTDogaHRtbFZhbHVlLCBjbGFzc05hbWU6IHRoaXMuc3VydmV5LmxvYWRpbmdCb2R5Q3NzIH0pKTtcbiAgICB9O1xuICAgIFN1cnZleS5wcm90b3R5cGUucmVuZGVyU3VydmV5ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYWN0aXZlUGFnZSA9IHRoaXMuc3VydmV5LmFjdGl2ZVBhZ2VcbiAgICAgICAgICAgID8gdGhpcy5yZW5kZXJQYWdlKHRoaXMuc3VydmV5LmFjdGl2ZVBhZ2UpXG4gICAgICAgICAgICA6IG51bGw7XG4gICAgICAgIHZhciBpc1N0YXJpbmcgPSB0aGlzLnN1cnZleS5pc1Nob3dTdGFydGluZ1BhZ2U7XG4gICAgICAgIHZhciBwYWdlSWQgPSB0aGlzLnN1cnZleS5hY3RpdmVQYWdlID8gdGhpcy5zdXJ2ZXkuYWN0aXZlUGFnZS5pZCA6IFwiXCI7XG4gICAgICAgIHZhciBjbGFzc05hbWUgPSB0aGlzLnN1cnZleS5ib2R5Q3NzO1xuICAgICAgICB2YXIgc3R5bGUgPSB7fTtcbiAgICAgICAgaWYgKCEhdGhpcy5zdXJ2ZXkucmVuZGVyZWRXaWR0aCkge1xuICAgICAgICAgICAgc3R5bGUubWF4V2lkdGggPSB0aGlzLnN1cnZleS5yZW5kZXJlZFdpZHRoO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMuc3VydmV5LmJvZHlDb250YWluZXJDc3MgfSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKGNvbXBvbmVudHNfY29udGFpbmVyX0NvbXBvbmVudHNDb250YWluZXIsIHsgc3VydmV5OiB0aGlzLnN1cnZleSwgY29udGFpbmVyOiBcImxlZnRcIiB9KSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN2LWNvbXBvbmVudHMtY29sdW1uIHN2LWNvbXBvbmVudHMtY29sdW1uLS1leHBhbmRhYmxlXCIgfSxcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShjb21wb25lbnRzX2NvbnRhaW5lcl9Db21wb25lbnRzQ29udGFpbmVyLCB7IHN1cnZleTogdGhpcy5zdXJ2ZXksIGNvbnRhaW5lcjogXCJjZW50ZXJcIiB9KSxcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGlkOiBwYWdlSWQsIGNsYXNzTmFtZTogY2xhc3NOYW1lLCBzdHlsZTogc3R5bGUgfSxcbiAgICAgICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oY29tcG9uZW50c19jb250YWluZXJfQ29tcG9uZW50c0NvbnRhaW5lciwgeyBzdXJ2ZXk6IHRoaXMuc3VydmV5LCBjb250YWluZXI6IFwiY29udGVudFRvcFwiIH0pLFxuICAgICAgICAgICAgICAgICAgICBhY3RpdmVQYWdlLFxuICAgICAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShjb21wb25lbnRzX2NvbnRhaW5lcl9Db21wb25lbnRzQ29udGFpbmVyLCB7IHN1cnZleTogdGhpcy5zdXJ2ZXksIGNvbnRhaW5lcjogXCJjb250ZW50Qm90dG9tXCIgfSksXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc3VydmV5LnNob3dCcmFuZEluZm8gPyBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShicmFuZF9pbmZvX0JyYW5kSW5mbywgbnVsbCkgOiBudWxsKSksXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShjb21wb25lbnRzX2NvbnRhaW5lcl9Db21wb25lbnRzQ29udGFpbmVyLCB7IHN1cnZleTogdGhpcy5zdXJ2ZXksIGNvbnRhaW5lcjogXCJyaWdodFwiIH0pKSk7XG4gICAgfTtcbiAgICBTdXJ2ZXkucHJvdG90eXBlLnJlbmRlclBhZ2UgPSBmdW5jdGlvbiAocGFnZSkge1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHBhZ2VfU3VydmV5UGFnZSwgeyBzdXJ2ZXk6IHRoaXMuc3VydmV5LCBwYWdlOiBwYWdlLCBjc3M6IHRoaXMuY3NzLCBjcmVhdG9yOiB0aGlzIH0pKTtcbiAgICB9O1xuICAgIFN1cnZleS5wcm90b3R5cGUucmVuZGVyRW1wdHlTdXJ2ZXkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5jc3MuYm9keUVtcHR5IH0sIHRoaXMuc3VydmV5LmVtcHR5U3VydmV5VGV4dCk7XG4gICAgfTtcbiAgICBTdXJ2ZXkucHJvdG90eXBlLmNyZWF0ZVN1cnZleSA9IGZ1bmN0aW9uIChuZXdQcm9wcykge1xuICAgICAgICBpZiAoIW5ld1Byb3BzKVxuICAgICAgICAgICAgbmV3UHJvcHMgPSB7fTtcbiAgICAgICAgdGhpcy5wcmV2aW91c0pTT04gPSB7fTtcbiAgICAgICAgaWYgKG5ld1Byb3BzKSB7XG4gICAgICAgICAgICBpZiAobmV3UHJvcHMubW9kZWwpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN1cnZleSA9IG5ld1Byb3BzLm1vZGVsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgaWYgKG5ld1Byb3BzLmpzb24pIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wcmV2aW91c0pTT04gPSBuZXdQcm9wcy5qc29uO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN1cnZleSA9IG5ldyBleHRlcm5hbF9yb290X1N1cnZleV9jb21tb25qczJfc3VydmV5X2NvcmVfY29tbW9uanNfc3VydmV5X2NvcmVfYW1kX3N1cnZleV9jb3JlX1tcIlN1cnZleU1vZGVsXCJdKG5ld1Byb3BzLmpzb24pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuc3VydmV5ID0gbmV3IGV4dGVybmFsX3Jvb3RfU3VydmV5X2NvbW1vbmpzMl9zdXJ2ZXlfY29yZV9jb21tb25qc19zdXJ2ZXlfY29yZV9hbWRfc3VydmV5X2NvcmVfW1wiU3VydmV5TW9kZWxcIl0oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoISFuZXdQcm9wcy5jc3MpIHtcbiAgICAgICAgICAgIHRoaXMuc3VydmV5LmNzcyA9IHRoaXMuY3NzO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0U3VydmV5RXZlbnRzKCk7XG4gICAgfTtcbiAgICBTdXJ2ZXkucHJvdG90eXBlLmlzTW9kZWxKU09OQ2hhbmdlZCA9IGZ1bmN0aW9uIChuZXdQcm9wcykge1xuICAgICAgICBpZiAoISFuZXdQcm9wc1tcIm1vZGVsXCJdKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5zdXJ2ZXkgIT09IG5ld1Byb3BzW1wibW9kZWxcIl07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCEhbmV3UHJvcHNbXCJqc29uXCJdKSB7XG4gICAgICAgICAgICByZXR1cm4gIWV4dGVybmFsX3Jvb3RfU3VydmV5X2NvbW1vbmpzMl9zdXJ2ZXlfY29yZV9jb21tb25qc19zdXJ2ZXlfY29yZV9hbWRfc3VydmV5X2NvcmVfW1wiSGVscGVyc1wiXS5pc1R3b1ZhbHVlRXF1YWxzKG5ld1Byb3BzW1wianNvblwiXSwgdGhpcy5wcmV2aW91c0pTT04pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuICAgIFN1cnZleS5wcm90b3R5cGUudXBkYXRlU3VydmV5ID0gZnVuY3Rpb24gKG5ld1Byb3BzLCBvbGRQcm9wcykge1xuICAgICAgICBpZiAoIW5ld1Byb3BzKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBvbGRQcm9wcyA9IG9sZFByb3BzIHx8IHt9O1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gbmV3UHJvcHMpIHtcbiAgICAgICAgICAgIGlmIChrZXkgPT0gXCJtb2RlbFwiIHx8IGtleSA9PSBcImNoaWxkcmVuXCIgfHwga2V5ID09IFwianNvblwiKSB7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoa2V5ID09IFwiY3NzXCIpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN1cnZleS5tZXJnZVZhbHVlcyhuZXdQcm9wcy5jc3MsIHRoaXMuc3VydmV5LmdldENzcygpKTtcbiAgICAgICAgICAgICAgICB0aGlzLnN1cnZleVtcInVwZGF0ZU5hdmlnYXRpb25Dc3NcIl0oKTtcbiAgICAgICAgICAgICAgICB0aGlzLnN1cnZleVtcInVwZGF0ZUVsZW1lbnRDc3NcIl0oKTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChuZXdQcm9wc1trZXldID09PSBvbGRQcm9wc1trZXldKVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgaWYgKGtleS5pbmRleE9mKFwib25cIikgPT0gMCAmJiB0aGlzLnN1cnZleVtrZXldICYmIHRoaXMuc3VydmV5W2tleV0uYWRkKSB7XG4gICAgICAgICAgICAgICAgaWYgKCEhb2xkUHJvcHNba2V5XSkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnN1cnZleVtrZXldLnJlbW92ZShvbGRQcm9wc1trZXldKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5zdXJ2ZXlba2V5XS5hZGQobmV3UHJvcHNba2V5XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN1cnZleVtrZXldID0gbmV3UHJvcHNba2V5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgU3VydmV5LnByb3RvdHlwZS5zZXRTdXJ2ZXlFdmVudHMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5zdXJ2ZXkucmVuZGVyQ2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2YXIgY291bnRlciA9ICEhc2VsZi5zdGF0ZSAmJiAhIXNlbGYuc3RhdGUubW9kZWxDaGFuZ2VkID8gc2VsZi5zdGF0ZS5tb2RlbENoYW5nZWQgOiAwO1xuICAgICAgICAgICAgc2VsZi5zZXRTdGF0ZSh7IG1vZGVsQ2hhbmdlZDogY291bnRlciArIDEgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc3VydmV5Lm9uUGFydGlhbFNlbmQuYWRkKGZ1bmN0aW9uIChzZW5kZXIpIHtcbiAgICAgICAgICAgIGlmICghIXNlbGYuc3RhdGUpIHtcbiAgICAgICAgICAgICAgICBzZWxmLnNldFN0YXRlKHNlbGYuc3RhdGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIC8vSVN1cnZleUNyZWF0b3JcbiAgICBTdXJ2ZXkucHJvdG90eXBlLmNyZWF0ZVF1ZXN0aW9uRWxlbWVudCA9IGZ1bmN0aW9uIChxdWVzdGlvbikge1xuICAgICAgICByZXR1cm4gUmVhY3RRdWVzdGlvbkZhY3RvcnkuSW5zdGFuY2UuY3JlYXRlUXVlc3Rpb24ocXVlc3Rpb24uaXNEZWZhdWx0UmVuZGVyaW5nKCkgPyBxdWVzdGlvbi5nZXRUZW1wbGF0ZSgpIDogcXVlc3Rpb24uZ2V0Q29tcG9uZW50TmFtZSgpLCB7XG4gICAgICAgICAgICBxdWVzdGlvbjogcXVlc3Rpb24sXG4gICAgICAgICAgICBpc0Rpc3BsYXlNb2RlOiBxdWVzdGlvbi5pc0lucHV0UmVhZE9ubHksXG4gICAgICAgICAgICBjcmVhdG9yOiB0aGlzLFxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFN1cnZleS5wcm90b3R5cGUucmVuZGVyRXJyb3IgPSBmdW5jdGlvbiAoa2V5LCBlcnJvciwgY3NzQ2xhc3NlcywgZWxlbWVudCkge1xuICAgICAgICByZXR1cm4gUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5jcmVhdGVFbGVtZW50KHRoaXMuc3VydmV5LnF1ZXN0aW9uRXJyb3JDb21wb25lbnQsIHsga2V5OiBrZXksIGVycm9yOiBlcnJvciwgY3NzQ2xhc3NlczogY3NzQ2xhc3NlcywgZWxlbWVudDogZWxlbWVudCB9KTtcbiAgICB9O1xuICAgIFN1cnZleS5wcm90b3R5cGUucXVlc3Rpb25UaXRsZUxvY2F0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5zdXJ2ZXkucXVlc3Rpb25UaXRsZUxvY2F0aW9uO1xuICAgIH07XG4gICAgU3VydmV5LnByb3RvdHlwZS5xdWVzdGlvbkVycm9yTG9jYXRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN1cnZleS5xdWVzdGlvbkVycm9yTG9jYXRpb247XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5O1xufShyZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5RWxlbWVudEJhc2UpKTtcblxuUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlckVsZW1lbnQoXCJzdXJ2ZXlcIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHJlYWN0U3VydmV5X1N1cnZleSwgcHJvcHMpO1xufSk7XG5mdW5jdGlvbiBhdHRhY2hLZXkyY2xpY2soZWxlbWVudCwgdmlld01vZGVsLCBvcHRpb25zKSB7XG4gICAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgeyBvcHRpb25zID0geyBwcm9jZXNzRXNjOiB0cnVlLCBkaXNhYmxlVGFiU3RvcDogZmFsc2UgfTsgfVxuICAgIGlmICgoISF2aWV3TW9kZWwgJiYgdmlld01vZGVsLmRpc2FibGVUYWJTdG9wKSB8fCAoISFvcHRpb25zICYmIG9wdGlvbnMuZGlzYWJsZVRhYlN0b3ApKSB7XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY2xvbmVFbGVtZW50XCJdKGVsZW1lbnQsIHsgdGFiSW5kZXg6IC0xIH0pO1xuICAgIH1cbiAgICBvcHRpb25zID0gX19hc3NpZ24oe30sIG9wdGlvbnMpO1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY2xvbmVFbGVtZW50XCJdKGVsZW1lbnQsIHtcbiAgICAgICAgdGFiSW5kZXg6IDAsXG4gICAgICAgIG9uS2V5VXA6IGZ1bmN0aW9uIChldnQpIHtcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgZXZ0LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgT2JqZWN0KGV4dGVybmFsX3Jvb3RfU3VydmV5X2NvbW1vbmpzMl9zdXJ2ZXlfY29yZV9jb21tb25qc19zdXJ2ZXlfY29yZV9hbWRfc3VydmV5X2NvcmVfW1wiZG9LZXkyQ2xpY2tVcFwiXSkoZXZ0LCBvcHRpb25zKTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSxcbiAgICAgICAgb25LZXlEb3duOiBmdW5jdGlvbiAoZXZ0KSB7IHJldHVybiBPYmplY3QoZXh0ZXJuYWxfcm9vdF9TdXJ2ZXlfY29tbW9uanMyX3N1cnZleV9jb3JlX2NvbW1vbmpzX3N1cnZleV9jb3JlX2FtZF9zdXJ2ZXlfY29yZV9bXCJkb0tleTJDbGlja0Rvd25cIl0pKGV2dCwgb3B0aW9ucyk7IH0sXG4gICAgICAgIG9uQmx1cjogZnVuY3Rpb24gKGV2dCkgeyByZXR1cm4gT2JqZWN0KGV4dGVybmFsX3Jvb3RfU3VydmV5X2NvbW1vbmpzMl9zdXJ2ZXlfY29yZV9jb21tb25qc19zdXJ2ZXlfY29yZV9hbWRfc3VydmV5X2NvcmVfW1wiZG9LZXkyQ2xpY2tCbHVyXCJdKShldnQpOyB9LFxuICAgIH0pO1xufVxuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvcmVhY3RTdXJ2ZXlOYXZpZ2F0aW9uQmFzZS50c3hcbnZhciByZWFjdFN1cnZleU5hdmlnYXRpb25CYXNlX2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG52YXIgU3VydmV5TmF2aWdhdGlvbkJhc2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcmVhY3RTdXJ2ZXlOYXZpZ2F0aW9uQmFzZV9leHRlbmRzKFN1cnZleU5hdmlnYXRpb25CYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleU5hdmlnYXRpb25CYXNlKHByb3BzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy51cGRhdGVTdGF0ZUZ1bmN0aW9uID0gbnVsbDtcbiAgICAgICAgX3RoaXMuc3RhdGUgPSB7IHVwZGF0ZTogMCB9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUsIFwic3VydmV5XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5zdXJ2ZXk7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5TmF2aWdhdGlvbkJhc2UucHJvdG90eXBlLCBcImNzc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuY3NzIHx8IHRoaXMuc3VydmV5LmNzcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleU5hdmlnYXRpb25CYXNlLnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMuc3VydmV5KSB7XG4gICAgICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgICAgICB0aGlzLnVwZGF0ZVN0YXRlRnVuY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgc2VsZi5zZXRTdGF0ZSh7IHVwZGF0ZTogc2VsZi5zdGF0ZS51cGRhdGUgKyAxIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRoaXMuc3VydmV5Lm9uUGFnZVZpc2libGVDaGFuZ2VkLmFkZCh0aGlzLnVwZGF0ZVN0YXRlRnVuY3Rpb24pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTdXJ2ZXlOYXZpZ2F0aW9uQmFzZS5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnN1cnZleSAmJiB0aGlzLnVwZGF0ZVN0YXRlRnVuY3Rpb24pIHtcbiAgICAgICAgICAgIHRoaXMuc3VydmV5Lm9uUGFnZVZpc2libGVDaGFuZ2VkLnJlbW92ZSh0aGlzLnVwZGF0ZVN0YXRlRnVuY3Rpb24pO1xuICAgICAgICAgICAgdGhpcy51cGRhdGVTdGF0ZUZ1bmN0aW9uID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleU5hdmlnYXRpb25CYXNlO1xufShleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiQ29tcG9uZW50XCJdKSk7XG5cblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL3JlYWN0dGltZXJwYW5lbC50c3hcbnZhciByZWFjdHRpbWVycGFuZWxfZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG5cbnZhciByZWFjdHRpbWVycGFuZWxfU3VydmV5VGltZXJQYW5lbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICByZWFjdHRpbWVycGFuZWxfZXh0ZW5kcyhTdXJ2ZXlUaW1lclBhbmVsLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVRpbWVyUGFuZWwocHJvcHMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmNpcmNsZUxlbmd0aCA9IDQ0MDtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBTdXJ2ZXlUaW1lclBhbmVsLnByb3RvdHlwZS5nZXRTdGF0ZUVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnRpbWVyTW9kZWw7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5VGltZXJQYW5lbC5wcm90b3R5cGUsIFwidGltZXJNb2RlbFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMubW9kZWw7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5VGltZXJQYW5lbC5wcm90b3R5cGUsIFwicHJvZ3Jlc3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAtdGhpcy50aW1lck1vZGVsLnByb2dyZXNzICogdGhpcy5jaXJjbGVMZW5ndGg7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlUaW1lclBhbmVsLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy50aW1lck1vZGVsLmlzUnVubmluZykge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIHJlc3VsdCA9IGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLnRpbWVyTW9kZWwuc3VydmV5LmdldENzcygpLnRpbWVyUm9vdCB9LCB0aGlzLnRpbWVyTW9kZWwudGV4dCk7XG4gICAgICAgIGlmICh0aGlzLnRpbWVyTW9kZWwuc2hvd1RpbWVyQXNDbG9jaykge1xuICAgICAgICAgICAgdmFyIHN0eWxlID0geyBzdHJva2VEYXNoYXJyYXk6IHRoaXMuY2lyY2xlTGVuZ3RoLCBzdHJva2VEYXNob2Zmc2V0OiB0aGlzLnByb2dyZXNzIH07XG4gICAgICAgICAgICB2YXIgcHJvZ3Jlc3MgPSAodGhpcy50aW1lck1vZGVsLnNob3dQcm9ncmVzcyA/IGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHN2Z19pY29uX1N2Z0ljb24sIHsgY2xhc3NOYW1lOiB0aGlzLnRpbWVyTW9kZWwuZ2V0UHJvZ3Jlc3NDc3MoKSwgc3R5bGU6IHN0eWxlLCBpY29uTmFtZTogXCJpY29uLXRpbWVyY2lyY2xlXCIsIHNpemU6IFwiYXV0b1wiIH0pIDogbnVsbCk7XG4gICAgICAgICAgICByZXN1bHQgPVxuICAgICAgICAgICAgICAgIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy50aW1lck1vZGVsLnJvb3RDc3MgfSxcbiAgICAgICAgICAgICAgICAgICAgcHJvZ3Jlc3MsXG4gICAgICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLnRpbWVyTW9kZWwudGV4dENvbnRhaW5lckNzcyB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJzcGFuXCIsIHsgY2xhc3NOYW1lOiB0aGlzLnRpbWVyTW9kZWwubWFqb3JUZXh0Q3NzIH0sIHRoaXMudGltZXJNb2RlbC5jbG9ja01ham9yVGV4dCksXG4gICAgICAgICAgICAgICAgICAgICAgICAodGhpcy50aW1lck1vZGVsLmNsb2NrTWlub3JUZXh0ID8gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJzcGFuXCIsIHsgY2xhc3NOYW1lOiB0aGlzLnRpbWVyTW9kZWwubWlub3JUZXh0Q3NzIH0sIHRoaXMudGltZXJNb2RlbC5jbG9ja01pbm9yVGV4dCkgOiBudWxsKSkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVRpbWVyUGFuZWw7XG59KFJlYWN0U3VydmV5RWxlbWVudCkpO1xuXG5SZWFjdEVsZW1lbnRGYWN0b3J5Lkluc3RhbmNlLnJlZ2lzdGVyRWxlbWVudChcInN2LXRpbWVycGFuZWxcIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHJlYWN0dGltZXJwYW5lbF9TdXJ2ZXlUaW1lclBhbmVsLCBwcm9wcyk7XG59KTtcblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL3BhbmVsLnRzeFxudmFyIHBhbmVsX2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cblxuXG5cblxuXG5cblxudmFyIHBhbmVsX1N1cnZleVBhbmVsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHBhbmVsX2V4dGVuZHMoU3VydmV5UGFuZWwsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UGFuZWwocHJvcHMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmhhc0JlZW5FeHBhbmRlZCA9IGZhbHNlO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlQYW5lbC5wcm90b3R5cGUsIFwicGFuZWxcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnBhbmVsQmFzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleVBhbmVsLnByb3RvdHlwZS5yZW5kZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgaGVhZGVyID0gdGhpcy5yZW5kZXJIZWFkZXIoKTtcbiAgICAgICAgdmFyIGVycm9ycyA9IChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyZWFjdHF1ZXN0aW9uX1N1cnZleUVsZW1lbnRFcnJvcnMsIHsgZWxlbWVudDogdGhpcy5wYW5lbEJhc2UsIGNzc0NsYXNzZXM6IHRoaXMucGFuZWxCYXNlLmNzc0NsYXNzZXMsIGNyZWF0b3I6IHRoaXMuY3JlYXRvciB9KSk7XG4gICAgICAgIHZhciBzdHlsZSA9IHtcbiAgICAgICAgICAgIHBhZGRpbmdMZWZ0OiB0aGlzLnBhbmVsLmlubmVyUGFkZGluZ0xlZnQsXG4gICAgICAgICAgICBkaXNwbGF5OiB0aGlzLnBhbmVsLnJlbmRlcmVkSXNFeHBhbmRlZCA/IHVuZGVmaW5lZCA6IFwibm9uZVwiLFxuICAgICAgICB9O1xuICAgICAgICB2YXIgY29udGVudCA9IG51bGw7XG4gICAgICAgIGlmICh0aGlzLnBhbmVsLnJlbmRlcmVkSXNFeHBhbmRlZCkge1xuICAgICAgICAgICAgLy8gdGhpcy5oYXNCZWVuRXhwYW5kZWQgPSB0cnVlO1xuICAgICAgICAgICAgdmFyIHJvd3MgPSB0aGlzLnJlbmRlclJvd3ModGhpcy5wYW5lbEJhc2UuY3NzQ2xhc3Nlcyk7XG4gICAgICAgICAgICB2YXIgY2xhc3NOYW1lID0gdGhpcy5wYW5lbEJhc2UuY3NzQ2xhc3Nlcy5wYW5lbC5jb250ZW50O1xuICAgICAgICAgICAgY29udGVudCA9IHRoaXMucmVuZGVyQ29udGVudChzdHlsZSwgcm93cywgY2xhc3NOYW1lKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgZm9jdXNJbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIGlmIChfdGhpcy5wYW5lbEJhc2UpXG4gICAgICAgICAgICAgICAgX3RoaXMucGFuZWxCYXNlLmZvY3VzSW4oKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IHJlZjogdGhpcy5yb290UmVmLCBjbGFzc05hbWU6IHRoaXMucGFuZWxCYXNlLmdldENvbnRhaW5lckNzcygpLCBvbkZvY3VzOiBmb2N1c0luLCBpZDogdGhpcy5wYW5lbEJhc2UuaWQgfSxcbiAgICAgICAgICAgIHRoaXMucGFuZWwuc2hvd0Vycm9yc0Fib3ZlUGFuZWwgPyBlcnJvcnMgOiBudWxsLFxuICAgICAgICAgICAgaGVhZGVyLFxuICAgICAgICAgICAgdGhpcy5wYW5lbC5zaG93RXJyb3JzQWJvdmVQYW5lbCA/IG51bGwgOiBlcnJvcnMsXG4gICAgICAgICAgICBjb250ZW50KSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlQYW5lbC5wcm90b3R5cGUucmVuZGVySGVhZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMucGFuZWwuaGFzVGl0bGUgJiYgIXRoaXMucGFuZWwuaGFzRGVzY3JpcHRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShlbGVtZW50X2hlYWRlcl9TdXJ2ZXlFbGVtZW50SGVhZGVyLCB7IGVsZW1lbnQ6IHRoaXMucGFuZWwgfSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlQYW5lbC5wcm90b3R5cGUud3JhcEVsZW1lbnQgPSBmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgICAgICB2YXIgc3VydmV5ID0gdGhpcy5wYW5lbC5zdXJ2ZXk7XG4gICAgICAgIHZhciB3cmFwcGVyID0gbnVsbDtcbiAgICAgICAgaWYgKHN1cnZleSkge1xuICAgICAgICAgICAgd3JhcHBlciA9IHJlYWN0c3VydmV5bW9kZWxfUmVhY3RTdXJ2ZXlFbGVtZW50c1dyYXBwZXIud3JhcEVsZW1lbnQoc3VydmV5LCBlbGVtZW50LCB0aGlzLnBhbmVsKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gd3JhcHBlciAhPT0gbnVsbCAmJiB3cmFwcGVyICE9PSB2b2lkIDAgPyB3cmFwcGVyIDogZWxlbWVudDtcbiAgICB9O1xuICAgIFN1cnZleVBhbmVsLnByb3RvdHlwZS5yZW5kZXJDb250ZW50ID0gZnVuY3Rpb24gKHN0eWxlLCByb3dzLCBjbGFzc05hbWUpIHtcbiAgICAgICAgdmFyIGJvdHRvbSA9IHRoaXMucmVuZGVyQm90dG9tKCk7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBzdHlsZTogc3R5bGUsIGNsYXNzTmFtZTogY2xhc3NOYW1lLCBpZDogdGhpcy5wYW5lbC5jb250ZW50SWQgfSxcbiAgICAgICAgICAgIHJvd3MsXG4gICAgICAgICAgICBib3R0b20pKTtcbiAgICB9O1xuICAgIFN1cnZleVBhbmVsLnByb3RvdHlwZS5yZW5kZXJUaXRsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnBhbmVsQmFzZS50aXRsZSlcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0odGl0bGVfZWxlbWVudF9UaXRsZUVsZW1lbnQsIHsgZWxlbWVudDogdGhpcy5wYW5lbEJhc2UgfSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlQYW5lbC5wcm90b3R5cGUucmVuZGVyRGVzY3JpcHRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5wYW5lbEJhc2UuZGVzY3JpcHRpb24pXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgdmFyIHRleHQgPSByZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5RWxlbWVudEJhc2UucmVuZGVyTG9jU3RyaW5nKHRoaXMucGFuZWxCYXNlLmxvY0Rlc2NyaXB0aW9uKTtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5wYW5lbC5jc3NDbGFzc2VzLnBhbmVsLmRlc2NyaXB0aW9uIH0sIHRleHQpKTtcbiAgICB9O1xuICAgIFN1cnZleVBhbmVsLnByb3RvdHlwZS5yZW5kZXJCb3R0b20gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBmb290ZXJUb29sYmFyID0gdGhpcy5wYW5lbC5nZXRGb290ZXJUb29sYmFyKCk7XG4gICAgICAgIGlmICghZm9vdGVyVG9vbGJhci5oYXNBY3Rpb25zKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShhY3Rpb25fYmFyX1N1cnZleUFjdGlvbkJhciwgeyBtb2RlbDogZm9vdGVyVG9vbGJhciB9KTtcbiAgICB9O1xuICAgIFN1cnZleVBhbmVsLnByb3RvdHlwZS5nZXRJc1Zpc2libGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBhbmVsQmFzZS5nZXRJc0NvbnRlbnRWaXNpYmxlKCk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5UGFuZWw7XG59KHBhbmVsX2Jhc2VfU3VydmV5UGFuZWxCYXNlKSk7XG5cblJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJFbGVtZW50KFwicGFuZWxcIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHBhbmVsX1N1cnZleVBhbmVsLCBwcm9wcyk7XG59KTtcblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL2Zsb3ctcGFuZWwudHN4XG52YXIgZmxvd19wYW5lbF9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cblxudmFyIGZsb3dfcGFuZWxfU3VydmV5Rmxvd1BhbmVsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIGZsb3dfcGFuZWxfZXh0ZW5kcyhTdXJ2ZXlGbG93UGFuZWwsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5Rmxvd1BhbmVsKHByb3BzKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleUZsb3dQYW5lbC5wcm90b3R5cGUsIFwiZmxvd1BhbmVsXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wYW5lbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleUZsb3dQYW5lbC5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKCEhdGhpcy5mbG93UGFuZWwpIHtcbiAgICAgICAgICAgIHRoaXMuZmxvd1BhbmVsLm9uQ3VzdG9tSHRtbFByb2R1Y2luZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gXCJcIjtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmZsb3dQYW5lbC5vbkdldEh0bWxGb3JRdWVzdGlvbiA9IHRoaXMucmVuZGVyUXVlc3Rpb247XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN1cnZleUZsb3dQYW5lbC5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKCEhdGhpcy5mbG93UGFuZWwpIHtcbiAgICAgICAgICAgIHRoaXMuZmxvd1BhbmVsLm9uQ3VzdG9tSHRtbFByb2R1Y2luZyA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLmZsb3dQYW5lbC5vbkdldEh0bWxGb3JRdWVzdGlvbiA9IG51bGw7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN1cnZleUZsb3dQYW5lbC5wcm90b3R5cGUuZ2V0UXVlc3Rpb24gPSBmdW5jdGlvbiAobmFtZSkge1xuICAgICAgICByZXR1cm4gdGhpcy5mbG93UGFuZWwuZ2V0UXVlc3Rpb25CeU5hbWUobmFtZSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlGbG93UGFuZWwucHJvdG90eXBlLnJlbmRlclF1ZXN0aW9uID0gZnVuY3Rpb24gKHF1ZXN0aW9uKSB7XG4gICAgICAgIHJldHVybiBcIjxxdWVzdGlvbj5cIiArIHF1ZXN0aW9uLm5hbWUgKyBcIjwvcXVlc3Rpb24+XCI7XG4gICAgfTtcbiAgICBTdXJ2ZXlGbG93UGFuZWwucHJvdG90eXBlLnJlbmRlclJvd3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciByZXN1bHQgPSB0aGlzLnJlbmRlckh0bWwoKTtcbiAgICAgICAgaWYgKCEhcmVzdWx0KSB7XG4gICAgICAgICAgICByZXR1cm4gW3Jlc3VsdF07XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN1cnZleUZsb3dQYW5lbC5wcm90b3R5cGUuZ2V0Tm9kZUluZGV4ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJlZEluZGV4Kys7XG4gICAgfTtcbiAgICBTdXJ2ZXlGbG93UGFuZWwucHJvdG90eXBlLnJlbmRlckh0bWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5mbG93UGFuZWwpXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgdmFyIGh0bWwgPSBcIjxzcGFuPlwiICsgdGhpcy5mbG93UGFuZWwucHJvZHVjZUh0bWwoKSArIFwiPC9zcGFuPlwiO1xuICAgICAgICBpZiAoIURPTVBhcnNlcikge1xuICAgICAgICAgICAgdmFyIGh0bWxWYWx1ZSA9IHsgX19odG1sOiBodG1sIH07XG4gICAgICAgICAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBkYW5nZXJvdXNseVNldElubmVySFRNTDogaHRtbFZhbHVlIH0pO1xuICAgICAgICB9XG4gICAgICAgIHZhciBkb2MgPSBuZXcgRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKGh0bWwsIFwidGV4dC94bWxcIik7XG4gICAgICAgIHRoaXMucmVuZGVyZWRJbmRleCA9IDA7XG4gICAgICAgIHJldHVybiB0aGlzLnJlbmRlclBhcmVudE5vZGUoZG9jKTtcbiAgICB9O1xuICAgIFN1cnZleUZsb3dQYW5lbC5wcm90b3R5cGUucmVuZGVyTm9kZXMgPSBmdW5jdGlvbiAoZG9tTm9kZXMpIHtcbiAgICAgICAgdmFyIG5vZGVzID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZG9tTm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBub2RlID0gdGhpcy5yZW5kZXJOb2RlKGRvbU5vZGVzW2ldKTtcbiAgICAgICAgICAgIGlmICghIW5vZGUpIHtcbiAgICAgICAgICAgICAgICBub2Rlcy5wdXNoKG5vZGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBub2RlcztcbiAgICB9O1xuICAgIFN1cnZleUZsb3dQYW5lbC5wcm90b3R5cGUuZ2V0U3R5bGUgPSBmdW5jdGlvbiAobm9kZVR5cGUpIHtcbiAgICAgICAgdmFyIHN0eWxlID0ge307XG4gICAgICAgIGlmIChub2RlVHlwZS50b0xvd2VyQ2FzZSgpID09PSBcImJcIikge1xuICAgICAgICAgICAgc3R5bGUuZm9udFdlaWdodCA9IFwiYm9sZFwiO1xuICAgICAgICB9XG4gICAgICAgIGlmIChub2RlVHlwZS50b0xvd2VyQ2FzZSgpID09PSBcImlcIikge1xuICAgICAgICAgICAgc3R5bGUuZm9udFN0eWxlID0gXCJpdGFsaWNcIjtcbiAgICAgICAgfVxuICAgICAgICBpZiAobm9kZVR5cGUudG9Mb3dlckNhc2UoKSA9PT0gXCJ1XCIpIHtcbiAgICAgICAgICAgIHN0eWxlLnRleHREZWNvcmF0aW9uID0gXCJ1bmRlcmxpbmVcIjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gc3R5bGU7XG4gICAgfTtcbiAgICBTdXJ2ZXlGbG93UGFuZWwucHJvdG90eXBlLnJlbmRlclBhcmVudE5vZGUgPSBmdW5jdGlvbiAobm9kZSkge1xuICAgICAgICB2YXIgbm9kZVR5cGUgPSBub2RlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIHZhciBjaGlsZHJlbiA9IHRoaXMucmVuZGVyTm9kZXModGhpcy5nZXRDaGlsZERvbU5vZGVzKG5vZGUpKTtcbiAgICAgICAgaWYgKG5vZGVUeXBlID09PSBcImRpdlwiKVxuICAgICAgICAgICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsga2V5OiB0aGlzLmdldE5vZGVJbmRleCgpIH0sIGNoaWxkcmVuKTtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInNwYW5cIiwgeyBrZXk6IHRoaXMuZ2V0Tm9kZUluZGV4KCksIHN0eWxlOiB0aGlzLmdldFN0eWxlKG5vZGVUeXBlKSB9LCBjaGlsZHJlbikpO1xuICAgIH07XG4gICAgU3VydmV5Rmxvd1BhbmVsLnByb3RvdHlwZS5yZW5kZXJOb2RlID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgaWYgKCF0aGlzLmhhc1RleHRDaGlsZE5vZGVzT25seShub2RlKSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyUGFyZW50Tm9kZShub2RlKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbm9kZVR5cGUgPSBub2RlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGlmIChub2RlVHlwZSA9PT0gXCJxdWVzdGlvblwiKSB7XG4gICAgICAgICAgICB2YXIgcXVlc3Rpb24gPSB0aGlzLmZsb3dQYW5lbC5nZXRRdWVzdGlvbkJ5TmFtZShub2RlLnRleHRDb250ZW50KTtcbiAgICAgICAgICAgIGlmICghcXVlc3Rpb24pXG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB2YXIgcXVlc3Rpb25Cb2R5ID0gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHJlYWN0cXVlc3Rpb25fU3VydmV5UXVlc3Rpb24sIHsga2V5OiBxdWVzdGlvbi5uYW1lLCBlbGVtZW50OiBxdWVzdGlvbiwgY3JlYXRvcjogdGhpcy5jcmVhdG9yLCBjc3M6IHRoaXMuY3NzIH0pKTtcbiAgICAgICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInNwYW5cIiwgeyBrZXk6IHRoaXMuZ2V0Tm9kZUluZGV4KCkgfSwgcXVlc3Rpb25Cb2R5KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobm9kZVR5cGUgPT09IFwiZGl2XCIpIHtcbiAgICAgICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGtleTogdGhpcy5nZXROb2RlSW5kZXgoKSB9LCBub2RlLnRleHRDb250ZW50KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwic3BhblwiLCB7IGtleTogdGhpcy5nZXROb2RlSW5kZXgoKSwgc3R5bGU6IHRoaXMuZ2V0U3R5bGUobm9kZVR5cGUpIH0sIG5vZGUudGV4dENvbnRlbnQpKTtcbiAgICB9O1xuICAgIFN1cnZleUZsb3dQYW5lbC5wcm90b3R5cGUuZ2V0Q2hpbGREb21Ob2RlcyA9IGZ1bmN0aW9uIChub2RlKSB7XG4gICAgICAgIHZhciBkb21Ob2RlcyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGUuY2hpbGROb2Rlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgZG9tTm9kZXMucHVzaChub2RlLmNoaWxkTm9kZXNbaV0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBkb21Ob2RlcztcbiAgICB9O1xuICAgIFN1cnZleUZsb3dQYW5lbC5wcm90b3R5cGUuaGFzVGV4dENoaWxkTm9kZXNPbmx5ID0gZnVuY3Rpb24gKG5vZGUpIHtcbiAgICAgICAgdmFyIG5vZGVzID0gbm9kZS5jaGlsZE5vZGVzO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAobm9kZXNbaV0ubm9kZU5hbWUudG9Mb3dlckNhc2UoKSAhPT0gXCIjdGV4dFwiKVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIFN1cnZleUZsb3dQYW5lbC5wcm90b3R5cGUucmVuZGVyQ29udGVudCA9IGZ1bmN0aW9uIChzdHlsZSwgcm93cykge1xuICAgICAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJmLXBhbmVsXCIsIHsgc3R5bGU6IHN0eWxlIH0sIHJvd3MpO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleUZsb3dQYW5lbDtcbn0ocGFuZWxfU3VydmV5UGFuZWwpKTtcblxuUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlckVsZW1lbnQoXCJmbG93cGFuZWxcIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKGZsb3dfcGFuZWxfU3VydmV5Rmxvd1BhbmVsLCBwcm9wcyk7XG59KTtcblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL3JlYWN0cXVlc3Rpb25fY2hlY2tib3gudHN4XG52YXIgcmVhY3RxdWVzdGlvbl9jaGVja2JveF9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cblxuXG5cbnZhciByZWFjdHF1ZXN0aW9uX2NoZWNrYm94X1N1cnZleVF1ZXN0aW9uQ2hlY2tib3ggPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcmVhY3RxdWVzdGlvbl9jaGVja2JveF9leHRlbmRzKFN1cnZleVF1ZXN0aW9uQ2hlY2tib3gsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UXVlc3Rpb25DaGVja2JveChwcm9wcykge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbkNoZWNrYm94LnByb3RvdHlwZSwgXCJxdWVzdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucXVlc3Rpb25CYXNlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3VydmV5UXVlc3Rpb25DaGVja2JveC5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGNzc0NsYXNzZXMgPSB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXM7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJmaWVsZHNldFwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5nZXRTZWxlY3RCYXNlUm9vdENzcygpLCByZWY6IGZ1bmN0aW9uIChmaWVsZHNldCkgeyByZXR1cm4gKF90aGlzLnNldENvbnRyb2woZmllbGRzZXQpKTsgfSwgcm9sZTogdGhpcy5xdWVzdGlvbi5hMTF5X2lucHV0X2FyaWFSb2xlLCBcImFyaWEtcmVxdWlyZWRcIjogdGhpcy5xdWVzdGlvbi5hMTF5X2lucHV0X2FyaWFSZXF1aXJlZCwgXCJhcmlhLWxhYmVsXCI6IHRoaXMucXVlc3Rpb24uYTExeV9pbnB1dF9hcmlhTGFiZWwsIFwiYXJpYS1sYWJlbGxlZGJ5XCI6IHRoaXMucXVlc3Rpb24uYTExeV9pbnB1dF9hcmlhTGFiZWxsZWRCeSwgXCJhcmlhLWRlc2NyaWJlZGJ5XCI6IHRoaXMucXVlc3Rpb24uYTExeV9pbnB1dF9hcmlhRGVzY3JpYmVkQnksIFwiYXJpYS1pbnZhbGlkXCI6IHRoaXMucXVlc3Rpb24uYTExeV9pbnB1dF9hcmlhSW52YWxpZCwgXCJhcmlhLWVycm9ybWVzc2FnZVwiOiB0aGlzLnF1ZXN0aW9uLmExMXlfaW5wdXRfYXJpYUVycm9ybWVzc2FnZSB9LFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJsZWdlbmRcIiwgeyBjbGFzc05hbWU6IFwic3YtaGlkZGVuXCIgfSwgdGhpcy5xdWVzdGlvbi5sb2NUaXRsZS5yZW5kZXJlZEh0bWwpLFxuICAgICAgICAgICAgdGhpcy5nZXRIZWFkZXIoKSxcbiAgICAgICAgICAgIHRoaXMucXVlc3Rpb24uaGFzQ29sdW1uc1xuICAgICAgICAgICAgICAgID8gdGhpcy5nZXRDb2x1bW5lZEJvZHkoY3NzQ2xhc3NlcylcbiAgICAgICAgICAgICAgICA6IHRoaXMuZ2V0Qm9keShjc3NDbGFzc2VzKSxcbiAgICAgICAgICAgIHRoaXMuZ2V0Rm9vdGVyKCksXG4gICAgICAgICAgICB0aGlzLnF1ZXN0aW9uLmlzT3RoZXJTZWxlY3RlZCA/IHRoaXMucmVuZGVyT3RoZXIoKSA6IG51bGwpKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uQ2hlY2tib3gucHJvdG90eXBlLmdldEhlYWRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHRoaXMucXVlc3Rpb24uaGFzSGVhZEl0ZW1zKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5xdWVzdGlvbi5oZWFkSXRlbXMubWFwKGZ1bmN0aW9uIChpdGVtLCBpaSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5yZW5kZXJJdGVtKFwiaXRlbV9oXCIgKyBpaSwgaXRlbSwgZmFsc2UsIF90aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uQ2hlY2tib3gucHJvdG90eXBlLmdldEZvb3RlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHRoaXMucXVlc3Rpb24uaGFzRm9vdEl0ZW1zKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5xdWVzdGlvbi5mb290SXRlbXMubWFwKGZ1bmN0aW9uIChpdGVtLCBpaSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5yZW5kZXJJdGVtKFwiaXRlbV9mXCIgKyBpaSwgaXRlbSwgZmFsc2UsIF90aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uQ2hlY2tib3gucHJvdG90eXBlLmdldENvbHVtbmVkQm9keSA9IGZ1bmN0aW9uIChjc3NDbGFzc2VzKSB7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IGNzc0NsYXNzZXMucm9vdE11bHRpQ29sdW1uIH0sIHRoaXMuZ2V0Q29sdW1ucyhjc3NDbGFzc2VzKSkpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25DaGVja2JveC5wcm90b3R5cGUuZ2V0Q29sdW1ucyA9IGZ1bmN0aW9uIChjc3NDbGFzc2VzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiB0aGlzLnF1ZXN0aW9uLmNvbHVtbnMubWFwKGZ1bmN0aW9uIChjb2x1bW4sIGNpKSB7XG4gICAgICAgICAgICB2YXIgaXRlbXMgPSBjb2x1bW4ubWFwKGZ1bmN0aW9uIChpdGVtLCBpaSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5yZW5kZXJJdGVtKFwiaXRlbVwiICsgaWksIGl0ZW0sIGNpID09PSAwICYmIGlpID09PSAwLCBjc3NDbGFzc2VzLCBcIlwiICsgY2kgKyBpaSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBrZXk6IFwiY29sdW1uXCIgKyBjaSArIF90aGlzLnF1ZXN0aW9uLmdldEl0ZW1zQ29sdW1uS2V5KGNvbHVtbiksIGNsYXNzTmFtZTogX3RoaXMucXVlc3Rpb24uZ2V0Q29sdW1uQ2xhc3MoKSwgcm9sZTogXCJwcmVzZW50YXRpb25cIiB9LCBpdGVtcykpO1xuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uQ2hlY2tib3gucHJvdG90eXBlLmdldEJvZHkgPSBmdW5jdGlvbiAoY3NzQ2xhc3Nlcykge1xuICAgICAgICBpZiAodGhpcy5xdWVzdGlvbi5ibG9ja2VkUm93KSB7XG4gICAgICAgICAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IGNzc0NsYXNzZXMucm9vdFJvdyB9LCB0aGlzLmdldEl0ZW1zKGNzc0NsYXNzZXMsIHRoaXMucXVlc3Rpb24uZGF0YUNob2ljZXMpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcIkZyYWdtZW50XCJdLCBudWxsLCB0aGlzLmdldEl0ZW1zKGNzc0NsYXNzZXMsIHRoaXMucXVlc3Rpb24uYm9keUl0ZW1zKSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkNoZWNrYm94LnByb3RvdHlwZS5nZXRJdGVtcyA9IGZ1bmN0aW9uIChjc3NDbGFzc2VzLCBjaG9pY2VzKSB7XG4gICAgICAgIHZhciByZW5kZXJlZEl0ZW1zID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hvaWNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBjaG9pY2VzW2ldO1xuICAgICAgICAgICAgdmFyIGtleSA9IFwiaXRlbVwiICsgaTtcbiAgICAgICAgICAgIHZhciByZW5kZXJlZEl0ZW0gPSB0aGlzLnJlbmRlckl0ZW0oa2V5LCBpdGVtLCBpID09IDAsIGNzc0NsYXNzZXMsIFwiXCIgKyBpKTtcbiAgICAgICAgICAgIGlmICghIXJlbmRlcmVkSXRlbSkge1xuICAgICAgICAgICAgICAgIHJlbmRlcmVkSXRlbXMucHVzaChyZW5kZXJlZEl0ZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZW5kZXJlZEl0ZW1zO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uQ2hlY2tib3gucHJvdG90eXBlLCBcInRleHRTdHlsZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkNoZWNrYm94LnByb3RvdHlwZS5yZW5kZXJPdGhlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNzc0NsYXNzZXMgPSB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXM7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uZ2V0Q29tbWVudEFyZWFDc3ModHJ1ZSkgfSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFN1cnZleVF1ZXN0aW9uT3RoZXJWYWx1ZUl0ZW0sIHsgcXVlc3Rpb246IHRoaXMucXVlc3Rpb24sIG90aGVyQ3NzOiBjc3NDbGFzc2VzLm90aGVyLCBjc3NDbGFzc2VzOiBjc3NDbGFzc2VzLCBpc0Rpc3BsYXlNb2RlOiB0aGlzLmlzRGlzcGxheU1vZGUgfSkpKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uQ2hlY2tib3gucHJvdG90eXBlLnJlbmRlckl0ZW0gPSBmdW5jdGlvbiAoa2V5LCBpdGVtLCBpc0ZpcnN0LCBjc3NDbGFzc2VzLCBpbmRleCkge1xuICAgICAgICB2YXIgcmVuZGVyZWRJdGVtID0gUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5jcmVhdGVFbGVtZW50KHRoaXMucXVlc3Rpb24uaXRlbUNvbXBvbmVudCwge1xuICAgICAgICAgICAga2V5OiBrZXksXG4gICAgICAgICAgICBxdWVzdGlvbjogdGhpcy5xdWVzdGlvbixcbiAgICAgICAgICAgIGNzc0NsYXNzZXM6IGNzc0NsYXNzZXMsXG4gICAgICAgICAgICBpc0Rpc3BsYXlNb2RlOiB0aGlzLmlzRGlzcGxheU1vZGUsXG4gICAgICAgICAgICBpdGVtOiBpdGVtLFxuICAgICAgICAgICAgdGV4dFN0eWxlOiB0aGlzLnRleHRTdHlsZSxcbiAgICAgICAgICAgIGluZGV4OiBpbmRleCxcbiAgICAgICAgICAgIGlzRmlyc3Q6IGlzRmlyc3QsXG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgc3VydmV5ID0gdGhpcy5xdWVzdGlvbi5zdXJ2ZXk7XG4gICAgICAgIHZhciB3cmFwcGVkSXRlbSA9IG51bGw7XG4gICAgICAgIGlmICghIXN1cnZleSAmJiAhIXJlbmRlcmVkSXRlbSkge1xuICAgICAgICAgICAgd3JhcHBlZEl0ZW0gPSByZWFjdHN1cnZleW1vZGVsX1JlYWN0U3VydmV5RWxlbWVudHNXcmFwcGVyLndyYXBJdGVtVmFsdWUoc3VydmV5LCByZW5kZXJlZEl0ZW0sIHRoaXMucXVlc3Rpb24sIGl0ZW0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB3cmFwcGVkSXRlbSAhPT0gbnVsbCAmJiB3cmFwcGVkSXRlbSAhPT0gdm9pZCAwID8gd3JhcHBlZEl0ZW0gOiByZW5kZXJlZEl0ZW07XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5UXVlc3Rpb25DaGVja2JveDtcbn0ocmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleVF1ZXN0aW9uRWxlbWVudEJhc2UpKTtcblxudmFyIHJlYWN0cXVlc3Rpb25fY2hlY2tib3hfU3VydmV5UXVlc3Rpb25DaGVja2JveEl0ZW0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcmVhY3RxdWVzdGlvbl9jaGVja2JveF9leHRlbmRzKFN1cnZleVF1ZXN0aW9uQ2hlY2tib3hJdGVtLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uQ2hlY2tib3hJdGVtKHByb3BzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5oYW5kbGVPbkNoYW5nZSA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgX3RoaXMucXVlc3Rpb24uY2xpY2tJdGVtSGFuZGxlcihfdGhpcy5pdGVtLCBldmVudC50YXJnZXQuY2hlY2tlZCk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgU3VydmV5UXVlc3Rpb25DaGVja2JveEl0ZW0ucHJvdG90eXBlLmdldFN0YXRlRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlbTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbkNoZWNrYm94SXRlbS5wcm90b3R5cGUsIFwicXVlc3Rpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLnF1ZXN0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uQ2hlY2tib3hJdGVtLnByb3RvdHlwZSwgXCJpdGVtXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5pdGVtO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uQ2hlY2tib3hJdGVtLnByb3RvdHlwZSwgXCJ0ZXh0U3R5bGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLnRleHRTdHlsZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbkNoZWNrYm94SXRlbS5wcm90b3R5cGUsIFwiaXNGaXJzdFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuaXNGaXJzdDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbkNoZWNrYm94SXRlbS5wcm90b3R5cGUsIFwiaW5kZXhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLmluZGV4O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uQ2hlY2tib3hJdGVtLnByb3RvdHlwZSwgXCJoaWRlQ2FwdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuaGlkZUNhcHRpb24gPT09IHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkNoZWNrYm94SXRlbS5wcm90b3R5cGUuc2hvdWxkQ29tcG9uZW50VXBkYXRlID0gZnVuY3Rpb24gKG5leHRQcm9wcywgbmV4dFN0YXRlKSB7XG4gICAgICAgIGlmICghX3N1cGVyLnByb3RvdHlwZS5zaG91bGRDb21wb25lbnRVcGRhdGUuY2FsbCh0aGlzLCBuZXh0UHJvcHMsIG5leHRTdGF0ZSkpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIGlmICghdGhpcy5xdWVzdGlvbilcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgcmV0dXJuICghdGhpcy5xdWVzdGlvbi5jdXN0b21XaWRnZXQgfHxcbiAgICAgICAgICAgICEhdGhpcy5xdWVzdGlvbi5jdXN0b21XaWRnZXREYXRhLmlzTmVlZFJlbmRlciB8fFxuICAgICAgICAgICAgISF0aGlzLnF1ZXN0aW9uLmN1c3RvbVdpZGdldC53aWRnZXRKc29uLmlzRGVmYXVsdFJlbmRlciB8fFxuICAgICAgICAgICAgISF0aGlzLnF1ZXN0aW9uLmN1c3RvbVdpZGdldC53aWRnZXRKc29uLnJlbmRlcik7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkNoZWNrYm94SXRlbS5wcm90b3R5cGUuY2FuUmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gISF0aGlzLml0ZW0gJiYgISF0aGlzLnF1ZXN0aW9uO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25DaGVja2JveEl0ZW0ucHJvdG90eXBlLnJlbmRlckVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpc0NoZWNrZWQgPSB0aGlzLnF1ZXN0aW9uLmlzSXRlbVNlbGVjdGVkKHRoaXMuaXRlbSk7XG4gICAgICAgIHJldHVybiB0aGlzLnJlbmRlckNoZWNrYm94KGlzQ2hlY2tlZCwgbnVsbCk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25DaGVja2JveEl0ZW0ucHJvdG90eXBlLCBcImlucHV0U3R5bGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsOyAvL3sgbWFyZ2luUmlnaHQ6IFwiM3B4XCIgfTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleVF1ZXN0aW9uQ2hlY2tib3hJdGVtLnByb3RvdHlwZS5yZW5kZXJDaGVja2JveCA9IGZ1bmN0aW9uIChpc0NoZWNrZWQsIG90aGVySXRlbSkge1xuICAgICAgICB2YXIgaWQgPSB0aGlzLnF1ZXN0aW9uLmdldEl0ZW1JZCh0aGlzLml0ZW0pO1xuICAgICAgICB2YXIgaXRlbUNsYXNzID0gdGhpcy5xdWVzdGlvbi5nZXRJdGVtQ2xhc3ModGhpcy5pdGVtKTtcbiAgICAgICAgdmFyIGxhYmVsQ2xhc3MgPSB0aGlzLnF1ZXN0aW9uLmdldExhYmVsQ2xhc3ModGhpcy5pdGVtKTtcbiAgICAgICAgdmFyIGl0ZW1MYWJlbCA9ICF0aGlzLmhpZGVDYXB0aW9uID8gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJzcGFuXCIsIHsgY2xhc3NOYW1lOiB0aGlzLmNzc0NsYXNzZXMuY29udHJvbExhYmVsIH0sIHRoaXMucmVuZGVyTG9jU3RyaW5nKHRoaXMuaXRlbS5sb2NUZXh0LCB0aGlzLnRleHRTdHlsZSkpIDogbnVsbDtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogaXRlbUNsYXNzLCByb2xlOiBcInByZXNlbnRhdGlvblwiIH0sXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImxhYmVsXCIsIHsgY2xhc3NOYW1lOiBsYWJlbENsYXNzIH0sXG4gICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJpbnB1dFwiLCB7IGNsYXNzTmFtZTogdGhpcy5jc3NDbGFzc2VzLml0ZW1Db250cm9sLCB0eXBlOiBcImNoZWNrYm94XCIsIG5hbWU6IHRoaXMucXVlc3Rpb24ubmFtZSArIHRoaXMuaXRlbS5pZCwgdmFsdWU6IHRoaXMuaXRlbS52YWx1ZSwgaWQ6IGlkLCBzdHlsZTogdGhpcy5pbnB1dFN0eWxlLCBkaXNhYmxlZDogIXRoaXMucXVlc3Rpb24uZ2V0SXRlbUVuYWJsZWQodGhpcy5pdGVtKSwgcmVhZE9ubHk6IHRoaXMucXVlc3Rpb24uaXNSZWFkT25seUF0dHIsIGNoZWNrZWQ6IGlzQ2hlY2tlZCwgb25DaGFuZ2U6IHRoaXMuaGFuZGxlT25DaGFuZ2UsIHJlcXVpcmVkOiB0aGlzLnF1ZXN0aW9uLmhhc1JlcXVpcmVkRXJyb3IoKSB9KSxcbiAgICAgICAgICAgICAgICB0aGlzLmNzc0NsYXNzZXMubWF0ZXJpYWxEZWNvcmF0b3IgP1xuICAgICAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInNwYW5cIiwgeyBjbGFzc05hbWU6IHRoaXMuY3NzQ2xhc3Nlcy5tYXRlcmlhbERlY29yYXRvciB9LCB0aGlzLnF1ZXN0aW9uLml0ZW1TdmdJY29uID9cbiAgICAgICAgICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwic3ZnXCIsIHsgY2xhc3NOYW1lOiB0aGlzLmNzc0NsYXNzZXMuaXRlbURlY29yYXRvciB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwidXNlXCIsIHsgeGxpbmtIcmVmOiB0aGlzLnF1ZXN0aW9uLml0ZW1TdmdJY29uIH0pKSA6XG4gICAgICAgICAgICAgICAgICAgICAgICBudWxsKSA6XG4gICAgICAgICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICAgICAgaXRlbUxhYmVsKSxcbiAgICAgICAgICAgIG90aGVySXRlbSkpO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVF1ZXN0aW9uQ2hlY2tib3hJdGVtO1xufShSZWFjdFN1cnZleUVsZW1lbnQpKTtcblxuUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlckVsZW1lbnQoXCJzdXJ2ZXktY2hlY2tib3gtaXRlbVwiLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0ocmVhY3RxdWVzdGlvbl9jaGVja2JveF9TdXJ2ZXlRdWVzdGlvbkNoZWNrYm94SXRlbSwgcHJvcHMpO1xufSk7XG5SZWFjdFF1ZXN0aW9uRmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlclF1ZXN0aW9uKFwiY2hlY2tib3hcIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHJlYWN0cXVlc3Rpb25fY2hlY2tib3hfU3VydmV5UXVlc3Rpb25DaGVja2JveCwgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9yZWFjdHF1ZXN0aW9uX3JhbmtpbmcudHN4XG52YXIgcmVhY3RxdWVzdGlvbl9yYW5raW5nX2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cblxuXG5cbnZhciByZWFjdHF1ZXN0aW9uX3JhbmtpbmdfU3VydmV5UXVlc3Rpb25SYW5raW5nID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJlYWN0cXVlc3Rpb25fcmFua2luZ19leHRlbmRzKFN1cnZleVF1ZXN0aW9uUmFua2luZywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlRdWVzdGlvblJhbmtpbmcoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uUmFua2luZy5wcm90b3R5cGUsIFwicXVlc3Rpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnF1ZXN0aW9uQmFzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleVF1ZXN0aW9uUmFua2luZy5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCF0aGlzLnF1ZXN0aW9uLnNlbGVjdFRvUmFua0VuYWJsZWQpIHtcbiAgICAgICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24ucm9vdENsYXNzLCByZWY6IGZ1bmN0aW9uIChyb290KSB7IHJldHVybiAoX3RoaXMuc2V0Q29udHJvbChyb290KSk7IH0gfSwgdGhpcy5nZXRJdGVtcygpKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB2YXIgdW5yYW5rZWRJdGVtID0gdHJ1ZTtcbiAgICAgICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24ucm9vdENsYXNzLCByZWY6IGZ1bmN0aW9uIChyb290KSB7IHJldHVybiAoX3RoaXMuc2V0Q29udHJvbChyb290KSk7IH0gfSxcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5nZXRDb250YWluZXJDbGFzc2VzKFwiZnJvbVwiKSwgXCJkYXRhLXJhbmtpbmdcIjogXCJmcm9tLWNvbnRhaW5lclwiIH0sXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0SXRlbXModGhpcy5xdWVzdGlvbi5yZW5kZXJlZFVuUmFua2luZ0Nob2ljZXMsIHVucmFua2VkSXRlbSksXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucXVlc3Rpb24ucmVuZGVyZWRVblJhbmtpbmdDaG9pY2VzLmxlbmd0aCA9PT0gMCA/IGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMuY29udGFpbmVyUGxhY2Vob2xkZXIgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiIFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJMb2NTdHJpbmcodGhpcy5xdWVzdGlvbi5sb2NTZWxlY3RUb1JhbmtFbXB0eVJhbmtlZEFyZWFUZXh0KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiIFwiKSA6IG51bGwpLFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMuY29udGFpbmVyc0RpdmlkZXIgfSksXG4gICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uZ2V0Q29udGFpbmVyQ2xhc3NlcyhcInRvXCIpLCBcImRhdGEtcmFua2luZ1wiOiBcInRvLWNvbnRhaW5lclwiIH0sXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0SXRlbXMoKSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWVzdGlvbi5yZW5kZXJlZFJhbmtpbmdDaG9pY2VzLmxlbmd0aCA9PT0gMCA/IGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMuY29udGFpbmVyUGxhY2Vob2xkZXIgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiIFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJMb2NTdHJpbmcodGhpcy5xdWVzdGlvbi5sb2NTZWxlY3RUb1JhbmtFbXB0eVVucmFua2VkQXJlYVRleHQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCIgXCIpIDogbnVsbCkpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25SYW5raW5nLnByb3RvdHlwZS5nZXRJdGVtcyA9IGZ1bmN0aW9uIChjaG9pY2VzLCB1bnJhbmtlZEl0ZW0pIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKGNob2ljZXMgPT09IHZvaWQgMCkgeyBjaG9pY2VzID0gdGhpcy5xdWVzdGlvbi5yZW5kZXJlZFJhbmtpbmdDaG9pY2VzOyB9XG4gICAgICAgIHZhciBpdGVtcyA9IFtdO1xuICAgICAgICB2YXIgX2xvb3BfMSA9IGZ1bmN0aW9uIChpKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IGNob2ljZXNbaV07XG4gICAgICAgICAgICBpdGVtcy5wdXNoKHRoaXNfMS5yZW5kZXJJdGVtKGl0ZW0sIGksIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIF90aGlzLnF1ZXN0aW9uLmhhbmRsZUtleWRvd24uY2FsbChfdGhpcy5xdWVzdGlvbiwgZXZlbnQsIGl0ZW0pO1xuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgZXZlbnQucGVyc2lzdCgpO1xuICAgICAgICAgICAgICAgIC8vZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgICAgICBfdGhpcy5xdWVzdGlvbi5oYW5kbGVQb2ludGVyRG93bi5jYWxsKF90aGlzLnF1ZXN0aW9uLCBldmVudCwgaXRlbSwgZXZlbnQuY3VycmVudFRhcmdldCk7XG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgICAgICBldmVudC5wZXJzaXN0KCk7XG4gICAgICAgICAgICAgICAgLy9ldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgICAgIF90aGlzLnF1ZXN0aW9uLmhhbmRsZVBvaW50ZXJVcC5jYWxsKF90aGlzLnF1ZXN0aW9uLCBldmVudCwgaXRlbSwgZXZlbnQuY3VycmVudFRhcmdldCk7XG4gICAgICAgICAgICB9LCB0aGlzXzEucXVlc3Rpb24uY3NzQ2xhc3NlcywgdGhpc18xLnF1ZXN0aW9uLmdldEl0ZW1DbGFzcyhpdGVtKSwgdGhpc18xLnF1ZXN0aW9uLCB1bnJhbmtlZEl0ZW0pKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHRoaXNfMSA9IHRoaXM7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hvaWNlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgX2xvb3BfMShpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaXRlbXM7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvblJhbmtpbmcucHJvdG90eXBlLnJlbmRlckl0ZW0gPSBmdW5jdGlvbiAoaXRlbSwgaSwgaGFuZGxlS2V5ZG93biwgaGFuZGxlUG9pbnRlckRvd24sIGhhbmRsZVBvaW50ZXJVcCwgY3NzQ2xhc3NlcywgaXRlbUNsYXNzLCBxdWVzdGlvbiwgdW5yYW5rZWRJdGVtKSB7XG4gICAgICAgIHZhciBrZXkgPSBcImlkLVwiICsgaXRlbS5yZW5kZXJlZElkO1xuICAgICAgICB2YXIgdGV4dCA9IHRoaXMucmVuZGVyTG9jU3RyaW5nKGl0ZW0ubG9jVGV4dCk7XG4gICAgICAgIHZhciBpbmRleCA9IGk7XG4gICAgICAgIHZhciBpbmRleFRleHQgPSB0aGlzLnF1ZXN0aW9uLmdldE51bWJlckJ5SW5kZXgoaW5kZXgpO1xuICAgICAgICB2YXIgdGFiSW5kZXggPSB0aGlzLnF1ZXN0aW9uLmdldEl0ZW1UYWJJbmRleChpdGVtKTtcbiAgICAgICAgdmFyIHJlbmRlcmVkSXRlbSA9IChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyZWFjdHF1ZXN0aW9uX3JhbmtpbmdfU3VydmV5UXVlc3Rpb25SYW5raW5nSXRlbSwgeyBrZXk6IGl0ZW0udmFsdWUsIHRleHQ6IHRleHQsIGluZGV4OiBpbmRleCwgaW5kZXhUZXh0OiBpbmRleFRleHQsIGl0ZW1UYWJJbmRleDogdGFiSW5kZXgsIGhhbmRsZUtleWRvd246IGhhbmRsZUtleWRvd24sIGhhbmRsZVBvaW50ZXJEb3duOiBoYW5kbGVQb2ludGVyRG93biwgaGFuZGxlUG9pbnRlclVwOiBoYW5kbGVQb2ludGVyVXAsIGNzc0NsYXNzZXM6IGNzc0NsYXNzZXMsIGl0ZW1DbGFzczogaXRlbUNsYXNzLCBxdWVzdGlvbjogcXVlc3Rpb24sIHVucmFua2VkSXRlbTogdW5yYW5rZWRJdGVtLCBpdGVtOiBpdGVtIH0pKTtcbiAgICAgICAgdmFyIHN1cnZleSA9IHRoaXMucXVlc3Rpb24uc3VydmV5O1xuICAgICAgICB2YXIgd3JhcHBlZEl0ZW0gPSBudWxsO1xuICAgICAgICBpZiAoISFzdXJ2ZXkpIHtcbiAgICAgICAgICAgIHdyYXBwZWRJdGVtID0gcmVhY3RzdXJ2ZXltb2RlbF9SZWFjdFN1cnZleUVsZW1lbnRzV3JhcHBlci53cmFwSXRlbVZhbHVlKHN1cnZleSwgcmVuZGVyZWRJdGVtLCB0aGlzLnF1ZXN0aW9uLCBpdGVtKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gd3JhcHBlZEl0ZW0gIT09IG51bGwgJiYgd3JhcHBlZEl0ZW0gIT09IHZvaWQgMCA/IHdyYXBwZWRJdGVtIDogcmVuZGVyZWRJdGVtO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVF1ZXN0aW9uUmFua2luZztcbn0ocmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleVF1ZXN0aW9uRWxlbWVudEJhc2UpKTtcblxudmFyIHJlYWN0cXVlc3Rpb25fcmFua2luZ19TdXJ2ZXlRdWVzdGlvblJhbmtpbmdJdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJlYWN0cXVlc3Rpb25fcmFua2luZ19leHRlbmRzKFN1cnZleVF1ZXN0aW9uUmFua2luZ0l0ZW0sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UXVlc3Rpb25SYW5raW5nSXRlbSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25SYW5raW5nSXRlbS5wcm90b3R5cGUsIFwidGV4dFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMudGV4dDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvblJhbmtpbmdJdGVtLnByb3RvdHlwZSwgXCJpbmRleFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuaW5kZXg7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25SYW5raW5nSXRlbS5wcm90b3R5cGUsIFwiaW5kZXhUZXh0XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5pbmRleFRleHQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25SYW5raW5nSXRlbS5wcm90b3R5cGUsIFwiaGFuZGxlS2V5ZG93blwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuaGFuZGxlS2V5ZG93bjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvblJhbmtpbmdJdGVtLnByb3RvdHlwZSwgXCJoYW5kbGVQb2ludGVyRG93blwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuaGFuZGxlUG9pbnRlckRvd247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25SYW5raW5nSXRlbS5wcm90b3R5cGUsIFwiaGFuZGxlUG9pbnRlclVwXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5oYW5kbGVQb2ludGVyVXA7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25SYW5raW5nSXRlbS5wcm90b3R5cGUsIFwiY3NzQ2xhc3Nlc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuY3NzQ2xhc3NlcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvblJhbmtpbmdJdGVtLnByb3RvdHlwZSwgXCJpdGVtQ2xhc3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLml0ZW1DbGFzcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvblJhbmtpbmdJdGVtLnByb3RvdHlwZSwgXCJpdGVtVGFiSW5kZXhcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLml0ZW1UYWJJbmRleDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvblJhbmtpbmdJdGVtLnByb3RvdHlwZSwgXCJxdWVzdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMucXVlc3Rpb247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25SYW5raW5nSXRlbS5wcm90b3R5cGUsIFwidW5yYW5rZWRJdGVtXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy51bnJhbmtlZEl0ZW07XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25SYW5raW5nSXRlbS5wcm90b3R5cGUsIFwiaXRlbVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuaXRlbTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleVF1ZXN0aW9uUmFua2luZ0l0ZW0ucHJvdG90eXBlLnJlbmRlckVtcHR5SWNvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInN2Z1wiLCBudWxsLFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJ1c2VcIiwgeyB4bGlua0hyZWY6IHRoaXMucXVlc3Rpb24uZGFzaFN2Z0ljb24gfSkpKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uUmFua2luZ0l0ZW0ucHJvdG90eXBlLnJlbmRlckVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBpdGVtQ29udGVudCA9IFJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UuY3JlYXRlRWxlbWVudCh0aGlzLnF1ZXN0aW9uLml0ZW1Db21wb25lbnQsIHsgaXRlbTogdGhpcy5pdGVtLCBjc3NDbGFzc2VzOiB0aGlzLmNzc0NsYXNzZXMgfSk7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyB0YWJJbmRleDogdGhpcy5pdGVtVGFiSW5kZXgsIGNsYXNzTmFtZTogdGhpcy5pdGVtQ2xhc3MsIG9uS2V5RG93bjogdGhpcy5oYW5kbGVLZXlkb3duLCBvblBvaW50ZXJEb3duOiB0aGlzLmhhbmRsZVBvaW50ZXJEb3duLCBvblBvaW50ZXJVcDogdGhpcy5oYW5kbGVQb2ludGVyVXAsIFwiZGF0YS1zdi1kcm9wLXRhcmdldC1yYW5raW5nLWl0ZW1cIjogdGhpcy5pbmRleCB9LFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyB0YWJJbmRleDogLTEsIHN0eWxlOiB7IG91dGxpbmU6IFwibm9uZVwiIH0gfSxcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5jc3NDbGFzc2VzLml0ZW1HaG9zdE5vZGUgfSksXG4gICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMuY3NzQ2xhc3Nlcy5pdGVtQ29udGVudCB9LFxuICAgICAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5jc3NDbGFzc2VzLml0ZW1JY29uQ29udGFpbmVyIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInN2Z1wiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5nZXRJY29uSG92ZXJDc3MoKSB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwidXNlXCIsIHsgeGxpbmtIcmVmOiB0aGlzLnF1ZXN0aW9uLmRyYWdEcm9wU3ZnSWNvbiB9KSksXG4gICAgICAgICAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInN2Z1wiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5nZXRJY29uRm9jdXNDc3MoKSB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwidXNlXCIsIHsgeGxpbmtIcmVmOiB0aGlzLnF1ZXN0aW9uLmFycm93c1N2Z0ljb24gfSkpKSxcbiAgICAgICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uZ2V0SXRlbUluZGV4Q2xhc3Nlcyh0aGlzLml0ZW0pIH0sICghdGhpcy51bnJhbmtlZEl0ZW0gJiYgdGhpcy5pbmRleFRleHQpID8gdGhpcy5pbmRleFRleHQgOiB0aGlzLnJlbmRlckVtcHR5SWNvbigpKSxcbiAgICAgICAgICAgICAgICAgICAgaXRlbUNvbnRlbnQpKSkpO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVF1ZXN0aW9uUmFua2luZ0l0ZW07XG59KFJlYWN0U3VydmV5RWxlbWVudCkpO1xuXG52YXIgcmVhY3RxdWVzdGlvbl9yYW5raW5nX1N1cnZleVF1ZXN0aW9uUmFua2luZ0l0ZW1Db250ZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJlYWN0cXVlc3Rpb25fcmFua2luZ19leHRlbmRzKFN1cnZleVF1ZXN0aW9uUmFua2luZ0l0ZW1Db250ZW50LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uUmFua2luZ0l0ZW1Db250ZW50KCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvblJhbmtpbmdJdGVtQ29udGVudC5wcm90b3R5cGUsIFwiaXRlbVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuaXRlbTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvblJhbmtpbmdJdGVtQ29udGVudC5wcm90b3R5cGUsIFwiY3NzQ2xhc3Nlc1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuY3NzQ2xhc3NlcztcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleVF1ZXN0aW9uUmFua2luZ0l0ZW1Db250ZW50LnByb3RvdHlwZS5yZW5kZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMuY3NzQ2xhc3Nlcy5jb250cm9sTGFiZWwgfSwgcmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleUVsZW1lbnRCYXNlLnJlbmRlckxvY1N0cmluZyh0aGlzLml0ZW0ubG9jVGV4dCkpO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVF1ZXN0aW9uUmFua2luZ0l0ZW1Db250ZW50O1xufShSZWFjdFN1cnZleUVsZW1lbnQpKTtcblxuUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlckVsZW1lbnQoXCJzdi1yYW5raW5nLWl0ZW1cIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHJlYWN0cXVlc3Rpb25fcmFua2luZ19TdXJ2ZXlRdWVzdGlvblJhbmtpbmdJdGVtQ29udGVudCwgcHJvcHMpO1xufSk7XG5SZWFjdFF1ZXN0aW9uRmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlclF1ZXN0aW9uKFwicmFua2luZ1wiLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0ocmVhY3RxdWVzdGlvbl9yYW5raW5nX1N1cnZleVF1ZXN0aW9uUmFua2luZywgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9jb21wb25lbnRzL3JhdGluZy9yYXRpbmctaXRlbS50c3hcbnZhciByYXRpbmdfaXRlbV9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cbnZhciBSYXRpbmdJdGVtQmFzZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICByYXRpbmdfaXRlbV9leHRlbmRzKFJhdGluZ0l0ZW1CYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFJhdGluZ0l0ZW1CYXNlKHByb3BzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5oYW5kbGVPbk1vdXNlRG93biA9IF90aGlzLmhhbmRsZU9uTW91c2VEb3duLmJpbmQoX3RoaXMpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShSYXRpbmdJdGVtQmFzZS5wcm90b3R5cGUsIFwicXVlc3Rpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLnF1ZXN0aW9uO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFJhdGluZ0l0ZW1CYXNlLnByb3RvdHlwZSwgXCJpdGVtXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5pdGVtO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFJhdGluZ0l0ZW1CYXNlLnByb3RvdHlwZSwgXCJpbmRleFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuaW5kZXg7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBSYXRpbmdJdGVtQmFzZS5wcm90b3R5cGUuZ2V0U3RhdGVFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pdGVtO1xuICAgIH07XG4gICAgUmF0aW5nSXRlbUJhc2UucHJvdG90eXBlLmhhbmRsZU9uTW91c2VEb3duID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHRoaXMucXVlc3Rpb24ub25Nb3VzZURvd24oKTtcbiAgICB9O1xuICAgIHJldHVybiBSYXRpbmdJdGVtQmFzZTtcbn0ocmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleUVsZW1lbnRCYXNlKSk7XG5cbnZhciByYXRpbmdfaXRlbV9SYXRpbmdJdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJhdGluZ19pdGVtX2V4dGVuZHMoUmF0aW5nSXRlbSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBSYXRpbmdJdGVtKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFJhdGluZ0l0ZW0ucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGl0ZW1UZXh0ID0gdGhpcy5yZW5kZXJMb2NTdHJpbmcodGhpcy5pdGVtLmxvY1RleHQpO1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcImxhYmVsXCIsIHsgb25Nb3VzZURvd246IHRoaXMuaGFuZGxlT25Nb3VzZURvd24sIGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5nZXRJdGVtQ2xhc3NCeVRleHQodGhpcy5pdGVtLml0ZW1WYWx1ZSwgdGhpcy5pdGVtLnRleHQpIH0sXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiLCB7IHR5cGU6IFwicmFkaW9cIiwgY2xhc3NOYW1lOiBcInN2LXZpc3VhbGx5aGlkZGVuXCIsIG5hbWU6IHRoaXMucXVlc3Rpb24ucXVlc3Rpb25OYW1lLCBpZDogdGhpcy5xdWVzdGlvbi5nZXRJbnB1dElkKHRoaXMuaW5kZXgpLCB2YWx1ZTogdGhpcy5pdGVtLnZhbHVlLCBkaXNhYmxlZDogdGhpcy5xdWVzdGlvbi5pc0Rpc2FibGVkQXR0ciwgcmVhZE9ubHk6IHRoaXMucXVlc3Rpb24uaXNSZWFkT25seUF0dHIsIGNoZWNrZWQ6IHRoaXMucXVlc3Rpb24udmFsdWUgPT0gdGhpcy5pdGVtLnZhbHVlLCBvbkNsaWNrOiB0aGlzLnByb3BzLmhhbmRsZU9uQ2xpY2ssIG9uQ2hhbmdlOiBmdW5jdGlvbiAoKSB7IH0sIFwiYXJpYS1yZXF1aXJlZFwiOiB0aGlzLnF1ZXN0aW9uLmFyaWFSZXF1aXJlZCwgXCJhcmlhLWxhYmVsXCI6IHRoaXMucXVlc3Rpb24uYXJpYUxhYmVsLCBcImFyaWEtaW52YWxpZFwiOiB0aGlzLnF1ZXN0aW9uLmFyaWFJbnZhbGlkLCBcImFyaWEtZXJyb3JtZXNzYWdlXCI6IHRoaXMucXVlc3Rpb24uYXJpYUVycm9ybWVzc2FnZSB9KSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcInNwYW5cIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5pdGVtVGV4dCwgXCJkYXRhLXRleHRcIjogdGhpcy5pdGVtLnRleHQgfSwgaXRlbVRleHQpKSk7XG4gICAgfTtcbiAgICBSYXRpbmdJdGVtLnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudC5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgcmV0dXJuIFJhdGluZ0l0ZW07XG59KFJhdGluZ0l0ZW1CYXNlKSk7XG5cblJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJFbGVtZW50KFwic3YtcmF0aW5nLWl0ZW1cIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChyYXRpbmdfaXRlbV9SYXRpbmdJdGVtLCBwcm9wcyk7XG59KTtcblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL2NvbXBvbmVudHMvcmF0aW5nL3JhdGluZy1pdGVtLXN0YXIudHN4XG52YXIgcmF0aW5nX2l0ZW1fc3Rhcl9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cblxudmFyIHJhdGluZ19pdGVtX3N0YXJfUmF0aW5nSXRlbVN0YXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcmF0aW5nX2l0ZW1fc3Rhcl9leHRlbmRzKFJhdGluZ0l0ZW1TdGFyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFJhdGluZ0l0ZW1TdGFyKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFJhdGluZ0l0ZW1TdGFyLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwibGFiZWxcIiwgeyBvbk1vdXNlRG93bjogdGhpcy5oYW5kbGVPbk1vdXNlRG93biwgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmdldEl0ZW1DbGFzcyh0aGlzLml0ZW0uaXRlbVZhbHVlKSwgb25Nb3VzZU92ZXI6IGZ1bmN0aW9uIChlKSB7IHJldHVybiBfdGhpcy5xdWVzdGlvbi5vbkl0ZW1Nb3VzZUluKF90aGlzLml0ZW0pOyB9LCBvbk1vdXNlT3V0OiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gX3RoaXMucXVlc3Rpb24ub25JdGVtTW91c2VPdXQoX3RoaXMuaXRlbSk7IH0gfSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcImlucHV0XCIsIHsgdHlwZTogXCJyYWRpb1wiLCBjbGFzc05hbWU6IFwic3YtdmlzdWFsbHloaWRkZW5cIiwgbmFtZTogdGhpcy5xdWVzdGlvbi5xdWVzdGlvbk5hbWUsIGlkOiB0aGlzLnF1ZXN0aW9uLmdldElucHV0SWQodGhpcy5pbmRleCksIHZhbHVlOiB0aGlzLml0ZW0udmFsdWUsIGRpc2FibGVkOiB0aGlzLnF1ZXN0aW9uLmlzRGlzYWJsZWRBdHRyLCByZWFkT25seTogdGhpcy5xdWVzdGlvbi5pc1JlYWRPbmx5QXR0ciwgY2hlY2tlZDogdGhpcy5xdWVzdGlvbi52YWx1ZSA9PSB0aGlzLml0ZW0udmFsdWUsIG9uQ2xpY2s6IHRoaXMucHJvcHMuaGFuZGxlT25DbGljaywgb25DaGFuZ2U6IGZ1bmN0aW9uICgpIHsgfSwgXCJhcmlhLXJlcXVpcmVkXCI6IHRoaXMucXVlc3Rpb24uYXJpYVJlcXVpcmVkLCBcImFyaWEtbGFiZWxcIjogdGhpcy5xdWVzdGlvbi5hcmlhTGFiZWwsIFwiYXJpYS1pbnZhbGlkXCI6IHRoaXMucXVlc3Rpb24uYXJpYUludmFsaWQsIFwiYXJpYS1lcnJvcm1lc3NhZ2VcIjogdGhpcy5xdWVzdGlvbi5hcmlhRXJyb3JtZXNzYWdlIH0pLFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KHN2Z19pY29uX1N2Z0ljb24sIHsgY2xhc3NOYW1lOiBcInN2LXN0YXJcIiwgc2l6ZTogXCJhdXRvXCIsIGljb25OYW1lOiB0aGlzLnF1ZXN0aW9uLml0ZW1TdGFySWNvbiwgdGl0bGU6IHRoaXMuaXRlbS50ZXh0IH0pLFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KHN2Z19pY29uX1N2Z0ljb24sIHsgY2xhc3NOYW1lOiBcInN2LXN0YXItMlwiLCBzaXplOiBcImF1dG9cIiwgaWNvbk5hbWU6IHRoaXMucXVlc3Rpb24uaXRlbVN0YXJJY29uQWx0LCB0aXRsZTogdGhpcy5pdGVtLnRleHQgfSkpKTtcbiAgICB9O1xuICAgIHJldHVybiBSYXRpbmdJdGVtU3Rhcjtcbn0oUmF0aW5nSXRlbUJhc2UpKTtcblxuUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlckVsZW1lbnQoXCJzdi1yYXRpbmctaXRlbS1zdGFyXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQocmF0aW5nX2l0ZW1fc3Rhcl9SYXRpbmdJdGVtU3RhciwgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9jb21wb25lbnRzL3JhdGluZy9yYXRpbmctaXRlbS1zbWlsZXkudHN4XG52YXIgcmF0aW5nX2l0ZW1fc21pbGV5X2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cblxuXG52YXIgcmF0aW5nX2l0ZW1fc21pbGV5X1JhdGluZ0l0ZW1TbWlsZXkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcmF0aW5nX2l0ZW1fc21pbGV5X2V4dGVuZHMoUmF0aW5nSXRlbVNtaWxleSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBSYXRpbmdJdGVtU21pbGV5KCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFJhdGluZ0l0ZW1TbWlsZXkucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiLCB7IG9uTW91c2VEb3duOiB0aGlzLmhhbmRsZU9uTW91c2VEb3duLCBzdHlsZTogdGhpcy5xdWVzdGlvbi5nZXRJdGVtU3R5bGUodGhpcy5pdGVtLml0ZW1WYWx1ZSwgdGhpcy5pdGVtLmhpZ2hsaWdodCksIGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5nZXRJdGVtQ2xhc3ModGhpcy5pdGVtLml0ZW1WYWx1ZSksIG9uTW91c2VPdmVyOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gX3RoaXMucXVlc3Rpb24ub25JdGVtTW91c2VJbihfdGhpcy5pdGVtKTsgfSwgb25Nb3VzZU91dDogZnVuY3Rpb24gKGUpIHsgcmV0dXJuIF90aGlzLnF1ZXN0aW9uLm9uSXRlbU1vdXNlT3V0KF90aGlzLml0ZW0pOyB9IH0sXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiLCB7IHR5cGU6IFwicmFkaW9cIiwgY2xhc3NOYW1lOiBcInN2LXZpc3VhbGx5aGlkZGVuXCIsIG5hbWU6IHRoaXMucXVlc3Rpb24ucXVlc3Rpb25OYW1lLCBpZDogdGhpcy5xdWVzdGlvbi5nZXRJbnB1dElkKHRoaXMuaW5kZXgpLCB2YWx1ZTogdGhpcy5pdGVtLnZhbHVlLCBkaXNhYmxlZDogdGhpcy5xdWVzdGlvbi5pc0Rpc2FibGVkQXR0ciwgcmVhZE9ubHk6IHRoaXMucXVlc3Rpb24uaXNSZWFkT25seUF0dHIsIGNoZWNrZWQ6IHRoaXMucXVlc3Rpb24udmFsdWUgPT0gdGhpcy5pdGVtLnZhbHVlLCBvbkNsaWNrOiB0aGlzLnByb3BzLmhhbmRsZU9uQ2xpY2ssIG9uQ2hhbmdlOiBmdW5jdGlvbiAoKSB7IH0sIFwiYXJpYS1yZXF1aXJlZFwiOiB0aGlzLnF1ZXN0aW9uLmFyaWFSZXF1aXJlZCwgXCJhcmlhLWxhYmVsXCI6IHRoaXMucXVlc3Rpb24uYXJpYUxhYmVsLCBcImFyaWEtaW52YWxpZFwiOiB0aGlzLnF1ZXN0aW9uLmFyaWFJbnZhbGlkLCBcImFyaWEtZXJyb3JtZXNzYWdlXCI6IHRoaXMucXVlc3Rpb24uYXJpYUVycm9ybWVzc2FnZSB9KSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChzdmdfaWNvbl9TdmdJY29uLCB7IHNpemU6IFwiYXV0b1wiLCBpY29uTmFtZTogdGhpcy5xdWVzdGlvbi5nZXRJdGVtU21pbGV5SWNvbk5hbWUodGhpcy5pdGVtLml0ZW1WYWx1ZSksIHRpdGxlOiB0aGlzLml0ZW0udGV4dCB9KSkpO1xuICAgIH07XG4gICAgcmV0dXJuIFJhdGluZ0l0ZW1TbWlsZXk7XG59KFJhdGluZ0l0ZW1CYXNlKSk7XG5cblJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJFbGVtZW50KFwic3YtcmF0aW5nLWl0ZW0tc21pbGV5XCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQocmF0aW5nX2l0ZW1fc21pbGV5X1JhdGluZ0l0ZW1TbWlsZXksIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvY29tcG9uZW50cy9yYXRpbmcvcmF0aW5nLWRyb3Bkb3duLWl0ZW0udHN4XG52YXIgcmF0aW5nX2Ryb3Bkb3duX2l0ZW1fZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG52YXIgcmF0aW5nX2Ryb3Bkb3duX2l0ZW1fUmF0aW5nRHJvcGRvd25JdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJhdGluZ19kcm9wZG93bl9pdGVtX2V4dGVuZHMoUmF0aW5nRHJvcGRvd25JdGVtLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFJhdGluZ0Ryb3Bkb3duSXRlbSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoUmF0aW5nRHJvcGRvd25JdGVtLnByb3RvdHlwZSwgXCJpdGVtXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5pdGVtO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgUmF0aW5nRHJvcGRvd25JdGVtLnByb3RvdHlwZS5nZXRTdGF0ZUVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLml0ZW07XG4gICAgfTtcbiAgICBSYXRpbmdEcm9wZG93bkl0ZW0ucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLml0ZW0pXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgdmFyIGl0ZW0gPSB0aGlzLnByb3BzLml0ZW07XG4gICAgICAgIHZhciBkZXNjcmlwdGlvbiA9IHRoaXMucmVuZGVyRGVzY3JpcHRpb24oaXRlbSk7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInNkLXJhdGluZy1kcm9wZG93bi1pdGVtXCIgfSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcInNwYW5cIiwgeyBjbGFzc05hbWU6IFwic2QtcmF0aW5nLWRyb3Bkb3duLWl0ZW1fdGV4dFwiIH0sIGl0ZW0udGl0bGUpLFxuICAgICAgICAgICAgZGVzY3JpcHRpb24pKTtcbiAgICB9O1xuICAgIFJhdGluZ0Ryb3Bkb3duSXRlbS5wcm90b3R5cGUucmVuZGVyRGVzY3JpcHRpb24gPSBmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgICBpZiAoIWl0ZW0uZGVzY3JpcHRpb24pXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic2QtcmF0aW5nLWRyb3Bkb3duLWl0ZW1fZGVzY3JpcHRpb25cIiB9LCB0aGlzLnJlbmRlckxvY1N0cmluZyhpdGVtLmRlc2NyaXB0aW9uLCB1bmRlZmluZWQsIFwibG9jU3RyaW5nXCIpKSk7XG4gICAgfTtcbiAgICByZXR1cm4gUmF0aW5nRHJvcGRvd25JdGVtO1xufShyZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5RWxlbWVudEJhc2UpKTtcblxuUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlckVsZW1lbnQoXCJzdi1yYXRpbmctZHJvcGRvd24taXRlbVwiLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KHJhdGluZ19kcm9wZG93bl9pdGVtX1JhdGluZ0Ryb3Bkb3duSXRlbSwgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy90YWdib3gtZmlsdGVyLnRzeFxudmFyIHRhZ2JveF9maWx0ZXJfZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG5cbnZhciB0YWdib3hfZmlsdGVyX1RhZ2JveEZpbHRlclN0cmluZyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICB0YWdib3hfZmlsdGVyX2V4dGVuZHMoVGFnYm94RmlsdGVyU3RyaW5nLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFRhZ2JveEZpbHRlclN0cmluZyhwcm9wcykge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYWdib3hGaWx0ZXJTdHJpbmcucHJvdG90eXBlLCBcIm1vZGVsXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5tb2RlbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShUYWdib3hGaWx0ZXJTdHJpbmcucHJvdG90eXBlLCBcInF1ZXN0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5xdWVzdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFRhZ2JveEZpbHRlclN0cmluZy5wcm90b3R5cGUuY29tcG9uZW50RGlkVXBkYXRlID0gZnVuY3Rpb24gKHByZXZQcm9wcywgcHJldlN0YXRlKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50RGlkVXBkYXRlLmNhbGwodGhpcywgcHJldlByb3BzLCBwcmV2U3RhdGUpO1xuICAgICAgICB0aGlzLnVwZGF0ZURvbUVsZW1lbnQoKTtcbiAgICB9O1xuICAgIFRhZ2JveEZpbHRlclN0cmluZy5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy51cGRhdGVEb21FbGVtZW50KCk7XG4gICAgfTtcbiAgICBUYWdib3hGaWx0ZXJTdHJpbmcucHJvdG90eXBlLnVwZGF0ZURvbUVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghIXRoaXMuaW5wdXRFbGVtZW50KSB7XG4gICAgICAgICAgICB2YXIgY29udHJvbCA9IHRoaXMuaW5wdXRFbGVtZW50O1xuICAgICAgICAgICAgdmFyIG5ld1ZhbHVlID0gdGhpcy5tb2RlbC5pbnB1dFN0cmluZ1JlbmRlcmVkO1xuICAgICAgICAgICAgaWYgKCFleHRlcm5hbF9yb290X1N1cnZleV9jb21tb25qczJfc3VydmV5X2NvcmVfY29tbW9uanNfc3VydmV5X2NvcmVfYW1kX3N1cnZleV9jb3JlX1tcIkhlbHBlcnNcIl0uaXNUd29WYWx1ZUVxdWFscyhuZXdWYWx1ZSwgY29udHJvbC52YWx1ZSwgZmFsc2UsIHRydWUsIGZhbHNlKSkge1xuICAgICAgICAgICAgICAgIGNvbnRyb2wudmFsdWUgPSB0aGlzLm1vZGVsLmlucHV0U3RyaW5nUmVuZGVyZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFRhZ2JveEZpbHRlclN0cmluZy5wcm90b3R5cGUub25DaGFuZ2UgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB2YXIgcm9vdCA9IGV4dGVybmFsX3Jvb3RfU3VydmV5X2NvbW1vbmpzMl9zdXJ2ZXlfY29yZV9jb21tb25qc19zdXJ2ZXlfY29yZV9hbWRfc3VydmV5X2NvcmVfW1wic2V0dGluZ3NcIl0uZW52aXJvbm1lbnQucm9vdDtcbiAgICAgICAgaWYgKGUudGFyZ2V0ID09PSByb290LmFjdGl2ZUVsZW1lbnQpIHtcbiAgICAgICAgICAgIHRoaXMubW9kZWwuaW5wdXRTdHJpbmdSZW5kZXJlZCA9IGUudGFyZ2V0LnZhbHVlO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBUYWdib3hGaWx0ZXJTdHJpbmcucHJvdG90eXBlLmtleWhhbmRsZXIgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB0aGlzLm1vZGVsLmlucHV0S2V5SGFuZGxlcihlKTtcbiAgICB9O1xuICAgIFRhZ2JveEZpbHRlclN0cmluZy5wcm90b3R5cGUub25CbHVyID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgdGhpcy5tb2RlbC5vbkJsdXIoZSk7XG4gICAgfTtcbiAgICBUYWdib3hGaWx0ZXJTdHJpbmcucHJvdG90eXBlLm9uRm9jdXMgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICB0aGlzLm1vZGVsLm9uRm9jdXMoZSk7XG4gICAgfTtcbiAgICBUYWdib3hGaWx0ZXJTdHJpbmcucHJvdG90eXBlLmdldFN0YXRlRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubW9kZWw7XG4gICAgfTtcbiAgICBUYWdib3hGaWx0ZXJTdHJpbmcucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmhpbnQgfSxcbiAgICAgICAgICAgIHRoaXMubW9kZWwuc2hvd0hpbnRQcmVmaXggP1xuICAgICAgICAgICAgICAgIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmhpbnRQcmVmaXggfSxcbiAgICAgICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJzcGFuXCIsIG51bGwsIHRoaXMubW9kZWwuaGludFN0cmluZ1ByZWZpeCkpKSA6IG51bGwsXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmhpbnRTdWZmaXhXcmFwcGVyIH0sXG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlbC5zaG93SGludFN0cmluZyA/XG4gICAgICAgICAgICAgICAgICAgIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmhpbnRTdWZmaXggfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwic3BhblwiLCB7IHN0eWxlOiB7IHZpc2liaWxpdHk6IFwiaGlkZGVuXCIgfSwgXCJkYXRhLWJpbmRcIjogXCJ0ZXh0OiBtb2RlbC5maWx0ZXJTdHJpbmdcIiB9LCB0aGlzLm1vZGVsLmlucHV0U3RyaW5nUmVuZGVyZWQpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJzcGFuXCIsIG51bGwsIHRoaXMubW9kZWwuaGludFN0cmluZ1N1ZmZpeCkpKSA6IG51bGwsXG4gICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJpbnB1dFwiLCB7IHR5cGU6IFwidGV4dFwiLCBhdXRvQ29tcGxldGU6IFwib2ZmXCIsIGlkOiB0aGlzLnF1ZXN0aW9uLmdldElucHV0SWQoKSwgaW5wdXRNb2RlOiB0aGlzLm1vZGVsLmlucHV0TW9kZSwgcmVmOiBmdW5jdGlvbiAoZWxlbWVudCkgeyByZXR1cm4gKF90aGlzLmlucHV0RWxlbWVudCA9IGVsZW1lbnQpOyB9LCBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5maWx0ZXJTdHJpbmdJbnB1dCwgZGlzYWJsZWQ6IHRoaXMucXVlc3Rpb24uaXNJbnB1dFJlYWRPbmx5LCByZWFkT25seTogdGhpcy5tb2RlbC5maWx0ZXJSZWFkT25seSA/IHRydWUgOiB1bmRlZmluZWQsIHNpemU6ICF0aGlzLm1vZGVsLmlucHV0U3RyaW5nUmVuZGVyZWQgPyAxIDogdW5kZWZpbmVkLCByb2xlOiB0aGlzLm1vZGVsLmZpbHRlclN0cmluZ0VuYWJsZWQgPyB0aGlzLnF1ZXN0aW9uLmFyaWFSb2xlIDogdW5kZWZpbmVkLCBcImFyaWEtZXhwYW5kZWRcIjogdGhpcy5xdWVzdGlvbi5hcmlhRXhwYW5kZWQsIFwiYXJpYS1sYWJlbFwiOiB0aGlzLnF1ZXN0aW9uLmExMXlfaW5wdXRfYXJpYUxhYmVsLCBcImFyaWEtbGFiZWxsZWRieVwiOiB0aGlzLnF1ZXN0aW9uLmExMXlfaW5wdXRfYXJpYUxhYmVsbGVkQnksIFwiYXJpYS1kZXNjcmliZWRieVwiOiB0aGlzLnF1ZXN0aW9uLmExMXlfaW5wdXRfYXJpYURlc2NyaWJlZEJ5LCBcImFyaWEtY29udHJvbHNcIjogdGhpcy5tb2RlbC5saXN0RWxlbWVudElkLCBcImFyaWEtYWN0aXZlZGVzY2VuZGFudFwiOiB0aGlzLm1vZGVsLmFyaWFBY3RpdmVkZXNjZW5kYW50LCBwbGFjZWhvbGRlcjogdGhpcy5tb2RlbC5maWx0ZXJTdHJpbmdQbGFjZWhvbGRlciwgb25LZXlEb3duOiBmdW5jdGlvbiAoZSkgeyBfdGhpcy5rZXloYW5kbGVyKGUpOyB9LCBvbkNoYW5nZTogZnVuY3Rpb24gKGUpIHsgX3RoaXMub25DaGFuZ2UoZSk7IH0sIG9uQmx1cjogZnVuY3Rpb24gKGUpIHsgX3RoaXMub25CbHVyKGUpOyB9LCBvbkZvY3VzOiBmdW5jdGlvbiAoZSkgeyBfdGhpcy5vbkZvY3VzKGUpOyB9IH0pKSkpO1xuICAgIH07XG4gICAgcmV0dXJuIFRhZ2JveEZpbHRlclN0cmluZztcbn0ocmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleUVsZW1lbnRCYXNlKSk7XG5cblJlYWN0UXVlc3Rpb25GYWN0b3J5Lkluc3RhbmNlLnJlZ2lzdGVyUXVlc3Rpb24oXCJzdi10YWdib3gtZmlsdGVyXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXSh0YWdib3hfZmlsdGVyX1RhZ2JveEZpbHRlclN0cmluZywgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9kcm9wZG93bi1pdGVtLnRzeFxudmFyIGRyb3Bkb3duX2l0ZW1fZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxudmFyIGRyb3Bkb3duX2l0ZW1fU3VydmV5UXVlc3Rpb25PcHRpb25JdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIGRyb3Bkb3duX2l0ZW1fZXh0ZW5kcyhTdXJ2ZXlRdWVzdGlvbk9wdGlvbkl0ZW0sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UXVlc3Rpb25PcHRpb25JdGVtKHByb3BzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5zdGF0ZSA9IHsgY2hhbmdlZDogMCB9O1xuICAgICAgICBfdGhpcy5zZXR1cE1vZGVsKCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgU3VydmV5UXVlc3Rpb25PcHRpb25JdGVtLnByb3RvdHlwZS5jb21wb25lbnREaWRVcGRhdGUgPSBmdW5jdGlvbiAocHJldlByb3BzLCBwcmV2U3RhdGUpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jb21wb25lbnREaWRVcGRhdGUuY2FsbCh0aGlzLCBwcmV2UHJvcHMsIHByZXZTdGF0ZSk7XG4gICAgICAgIHRoaXMuc2V0dXBNb2RlbCgpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25PcHRpb25JdGVtLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudC5jYWxsKHRoaXMpO1xuICAgICAgICBpZiAoISF0aGlzLml0ZW0pIHtcbiAgICAgICAgICAgIHRoaXMuaXRlbS5sb2NUZXh0Lm9uQ2hhbmdlZCA9IGZ1bmN0aW9uICgpIHsgfTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25PcHRpb25JdGVtLnByb3RvdHlwZS5zZXR1cE1vZGVsID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuaXRlbS5sb2NUZXh0KVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHRoaXMuaXRlbS5sb2NUZXh0Lm9uQ2hhbmdlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHNlbGYuc2V0U3RhdGUoeyBjaGFuZ2VkOiBzZWxmLnN0YXRlLmNoYW5nZWQgKyAxIH0pO1xuICAgICAgICB9O1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25PcHRpb25JdGVtLnByb3RvdHlwZS5nZXRTdGF0ZUVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLml0ZW07XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25PcHRpb25JdGVtLnByb3RvdHlwZSwgXCJpdGVtXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5pdGVtO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3VydmV5UXVlc3Rpb25PcHRpb25JdGVtLnByb3RvdHlwZS5jYW5SZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAhIXRoaXMuaXRlbTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uT3B0aW9uSXRlbS5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcIm9wdGlvblwiLCB7IHZhbHVlOiB0aGlzLml0ZW0udmFsdWUsIGRpc2FibGVkOiAhdGhpcy5pdGVtLmlzRW5hYmxlZCB9LCB0aGlzLml0ZW0udGV4dCkpO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVF1ZXN0aW9uT3B0aW9uSXRlbTtcbn0oUmVhY3RTdXJ2ZXlFbGVtZW50KSk7XG5cblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL2Ryb3Bkb3duLWJhc2UudHN4XG52YXIgZHJvcGRvd25fYmFzZV9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cblxuXG5cblxudmFyIGRyb3Bkb3duX2Jhc2VfU3VydmV5UXVlc3Rpb25Ecm9wZG93bkJhc2UgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgZHJvcGRvd25fYmFzZV9leHRlbmRzKFN1cnZleVF1ZXN0aW9uRHJvcGRvd25CYXNlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uRHJvcGRvd25CYXNlKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuY2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIHZhciBfYTtcbiAgICAgICAgICAgIChfYSA9IF90aGlzLnF1ZXN0aW9uLmRyb3Bkb3duTGlzdE1vZGVsKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Eub25DbGljayhldmVudCk7XG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLmNoZXZyb25Qb2ludGVyRG93biA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgKF9hID0gX3RoaXMucXVlc3Rpb24uZHJvcGRvd25MaXN0TW9kZWwpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5jaGV2cm9uUG9pbnRlckRvd24oZXZlbnQpO1xuICAgICAgICB9O1xuICAgICAgICBfdGhpcy5jbGVhciA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgKF9hID0gX3RoaXMucXVlc3Rpb24uZHJvcGRvd25MaXN0TW9kZWwpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5vbkNsZWFyKGV2ZW50KTtcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMua2V5aGFuZGxlciA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgKF9hID0gX3RoaXMucXVlc3Rpb24uZHJvcGRvd25MaXN0TW9kZWwpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5rZXlIYW5kbGVyKGV2ZW50KTtcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMuYmx1ciA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgX3RoaXMudXBkYXRlSW5wdXREb21FbGVtZW50KCk7XG4gICAgICAgICAgICBfdGhpcy5xdWVzdGlvbi5vbkJsdXIoZXZlbnQpO1xuICAgICAgICB9O1xuICAgICAgICBfdGhpcy5mb2N1cyA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgX3RoaXMucXVlc3Rpb24ub25Gb2N1cyhldmVudCk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgU3VydmV5UXVlc3Rpb25Ecm9wZG93bkJhc2UucHJvdG90eXBlLmdldFN0YXRlRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucXVlc3Rpb25bXCJkcm9wZG93bkxpc3RNb2RlbFwiXTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uRHJvcGRvd25CYXNlLnByb3RvdHlwZS5zZXRWYWx1ZUNvcmUgPSBmdW5jdGlvbiAobmV3VmFsdWUpIHtcbiAgICAgICAgdGhpcy5xdWVzdGlvbkJhc2UucmVuZGVyZWRWYWx1ZSA9IG5ld1ZhbHVlO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25Ecm9wZG93bkJhc2UucHJvdG90eXBlLmdldFZhbHVlQ29yZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucXVlc3Rpb25CYXNlLnJlbmRlcmVkVmFsdWU7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkRyb3Bkb3duQmFzZS5wcm90b3R5cGUucmVuZGVyUmVhZE9ubHlFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgbnVsbCwgdGhpcy5xdWVzdGlvbi5yZWFkT25seVRleHQpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25Ecm9wZG93bkJhc2UucHJvdG90eXBlLnJlbmRlclNlbGVjdCA9IGZ1bmN0aW9uIChjc3NDbGFzc2VzKSB7XG4gICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgIHZhciBzZWxlY3RFbGVtZW50ID0gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMucXVlc3Rpb24uaXNSZWFkT25seSkge1xuICAgICAgICAgICAgdmFyIHRleHQgPSAodGhpcy5xdWVzdGlvbi5zZWxlY3RlZEl0ZW1Mb2NUZXh0KSA/IHRoaXMucmVuZGVyTG9jU3RyaW5nKHRoaXMucXVlc3Rpb24uc2VsZWN0ZWRJdGVtTG9jVGV4dCkgOiBcIlwiO1xuICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHMtY29tbWVudFxuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgc2VsZWN0RWxlbWVudCA9IGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgaWQ6IHRoaXMucXVlc3Rpb24uaW5wdXRJZCwgXCJhcmlhLWxhYmVsXCI6IHRoaXMucXVlc3Rpb24uYTExeV9pbnB1dF9hcmlhTGFiZWwsIFwiYXJpYS1sYWJlbGxlZGJ5XCI6IHRoaXMucXVlc3Rpb24uYTExeV9pbnB1dF9hcmlhTGFiZWxsZWRCeSwgXCJhcmlhLWRlc2NyaWJlZGJ5XCI6IHRoaXMucXVlc3Rpb24uYTExeV9pbnB1dF9hcmlhRGVzY3JpYmVkQnksIHRhYkluZGV4OiB0aGlzLnF1ZXN0aW9uLmlzRGlzYWJsZWRBdHRyID8gdW5kZWZpbmVkIDogMCwgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmdldENvbnRyb2xDbGFzcygpIH0sXG4gICAgICAgICAgICAgICAgdGV4dCxcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclJlYWRPbmx5RWxlbWVudCgpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHNlbGVjdEVsZW1lbnQgPSBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiRnJhZ21lbnRcIl0sIG51bGwsXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJJbnB1dCh0aGlzLnF1ZXN0aW9uW1wiZHJvcGRvd25MaXN0TW9kZWxcIl0pLFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHBvcHVwX1BvcHVwLCB7IG1vZGVsOiAoX2IgPSAoX2EgPSB0aGlzLnF1ZXN0aW9uKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZHJvcGRvd25MaXN0TW9kZWwpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5wb3B1cE1vZGVsIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBjc3NDbGFzc2VzLnNlbGVjdFdyYXBwZXIsIG9uQ2xpY2s6IHRoaXMuY2xpY2sgfSxcbiAgICAgICAgICAgIHNlbGVjdEVsZW1lbnQsXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUNoZXZyb25CdXR0b24oKSkpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25Ecm9wZG93bkJhc2UucHJvdG90eXBlLnJlbmRlclZhbHVlRWxlbWVudCA9IGZ1bmN0aW9uIChkcm9wZG93bkxpc3RNb2RlbCkge1xuICAgICAgICBpZiAodGhpcy5xdWVzdGlvbi5zaG93SW5wdXRGaWVsZENvbXBvbmVudCkge1xuICAgICAgICAgICAgcmV0dXJuIFJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UuY3JlYXRlRWxlbWVudCh0aGlzLnF1ZXN0aW9uLmlucHV0RmllbGRDb21wb25lbnROYW1lLCB7IGl0ZW06IGRyb3Bkb3duTGlzdE1vZGVsLmdldFNlbGVjdGVkQWN0aW9uKCksIHF1ZXN0aW9uOiB0aGlzLnF1ZXN0aW9uIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMucXVlc3Rpb24uc2hvd1NlbGVjdGVkSXRlbUxvY1RleHQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbmRlckxvY1N0cmluZyh0aGlzLnF1ZXN0aW9uLnNlbGVjdGVkSXRlbUxvY1RleHQpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25Ecm9wZG93bkJhc2UucHJvdG90eXBlLnJlbmRlcklucHV0ID0gZnVuY3Rpb24gKGRyb3Bkb3duTGlzdE1vZGVsKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciB2YWx1ZUVsZW1lbnQgPSB0aGlzLnJlbmRlclZhbHVlRWxlbWVudChkcm9wZG93bkxpc3RNb2RlbCk7XG4gICAgICAgIHZhciByb290ID0gZXh0ZXJuYWxfcm9vdF9TdXJ2ZXlfY29tbW9uanMyX3N1cnZleV9jb3JlX2NvbW1vbmpzX3N1cnZleV9jb3JlX2FtZF9zdXJ2ZXlfY29yZV9bXCJzZXR0aW5nc1wiXS5lbnZpcm9ubWVudC5yb290O1xuICAgICAgICB2YXIgb25JbnB1dENoYW5nZSA9IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICBpZiAoZS50YXJnZXQgPT09IHJvb3QuYWN0aXZlRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGRyb3Bkb3duTGlzdE1vZGVsLmlucHV0U3RyaW5nUmVuZGVyZWQgPSBlLnRhcmdldC52YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGlkOiB0aGlzLnF1ZXN0aW9uLmlucHV0SWQsIGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5nZXRDb250cm9sQ2xhc3MoKSwgdGFiSW5kZXg6IGRyb3Bkb3duTGlzdE1vZGVsLm5vVGFiSW5kZXggPyB1bmRlZmluZWQgOiAwLCBcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXRzLWNvbW1lbnRcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIGRpc2FibGVkOiB0aGlzLnF1ZXN0aW9uLmlzRGlzYWJsZWRBdHRyLCByZXF1aXJlZDogdGhpcy5xdWVzdGlvbi5pc1JlcXVpcmVkLCBvbktleURvd246IHRoaXMua2V5aGFuZGxlciwgb25CbHVyOiB0aGlzLmJsdXIsIG9uRm9jdXM6IHRoaXMuZm9jdXMsIHJvbGU6IHRoaXMucXVlc3Rpb24uYXJpYVJvbGUsIFwiYXJpYS1yZXF1aXJlZFwiOiB0aGlzLnF1ZXN0aW9uLmFyaWFSZXF1aXJlZCwgXCJhcmlhLWxhYmVsXCI6IHRoaXMucXVlc3Rpb24uYXJpYUxhYmVsLCBcImFyaWEtaW52YWxpZFwiOiB0aGlzLnF1ZXN0aW9uLmFyaWFJbnZhbGlkLCBcImFyaWEtZXJyb3JtZXNzYWdlXCI6IHRoaXMucXVlc3Rpb24uYXJpYUVycm9ybWVzc2FnZSwgXCJhcmlhLWV4cGFuZGVkXCI6IHRoaXMucXVlc3Rpb24uYXJpYUV4cGFuZGVkLCBcImFyaWEtY29udHJvbHNcIjogZHJvcGRvd25MaXN0TW9kZWwubGlzdEVsZW1lbnRJZCwgXCJhcmlhLWFjdGl2ZWRlc2NlbmRhbnRcIjogZHJvcGRvd25MaXN0TW9kZWwuYXJpYUFjdGl2ZWRlc2NlbmRhbnQgfSxcbiAgICAgICAgICAgIGRyb3Bkb3duTGlzdE1vZGVsLnNob3dIaW50UHJlZml4ID9cbiAgICAgICAgICAgICAgICAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5oaW50UHJlZml4IH0sXG4gICAgICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwic3BhblwiLCBudWxsLCBkcm9wZG93bkxpc3RNb2RlbC5oaW50U3RyaW5nUHJlZml4KSkpIDogbnVsbCxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMuY29udHJvbFZhbHVlIH0sXG4gICAgICAgICAgICAgICAgZHJvcGRvd25MaXN0TW9kZWwuc2hvd0hpbnRTdHJpbmcgP1xuICAgICAgICAgICAgICAgICAgICAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5oaW50U3VmZml4IH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInNwYW5cIiwgeyBzdHlsZTogeyB2aXNpYmlsaXR5OiBcImhpZGRlblwiIH0sIFwiZGF0YS1iaW5kXCI6IFwidGV4dDogbW9kZWwuZmlsdGVyU3RyaW5nXCIgfSwgZHJvcGRvd25MaXN0TW9kZWwuaW5wdXRTdHJpbmdSZW5kZXJlZCksXG4gICAgICAgICAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInNwYW5cIiwgbnVsbCwgZHJvcGRvd25MaXN0TW9kZWwuaGludFN0cmluZ1N1ZmZpeCkpKSA6IG51bGwsXG4gICAgICAgICAgICAgICAgdmFsdWVFbGVtZW50LFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiaW5wdXRcIiwgeyB0eXBlOiBcInRleHRcIiwgYXV0b0NvbXBsZXRlOiBcIm9mZlwiLCBpZDogdGhpcy5xdWVzdGlvbi5nZXRJbnB1dElkKCksIHJlZjogZnVuY3Rpb24gKGVsZW1lbnQpIHsgcmV0dXJuIChfdGhpcy5pbnB1dEVsZW1lbnQgPSBlbGVtZW50KTsgfSwgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMuZmlsdGVyU3RyaW5nSW5wdXQsIHJvbGU6IGRyb3Bkb3duTGlzdE1vZGVsLmZpbHRlclN0cmluZ0VuYWJsZWQgPyB0aGlzLnF1ZXN0aW9uLmFyaWFSb2xlIDogdW5kZWZpbmVkLCBcImFyaWEtZXhwYW5kZWRcIjogdGhpcy5xdWVzdGlvbi5hcmlhRXhwYW5kZWQsIFwiYXJpYS1sYWJlbFwiOiB0aGlzLnF1ZXN0aW9uLmExMXlfaW5wdXRfYXJpYUxhYmVsLCBcImFyaWEtbGFiZWxsZWRieVwiOiB0aGlzLnF1ZXN0aW9uLmExMXlfaW5wdXRfYXJpYUxhYmVsbGVkQnksIFwiYXJpYS1kZXNjcmliZWRieVwiOiB0aGlzLnF1ZXN0aW9uLmExMXlfaW5wdXRfYXJpYURlc2NyaWJlZEJ5LCBcImFyaWEtY29udHJvbHNcIjogZHJvcGRvd25MaXN0TW9kZWwubGlzdEVsZW1lbnRJZCwgXCJhcmlhLWFjdGl2ZWRlc2NlbmRhbnRcIjogZHJvcGRvd25MaXN0TW9kZWwuYXJpYUFjdGl2ZWRlc2NlbmRhbnQsIHBsYWNlaG9sZGVyOiBkcm9wZG93bkxpc3RNb2RlbC5wbGFjZWhvbGRlclJlbmRlcmVkLCByZWFkT25seTogZHJvcGRvd25MaXN0TW9kZWwuZmlsdGVyUmVhZE9ubHkgPyB0cnVlIDogdW5kZWZpbmVkLCB0YWJJbmRleDogZHJvcGRvd25MaXN0TW9kZWwubm9UYWJJbmRleCA/IHVuZGVmaW5lZCA6IC0xLCBkaXNhYmxlZDogdGhpcy5xdWVzdGlvbi5pc0Rpc2FibGVkQXR0ciwgaW5wdXRNb2RlOiBkcm9wZG93bkxpc3RNb2RlbC5pbnB1dE1vZGUsIG9uQ2hhbmdlOiBmdW5jdGlvbiAoZSkgeyBvbklucHV0Q2hhbmdlKGUpOyB9LCBvbkJsdXI6IHRoaXMuYmx1ciwgb25Gb2N1czogdGhpcy5mb2N1cyB9KSksXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUNsZWFyQnV0dG9uKCkpKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uRHJvcGRvd25CYXNlLnByb3RvdHlwZS5jcmVhdGVDbGVhckJ1dHRvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnF1ZXN0aW9uLmFsbG93Q2xlYXIgfHwgIXRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5jbGVhbkJ1dHRvbkljb25JZClcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB2YXIgc3R5bGUgPSB7IGRpc3BsYXk6ICF0aGlzLnF1ZXN0aW9uLnNob3dDbGVhckJ1dHRvbiA/IFwibm9uZVwiIDogXCJcIiB9O1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMuY2xlYW5CdXR0b24sIHN0eWxlOiBzdHlsZSwgb25DbGljazogdGhpcy5jbGVhciwgXCJhcmlhLWhpZGRlblwiOiBcInRydWVcIiB9LFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oc3ZnX2ljb25fU3ZnSWNvbiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5jbGVhbkJ1dHRvblN2ZywgaWNvbk5hbWU6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5jbGVhbkJ1dHRvbkljb25JZCwgdGl0bGU6IHRoaXMucXVlc3Rpb24uY2xlYXJDYXB0aW9uLCBzaXplOiBcImF1dG9cIiB9KSkpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25Ecm9wZG93bkJhc2UucHJvdG90eXBlLmNyZWF0ZUNoZXZyb25CdXR0b24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmNoZXZyb25CdXR0b25JY29uSWQpXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmNoZXZyb25CdXR0b24sIFwiYXJpYS1oaWRkZW5cIjogXCJ0cnVlXCIsIG9uUG9pbnRlckRvd246IHRoaXMuY2hldnJvblBvaW50ZXJEb3duIH0sXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShzdmdfaWNvbl9TdmdJY29uLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmNoZXZyb25CdXR0b25TdmcsIGljb25OYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMuY2hldnJvbkJ1dHRvbkljb25JZCwgc2l6ZTogXCJhdXRvXCIgfSkpKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uRHJvcGRvd25CYXNlLnByb3RvdHlwZS5yZW5kZXJPdGhlciA9IGZ1bmN0aW9uIChjc3NDbGFzc2VzKSB7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uZ2V0Q29tbWVudEFyZWFDc3ModHJ1ZSkgfSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFN1cnZleVF1ZXN0aW9uT3RoZXJWYWx1ZUl0ZW0sIHsgcXVlc3Rpb246IHRoaXMucXVlc3Rpb24sIG90aGVyQ3NzOiBjc3NDbGFzc2VzLm90aGVyLCBjc3NDbGFzc2VzOiBjc3NDbGFzc2VzLCBpc0Rpc3BsYXlNb2RlOiB0aGlzLmlzRGlzcGxheU1vZGUsIGlzT3RoZXI6IHRydWUgfSkpKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uRHJvcGRvd25CYXNlLnByb3RvdHlwZS5jb21wb25lbnREaWRVcGRhdGUgPSBmdW5jdGlvbiAocHJldlByb3BzLCBwcmV2U3RhdGUpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jb21wb25lbnREaWRVcGRhdGUuY2FsbCh0aGlzLCBwcmV2UHJvcHMsIHByZXZTdGF0ZSk7XG4gICAgICAgIHRoaXMudXBkYXRlSW5wdXREb21FbGVtZW50KCk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkRyb3Bkb3duQmFzZS5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy51cGRhdGVJbnB1dERvbUVsZW1lbnQoKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uRHJvcGRvd25CYXNlLnByb3RvdHlwZS51cGRhdGVJbnB1dERvbUVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghIXRoaXMuaW5wdXRFbGVtZW50KSB7XG4gICAgICAgICAgICB2YXIgY29udHJvbCA9IHRoaXMuaW5wdXRFbGVtZW50O1xuICAgICAgICAgICAgdmFyIG5ld1ZhbHVlID0gdGhpcy5xdWVzdGlvbi5kcm9wZG93bkxpc3RNb2RlbC5pbnB1dFN0cmluZ1JlbmRlcmVkO1xuICAgICAgICAgICAgaWYgKCFleHRlcm5hbF9yb290X1N1cnZleV9jb21tb25qczJfc3VydmV5X2NvcmVfY29tbW9uanNfc3VydmV5X2NvcmVfYW1kX3N1cnZleV9jb3JlX1tcIkhlbHBlcnNcIl0uaXNUd29WYWx1ZUVxdWFscyhuZXdWYWx1ZSwgY29udHJvbC52YWx1ZSwgZmFsc2UsIHRydWUsIGZhbHNlKSkge1xuICAgICAgICAgICAgICAgIGNvbnRyb2wudmFsdWUgPSB0aGlzLnF1ZXN0aW9uLmRyb3Bkb3duTGlzdE1vZGVsLmlucHV0U3RyaW5nUmVuZGVyZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvbkRyb3Bkb3duQmFzZTtcbn0ocmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleVF1ZXN0aW9uVW5jb250cm9sbGVkRWxlbWVudCkpO1xuXG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9yZWFjdHF1ZXN0aW9uX2Ryb3Bkb3duLnRzeFxudmFyIHJlYWN0cXVlc3Rpb25fZHJvcGRvd25fZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG52YXIgcmVhY3RxdWVzdGlvbl9kcm9wZG93bl9TdXJ2ZXlRdWVzdGlvbkRyb3Bkb3duID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJlYWN0cXVlc3Rpb25fZHJvcGRvd25fZXh0ZW5kcyhTdXJ2ZXlRdWVzdGlvbkRyb3Bkb3duLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uRHJvcGRvd24ocHJvcHMpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTdXJ2ZXlRdWVzdGlvbkRyb3Bkb3duLnByb3RvdHlwZS5yZW5kZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY3NzQ2xhc3NlcyA9IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3NlcztcbiAgICAgICAgdmFyIGNvbW1lbnQgPSB0aGlzLnF1ZXN0aW9uLmlzT3RoZXJTZWxlY3RlZCA/IHRoaXMucmVuZGVyT3RoZXIoY3NzQ2xhc3NlcykgOiBudWxsO1xuICAgICAgICB2YXIgc2VsZWN0ID0gdGhpcy5yZW5kZXJTZWxlY3QoY3NzQ2xhc3Nlcyk7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24ucmVuZGVyQ3NzUm9vdCB9LFxuICAgICAgICAgICAgc2VsZWN0LFxuICAgICAgICAgICAgY29tbWVudCkpO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVF1ZXN0aW9uRHJvcGRvd247XG59KGRyb3Bkb3duX2Jhc2VfU3VydmV5UXVlc3Rpb25Ecm9wZG93bkJhc2UpKTtcblxuUmVhY3RRdWVzdGlvbkZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJRdWVzdGlvbihcImRyb3Bkb3duXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyZWFjdHF1ZXN0aW9uX2Ryb3Bkb3duX1N1cnZleVF1ZXN0aW9uRHJvcGRvd24sIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvdGFnYm94LWl0ZW0udHN4XG52YXIgdGFnYm94X2l0ZW1fZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG52YXIgdGFnYm94X2l0ZW1fU3VydmV5UXVlc3Rpb25UYWdib3hJdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHRhZ2JveF9pdGVtX2V4dGVuZHMoU3VydmV5UXVlc3Rpb25UYWdib3hJdGVtLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uVGFnYm94SXRlbShwcm9wcykge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvblRhZ2JveEl0ZW0ucHJvdG90eXBlLCBcInF1ZXN0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5xdWVzdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvblRhZ2JveEl0ZW0ucHJvdG90eXBlLCBcIml0ZW1cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLml0ZW07XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlRdWVzdGlvblRhZ2JveEl0ZW0ucHJvdG90eXBlLmNhblJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICEhdGhpcy5pdGVtICYmICEhdGhpcy5xdWVzdGlvbjtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uVGFnYm94SXRlbS5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHRleHQgPSB0aGlzLnJlbmRlckxvY1N0cmluZyh0aGlzLml0ZW0ubG9jVGV4dCk7XG4gICAgICAgIHZhciByZW1vdmVJdGVtID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICBfdGhpcy5xdWVzdGlvbi5kcm9wZG93bkxpc3RNb2RlbC5kZXNlbGVjdEl0ZW0oX3RoaXMuaXRlbS52YWx1ZSk7XG4gICAgICAgICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzdi10YWdib3hfX2l0ZW1cIiB9LFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3YtdGFnYm94X19pdGVtLXRleHRcIiB9LCB0ZXh0KSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMuY2xlYW5JdGVtQnV0dG9uLCBvbkNsaWNrOiByZW1vdmVJdGVtIH0sXG4gICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oc3ZnX2ljb25fU3ZnSWNvbiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5jbGVhbkl0ZW1CdXR0b25TdmcsIGljb25OYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMuY2xlYW5JdGVtQnV0dG9uSWNvbklkLCBzaXplOiBcImF1dG9cIiB9KSkpKTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvblRhZ2JveEl0ZW07XG59KFJlYWN0U3VydmV5RWxlbWVudCkpO1xuXG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9yZWFjdHF1ZXN0aW9uX3RhZ2JveC50c3hcbnZhciByZWFjdHF1ZXN0aW9uX3RhZ2JveF9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cblxuXG52YXIgcmVhY3RxdWVzdGlvbl90YWdib3hfU3VydmV5UXVlc3Rpb25UYWdib3ggPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcmVhY3RxdWVzdGlvbl90YWdib3hfZXh0ZW5kcyhTdXJ2ZXlRdWVzdGlvblRhZ2JveCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlRdWVzdGlvblRhZ2JveChwcm9wcykge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFN1cnZleVF1ZXN0aW9uVGFnYm94LnByb3RvdHlwZS5yZW5kZXJJdGVtID0gZnVuY3Rpb24gKGtleSwgaXRlbSkge1xuICAgICAgICB2YXIgcmVuZGVyZWRJdGVtID0gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHRhZ2JveF9pdGVtX1N1cnZleVF1ZXN0aW9uVGFnYm94SXRlbSwgeyBrZXk6IGtleSwgcXVlc3Rpb246IHRoaXMucXVlc3Rpb24sIGl0ZW06IGl0ZW0gfSkpO1xuICAgICAgICByZXR1cm4gcmVuZGVyZWRJdGVtO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25UYWdib3gucHJvdG90eXBlLnJlbmRlcklucHV0ID0gZnVuY3Rpb24gKGRyb3Bkb3duTGlzdE1vZGVsKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBkcm9wZG93bk11bHRpU2VsZWN0TGlzdE1vZGVsID0gZHJvcGRvd25MaXN0TW9kZWw7XG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMucXVlc3Rpb24uc2VsZWN0ZWRDaG9pY2VzLm1hcChmdW5jdGlvbiAoY2hvaWNlLCBpbmRleCkgeyByZXR1cm4gX3RoaXMucmVuZGVySXRlbShcIml0ZW1cIiArIGluZGV4LCBjaG9pY2UpOyB9KTtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGlkOiB0aGlzLnF1ZXN0aW9uLmlucHV0SWQsIGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5nZXRDb250cm9sQ2xhc3MoKSwgdGFiSW5kZXg6IGRyb3Bkb3duTGlzdE1vZGVsLm5vVGFiSW5kZXggPyB1bmRlZmluZWQgOiAwLCBcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXRzLWNvbW1lbnRcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIGRpc2FibGVkOiB0aGlzLnF1ZXN0aW9uLmlzSW5wdXRSZWFkT25seSwgcmVxdWlyZWQ6IHRoaXMucXVlc3Rpb24uaXNSZXF1aXJlZCwgb25LZXlEb3duOiB0aGlzLmtleWhhbmRsZXIsIG9uQmx1cjogdGhpcy5ibHVyLCByb2xlOiB0aGlzLnF1ZXN0aW9uLmFyaWFSb2xlLCBcImFyaWEtcmVxdWlyZWRcIjogdGhpcy5xdWVzdGlvbi5hcmlhUmVxdWlyZWQsIFwiYXJpYS1sYWJlbFwiOiB0aGlzLnF1ZXN0aW9uLmFyaWFMYWJlbCwgXCJhcmlhLWludmFsaWRcIjogdGhpcy5xdWVzdGlvbi5hcmlhSW52YWxpZCwgXCJhcmlhLWVycm9ybWVzc2FnZVwiOiB0aGlzLnF1ZXN0aW9uLmFyaWFFcnJvcm1lc3NhZ2UsIFwiYXJpYS1leHBhbmRlZFwiOiB0aGlzLnF1ZXN0aW9uLmFyaWFFeHBhbmRlZCwgXCJhcmlhLWNvbnRyb2xzXCI6IGRyb3Bkb3duTGlzdE1vZGVsLmxpc3RFbGVtZW50SWQsIFwiYXJpYS1hY3RpdmVkZXNjZW5kYW50XCI6IGRyb3Bkb3duTGlzdE1vZGVsLmFyaWFBY3RpdmVkZXNjZW5kYW50IH0sXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmNvbnRyb2xWYWx1ZSB9LFxuICAgICAgICAgICAgICAgIGl0ZW1zLFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHRhZ2JveF9maWx0ZXJfVGFnYm94RmlsdGVyU3RyaW5nLCB7IG1vZGVsOiBkcm9wZG93bk11bHRpU2VsZWN0TGlzdE1vZGVsLCBxdWVzdGlvbjogdGhpcy5xdWVzdGlvbiB9KSksXG4gICAgICAgICAgICB0aGlzLmNyZWF0ZUNsZWFyQnV0dG9uKCkpKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uVGFnYm94LnByb3RvdHlwZS5yZW5kZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY3NzQ2xhc3NlcyA9IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3NlcztcbiAgICAgICAgdmFyIGNvbW1lbnQgPSB0aGlzLnF1ZXN0aW9uLmlzT3RoZXJTZWxlY3RlZCA/IHRoaXMucmVuZGVyT3RoZXIoY3NzQ2xhc3NlcykgOiBudWxsO1xuICAgICAgICB2YXIgc2VsZWN0ID0gdGhpcy5yZW5kZXJTZWxlY3QoY3NzQ2xhc3Nlcyk7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24ucmVuZGVyQ3NzUm9vdCB9LFxuICAgICAgICAgICAgc2VsZWN0LFxuICAgICAgICAgICAgY29tbWVudCkpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25UYWdib3gucHJvdG90eXBlLnJlbmRlclJlYWRPbmx5RWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucXVlc3Rpb24ubG9jUmVhZE9ubHlUZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJMb2NTdHJpbmcodGhpcy5xdWVzdGlvbi5sb2NSZWFkT25seVRleHQpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvblRhZ2JveDtcbn0oZHJvcGRvd25fYmFzZV9TdXJ2ZXlRdWVzdGlvbkRyb3Bkb3duQmFzZSkpO1xuXG5SZWFjdFF1ZXN0aW9uRmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlclF1ZXN0aW9uKFwidGFnYm94XCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyZWFjdHF1ZXN0aW9uX3RhZ2JveF9TdXJ2ZXlRdWVzdGlvblRhZ2JveCwgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9kcm9wZG93bi1zZWxlY3QudHN4XG52YXIgZHJvcGRvd25fc2VsZWN0X2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cblxuXG5cbnZhciBkcm9wZG93bl9zZWxlY3RfU3VydmV5UXVlc3Rpb25Ecm9wZG93blNlbGVjdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBkcm9wZG93bl9zZWxlY3RfZXh0ZW5kcyhTdXJ2ZXlRdWVzdGlvbkRyb3Bkb3duU2VsZWN0LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uRHJvcGRvd25TZWxlY3QocHJvcHMpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTdXJ2ZXlRdWVzdGlvbkRyb3Bkb3duU2VsZWN0LnByb3RvdHlwZS5yZW5kZXJTZWxlY3QgPSBmdW5jdGlvbiAoY3NzQ2xhc3Nlcykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgY2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIF90aGlzLnF1ZXN0aW9uLm9uQ2xpY2soZXZlbnQpO1xuICAgICAgICB9O1xuICAgICAgICB2YXIga2V5dXAgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIF90aGlzLnF1ZXN0aW9uLm9uS2V5VXAoZXZlbnQpO1xuICAgICAgICB9O1xuICAgICAgICB2YXIgc2VsZWN0RWxlbWVudCA9IHRoaXMuaXNEaXNwbGF5TW9kZSA/IChcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9iYW4tdHMtY29tbWVudFxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgaWQ6IHRoaXMucXVlc3Rpb24uaW5wdXRJZCwgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmdldENvbnRyb2xDbGFzcygpLCBkaXNhYmxlZDogdHJ1ZSB9LCB0aGlzLnF1ZXN0aW9uLnJlYWRPbmx5VGV4dCkpIDpcbiAgICAgICAgICAgIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInNlbGVjdFwiLCB7IGlkOiB0aGlzLnF1ZXN0aW9uLmlucHV0SWQsIGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5nZXRDb250cm9sQ2xhc3MoKSwgcmVmOiBmdW5jdGlvbiAoc2VsZWN0KSB7IHJldHVybiAoX3RoaXMuc2V0Q29udHJvbChzZWxlY3QpKTsgfSwgYXV0b0NvbXBsZXRlOiB0aGlzLnF1ZXN0aW9uLmF1dG9jb21wbGV0ZSwgb25DaGFuZ2U6IHRoaXMudXBkYXRlVmFsdWVPbkV2ZW50LCBvbklucHV0OiB0aGlzLnVwZGF0ZVZhbHVlT25FdmVudCwgb25DbGljazogY2xpY2ssIG9uS2V5VXA6IGtleXVwLCBcImFyaWEtcmVxdWlyZWRcIjogdGhpcy5xdWVzdGlvbi5hcmlhUmVxdWlyZWQsIFwiYXJpYS1sYWJlbFwiOiB0aGlzLnF1ZXN0aW9uLmFyaWFMYWJlbCwgXCJhcmlhLWludmFsaWRcIjogdGhpcy5xdWVzdGlvbi5hcmlhSW52YWxpZCwgXCJhcmlhLWVycm9ybWVzc2FnZVwiOiB0aGlzLnF1ZXN0aW9uLmFyaWFFcnJvcm1lc3NhZ2UsIHJlcXVpcmVkOiB0aGlzLnF1ZXN0aW9uLmlzUmVxdWlyZWQgfSxcbiAgICAgICAgICAgICAgICB0aGlzLnF1ZXN0aW9uLmFsbG93Q2xlYXIgPyAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJvcHRpb25cIiwgeyB2YWx1ZTogXCJcIiB9LCB0aGlzLnF1ZXN0aW9uLnBsYWNlaG9sZGVyKSkgOiBudWxsLFxuICAgICAgICAgICAgICAgIHRoaXMucXVlc3Rpb24udmlzaWJsZUNob2ljZXMubWFwKGZ1bmN0aW9uIChpdGVtLCBpKSB7IHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShkcm9wZG93bl9pdGVtX1N1cnZleVF1ZXN0aW9uT3B0aW9uSXRlbSwgeyBrZXk6IFwiaXRlbVwiICsgaSwgaXRlbTogaXRlbSB9KTsgfSkpKTtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogY3NzQ2xhc3Nlcy5zZWxlY3RXcmFwcGVyIH0sXG4gICAgICAgICAgICBzZWxlY3RFbGVtZW50LFxuICAgICAgICAgICAgdGhpcy5jcmVhdGVDaGV2cm9uQnV0dG9uKCkpKTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvbkRyb3Bkb3duU2VsZWN0O1xufShyZWFjdHF1ZXN0aW9uX2Ryb3Bkb3duX1N1cnZleVF1ZXN0aW9uRHJvcGRvd24pKTtcblxuUmVhY3RRdWVzdGlvbkZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJRdWVzdGlvbihcInN2LWRyb3Bkb3duLXNlbGVjdFwiLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oZHJvcGRvd25fc2VsZWN0X1N1cnZleVF1ZXN0aW9uRHJvcGRvd25TZWxlY3QsIHByb3BzKTtcbn0pO1xuZXh0ZXJuYWxfcm9vdF9TdXJ2ZXlfY29tbW9uanMyX3N1cnZleV9jb3JlX2NvbW1vbmpzX3N1cnZleV9jb3JlX2FtZF9zdXJ2ZXlfY29yZV9bXCJSZW5kZXJlckZhY3RvcnlcIl0uSW5zdGFuY2UucmVnaXN0ZXJSZW5kZXJlcihcImRyb3Bkb3duXCIsIFwic2VsZWN0XCIsIFwic3YtZHJvcGRvd24tc2VsZWN0XCIpO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvcmVhY3RxdWVzdGlvbl9tYXRyaXgudHN4XG52YXIgcmVhY3RxdWVzdGlvbl9tYXRyaXhfZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG5cblxudmFyIHJlYWN0cXVlc3Rpb25fbWF0cml4X1N1cnZleVF1ZXN0aW9uTWF0cml4ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJlYWN0cXVlc3Rpb25fbWF0cml4X2V4dGVuZHMoU3VydmV5UXVlc3Rpb25NYXRyaXgsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UXVlc3Rpb25NYXRyaXgocHJvcHMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnN0YXRlID0geyByb3dzQ2hhbmdlZDogMCB9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbk1hdHJpeC5wcm90b3R5cGUsIFwicXVlc3Rpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnF1ZXN0aW9uQmFzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4LnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudC5jYWxsKHRoaXMpO1xuICAgICAgICBpZiAodGhpcy5xdWVzdGlvbikge1xuICAgICAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICAgICAgdGhpcy5xdWVzdGlvbi52aXNpYmxlUm93c0NoYW5nZWRDYWxsYmFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBzZWxmLnNldFN0YXRlKHsgcm93c0NoYW5nZWQ6IHNlbGYuc3RhdGUucm93c0NoYW5nZWQgKyAxIH0pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXgucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50LmNhbGwodGhpcyk7XG4gICAgICAgIGlmICh0aGlzLnF1ZXN0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLnF1ZXN0aW9uLnZpc2libGVSb3dzQ2hhbmdlZENhbGxiYWNrID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXgucHJvdG90eXBlLnJlbmRlckVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBjc3NDbGFzc2VzID0gdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzO1xuICAgICAgICB2YXIgcm93c1RIID0gdGhpcy5xdWVzdGlvbi5oYXNSb3dzID8gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJ0ZFwiLCBudWxsKSA6IG51bGw7XG4gICAgICAgIHZhciBoZWFkZXJzID0gW107XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5xdWVzdGlvbi52aXNpYmxlQ29sdW1ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgdmFyIGNvbHVtbiA9IHRoaXMucXVlc3Rpb24udmlzaWJsZUNvbHVtbnNbaV07XG4gICAgICAgICAgICB2YXIga2V5ID0gXCJjb2x1bW5cIiArIGk7XG4gICAgICAgICAgICB2YXIgY29sdW1UZXh0ID0gdGhpcy5yZW5kZXJMb2NTdHJpbmcoY29sdW1uLmxvY1RleHQpO1xuICAgICAgICAgICAgdmFyIHN0eWxlID0ge307XG4gICAgICAgICAgICBpZiAoISF0aGlzLnF1ZXN0aW9uLmNvbHVtbk1pbldpZHRoKSB7XG4gICAgICAgICAgICAgICAgc3R5bGUubWluV2lkdGggPSB0aGlzLnF1ZXN0aW9uLmNvbHVtbk1pbldpZHRoO1xuICAgICAgICAgICAgICAgIHN0eWxlLndpZHRoID0gdGhpcy5xdWVzdGlvbi5jb2x1bW5NaW5XaWR0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGhlYWRlcnMucHVzaChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInRoXCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMuaGVhZGVyQ2VsbCwgc3R5bGU6IHN0eWxlLCBrZXk6IGtleSB9LCB0aGlzLndyYXBDZWxsKHsgY29sdW1uOiBjb2x1bW4gfSwgY29sdW1UZXh0LCBcImNvbHVtbi1oZWFkZXJcIikpKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgcm93cyA9IFtdO1xuICAgICAgICB2YXIgdmlzaWJsZVJvd3MgPSB0aGlzLnF1ZXN0aW9uLnZpc2libGVSb3dzO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHZpc2libGVSb3dzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgcm93ID0gdmlzaWJsZVJvd3NbaV07XG4gICAgICAgICAgICB2YXIga2V5ID0gXCJyb3ctXCIgKyByb3cubmFtZSArIFwiLVwiICsgaTtcbiAgICAgICAgICAgIHJvd3MucHVzaChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyZWFjdHF1ZXN0aW9uX21hdHJpeF9TdXJ2ZXlRdWVzdGlvbk1hdHJpeFJvdywgeyBrZXk6IGtleSwgcXVlc3Rpb246IHRoaXMucXVlc3Rpb24sIGNzc0NsYXNzZXM6IGNzc0NsYXNzZXMsIHJvdzogcm93LCBpc0ZpcnN0OiBpID09IDAgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBoZWFkZXIgPSAhdGhpcy5xdWVzdGlvbi5zaG93SGVhZGVyID8gbnVsbCA6IChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInRoZWFkXCIsIG51bGwsXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInRyXCIsIG51bGwsXG4gICAgICAgICAgICAgICAgcm93c1RILFxuICAgICAgICAgICAgICAgIGhlYWRlcnMpKSk7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IGNzc0NsYXNzZXMudGFibGVXcmFwcGVyLCByZWY6IGZ1bmN0aW9uIChyb290KSB7IHJldHVybiAoX3RoaXMuc2V0Q29udHJvbChyb290KSk7IH0gfSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZmllbGRzZXRcIiwgbnVsbCxcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImxlZ2VuZFwiLCB7IGNsYXNzTmFtZTogXCJzdi1oaWRkZW5cIiB9LCB0aGlzLnF1ZXN0aW9uLmxvY1RpdGxlLnJlbmRlcmVkSHRtbCksXG4gICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJ0YWJsZVwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5nZXRUYWJsZUNzcygpIH0sXG4gICAgICAgICAgICAgICAgICAgIGhlYWRlcixcbiAgICAgICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJ0Ym9keVwiLCBudWxsLCByb3dzKSkpKSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5UXVlc3Rpb25NYXRyaXg7XG59KHJlYWN0cXVlc3Rpb25fZWxlbWVudF9TdXJ2ZXlRdWVzdGlvbkVsZW1lbnRCYXNlKSk7XG5cbnZhciByZWFjdHF1ZXN0aW9uX21hdHJpeF9TdXJ2ZXlRdWVzdGlvbk1hdHJpeFJvdyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICByZWFjdHF1ZXN0aW9uX21hdHJpeF9leHRlbmRzKFN1cnZleVF1ZXN0aW9uTWF0cml4Um93LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uTWF0cml4Um93KHByb3BzKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICB9XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXhSb3cucHJvdG90eXBlLmdldFN0YXRlRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCEhdGhpcy5yb3cpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yb3cuaXRlbTtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUuZ2V0U3RhdGVFbGVtZW50LmNhbGwodGhpcyk7XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25NYXRyaXhSb3cucHJvdG90eXBlLCBcInF1ZXN0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5xdWVzdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbk1hdHJpeFJvdy5wcm90b3R5cGUsIFwicm93XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5yb3c7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlRdWVzdGlvbk1hdHJpeFJvdy5wcm90b3R5cGUud3JhcENlbGwgPSBmdW5jdGlvbiAoY2VsbCwgZWxlbWVudCwgcmVhc29uKSB7XG4gICAgICAgIGlmICghcmVhc29uKSB7XG4gICAgICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc3VydmV5ID0gdGhpcy5xdWVzdGlvbi5zdXJ2ZXk7XG4gICAgICAgIHZhciB3cmFwcGVyID0gbnVsbDtcbiAgICAgICAgaWYgKHN1cnZleSkge1xuICAgICAgICAgICAgd3JhcHBlciA9IHJlYWN0c3VydmV5bW9kZWxfUmVhY3RTdXJ2ZXlFbGVtZW50c1dyYXBwZXIud3JhcE1hdHJpeENlbGwoc3VydmV5LCBlbGVtZW50LCBjZWxsLCByZWFzb24pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB3cmFwcGVyICE9PSBudWxsICYmIHdyYXBwZXIgIT09IHZvaWQgMCA/IHdyYXBwZXIgOiBlbGVtZW50O1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXhSb3cucHJvdG90eXBlLmNhblJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICEhdGhpcy5yb3c7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbk1hdHJpeFJvdy5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJvd3NURCA9IG51bGw7XG4gICAgICAgIGlmICh0aGlzLnF1ZXN0aW9uLmhhc1Jvd3MpIHtcbiAgICAgICAgICAgIHZhciByb3dUZXh0ID0gdGhpcy5yZW5kZXJMb2NTdHJpbmcodGhpcy5yb3cubG9jVGV4dCk7XG4gICAgICAgICAgICB2YXIgc3R5bGUgPSB7fTtcbiAgICAgICAgICAgIGlmICghIXRoaXMucXVlc3Rpb24ucm93VGl0bGVXaWR0aCkge1xuICAgICAgICAgICAgICAgIHN0eWxlLm1pbldpZHRoID0gdGhpcy5xdWVzdGlvbi5yb3dUaXRsZVdpZHRoO1xuICAgICAgICAgICAgICAgIHN0eWxlLndpZHRoID0gdGhpcy5xdWVzdGlvbi5yb3dUaXRsZVdpZHRoO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcm93c1REID0gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJ0ZFwiLCB7IHN0eWxlOiBzdHlsZSwgY2xhc3NOYW1lOiB0aGlzLnJvdy5yb3dUZXh0Q2xhc3NlcyB9LCB0aGlzLndyYXBDZWxsKHsgcm93OiB0aGlzLnJvdyB9LCByb3dUZXh0LCBcInJvdy1oZWFkZXJcIikpO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0ZHMgPSB0aGlzLmdlbmVyYXRlVGRzKCk7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJ0clwiLCB7IGNsYXNzTmFtZTogdGhpcy5yb3cucm93Q2xhc3NlcyB8fCB1bmRlZmluZWQgfSxcbiAgICAgICAgICAgIHJvd3NURCxcbiAgICAgICAgICAgIHRkcykpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXhSb3cucHJvdG90eXBlLmdlbmVyYXRlVGRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgdGRzID0gW107XG4gICAgICAgIHZhciByb3cgPSB0aGlzLnJvdztcbiAgICAgICAgdmFyIGNlbGxDb21wb25lbnQgPSB0aGlzLnF1ZXN0aW9uLmNlbGxDb21wb25lbnQ7XG4gICAgICAgIHZhciBfbG9vcF8xID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgdmFyIHRkID0gbnVsbDtcbiAgICAgICAgICAgIHZhciBjb2x1bW4gPSB0aGlzXzEucXVlc3Rpb24udmlzaWJsZUNvbHVtbnNbaV07XG4gICAgICAgICAgICB2YXIga2V5ID0gXCJ2YWx1ZVwiICsgaTtcbiAgICAgICAgICAgIHZhciBpdGVtQ2xhc3MgPSB0aGlzXzEucXVlc3Rpb24uZ2V0SXRlbUNsYXNzKHJvdywgY29sdW1uKTtcbiAgICAgICAgICAgIGlmICh0aGlzXzEucXVlc3Rpb24uaGFzQ2VsbFRleHQpIHtcbiAgICAgICAgICAgICAgICB2YXIgZ2V0SGFuZGxlciA9IGZ1bmN0aW9uIChjb2x1bW4pIHsgcmV0dXJuIGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLmNlbGxDbGljayhyb3csIGNvbHVtbik7IH07IH07XG4gICAgICAgICAgICAgICAgdGQgPSAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJ0ZFwiLCB7IGtleToga2V5LCBjbGFzc05hbWU6IGl0ZW1DbGFzcywgb25DbGljazogZ2V0SGFuZGxlciA/IGdldEhhbmRsZXIoY29sdW1uKSA6IGZ1bmN0aW9uICgpIHsgfSB9LCB0aGlzXzEucmVuZGVyTG9jU3RyaW5nKHRoaXNfMS5xdWVzdGlvbi5nZXRDZWxsRGlzcGxheUxvY1RleHQocm93Lm5hbWUsIGNvbHVtbikpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICB2YXIgcmVuZGVyZWRDZWxsID0gUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5jcmVhdGVFbGVtZW50KGNlbGxDb21wb25lbnQsIHtcbiAgICAgICAgICAgICAgICAgICAgcXVlc3Rpb246IHRoaXNfMS5xdWVzdGlvbixcbiAgICAgICAgICAgICAgICAgICAgcm93OiB0aGlzXzEucm93LFxuICAgICAgICAgICAgICAgICAgICBjb2x1bW46IGNvbHVtbixcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uSW5kZXg6IGksXG4gICAgICAgICAgICAgICAgICAgIGNzc0NsYXNzZXM6IHRoaXNfMS5jc3NDbGFzc2VzLFxuICAgICAgICAgICAgICAgICAgICBjZWxsQ2hhbmdlZDogZnVuY3Rpb24gKCkgeyBfdGhpcy5jZWxsQ2xpY2soX3RoaXMucm93LCBjb2x1bW4pOyB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGQgPSAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJ0ZFwiLCB7IGtleToga2V5LCBcImRhdGEtcmVzcG9uc2l2ZS10aXRsZVwiOiBjb2x1bW4ubG9jVGV4dC5yZW5kZXJlZEh0bWwsIGNsYXNzTmFtZTogdGhpc18xLnF1ZXN0aW9uLmNzc0NsYXNzZXMuY2VsbCB9LCByZW5kZXJlZENlbGwpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRkcy5wdXNoKHRkKTtcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIHRoaXNfMSA9IHRoaXM7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5xdWVzdGlvbi52aXNpYmxlQ29sdW1ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgX2xvb3BfMSgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0ZHM7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbk1hdHJpeFJvdy5wcm90b3R5cGUuY2VsbENsaWNrID0gZnVuY3Rpb24gKHJvdywgY29sdW1uKSB7XG4gICAgICAgIHJvdy52YWx1ZSA9IGNvbHVtbi52YWx1ZTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHZhbHVlOiB0aGlzLnJvdy52YWx1ZSB9KTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvbk1hdHJpeFJvdztcbn0oUmVhY3RTdXJ2ZXlFbGVtZW50KSk7XG5cbnZhciByZWFjdHF1ZXN0aW9uX21hdHJpeF9TdXJ2ZXlRdWVzdGlvbk1hdHJpeENlbGwgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcmVhY3RxdWVzdGlvbl9tYXRyaXhfZXh0ZW5kcyhTdXJ2ZXlRdWVzdGlvbk1hdHJpeENlbGwsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UXVlc3Rpb25NYXRyaXhDZWxsKHByb3BzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5oYW5kbGVPbk1vdXNlRG93biA9IF90aGlzLmhhbmRsZU9uTW91c2VEb3duLmJpbmQoX3RoaXMpO1xuICAgICAgICBfdGhpcy5oYW5kbGVPbkNoYW5nZSA9IF90aGlzLmhhbmRsZU9uQ2hhbmdlLmJpbmQoX3RoaXMpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4Q2VsbC5wcm90b3R5cGUuaGFuZGxlT25DaGFuZ2UgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgaWYgKCEhdGhpcy5wcm9wcy5jZWxsQ2hhbmdlZCkge1xuICAgICAgICAgICAgdGhpcy5wcm9wcy5jZWxsQ2hhbmdlZCgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbk1hdHJpeENlbGwucHJvdG90eXBlLmhhbmRsZU9uTW91c2VEb3duID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHRoaXMucXVlc3Rpb24ub25Nb3VzZURvd24oKTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbk1hdHJpeENlbGwucHJvdG90eXBlLCBcInF1ZXN0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5xdWVzdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbk1hdHJpeENlbGwucHJvdG90eXBlLCBcInJvd1wiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMucm93O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uTWF0cml4Q2VsbC5wcm90b3R5cGUsIFwiY29sdW1uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5jb2x1bW47XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25NYXRyaXhDZWxsLnByb3RvdHlwZSwgXCJjb2x1bW5JbmRleFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuY29sdW1uSW5kZXg7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlRdWVzdGlvbk1hdHJpeENlbGwucHJvdG90eXBlLmNhblJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICEhdGhpcy5xdWVzdGlvbiAmJiAhIXRoaXMucm93O1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXhDZWxsLnByb3RvdHlwZS5yZW5kZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaXNDaGVja2VkID0gdGhpcy5yb3cudmFsdWUgPT0gdGhpcy5jb2x1bW4udmFsdWU7XG4gICAgICAgIHZhciBpbnB1dElkID0gdGhpcy5xdWVzdGlvbi5pbnB1dElkICsgXCJfXCIgKyB0aGlzLnJvdy5uYW1lICsgXCJfXCIgKyB0aGlzLmNvbHVtbkluZGV4O1xuICAgICAgICB2YXIgaXRlbUNsYXNzID0gdGhpcy5xdWVzdGlvbi5nZXRJdGVtQ2xhc3ModGhpcy5yb3csIHRoaXMuY29sdW1uKTtcbiAgICAgICAgdmFyIG1vYmlsZVNwYW4gPSB0aGlzLnF1ZXN0aW9uLmlzTW9iaWxlID9cbiAgICAgICAgICAgIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInNwYW5cIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5jZWxsUmVzcG9uc2l2ZVRpdGxlIH0sIHRoaXMucmVuZGVyTG9jU3RyaW5nKHRoaXMuY29sdW1uLmxvY1RleHQpKSlcbiAgICAgICAgICAgIDogdW5kZWZpbmVkO1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwibGFiZWxcIiwgeyBvbk1vdXNlRG93bjogdGhpcy5oYW5kbGVPbk1vdXNlRG93biwgY2xhc3NOYW1lOiBpdGVtQ2xhc3MgfSxcbiAgICAgICAgICAgIHRoaXMucmVuZGVySW5wdXQoaW5wdXRJZCwgaXNDaGVja2VkKSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwic3BhblwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLm1hdGVyaWFsRGVjb3JhdG9yIH0sIHRoaXMucXVlc3Rpb24uaXRlbVN2Z0ljb24gP1xuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwic3ZnXCIsIHsgY2xhc3NOYW1lOiB0aGlzLmNzc0NsYXNzZXMuaXRlbURlY29yYXRvciB9LFxuICAgICAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInVzZVwiLCB7IHhsaW5rSHJlZjogdGhpcy5xdWVzdGlvbi5pdGVtU3ZnSWNvbiB9KSkgOlxuICAgICAgICAgICAgICAgIG51bGwpLFxuICAgICAgICAgICAgbW9iaWxlU3BhbikpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXhDZWxsLnByb3RvdHlwZS5yZW5kZXJJbnB1dCA9IGZ1bmN0aW9uIChpbnB1dElkLCBpc0NoZWNrZWQpIHtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImlucHV0XCIsIHsgaWQ6IGlucHV0SWQsIHR5cGU6IFwicmFkaW9cIiwgY2xhc3NOYW1lOiB0aGlzLmNzc0NsYXNzZXMuaXRlbVZhbHVlLCBuYW1lOiB0aGlzLnJvdy5mdWxsTmFtZSwgdmFsdWU6IHRoaXMuY29sdW1uLnZhbHVlLCBkaXNhYmxlZDogdGhpcy5yb3cuaXNEaXNhYmxlZEF0dHIsIHJlYWRPbmx5OiB0aGlzLnJvdy5pc1JlYWRPbmx5QXR0ciwgY2hlY2tlZDogaXNDaGVja2VkLCBvbkNoYW5nZTogdGhpcy5oYW5kbGVPbkNoYW5nZSwgXCJhcmlhLXJlcXVpcmVkXCI6IHRoaXMucXVlc3Rpb24uYTExeV9pbnB1dF9hcmlhUmVxdWlyZWQsIFwiYXJpYS1sYWJlbFwiOiB0aGlzLnF1ZXN0aW9uLmdldENlbGxBcmlhTGFiZWwodGhpcy5yb3cubG9jVGV4dC5yZW5kZXJlZEh0bWwsIHRoaXMuY29sdW1uLmxvY1RleHQucmVuZGVyZWRIdG1sKSwgXCJhcmlhLWludmFsaWRcIjogdGhpcy5xdWVzdGlvbi5hMTF5X2lucHV0X2FyaWFJbnZhbGlkLCBcImFyaWEtZXJyb3JtZXNzYWdlXCI6IHRoaXMucXVlc3Rpb24uYTExeV9pbnB1dF9hcmlhRXJyb3JtZXNzYWdlIH0pKTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvbk1hdHJpeENlbGw7XG59KFJlYWN0U3VydmV5RWxlbWVudCkpO1xuXG5SZWFjdEVsZW1lbnRGYWN0b3J5Lkluc3RhbmNlLnJlZ2lzdGVyRWxlbWVudChcInN1cnZleS1tYXRyaXgtY2VsbFwiLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0ocmVhY3RxdWVzdGlvbl9tYXRyaXhfU3VydmV5UXVlc3Rpb25NYXRyaXhDZWxsLCBwcm9wcyk7XG59KTtcblJlYWN0UXVlc3Rpb25GYWN0b3J5Lkluc3RhbmNlLnJlZ2lzdGVyUXVlc3Rpb24oXCJtYXRyaXhcIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHJlYWN0cXVlc3Rpb25fbWF0cml4X1N1cnZleVF1ZXN0aW9uTWF0cml4LCBwcm9wcyk7XG59KTtcblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL3JlYWN0cXVlc3Rpb25faHRtbC50c3hcbnZhciByZWFjdHF1ZXN0aW9uX2h0bWxfZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG52YXIgcmVhY3RxdWVzdGlvbl9odG1sX1N1cnZleVF1ZXN0aW9uSHRtbCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICByZWFjdHF1ZXN0aW9uX2h0bWxfZXh0ZW5kcyhTdXJ2ZXlRdWVzdGlvbkh0bWwsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UXVlc3Rpb25IdG1sKHByb3BzKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uSHRtbC5wcm90b3R5cGUsIFwicXVlc3Rpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnF1ZXN0aW9uQmFzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleVF1ZXN0aW9uSHRtbC5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMucmVhY3RPblN0ckNoYW5nZWQoKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uSHRtbC5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMucXVlc3Rpb24ubG9jSHRtbC5vbkNoYW5nZWQgPSBmdW5jdGlvbiAoKSB7IH07XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkh0bWwucHJvdG90eXBlLmNvbXBvbmVudERpZFVwZGF0ZSA9IGZ1bmN0aW9uIChwcmV2UHJvcHMsIHByZXZTdGF0ZSkge1xuICAgICAgICB0aGlzLnJlYWN0T25TdHJDaGFuZ2VkKCk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkh0bWwucHJvdG90eXBlLnJlYWN0T25TdHJDaGFuZ2VkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB0aGlzLnF1ZXN0aW9uLmxvY0h0bWwub25DaGFuZ2VkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3RoaXMuc2V0U3RhdGUoeyBjaGFuZ2VkOiAhIV90aGlzLnN0YXRlICYmIF90aGlzLnN0YXRlLmNoYW5nZWQgPyBfdGhpcy5zdGF0ZS5jaGFuZ2VkICsgMSA6IDEgfSk7XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkh0bWwucHJvdG90eXBlLmNhblJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUuY2FuUmVuZGVyLmNhbGwodGhpcykgJiYgISF0aGlzLnF1ZXN0aW9uLmh0bWw7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkh0bWwucHJvdG90eXBlLnJlbmRlckVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBodG1sVmFsdWUgPSB7IF9faHRtbDogdGhpcy5xdWVzdGlvbi5sb2NIdG1sLnJlbmRlcmVkSHRtbCB9O1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLnJlbmRlckNzc1Jvb3QsIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MOiBodG1sVmFsdWUgfSkpO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVF1ZXN0aW9uSHRtbDtcbn0ocmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleVF1ZXN0aW9uRWxlbWVudEJhc2UpKTtcblxuUmVhY3RRdWVzdGlvbkZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJRdWVzdGlvbihcImh0bWxcIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHJlYWN0cXVlc3Rpb25faHRtbF9TdXJ2ZXlRdWVzdGlvbkh0bWwsIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvY29tcG9uZW50cy9sb2FkaW5nLWluZGljYXRvci50c3hcbnZhciBsb2FkaW5nX2luZGljYXRvcl9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG52YXIgbG9hZGluZ19pbmRpY2F0b3JfTG9hZGluZ0luZGljYXRvckNvbXBvbmVudCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBsb2FkaW5nX2luZGljYXRvcl9leHRlbmRzKExvYWRpbmdJbmRpY2F0b3JDb21wb25lbnQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTG9hZGluZ0luZGljYXRvckNvbXBvbmVudCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBMb2FkaW5nSW5kaWNhdG9yQ29tcG9uZW50LnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic2QtbG9hZGluZy1pbmRpY2F0b3JcIiB9LFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oc3ZnX2ljb25fU3ZnSWNvbiwgeyBpY29uTmFtZTogXCJpY29uLWxvYWRpbmdcIiwgc2l6ZTogXCJhdXRvXCIgfSkpKTtcbiAgICB9O1xuICAgIHJldHVybiBMb2FkaW5nSW5kaWNhdG9yQ29tcG9uZW50O1xufShleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiQ29tcG9uZW50XCJdKSk7XG5cblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL2NvbXBvbmVudHMvZmlsZS9maWxlLWNob29zZS1idXR0b24udHN4XG52YXIgZmlsZV9jaG9vc2VfYnV0dG9uX2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cblxuXG5cbnZhciBmaWxlX2Nob29zZV9idXR0b25fU3VydmV5RmlsZUNob29zZUJ1dHRvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBmaWxlX2Nob29zZV9idXR0b25fZXh0ZW5kcyhTdXJ2ZXlGaWxlQ2hvb3NlQnV0dG9uLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleUZpbGVDaG9vc2VCdXR0b24ocHJvcHMpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5RmlsZUNob29zZUJ1dHRvbi5wcm90b3R5cGUsIFwicXVlc3Rpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5wcm9wcy5pdGVtICYmIHRoaXMucHJvcHMuaXRlbS5kYXRhLnF1ZXN0aW9uKSB8fCB0aGlzLnByb3BzLmRhdGEucXVlc3Rpb247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlGaWxlQ2hvb3NlQnV0dG9uLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiBhdHRhY2hLZXkyY2xpY2soZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwibGFiZWxcIiwgeyB0YWJJbmRleDogMCwgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmdldENob29zZUZpbGVDc3MoKSwgaHRtbEZvcjogdGhpcy5xdWVzdGlvbi5pbnB1dElkLCBcImFyaWEtbGFiZWxcIjogdGhpcy5xdWVzdGlvbi5jaG9vc2VCdXR0b25UZXh0LCBvbkNsaWNrOiBmdW5jdGlvbiAoZSkgeyByZXR1cm4gX3RoaXMucXVlc3Rpb24uY2hvb3NlRmlsZShlLm5hdGl2ZUV2ZW50KTsgfSB9LFxuICAgICAgICAgICAgKCEhdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmNob29zZUZpbGVJY29uSWQpID8gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KHN2Z19pY29uX1N2Z0ljb24sIHsgdGl0bGU6IHRoaXMucXVlc3Rpb24uY2hvb3NlQnV0dG9uVGV4dCwgaWNvbk5hbWU6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5jaG9vc2VGaWxlSWNvbklkLCBzaXplOiBcImF1dG9cIiB9KSA6IG51bGwsXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIG51bGwsIHRoaXMucXVlc3Rpb24uY2hvb3NlQnV0dG9uVGV4dCkpKTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlGaWxlQ2hvb3NlQnV0dG9uO1xufShSZWFjdFN1cnZleUVsZW1lbnQpKTtcblxuUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlckVsZW1lbnQoXCJzdi1maWxlLWNob29zZS1idG5cIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChmaWxlX2Nob29zZV9idXR0b25fU3VydmV5RmlsZUNob29zZUJ1dHRvbiwgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9yZWFjdHF1ZXN0aW9uX2ZpbGUudHN4XG52YXIgcmVhY3RxdWVzdGlvbl9maWxlX2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cblxuXG5cblxuXG5cblxuLy8gaW1wb3J0IHsgUmVhY3RFbGVtZW50RmFjdG9yeSwgU3VydmV5RmlsZUNob29zZUJ1dHRvbiB9IGZyb20gXCIuLi9lbnRyaWVzL3JlYWN0LXVpLW1vZGVsXCI7XG52YXIgcmVhY3RxdWVzdGlvbl9maWxlX1N1cnZleVF1ZXN0aW9uRmlsZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICByZWFjdHF1ZXN0aW9uX2ZpbGVfZXh0ZW5kcyhTdXJ2ZXlRdWVzdGlvbkZpbGUsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UXVlc3Rpb25GaWxlKHByb3BzKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uRmlsZS5wcm90b3R5cGUsIFwicXVlc3Rpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnF1ZXN0aW9uQmFzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleVF1ZXN0aW9uRmlsZS5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHByZXZpZXcgPSB0aGlzLnF1ZXN0aW9uLmFsbG93U2hvd1ByZXZpZXcgPyB0aGlzLnJlbmRlclByZXZpZXcoKSA6IG51bGw7XG4gICAgICAgIHZhciBsb2FkaW5nSW5kaWNhdG9yID0gdGhpcy5xdWVzdGlvbi5zaG93TG9hZGluZ0luZGljYXRvciA/IHRoaXMucmVuZGVyTG9hZGluZ0luZGljYXRvcigpIDogbnVsbDtcbiAgICAgICAgdmFyIHZpZGVvID0gdGhpcy5xdWVzdGlvbi5pc1BsYXlpbmdWaWRlbyA/IHRoaXMucmVuZGVyVmlkZW8oKSA6IG51bGw7XG4gICAgICAgIHZhciBmaWxlRGVjb3JhdG9yID0gdGhpcy5xdWVzdGlvbi5zaG93RmlsZURlY29yYXRvciA/IHRoaXMucmVuZGVyRmlsZURlY29yYXRvcigpIDogbnVsbDtcbiAgICAgICAgdmFyIGNsZWFyQnV0dG9uID0gdGhpcy5xdWVzdGlvbi5zaG93UmVtb3ZlQnV0dG9uID8gdGhpcy5yZW5kZXJDbGVhckJ1dHRvbih0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMucmVtb3ZlQnV0dG9uKSA6IG51bGw7XG4gICAgICAgIHZhciBjbGVhckJ1dHRvbkJvdHRvbSA9IHRoaXMucXVlc3Rpb24uc2hvd1JlbW92ZUJ1dHRvbkJvdHRvbSA/IHRoaXMucmVuZGVyQ2xlYXJCdXR0b24odGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLnJlbW92ZUJ1dHRvbkJvdHRvbSkgOiBudWxsO1xuICAgICAgICB2YXIgZmlsZU5hdmlnYXRvciA9IHRoaXMucXVlc3Rpb24uZmlsZU5hdmlnYXRvclZpc2libGUgPyAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oYWN0aW9uX2Jhcl9TdXJ2ZXlBY3Rpb25CYXIsIHsgbW9kZWw6IHRoaXMucXVlc3Rpb24uZmlsZU5hdmlnYXRvciB9KSkgOiBudWxsO1xuICAgICAgICB2YXIgZmlsZUlucHV0O1xuICAgICAgICBpZiAodGhpcy5xdWVzdGlvbi5pc1JlYWRPbmx5QXR0cikge1xuICAgICAgICAgICAgZmlsZUlucHV0ID0gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJpbnB1dFwiLCB7IHJlYWRPbmx5OiB0cnVlLCB0eXBlOiBcImZpbGVcIiwgY2xhc3NOYW1lOiAhdGhpcy5pc0Rpc3BsYXlNb2RlID8gdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmZpbGVJbnB1dCA6IHRoaXMucXVlc3Rpb24uZ2V0UmVhZE9ubHlGaWxlQ3NzKCksIGlkOiB0aGlzLnF1ZXN0aW9uLmlucHV0SWQsIHJlZjogZnVuY3Rpb24gKGlucHV0KSB7IHJldHVybiAoX3RoaXMuc2V0Q29udHJvbChpbnB1dCkpOyB9LCBzdHlsZTogIXRoaXMuaXNEaXNwbGF5TW9kZSA/IHt9IDogeyBjb2xvcjogXCJ0cmFuc3BhcmVudFwiIH0sIG11bHRpcGxlOiB0aGlzLnF1ZXN0aW9uLmFsbG93TXVsdGlwbGUsIHBsYWNlaG9sZGVyOiB0aGlzLnF1ZXN0aW9uLnRpdGxlLCBhY2NlcHQ6IHRoaXMucXVlc3Rpb24uYWNjZXB0ZWRUeXBlcyB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLnF1ZXN0aW9uLmlzRGlzYWJsZWRBdHRyKSB7XG4gICAgICAgICAgICBmaWxlSW5wdXQgPSBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImlucHV0XCIsIHsgZGlzYWJsZWQ6IHRydWUsIHR5cGU6IFwiZmlsZVwiLCBjbGFzc05hbWU6ICF0aGlzLmlzRGlzcGxheU1vZGUgPyB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMuZmlsZUlucHV0IDogdGhpcy5xdWVzdGlvbi5nZXRSZWFkT25seUZpbGVDc3MoKSwgaWQ6IHRoaXMucXVlc3Rpb24uaW5wdXRJZCwgcmVmOiBmdW5jdGlvbiAoaW5wdXQpIHsgcmV0dXJuIChfdGhpcy5zZXRDb250cm9sKGlucHV0KSk7IH0sIHN0eWxlOiAhdGhpcy5pc0Rpc3BsYXlNb2RlID8ge30gOiB7IGNvbG9yOiBcInRyYW5zcGFyZW50XCIgfSwgbXVsdGlwbGU6IHRoaXMucXVlc3Rpb24uYWxsb3dNdWx0aXBsZSwgcGxhY2Vob2xkZXI6IHRoaXMucXVlc3Rpb24udGl0bGUsIGFjY2VwdDogdGhpcy5xdWVzdGlvbi5hY2NlcHRlZFR5cGVzIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMucXVlc3Rpb24uaGFzRmlsZVVJKSB7XG4gICAgICAgICAgICBmaWxlSW5wdXQgPSBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImlucHV0XCIsIHsgdHlwZTogXCJmaWxlXCIsIGRpc2FibGVkOiB0aGlzLmlzRGlzcGxheU1vZGUsIHRhYkluZGV4OiAtMSwgY2xhc3NOYW1lOiAhdGhpcy5pc0Rpc3BsYXlNb2RlID8gdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmZpbGVJbnB1dCA6IHRoaXMucXVlc3Rpb24uZ2V0UmVhZE9ubHlGaWxlQ3NzKCksIGlkOiB0aGlzLnF1ZXN0aW9uLmlucHV0SWQsIHJlZjogZnVuY3Rpb24gKGlucHV0KSB7IHJldHVybiAoX3RoaXMuc2V0Q29udHJvbChpbnB1dCkpOyB9LCBzdHlsZTogIXRoaXMuaXNEaXNwbGF5TW9kZSA/IHt9IDogeyBjb2xvcjogXCJ0cmFuc3BhcmVudFwiIH0sIFwiYXJpYS1yZXF1aXJlZFwiOiB0aGlzLnF1ZXN0aW9uLmFyaWFSZXF1aXJlZCwgXCJhcmlhLWxhYmVsXCI6IHRoaXMucXVlc3Rpb24uYXJpYUxhYmVsLCBcImFyaWEtaW52YWxpZFwiOiB0aGlzLnF1ZXN0aW9uLmFyaWFJbnZhbGlkLCBcImFyaWEtZXJyb3JtZXNzYWdlXCI6IHRoaXMucXVlc3Rpb24uYXJpYUVycm9ybWVzc2FnZSwgbXVsdGlwbGU6IHRoaXMucXVlc3Rpb24uYWxsb3dNdWx0aXBsZSwgdGl0bGU6IHRoaXMucXVlc3Rpb24uaW5wdXRUaXRsZSwgYWNjZXB0OiB0aGlzLnF1ZXN0aW9uLmFjY2VwdGVkVHlwZXMsIGNhcHR1cmU6IHRoaXMucXVlc3Rpb24ucmVuZGVyQ2FwdHVyZSB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGZpbGVJbnB1dCA9IG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5maWxlUm9vdENzcywgcmVmOiBmdW5jdGlvbiAoZWwpIHsgcmV0dXJuIChfdGhpcy5zZXRDb250ZW50KGVsKSk7IH0gfSxcbiAgICAgICAgICAgIGZpbGVJbnB1dCxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMuZHJhZ0FyZWEsIG9uRHJvcDogdGhpcy5xdWVzdGlvbi5vbkRyb3AsIG9uRHJhZ092ZXI6IHRoaXMucXVlc3Rpb24ub25EcmFnT3Zlciwgb25EcmFnTGVhdmU6IHRoaXMucXVlc3Rpb24ub25EcmFnTGVhdmUsIG9uRHJhZ0VudGVyOiB0aGlzLnF1ZXN0aW9uLm9uRHJhZ0VudGVyIH0sXG4gICAgICAgICAgICAgICAgZmlsZURlY29yYXRvcixcbiAgICAgICAgICAgICAgICBsb2FkaW5nSW5kaWNhdG9yLFxuICAgICAgICAgICAgICAgIHZpZGVvLFxuICAgICAgICAgICAgICAgIGNsZWFyQnV0dG9uLFxuICAgICAgICAgICAgICAgIHByZXZpZXcsXG4gICAgICAgICAgICAgICAgY2xlYXJCdXR0b25Cb3R0b20sXG4gICAgICAgICAgICAgICAgZmlsZU5hdmlnYXRvcikpKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uRmlsZS5wcm90b3R5cGUucmVuZGVyRmlsZURlY29yYXRvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNob29zZUJ1dHRvbiA9IHRoaXMucXVlc3Rpb24uc2hvd0Nob29zZUJ1dHRvbiA/IHRoaXMucmVuZGVyQ2hvb3NlQnV0dG9uKCkgOiBudWxsO1xuICAgICAgICB2YXIgYWN0aW9uc0NvbnRhaW5lciA9IHRoaXMucXVlc3Rpb24uYWN0aW9uc0NvbnRhaW5lclZpc2libGUgPyBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShhY3Rpb25fYmFyX1N1cnZleUFjdGlvbkJhciwgeyBtb2RlbDogdGhpcy5xdWVzdGlvbi5hY3Rpb25zQ29udGFpbmVyIH0pIDogbnVsbDtcbiAgICAgICAgdmFyIG5vRmlsZUNob3NlbiA9IHRoaXMucXVlc3Rpb24uaXNFbXB0eSgpID8gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwic3BhblwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLm5vRmlsZUNob3NlbiB9LCB0aGlzLnF1ZXN0aW9uLm5vRmlsZUNob3NlbkNhcHRpb24pKSA6IG51bGw7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uZ2V0RmlsZURlY29yYXRvckNzcygpIH0sXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInNwYW5cIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5kcmFnQXJlYVBsYWNlaG9sZGVyIH0sIHRoaXMucmVuZGVyTG9jU3RyaW5nKHRoaXMucXVlc3Rpb24ubG9jUmVuZGVyZWRQbGFjZWhvbGRlcikpLFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy53cmFwcGVyIH0sXG4gICAgICAgICAgICAgICAgY2hvb3NlQnV0dG9uLFxuICAgICAgICAgICAgICAgIGFjdGlvbnNDb250YWluZXIsXG4gICAgICAgICAgICAgICAgbm9GaWxlQ2hvc2VuKSkpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25GaWxlLnByb3RvdHlwZS5yZW5kZXJDaG9vc2VCdXR0b24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShmaWxlX2Nob29zZV9idXR0b25fU3VydmV5RmlsZUNob29zZUJ1dHRvbiwgeyBkYXRhOiB7IHF1ZXN0aW9uOiB0aGlzLnF1ZXN0aW9uIH0gfSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkZpbGUucHJvdG90eXBlLnJlbmRlckNsZWFyQnV0dG9uID0gZnVuY3Rpb24gKGNsYXNzTmFtZSkge1xuICAgICAgICByZXR1cm4gIXRoaXMucXVlc3Rpb24uaXNVcGxvYWRpbmcgPyAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJidXR0b25cIiwgeyB0eXBlOiBcImJ1dHRvblwiLCBvbkNsaWNrOiB0aGlzLnF1ZXN0aW9uLmRvQ2xlYW4sIGNsYXNzTmFtZTogY2xhc3NOYW1lIH0sXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInNwYW5cIiwgbnVsbCwgdGhpcy5xdWVzdGlvbi5jbGVhckJ1dHRvbkNhcHRpb24pLFxuICAgICAgICAgICAgKCEhdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLnJlbW92ZUJ1dHRvbkljb25JZCkgPyBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShzdmdfaWNvbl9TdmdJY29uLCB7IGljb25OYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMucmVtb3ZlQnV0dG9uSWNvbklkLCBzaXplOiBcImF1dG9cIiwgdGl0bGU6IHRoaXMucXVlc3Rpb24uY2xlYXJCdXR0b25DYXB0aW9uIH0pIDogbnVsbCkpIDogbnVsbDtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uRmlsZS5wcm90b3R5cGUucmVuZGVyUHJldmlldyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UuY3JlYXRlRWxlbWVudChcInN2LWZpbGUtcHJldmlld1wiLCB7IHF1ZXN0aW9uOiB0aGlzLnF1ZXN0aW9uIH0pO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25GaWxlLnByb3RvdHlwZS5yZW5kZXJMb2FkaW5nSW5kaWNhdG9yID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5sb2FkaW5nSW5kaWNhdG9yIH0sXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShsb2FkaW5nX2luZGljYXRvcl9Mb2FkaW5nSW5kaWNhdG9yQ29tcG9uZW50LCBudWxsKSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkZpbGUucHJvdG90eXBlLnJlbmRlclZpZGVvID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMudmlkZW9Db250YWluZXIgfSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKGFjdGlvbl9iYXJfaXRlbV9TdXJ2ZXlBY3Rpb24sIHsgaXRlbTogdGhpcy5xdWVzdGlvbi5jaGFuZ2VDYW1lcmFBY3Rpb24gfSksXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShhY3Rpb25fYmFyX2l0ZW1fU3VydmV5QWN0aW9uLCB7IGl0ZW06IHRoaXMucXVlc3Rpb24uY2xvc2VDYW1lcmFBY3Rpb24gfSksXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInZpZGVvXCIsIHsgYXV0b1BsYXk6IHRydWUsIHBsYXlzSW5saW5lOiB0cnVlLCBpZDogdGhpcy5xdWVzdGlvbi52aWRlb0lkLCBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy52aWRlbyB9KSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKGFjdGlvbl9iYXJfaXRlbV9TdXJ2ZXlBY3Rpb24sIHsgaXRlbTogdGhpcy5xdWVzdGlvbi50YWtlUGljdHVyZUFjdGlvbiB9KSkpO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVF1ZXN0aW9uRmlsZTtcbn0ocmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleVF1ZXN0aW9uRWxlbWVudEJhc2UpKTtcblxuUmVhY3RRdWVzdGlvbkZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJRdWVzdGlvbihcImZpbGVcIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHJlYWN0cXVlc3Rpb25fZmlsZV9TdXJ2ZXlRdWVzdGlvbkZpbGUsIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvY29tcG9uZW50cy9maWxlL2ZpbGUtcHJldmlldy50c3hcbnZhciBmaWxlX3ByZXZpZXdfZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG5cbnZhciBmaWxlX3ByZXZpZXdfU3VydmV5RmlsZVByZXZpZXcgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgZmlsZV9wcmV2aWV3X2V4dGVuZHMoU3VydmV5RmlsZVByZXZpZXcsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5RmlsZVByZXZpZXcoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleUZpbGVQcmV2aWV3LnByb3RvdHlwZSwgXCJxdWVzdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMucXVlc3Rpb247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlGaWxlUHJldmlldy5wcm90b3R5cGUucmVuZGVyRmlsZVNpZ24gPSBmdW5jdGlvbiAoY2xhc3NOYW1lLCB2YWwpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKCFjbGFzc05hbWUgfHwgIXZhbC5uYW1lKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBjbGFzc05hbWUgfSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcImFcIiwgeyBocmVmOiB2YWwuY29udGVudCwgb25DbGljazogZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzLnF1ZXN0aW9uLmRvRG93bmxvYWRGaWxlKGV2ZW50LCB2YWwpO1xuICAgICAgICAgICAgICAgIH0sIHRpdGxlOiB2YWwubmFtZSwgZG93bmxvYWQ6IHZhbC5uYW1lLCBzdHlsZTogeyB3aWR0aDogdGhpcy5xdWVzdGlvbi5pbWFnZVdpZHRoIH0gfSwgdmFsLm5hbWUpKSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlGaWxlUHJldmlldy5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIHByZXZpZXdzID0gdGhpcy5xdWVzdGlvbi5wcmV2aWV3VmFsdWUubWFwKGZ1bmN0aW9uICh2YWwsIGluZGV4KSB7XG4gICAgICAgICAgICBpZiAoIXZhbClcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwic3BhblwiLCB7IGtleTogX3RoaXMucXVlc3Rpb24uaW5wdXRJZCArIFwiX1wiICsgaW5kZXgsIGNsYXNzTmFtZTogX3RoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5wcmV2aWV3SXRlbSwgb25DbGljazogZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfdGhpcy5xdWVzdGlvbi5kb0Rvd25sb2FkRmlsZUZyb21Db250YWluZXIoZXZlbnQpOyB9LCBzdHlsZTogeyBkaXNwbGF5OiBfdGhpcy5xdWVzdGlvbi5pc1ByZXZpZXdWaXNpYmxlKGluZGV4KSA/IHVuZGVmaW5lZCA6IFwibm9uZVwiIH0gfSxcbiAgICAgICAgICAgICAgICBfdGhpcy5yZW5kZXJGaWxlU2lnbihfdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmZpbGVTaWduLCB2YWwpLFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogX3RoaXMucXVlc3Rpb24uZ2V0SW1hZ2VXcmFwcGVyQ3NzKHZhbCkgfSxcbiAgICAgICAgICAgICAgICAgICAgX3RoaXMucXVlc3Rpb24uY2FuUHJldmlld0ltYWdlKHZhbCkgPyAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiaW1nXCIsIHsgc3JjOiB2YWwuY29udGVudCwgc3R5bGU6IHsgaGVpZ2h0OiBfdGhpcy5xdWVzdGlvbi5pbWFnZUhlaWdodCwgd2lkdGg6IF90aGlzLnF1ZXN0aW9uLmltYWdlV2lkdGggfSwgYWx0OiBcIkZpbGUgcHJldmlld1wiIH0pKSA6IChfdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmRlZmF1bHRJbWFnZSA/IChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoc3ZnX2ljb25fU3ZnSWNvbiwgeyBpY29uTmFtZTogX3RoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5kZWZhdWx0SW1hZ2VJY29uSWQsIHNpemU6IFwiYXV0b1wiLCBjbGFzc05hbWU6IF90aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMuZGVmYXVsdEltYWdlIH0pKSA6IG51bGwpLFxuICAgICAgICAgICAgICAgICAgICB2YWwubmFtZSAmJiAhX3RoaXMucXVlc3Rpb24uaXNSZWFkT25seSA/IChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IF90aGlzLnF1ZXN0aW9uLmdldFJlbW92ZUJ1dHRvbkNzcygpLCBvbkNsaWNrOiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIF90aGlzLnF1ZXN0aW9uLmRvUmVtb3ZlRmlsZSh2YWwsIGV2ZW50KTsgfSB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwic3BhblwiLCB7IGNsYXNzTmFtZTogX3RoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5yZW1vdmVGaWxlIH0sIF90aGlzLnF1ZXN0aW9uLnJlbW92ZUZpbGVDYXB0aW9uKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIChfdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLnJlbW92ZUZpbGVTdmdJY29uSWQpID9cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KHN2Z19pY29uX1N2Z0ljb24sIHsgdGl0bGU6IF90aGlzLnF1ZXN0aW9uLnJlbW92ZUZpbGVDYXB0aW9uLCBpY29uTmFtZTogX3RoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5yZW1vdmVGaWxlU3ZnSWNvbklkLCBzaXplOiBcImF1dG9cIiwgY2xhc3NOYW1lOiBfdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLnJlbW92ZUZpbGVTdmcgfSkpIDogbnVsbCkpIDogbnVsbCksXG4gICAgICAgICAgICAgICAgX3RoaXMucmVuZGVyRmlsZVNpZ24oX3RoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5maWxlU2lnbkJvdHRvbSwgdmFsKSkpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmZpbGVMaXN0IHx8IHVuZGVmaW5lZCB9LCBwcmV2aWV3cyk7XG4gICAgfTtcbiAgICBTdXJ2ZXlGaWxlUHJldmlldy5wcm90b3R5cGUuY2FuUmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5xdWVzdGlvbi5zaG93UHJldmlld0NvbnRhaW5lcjtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlGaWxlUHJldmlldztcbn0ocmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleUVsZW1lbnRCYXNlKSk7XG5cblJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJFbGVtZW50KFwic3YtZmlsZS1wcmV2aWV3XCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoZmlsZV9wcmV2aWV3X1N1cnZleUZpbGVQcmV2aWV3LCBwcm9wcyk7XG59KTtcblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL3JlYWN0cXVlc3Rpb25fbXVsdGlwbGV0ZXh0LnRzeFxudmFyIHJlYWN0cXVlc3Rpb25fbXVsdGlwbGV0ZXh0X2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cblxuXG5cblxudmFyIHJlYWN0cXVlc3Rpb25fbXVsdGlwbGV0ZXh0X1N1cnZleVF1ZXN0aW9uTXVsdGlwbGVUZXh0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJlYWN0cXVlc3Rpb25fbXVsdGlwbGV0ZXh0X2V4dGVuZHMoU3VydmV5UXVlc3Rpb25NdWx0aXBsZVRleHQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UXVlc3Rpb25NdWx0aXBsZVRleHQocHJvcHMpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25NdWx0aXBsZVRleHQucHJvdG90eXBlLCBcInF1ZXN0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5xdWVzdGlvbkJhc2U7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlRdWVzdGlvbk11bHRpcGxlVGV4dC5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNzc0NsYXNzZXMgPSB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXM7XG4gICAgICAgIHZhciB0YWJsZVJvd3MgPSB0aGlzLnF1ZXN0aW9uLmdldFJvd3MoKTtcbiAgICAgICAgdmFyIHJvd3MgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWJsZVJvd3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGlmICh0YWJsZVJvd3NbaV0uaXNWaXNpYmxlKSB7XG4gICAgICAgICAgICAgICAgcm93cy5wdXNoKHRoaXMucmVuZGVyUm93KGksIHRhYmxlUm93c1tpXS5jZWxscywgY3NzQ2xhc3NlcykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJ0YWJsZVwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5nZXRRdWVzdGlvblJvb3RDc3MoKSB9LFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJ0Ym9keVwiLCBudWxsLCByb3dzKSkpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25NdWx0aXBsZVRleHQucHJvdG90eXBlLnJlbmRlckNlbGwgPSBmdW5jdGlvbiAoY2VsbCwgY3NzQ2xhc3NlcywgaW5kZXgpIHtcbiAgICAgICAgdmFyIGNlbGxDb250ZW50O1xuICAgICAgICB2YXIgZm9jdXNJbiA9IGZ1bmN0aW9uICgpIHsgY2VsbC5pdGVtLmZvY3VzSW4oKTsgfTtcbiAgICAgICAgaWYgKGNlbGwuaXNFcnJvcnNDZWxsKSB7XG4gICAgICAgICAgICBjZWxsQ29udGVudCA9IGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHJlYWN0cXVlc3Rpb25fU3VydmV5UXVlc3Rpb25FcnJvckNlbGwsIHsgcXVlc3Rpb246IGNlbGwuaXRlbS5lZGl0b3IsIGNyZWF0b3I6IHRoaXMuY3JlYXRvciB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNlbGxDb250ZW50ID0gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0ocmVhY3RxdWVzdGlvbl9tdWx0aXBsZXRleHRfU3VydmV5TXVsdGlwbGVUZXh0SXRlbSwgeyBxdWVzdGlvbjogdGhpcy5xdWVzdGlvbiwgaXRlbTogY2VsbC5pdGVtLCBjcmVhdG9yOiB0aGlzLmNyZWF0b3IsIGNzc0NsYXNzZXM6IGNzc0NsYXNzZXMgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInRkXCIsIHsga2V5OiBcIml0ZW1cIiArIGluZGV4LCBjbGFzc05hbWU6IGNlbGwuY2xhc3NOYW1lLCBvbkZvY3VzOiBmb2N1c0luIH0sIGNlbGxDb250ZW50KSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbk11bHRpcGxlVGV4dC5wcm90b3R5cGUucmVuZGVyUm93ID0gZnVuY3Rpb24gKHJvd0luZGV4LCBjZWxscywgY3NzQ2xhc3Nlcykge1xuICAgICAgICB2YXIga2V5ID0gXCJpdGVtXCIgKyByb3dJbmRleDtcbiAgICAgICAgdmFyIHRkcyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNlbGxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgY2VsbCA9IGNlbGxzW2ldO1xuICAgICAgICAgICAgdGRzLnB1c2godGhpcy5yZW5kZXJDZWxsKGNlbGwsIGNzc0NsYXNzZXMsIGkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwidHJcIiwgeyBrZXk6IGtleSwgY2xhc3NOYW1lOiBjc3NDbGFzc2VzLnJvdyB9LCB0ZHMpKTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvbk11bHRpcGxlVGV4dDtcbn0ocmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleVF1ZXN0aW9uRWxlbWVudEJhc2UpKTtcblxudmFyIHJlYWN0cXVlc3Rpb25fbXVsdGlwbGV0ZXh0X1N1cnZleU11bHRpcGxlVGV4dEl0ZW0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcmVhY3RxdWVzdGlvbl9tdWx0aXBsZXRleHRfZXh0ZW5kcyhTdXJ2ZXlNdWx0aXBsZVRleHRJdGVtLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleU11bHRpcGxlVGV4dEl0ZW0oKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleU11bHRpcGxlVGV4dEl0ZW0ucHJvdG90eXBlLCBcInF1ZXN0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5xdWVzdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlNdWx0aXBsZVRleHRJdGVtLnByb3RvdHlwZSwgXCJpdGVtXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5pdGVtO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3VydmV5TXVsdGlwbGVUZXh0SXRlbS5wcm90b3R5cGUuZ2V0U3RhdGVFbGVtZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIFt0aGlzLml0ZW0sIHRoaXMuaXRlbS5lZGl0b3JdO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleU11bHRpcGxlVGV4dEl0ZW0ucHJvdG90eXBlLCBcImNyZWF0b3JcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLmNyZWF0b3I7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlNdWx0aXBsZVRleHRJdGVtLnByb3RvdHlwZS5yZW5kZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaXRlbSA9IHRoaXMuaXRlbTtcbiAgICAgICAgdmFyIGNzc0NsYXNzZXMgPSB0aGlzLmNzc0NsYXNzZXM7XG4gICAgICAgIHZhciB0aXRsZVN0eWxlID0ge307XG4gICAgICAgIGlmICghIXRoaXMucXVlc3Rpb24uaXRlbVRpdGxlV2lkdGgpIHtcbiAgICAgICAgICAgIHRpdGxlU3R5bGUubWluV2lkdGggPSB0aGlzLnF1ZXN0aW9uLml0ZW1UaXRsZVdpZHRoO1xuICAgICAgICAgICAgdGl0bGVTdHlsZS53aWR0aCA9IHRoaXMucXVlc3Rpb24uaXRlbVRpdGxlV2lkdGg7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImxhYmVsXCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmdldEl0ZW1MYWJlbENzcyhpdGVtKSB9LFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJzcGFuXCIsIHsgY2xhc3NOYW1lOiBjc3NDbGFzc2VzLml0ZW1UaXRsZSwgc3R5bGU6IHRpdGxlU3R5bGUgfSxcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXSh0aXRsZV9jb250ZW50X1RpdGxlQ29udGVudCwgeyBlbGVtZW50OiBpdGVtLmVkaXRvciwgY3NzQ2xhc3NlczogaXRlbS5lZGl0b3IuY3NzQ2xhc3NlcyB9KSksXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyZWFjdHF1ZXN0aW9uX211bHRpcGxldGV4dF9TdXJ2ZXlNdWx0aXBsZVRleHRJdGVtRWRpdG9yLCB7IGNzc0NsYXNzZXM6IGNzc0NsYXNzZXMsIGl0ZW1Dc3M6IHRoaXMucXVlc3Rpb24uZ2V0SXRlbUNzcygpLCBxdWVzdGlvbjogaXRlbS5lZGl0b3IsIGNyZWF0b3I6IHRoaXMuY3JlYXRvciB9KSkpO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleU11bHRpcGxlVGV4dEl0ZW07XG59KFJlYWN0U3VydmV5RWxlbWVudCkpO1xuXG52YXIgcmVhY3RxdWVzdGlvbl9tdWx0aXBsZXRleHRfU3VydmV5TXVsdGlwbGVUZXh0SXRlbUVkaXRvciA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICByZWFjdHF1ZXN0aW9uX211bHRpcGxldGV4dF9leHRlbmRzKFN1cnZleU11bHRpcGxlVGV4dEl0ZW1FZGl0b3IsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5TXVsdGlwbGVUZXh0SXRlbUVkaXRvcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTdXJ2ZXlNdWx0aXBsZVRleHRJdGVtRWRpdG9yLnByb3RvdHlwZS5yZW5kZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMuaXRlbUNzcyB9LCB0aGlzLnJlbmRlckNvbnRlbnQoKSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5TXVsdGlwbGVUZXh0SXRlbUVkaXRvcjtcbn0ocmVhY3RxdWVzdGlvbl9TdXJ2ZXlRdWVzdGlvbkFuZEVycm9yc1dyYXBwZWQpKTtcblxuUmVhY3RRdWVzdGlvbkZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJRdWVzdGlvbihcIm11bHRpcGxldGV4dFwiLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0ocmVhY3RxdWVzdGlvbl9tdWx0aXBsZXRleHRfU3VydmV5UXVlc3Rpb25NdWx0aXBsZVRleHQsIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvcmVhY3RxdWVzdGlvbl9yYWRpb2dyb3VwLnRzeFxudmFyIHJlYWN0cXVlc3Rpb25fcmFkaW9ncm91cF9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cblxuXG5cbnZhciByZWFjdHF1ZXN0aW9uX3JhZGlvZ3JvdXBfU3VydmV5UXVlc3Rpb25SYWRpb2dyb3VwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJlYWN0cXVlc3Rpb25fcmFkaW9ncm91cF9leHRlbmRzKFN1cnZleVF1ZXN0aW9uUmFkaW9ncm91cCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlRdWVzdGlvblJhZGlvZ3JvdXAocHJvcHMpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25SYWRpb2dyb3VwLnByb3RvdHlwZSwgXCJxdWVzdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucXVlc3Rpb25CYXNlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3VydmV5UXVlc3Rpb25SYWRpb2dyb3VwLnByb3RvdHlwZS5yZW5kZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgY3NzQ2xhc3NlcyA9IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3NlcztcbiAgICAgICAgdmFyIGNsZWFyQnV0dG9uID0gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMucXVlc3Rpb24uc2hvd0NsZWFyQnV0dG9uSW5Db250ZW50KSB7XG4gICAgICAgICAgICBjbGVhckJ1dHRvbiA9IChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCBudWxsLFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiaW5wdXRcIiwgeyB0eXBlOiBcImJ1dHRvblwiLCBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5jbGVhckJ1dHRvbiwgb25DbGljazogZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMucXVlc3Rpb24uY2xlYXJWYWx1ZSh0cnVlKTsgfSwgdmFsdWU6IHRoaXMucXVlc3Rpb24uY2xlYXJCdXR0b25DYXB0aW9uIH0pKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImZpZWxkc2V0XCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmdldFNlbGVjdEJhc2VSb290Q3NzKCksIHJlZjogZnVuY3Rpb24gKGZpZWxkc2V0KSB7IHJldHVybiAoX3RoaXMuc2V0Q29udHJvbChmaWVsZHNldCkpOyB9LCByb2xlOiB0aGlzLnF1ZXN0aW9uLmExMXlfaW5wdXRfYXJpYVJvbGUsIFwiYXJpYS1yZXF1aXJlZFwiOiB0aGlzLnF1ZXN0aW9uLmExMXlfaW5wdXRfYXJpYVJlcXVpcmVkLCBcImFyaWEtbGFiZWxcIjogdGhpcy5xdWVzdGlvbi5hMTF5X2lucHV0X2FyaWFMYWJlbCwgXCJhcmlhLWxhYmVsbGVkYnlcIjogdGhpcy5xdWVzdGlvbi5hMTF5X2lucHV0X2FyaWFMYWJlbGxlZEJ5LCBcImFyaWEtZGVzY3JpYmVkYnlcIjogdGhpcy5xdWVzdGlvbi5hMTF5X2lucHV0X2FyaWFEZXNjcmliZWRCeSwgXCJhcmlhLWludmFsaWRcIjogdGhpcy5xdWVzdGlvbi5hMTF5X2lucHV0X2FyaWFJbnZhbGlkLCBcImFyaWEtZXJyb3JtZXNzYWdlXCI6IHRoaXMucXVlc3Rpb24uYTExeV9pbnB1dF9hcmlhRXJyb3JtZXNzYWdlIH0sXG4gICAgICAgICAgICB0aGlzLnF1ZXN0aW9uLmhhc0NvbHVtbnNcbiAgICAgICAgICAgICAgICA/IHRoaXMuZ2V0Q29sdW1uZWRCb2R5KGNzc0NsYXNzZXMpXG4gICAgICAgICAgICAgICAgOiB0aGlzLmdldEJvZHkoY3NzQ2xhc3NlcyksXG4gICAgICAgICAgICB0aGlzLmdldEZvb3RlcigpLFxuICAgICAgICAgICAgdGhpcy5xdWVzdGlvbi5pc090aGVyU2VsZWN0ZWQgPyB0aGlzLnJlbmRlck90aGVyKGNzc0NsYXNzZXMpIDogbnVsbCxcbiAgICAgICAgICAgIGNsZWFyQnV0dG9uKSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvblJhZGlvZ3JvdXAucHJvdG90eXBlLmdldEZvb3RlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgaWYgKHRoaXMucXVlc3Rpb24uaGFzRm9vdEl0ZW1zKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5xdWVzdGlvbi5mb290SXRlbXMubWFwKGZ1bmN0aW9uIChpdGVtLCBpaSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5yZW5kZXJJdGVtKFwiaXRlbV9mXCIgKyBpaSwgaXRlbSwgZmFsc2UsIF90aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uUmFkaW9ncm91cC5wcm90b3R5cGUuZ2V0Q29sdW1uZWRCb2R5ID0gZnVuY3Rpb24gKGNzc0NsYXNzZXMpIHtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogY3NzQ2xhc3Nlcy5yb290TXVsdGlDb2x1bW4gfSwgdGhpcy5nZXRDb2x1bW5zKGNzc0NsYXNzZXMpKSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvblJhZGlvZ3JvdXAucHJvdG90eXBlLmdldENvbHVtbnMgPSBmdW5jdGlvbiAoY3NzQ2xhc3Nlcykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgdmFsdWUgPSB0aGlzLmdldFN0YXRlVmFsdWUoKTtcbiAgICAgICAgcmV0dXJuIHRoaXMucXVlc3Rpb24uY29sdW1ucy5tYXAoZnVuY3Rpb24gKGNvbHVtbiwgY2kpIHtcbiAgICAgICAgICAgIHZhciBpdGVtcyA9IGNvbHVtbi5tYXAoZnVuY3Rpb24gKGl0ZW0sIGlpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLnJlbmRlckl0ZW0oXCJpdGVtXCIgKyBjaSArIGlpLCBpdGVtLCB2YWx1ZSwgY3NzQ2xhc3NlcywgXCJcIiArIGNpICsgaWkpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsga2V5OiBcImNvbHVtblwiICsgY2kgKyBfdGhpcy5xdWVzdGlvbi5nZXRJdGVtc0NvbHVtbktleShjb2x1bW4pLCBjbGFzc05hbWU6IF90aGlzLnF1ZXN0aW9uLmdldENvbHVtbkNsYXNzKCksIHJvbGU6IFwicHJlc2VudGF0aW9uXCIgfSwgaXRlbXMpKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvblJhZGlvZ3JvdXAucHJvdG90eXBlLmdldEJvZHkgPSBmdW5jdGlvbiAoY3NzQ2xhc3Nlcykge1xuICAgICAgICBpZiAodGhpcy5xdWVzdGlvbi5ibG9ja2VkUm93KSB7XG4gICAgICAgICAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IGNzc0NsYXNzZXMucm9vdFJvdyB9LCB0aGlzLmdldEl0ZW1zKGNzc0NsYXNzZXMsIHRoaXMucXVlc3Rpb24uZGF0YUNob2ljZXMpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlXG4gICAgICAgICAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcIkZyYWdtZW50XCJdLCBudWxsLCB0aGlzLmdldEl0ZW1zKGNzc0NsYXNzZXMsIHRoaXMucXVlc3Rpb24uYm9keUl0ZW1zKSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvblJhZGlvZ3JvdXAucHJvdG90eXBlLmdldEl0ZW1zID0gZnVuY3Rpb24gKGNzc0NsYXNzZXMsIGNob2ljZXMpIHtcbiAgICAgICAgdmFyIGl0ZW1zID0gW107XG4gICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuZ2V0U3RhdGVWYWx1ZSgpO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNob2ljZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gY2hvaWNlc1tpXTtcbiAgICAgICAgICAgIHZhciByZW5kZXJlZEl0ZW0gPSB0aGlzLnJlbmRlckl0ZW0oXCJpdGVtXCIgKyBpLCBpdGVtLCB2YWx1ZSwgY3NzQ2xhc3NlcywgXCJcIiArIGkpO1xuICAgICAgICAgICAgaXRlbXMucHVzaChyZW5kZXJlZEl0ZW0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpdGVtcztcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvblJhZGlvZ3JvdXAucHJvdG90eXBlLCBcInRleHRTdHlsZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7IC8veyBkaXNwbGF5OiBcImlubGluZVwiLCBwb3NpdGlvbjogXCJzdGF0aWNcIiB9O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3VydmV5UXVlc3Rpb25SYWRpb2dyb3VwLnByb3RvdHlwZS5yZW5kZXJPdGhlciA9IGZ1bmN0aW9uIChjc3NDbGFzc2VzKSB7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uZ2V0Q29tbWVudEFyZWFDc3ModHJ1ZSkgfSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFN1cnZleVF1ZXN0aW9uT3RoZXJWYWx1ZUl0ZW0sIHsgcXVlc3Rpb246IHRoaXMucXVlc3Rpb24sIG90aGVyQ3NzOiBjc3NDbGFzc2VzLm90aGVyLCBjc3NDbGFzc2VzOiBjc3NDbGFzc2VzLCBpc0Rpc3BsYXlNb2RlOiB0aGlzLmlzRGlzcGxheU1vZGUgfSkpKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uUmFkaW9ncm91cC5wcm90b3R5cGUucmVuZGVySXRlbSA9IGZ1bmN0aW9uIChrZXksIGl0ZW0sIHZhbHVlLCBjc3NDbGFzc2VzLCBpbmRleCkge1xuICAgICAgICB2YXIgcmVuZGVyZWRJdGVtID0gUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5jcmVhdGVFbGVtZW50KHRoaXMucXVlc3Rpb24uaXRlbUNvbXBvbmVudCwge1xuICAgICAgICAgICAga2V5OiBrZXksXG4gICAgICAgICAgICBxdWVzdGlvbjogdGhpcy5xdWVzdGlvbixcbiAgICAgICAgICAgIGNzc0NsYXNzZXM6IGNzc0NsYXNzZXMsXG4gICAgICAgICAgICBpc0Rpc3BsYXlNb2RlOiB0aGlzLmlzRGlzcGxheU1vZGUsXG4gICAgICAgICAgICBpdGVtOiBpdGVtLFxuICAgICAgICAgICAgdGV4dFN0eWxlOiB0aGlzLnRleHRTdHlsZSxcbiAgICAgICAgICAgIGluZGV4OiBpbmRleCxcbiAgICAgICAgICAgIGlzQ2hlY2tlZDogdmFsdWUgPT09IGl0ZW0udmFsdWUsXG4gICAgICAgIH0pO1xuICAgICAgICB2YXIgc3VydmV5ID0gdGhpcy5xdWVzdGlvbi5zdXJ2ZXk7XG4gICAgICAgIHZhciB3cmFwcGVkSXRlbSA9IG51bGw7XG4gICAgICAgIGlmICghIXN1cnZleSkge1xuICAgICAgICAgICAgd3JhcHBlZEl0ZW0gPSByZWFjdHN1cnZleW1vZGVsX1JlYWN0U3VydmV5RWxlbWVudHNXcmFwcGVyLndyYXBJdGVtVmFsdWUoc3VydmV5LCByZW5kZXJlZEl0ZW0sIHRoaXMucXVlc3Rpb24sIGl0ZW0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB3cmFwcGVkSXRlbSAhPT0gbnVsbCAmJiB3cmFwcGVkSXRlbSAhPT0gdm9pZCAwID8gd3JhcHBlZEl0ZW0gOiByZW5kZXJlZEl0ZW07XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvblJhZGlvZ3JvdXAucHJvdG90eXBlLmdldFN0YXRlVmFsdWUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAhdGhpcy5xdWVzdGlvbi5pc0VtcHR5KCkgPyB0aGlzLnF1ZXN0aW9uLnJlbmRlcmVkVmFsdWUgOiBcIlwiO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVF1ZXN0aW9uUmFkaW9ncm91cDtcbn0ocmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleVF1ZXN0aW9uRWxlbWVudEJhc2UpKTtcblxudmFyIHJlYWN0cXVlc3Rpb25fcmFkaW9ncm91cF9TdXJ2ZXlRdWVzdGlvblJhZGlvSXRlbSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICByZWFjdHF1ZXN0aW9uX3JhZGlvZ3JvdXBfZXh0ZW5kcyhTdXJ2ZXlRdWVzdGlvblJhZGlvSXRlbSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlRdWVzdGlvblJhZGlvSXRlbShwcm9wcykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuaGFuZGxlT25DaGFuZ2UgPSBfdGhpcy5oYW5kbGVPbkNoYW5nZS5iaW5kKF90aGlzKTtcbiAgICAgICAgX3RoaXMuaGFuZGxlT25Nb3VzZURvd24gPSBfdGhpcy5oYW5kbGVPbk1vdXNlRG93bi5iaW5kKF90aGlzKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBTdXJ2ZXlRdWVzdGlvblJhZGlvSXRlbS5wcm90b3R5cGUuZ2V0U3RhdGVFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pdGVtO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uUmFkaW9JdGVtLnByb3RvdHlwZSwgXCJxdWVzdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMucXVlc3Rpb247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25SYWRpb0l0ZW0ucHJvdG90eXBlLCBcIml0ZW1cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLml0ZW07XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25SYWRpb0l0ZW0ucHJvdG90eXBlLCBcInRleHRTdHlsZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMudGV4dFN0eWxlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uUmFkaW9JdGVtLnByb3RvdHlwZSwgXCJpbmRleFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuaW5kZXg7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25SYWRpb0l0ZW0ucHJvdG90eXBlLCBcImlzQ2hlY2tlZFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuaXNDaGVja2VkO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uUmFkaW9JdGVtLnByb3RvdHlwZSwgXCJoaWRlQ2FwdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuaGlkZUNhcHRpb24gPT09IHRydWU7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlRdWVzdGlvblJhZGlvSXRlbS5wcm90b3R5cGUuc2hvdWxkQ29tcG9uZW50VXBkYXRlID0gZnVuY3Rpb24gKG5leHRQcm9wcywgbmV4dFN0YXRlKSB7XG4gICAgICAgIGlmICghX3N1cGVyLnByb3RvdHlwZS5zaG91bGRDb21wb25lbnRVcGRhdGUuY2FsbCh0aGlzLCBuZXh0UHJvcHMsIG5leHRTdGF0ZSkpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIGlmICghdGhpcy5xdWVzdGlvbilcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgcmV0dXJuICghdGhpcy5xdWVzdGlvbi5jdXN0b21XaWRnZXQgfHxcbiAgICAgICAgICAgICEhdGhpcy5xdWVzdGlvbi5jdXN0b21XaWRnZXREYXRhLmlzTmVlZFJlbmRlciB8fFxuICAgICAgICAgICAgISF0aGlzLnF1ZXN0aW9uLmN1c3RvbVdpZGdldC53aWRnZXRKc29uLmlzRGVmYXVsdFJlbmRlciB8fFxuICAgICAgICAgICAgISF0aGlzLnF1ZXN0aW9uLmN1c3RvbVdpZGdldC53aWRnZXRKc29uLnJlbmRlcik7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvblJhZGlvSXRlbS5wcm90b3R5cGUuaGFuZGxlT25DaGFuZ2UgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5xdWVzdGlvbi5jbGlja0l0ZW1IYW5kbGVyKHRoaXMuaXRlbSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvblJhZGlvSXRlbS5wcm90b3R5cGUuaGFuZGxlT25Nb3VzZURvd24gPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5xdWVzdGlvbi5vbk1vdXNlRG93bigpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25SYWRpb0l0ZW0ucHJvdG90eXBlLmNhblJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICEhdGhpcy5xdWVzdGlvbiAmJiAhIXRoaXMuaXRlbTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uUmFkaW9JdGVtLnByb3RvdHlwZS5yZW5kZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaXRlbUNsYXNzID0gdGhpcy5xdWVzdGlvbi5nZXRJdGVtQ2xhc3ModGhpcy5pdGVtKTtcbiAgICAgICAgdmFyIGxhYmVsQ2xhc3MgPSB0aGlzLnF1ZXN0aW9uLmdldExhYmVsQ2xhc3ModGhpcy5pdGVtKTtcbiAgICAgICAgdmFyIGNvbnRyb2xMYWJlbENsYXNzID0gdGhpcy5xdWVzdGlvbi5nZXRDb250cm9sTGFiZWxDbGFzcyh0aGlzLml0ZW0pO1xuICAgICAgICB2YXIgaXRlbUxhYmVsID0gIXRoaXMuaGlkZUNhcHRpb24gPyBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInNwYW5cIiwgeyBjbGFzc05hbWU6IGNvbnRyb2xMYWJlbENsYXNzIH0sIHRoaXMucmVuZGVyTG9jU3RyaW5nKHRoaXMuaXRlbS5sb2NUZXh0LCB0aGlzLnRleHRTdHlsZSkpIDogbnVsbDtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogaXRlbUNsYXNzLCByb2xlOiBcInByZXNlbnRhdGlvblwiIH0sXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImxhYmVsXCIsIHsgb25Nb3VzZURvd246IHRoaXMuaGFuZGxlT25Nb3VzZURvd24sIGNsYXNzTmFtZTogbGFiZWxDbGFzcyB9LFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiaW5wdXRcIiwgeyBcImFyaWEtZXJyb3JtZXNzYWdlXCI6IHRoaXMucXVlc3Rpb24uYXJpYUVycm9ybWVzc2FnZSwgY2xhc3NOYW1lOiB0aGlzLmNzc0NsYXNzZXMuaXRlbUNvbnRyb2wsIGlkOiB0aGlzLnF1ZXN0aW9uLmdldEl0ZW1JZCh0aGlzLml0ZW0pLCB0eXBlOiBcInJhZGlvXCIsIG5hbWU6IHRoaXMucXVlc3Rpb24ucXVlc3Rpb25OYW1lLCBjaGVja2VkOiB0aGlzLmlzQ2hlY2tlZCwgdmFsdWU6IHRoaXMuaXRlbS52YWx1ZSwgZGlzYWJsZWQ6ICF0aGlzLnF1ZXN0aW9uLmdldEl0ZW1FbmFibGVkKHRoaXMuaXRlbSksIHJlYWRPbmx5OiB0aGlzLnF1ZXN0aW9uLmlzUmVhZE9ubHlBdHRyLCBvbkNoYW5nZTogdGhpcy5oYW5kbGVPbkNoYW5nZSB9KSxcbiAgICAgICAgICAgICAgICB0aGlzLmNzc0NsYXNzZXMubWF0ZXJpYWxEZWNvcmF0b3IgP1xuICAgICAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInNwYW5cIiwgeyBjbGFzc05hbWU6IHRoaXMuY3NzQ2xhc3Nlcy5tYXRlcmlhbERlY29yYXRvciB9LCB0aGlzLnF1ZXN0aW9uLml0ZW1TdmdJY29uID9cbiAgICAgICAgICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwic3ZnXCIsIHsgY2xhc3NOYW1lOiB0aGlzLmNzc0NsYXNzZXMuaXRlbURlY29yYXRvciB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwidXNlXCIsIHsgeGxpbmtIcmVmOiB0aGlzLnF1ZXN0aW9uLml0ZW1TdmdJY29uIH0pKSA6XG4gICAgICAgICAgICAgICAgICAgICAgICBudWxsKSA6XG4gICAgICAgICAgICAgICAgICAgIG51bGwsXG4gICAgICAgICAgICAgICAgaXRlbUxhYmVsKSkpO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVF1ZXN0aW9uUmFkaW9JdGVtO1xufShSZWFjdFN1cnZleUVsZW1lbnQpKTtcblxuUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlckVsZW1lbnQoXCJzdXJ2ZXktcmFkaW9ncm91cC1pdGVtXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyZWFjdHF1ZXN0aW9uX3JhZGlvZ3JvdXBfU3VydmV5UXVlc3Rpb25SYWRpb0l0ZW0sIHByb3BzKTtcbn0pO1xuUmVhY3RRdWVzdGlvbkZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJRdWVzdGlvbihcInJhZGlvZ3JvdXBcIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHJlYWN0cXVlc3Rpb25fcmFkaW9ncm91cF9TdXJ2ZXlRdWVzdGlvblJhZGlvZ3JvdXAsIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvcmVhY3RxdWVzdGlvbl90ZXh0LnRzeFxudmFyIHJlYWN0cXVlc3Rpb25fdGV4dF9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cblxudmFyIHJlYWN0cXVlc3Rpb25fdGV4dF9TdXJ2ZXlRdWVzdGlvblRleHQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcmVhY3RxdWVzdGlvbl90ZXh0X2V4dGVuZHMoU3VydmV5UXVlc3Rpb25UZXh0LCBfc3VwZXIpO1xuICAgIC8vY29udHJvbFJlZjogUmVhY3QuUmVmT2JqZWN0PEhUTUxJbnB1dEVsZW1lbnQ+O1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uVGV4dChwcm9wcykge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgICAgIC8vdGhpcy5jb250cm9sUmVmID0gUmVhY3QuY3JlYXRlUmVmKCk7XG4gICAgfVxuICAgIFN1cnZleVF1ZXN0aW9uVGV4dC5wcm90b3R5cGUucmVuZGVySW5wdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBpbnB1dENsYXNzID0gdGhpcy5xdWVzdGlvbi5nZXRDb250cm9sQ2xhc3MoKTtcbiAgICAgICAgdmFyIHBsYWNlaG9sZGVyID0gdGhpcy5xdWVzdGlvbi5yZW5kZXJlZFBsYWNlaG9sZGVyO1xuICAgICAgICBpZiAodGhpcy5xdWVzdGlvbi5pc1JlYWRPbmx5UmVuZGVyRGl2KCkpIHtcbiAgICAgICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCBudWxsLCB0aGlzLnF1ZXN0aW9uLmlucHV0VmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBjb3VudGVyID0gISF0aGlzLnF1ZXN0aW9uLmdldE1heExlbmd0aCgpID8gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKGNoYXJhY3Rlcl9jb3VudGVyX0NoYXJhY3RlckNvdW50ZXJDb21wb25lbnQsIHsgY291bnRlcjogdGhpcy5xdWVzdGlvbi5jaGFyYWN0ZXJDb3VudGVyLCByZW1haW5pbmdDaGFyYWN0ZXJDb3VudGVyOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMucmVtYWluaW5nQ2hhcmFjdGVyQ291bnRlciB9KSkgOiBudWxsO1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJGcmFnbWVudFwiXSwgbnVsbCxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiaW5wdXRcIiwgeyBpZDogdGhpcy5xdWVzdGlvbi5pbnB1dElkLCBcbiAgICAgICAgICAgICAgICAvLyBkaXNhYmxlZD17dGhpcy5pc0Rpc3BsYXlNb2RlfVxuICAgICAgICAgICAgICAgIGRpc2FibGVkOiB0aGlzLnF1ZXN0aW9uLmlzRGlzYWJsZWRBdHRyLCByZWFkT25seTogdGhpcy5xdWVzdGlvbi5pc1JlYWRPbmx5QXR0ciwgY2xhc3NOYW1lOiBpbnB1dENsYXNzLCB0eXBlOiB0aGlzLnF1ZXN0aW9uLmlucHV0VHlwZSwgXG4gICAgICAgICAgICAgICAgLy9yZWY9e3RoaXMuY29udHJvbFJlZn1cbiAgICAgICAgICAgICAgICByZWY6IGZ1bmN0aW9uIChpbnB1dCkgeyByZXR1cm4gKF90aGlzLnNldENvbnRyb2woaW5wdXQpKTsgfSwgc3R5bGU6IHRoaXMucXVlc3Rpb24uaW5wdXRTdHlsZSwgbWF4TGVuZ3RoOiB0aGlzLnF1ZXN0aW9uLmdldE1heExlbmd0aCgpLCBtaW46IHRoaXMucXVlc3Rpb24ucmVuZGVyZWRNaW4sIG1heDogdGhpcy5xdWVzdGlvbi5yZW5kZXJlZE1heCwgc3RlcDogdGhpcy5xdWVzdGlvbi5yZW5kZXJlZFN0ZXAsIHNpemU6IHRoaXMucXVlc3Rpb24uaW5wdXRTaXplLCBwbGFjZWhvbGRlcjogcGxhY2Vob2xkZXIsIGxpc3Q6IHRoaXMucXVlc3Rpb24uZGF0YUxpc3RJZCwgYXV0b0NvbXBsZXRlOiB0aGlzLnF1ZXN0aW9uLmF1dG9jb21wbGV0ZSwgb25CbHVyOiBmdW5jdGlvbiAoZXZlbnQpIHsgX3RoaXMucXVlc3Rpb24ub25CbHVyKGV2ZW50KTsgfSwgb25Gb2N1czogZnVuY3Rpb24gKGV2ZW50KSB7IF90aGlzLnF1ZXN0aW9uLm9uRm9jdXMoZXZlbnQpOyB9LCBvbkNoYW5nZTogdGhpcy5xdWVzdGlvbi5vbkNoYW5nZSwgb25LZXlVcDogdGhpcy5xdWVzdGlvbi5vbktleVVwLCBvbktleURvd246IHRoaXMucXVlc3Rpb24ub25LZXlEb3duLCBvbkNvbXBvc2l0aW9uVXBkYXRlOiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIF90aGlzLnF1ZXN0aW9uLm9uQ29tcG9zaXRpb25VcGRhdGUoZXZlbnQubmF0aXZlRXZlbnQpOyB9LCBcImFyaWEtcmVxdWlyZWRcIjogdGhpcy5xdWVzdGlvbi5hMTF5X2lucHV0X2FyaWFSZXF1aXJlZCwgXCJhcmlhLWxhYmVsXCI6IHRoaXMucXVlc3Rpb24uYTExeV9pbnB1dF9hcmlhTGFiZWwsIFwiYXJpYS1sYWJlbGxlZGJ5XCI6IHRoaXMucXVlc3Rpb24uYTExeV9pbnB1dF9hcmlhTGFiZWxsZWRCeSwgXCJhcmlhLWRlc2NyaWJlZGJ5XCI6IHRoaXMucXVlc3Rpb24uYTExeV9pbnB1dF9hcmlhRGVzY3JpYmVkQnksIFwiYXJpYS1pbnZhbGlkXCI6IHRoaXMucXVlc3Rpb24uYTExeV9pbnB1dF9hcmlhSW52YWxpZCwgXCJhcmlhLWVycm9ybWVzc2FnZVwiOiB0aGlzLnF1ZXN0aW9uLmExMXlfaW5wdXRfYXJpYUVycm9ybWVzc2FnZSB9KSxcbiAgICAgICAgICAgIGNvdW50ZXIpKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uVGV4dC5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLnF1ZXN0aW9uLmRhdGFMaXN0SWQgP1xuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgbnVsbCxcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcklucHV0KCksXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJEYXRhTGlzdCgpKSA6XG4gICAgICAgICAgICB0aGlzLnJlbmRlcklucHV0KCkpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25UZXh0LnByb3RvdHlwZS5zZXRWYWx1ZUNvcmUgPSBmdW5jdGlvbiAobmV3VmFsdWUpIHtcbiAgICAgICAgdGhpcy5xdWVzdGlvbi5pbnB1dFZhbHVlID0gbmV3VmFsdWU7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvblRleHQucHJvdG90eXBlLmdldFZhbHVlQ29yZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucXVlc3Rpb24uaW5wdXRWYWx1ZTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uVGV4dC5wcm90b3R5cGUucmVuZGVyRGF0YUxpc3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5xdWVzdGlvbi5kYXRhTGlzdElkKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMucXVlc3Rpb24uZGF0YUxpc3Q7XG4gICAgICAgIGlmIChpdGVtcy5sZW5ndGggPT0gMClcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB2YXIgb3B0aW9ucyA9IFtdO1xuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGl0ZW1zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBvcHRpb25zLnB1c2goZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJvcHRpb25cIiwgeyBrZXk6IFwiaXRlbVwiICsgaSwgdmFsdWU6IGl0ZW1zW2ldIH0pKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkYXRhbGlzdFwiLCB7IGlkOiB0aGlzLnF1ZXN0aW9uLmRhdGFMaXN0SWQgfSwgb3B0aW9ucyk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5UXVlc3Rpb25UZXh0O1xufShyZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5UXVlc3Rpb25VbmNvbnRyb2xsZWRFbGVtZW50KSk7XG5cblJlYWN0UXVlc3Rpb25GYWN0b3J5Lkluc3RhbmNlLnJlZ2lzdGVyUXVlc3Rpb24oXCJ0ZXh0XCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyZWFjdHF1ZXN0aW9uX3RleHRfU3VydmV5UXVlc3Rpb25UZXh0LCBwcm9wcyk7XG59KTtcblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL2Jvb2xlYW4udHN4XG52YXIgYm9vbGVhbl9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cbnZhciBib29sZWFuX1N1cnZleVF1ZXN0aW9uQm9vbGVhbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBib29sZWFuX2V4dGVuZHMoU3VydmV5UXVlc3Rpb25Cb29sZWFuLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uQm9vbGVhbihwcm9wcykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuaGFuZGxlT25DaGFuZ2UgPSBfdGhpcy5oYW5kbGVPbkNoYW5nZS5iaW5kKF90aGlzKTtcbiAgICAgICAgX3RoaXMuaGFuZGxlT25DbGljayA9IF90aGlzLmhhbmRsZU9uQ2xpY2suYmluZChfdGhpcyk7XG4gICAgICAgIF90aGlzLmhhbmRsZU9uTGFiZWxDbGljayA9IF90aGlzLmhhbmRsZU9uTGFiZWxDbGljay5iaW5kKF90aGlzKTtcbiAgICAgICAgX3RoaXMuaGFuZGxlT25Td2l0Y2hDbGljayA9IF90aGlzLmhhbmRsZU9uU3dpdGNoQ2xpY2suYmluZChfdGhpcyk7XG4gICAgICAgIF90aGlzLmhhbmRsZU9uS2V5RG93biA9IF90aGlzLmhhbmRsZU9uS2V5RG93bi5iaW5kKF90aGlzKTtcbiAgICAgICAgX3RoaXMuY2hlY2tSZWYgPSBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlUmVmXCJdKCk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgU3VydmV5UXVlc3Rpb25Cb29sZWFuLnByb3RvdHlwZS5nZXRTdGF0ZUVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnF1ZXN0aW9uO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uQm9vbGVhbi5wcm90b3R5cGUsIFwicXVlc3Rpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnF1ZXN0aW9uQmFzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIC8qXG4gICAgcHJpdmF0ZSBnZXQgYWxsb3dDbGljaygpOiBib29sZWFuIHtcbiAgICAgIHJldHVybiB0aGlzLnF1ZXN0aW9uLmlzSW5kZXRlcm1pbmF0ZSAmJiAhdGhpcy5pc0Rpc3BsYXlNb2RlO1xuICAgIH1cbiAgICAqL1xuICAgIFN1cnZleVF1ZXN0aW9uQm9vbGVhbi5wcm90b3R5cGUuZG9DaGVjayA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgICB0aGlzLnF1ZXN0aW9uLmJvb2xlYW5WYWx1ZSA9IHZhbHVlO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25Cb29sZWFuLnByb3RvdHlwZS5oYW5kbGVPbkNoYW5nZSA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB0aGlzLmRvQ2hlY2soZXZlbnQudGFyZ2V0LmNoZWNrZWQpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25Cb29sZWFuLnByb3RvdHlwZS5oYW5kbGVPbkNsaWNrID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHRoaXMucXVlc3Rpb24ub25MYWJlbENsaWNrKGV2ZW50LCB0cnVlKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uQm9vbGVhbi5wcm90b3R5cGUuaGFuZGxlT25Td2l0Y2hDbGljayA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB0aGlzLnF1ZXN0aW9uLm9uU3dpdGNoQ2xpY2tNb2RlbChldmVudC5uYXRpdmVFdmVudCk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkJvb2xlYW4ucHJvdG90eXBlLmhhbmRsZU9uTGFiZWxDbGljayA9IGZ1bmN0aW9uIChldmVudCwgdmFsdWUpIHtcbiAgICAgICAgdGhpcy5xdWVzdGlvbi5vbkxhYmVsQ2xpY2soZXZlbnQsIHZhbHVlKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uQm9vbGVhbi5wcm90b3R5cGUuaGFuZGxlT25LZXlEb3duID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHRoaXMucXVlc3Rpb24ub25LZXlEb3duQ29yZShldmVudCk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkJvb2xlYW4ucHJvdG90eXBlLnVwZGF0ZURvbUVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5xdWVzdGlvbilcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIGVsID0gdGhpcy5jaGVja1JlZi5jdXJyZW50O1xuICAgICAgICBpZiAoZWwpIHtcbiAgICAgICAgICAgIGVsLmluZGV0ZXJtaW5hdGUgPSB0aGlzLnF1ZXN0aW9uLmlzSW5kZXRlcm1pbmF0ZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnNldENvbnRyb2woZWwpO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLnVwZGF0ZURvbUVsZW1lbnQuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uQm9vbGVhbi5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGNzc0NsYXNzZXMgPSB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXM7XG4gICAgICAgIHZhciBpdGVtQ2xhc3MgPSB0aGlzLnF1ZXN0aW9uLmdldEl0ZW1Dc3MoKTtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogY3NzQ2xhc3Nlcy5yb290LCBvbktleURvd246IHRoaXMuaGFuZGxlT25LZXlEb3duIH0sXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImxhYmVsXCIsIHsgY2xhc3NOYW1lOiBpdGVtQ2xhc3MsIG9uQ2xpY2s6IHRoaXMuaGFuZGxlT25DbGljayB9LFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiaW5wdXRcIiwgeyByZWY6IHRoaXMuY2hlY2tSZWYsIHR5cGU6IFwiY2hlY2tib3hcIiwgbmFtZTogdGhpcy5xdWVzdGlvbi5uYW1lLCB2YWx1ZTogdGhpcy5xdWVzdGlvbi5ib29sZWFuVmFsdWUgPT09IG51bGxcbiAgICAgICAgICAgICAgICAgICAgICAgID8gXCJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgOiB0aGlzLnF1ZXN0aW9uLmJvb2xlYW5WYWx1ZSwgaWQ6IHRoaXMucXVlc3Rpb24uaW5wdXRJZCwgY2xhc3NOYW1lOiBjc3NDbGFzc2VzLmNvbnRyb2wsIGRpc2FibGVkOiB0aGlzLnF1ZXN0aW9uLmlzRGlzYWJsZWRBdHRyLCByZWFkT25seTogdGhpcy5xdWVzdGlvbi5pc1JlYWRPbmx5QXR0ciwgY2hlY2tlZDogdGhpcy5xdWVzdGlvbi5ib29sZWFuVmFsdWUgfHwgZmFsc2UsIG9uQ2hhbmdlOiB0aGlzLmhhbmRsZU9uQ2hhbmdlLCByb2xlOiB0aGlzLnF1ZXN0aW9uLmExMXlfaW5wdXRfYXJpYVJvbGUsIFwiYXJpYS1yZXF1aXJlZFwiOiB0aGlzLnF1ZXN0aW9uLmExMXlfaW5wdXRfYXJpYVJlcXVpcmVkLCBcImFyaWEtbGFiZWxcIjogdGhpcy5xdWVzdGlvbi5hMTF5X2lucHV0X2FyaWFMYWJlbCwgXCJhcmlhLWxhYmVsbGVkYnlcIjogdGhpcy5xdWVzdGlvbi5hMTF5X2lucHV0X2FyaWFMYWJlbGxlZEJ5LCBcImFyaWEtZGVzY3JpYmVkYnlcIjogdGhpcy5xdWVzdGlvbi5hMTF5X2lucHV0X2FyaWFEZXNjcmliZWRCeSwgXCJhcmlhLWludmFsaWRcIjogdGhpcy5xdWVzdGlvbi5hMTF5X2lucHV0X2FyaWFJbnZhbGlkLCBcImFyaWEtZXJyb3JtZXNzYWdlXCI6IHRoaXMucXVlc3Rpb24uYTExeV9pbnB1dF9hcmlhRXJyb3JtZXNzYWdlIH0pLFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBjc3NDbGFzc2VzLnNsaWRlckdob3N0LCBvbkNsaWNrOiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIF90aGlzLmhhbmRsZU9uTGFiZWxDbGljayhldmVudCwgX3RoaXMucXVlc3Rpb24uc3dhcE9yZGVyKTsgfSB9LFxuICAgICAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInNwYW5cIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uZ2V0TGFiZWxDc3ModGhpcy5xdWVzdGlvbi5zd2FwT3JkZXIpIH0sIHRoaXMucmVuZGVyTG9jU3RyaW5nKHRoaXMucXVlc3Rpb24ubG9jTGFiZWxMZWZ0KSkpLFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBjc3NDbGFzc2VzLnN3aXRjaCwgb25DbGljazogdGhpcy5oYW5kbGVPblN3aXRjaENsaWNrIH0sXG4gICAgICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwic3BhblwiLCB7IGNsYXNzTmFtZTogY3NzQ2xhc3Nlcy5zbGlkZXIgfSwgdGhpcy5xdWVzdGlvbi5pc0RldGVybWluYXRlZCAmJiBjc3NDbGFzc2VzLnNsaWRlclRleHQgP1xuICAgICAgICAgICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJzcGFuXCIsIHsgY2xhc3NOYW1lOiBjc3NDbGFzc2VzLnNsaWRlclRleHQgfSwgdGhpcy5yZW5kZXJMb2NTdHJpbmcodGhpcy5xdWVzdGlvbi5nZXRDaGVja2VkTGFiZWwoKSkpXG4gICAgICAgICAgICAgICAgICAgICAgICA6IG51bGwpKSxcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogY3NzQ2xhc3Nlcy5zbGlkZXJHaG9zdCwgb25DbGljazogZnVuY3Rpb24gKGV2ZW50KSB7IHJldHVybiBfdGhpcy5oYW5kbGVPbkxhYmVsQ2xpY2soZXZlbnQsICFfdGhpcy5xdWVzdGlvbi5zd2FwT3JkZXIpOyB9IH0sXG4gICAgICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwic3BhblwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5nZXRMYWJlbENzcyghdGhpcy5xdWVzdGlvbi5zd2FwT3JkZXIpIH0sIHRoaXMucmVuZGVyTG9jU3RyaW5nKHRoaXMucXVlc3Rpb24ubG9jTGFiZWxSaWdodCkpKSkpKTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvbkJvb2xlYW47XG59KHJlYWN0cXVlc3Rpb25fZWxlbWVudF9TdXJ2ZXlRdWVzdGlvbkVsZW1lbnRCYXNlKSk7XG5cblJlYWN0UXVlc3Rpb25GYWN0b3J5Lkluc3RhbmNlLnJlZ2lzdGVyUXVlc3Rpb24oXCJib29sZWFuXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShib29sZWFuX1N1cnZleVF1ZXN0aW9uQm9vbGVhbiwgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9ib29sZWFuLWNoZWNrYm94LnRzeFxudmFyIGJvb2xlYW5fY2hlY2tib3hfZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG5cblxuXG52YXIgYm9vbGVhbl9jaGVja2JveF9TdXJ2ZXlRdWVzdGlvbkJvb2xlYW5DaGVja2JveCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBib29sZWFuX2NoZWNrYm94X2V4dGVuZHMoU3VydmV5UXVlc3Rpb25Cb29sZWFuQ2hlY2tib3gsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UXVlc3Rpb25Cb29sZWFuQ2hlY2tib3gocHJvcHMpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTdXJ2ZXlRdWVzdGlvbkJvb2xlYW5DaGVja2JveC5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNzc0NsYXNzZXMgPSB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXM7XG4gICAgICAgIHZhciBpdGVtQ2xhc3MgPSB0aGlzLnF1ZXN0aW9uLmdldENoZWNrYm94SXRlbUNzcygpO1xuICAgICAgICB2YXIgZGVzY3JpcHRpb24gPSB0aGlzLnF1ZXN0aW9uLmNhblJlbmRlckxhYmVsRGVzY3JpcHRpb24gP1xuICAgICAgICAgICAgcmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleUVsZW1lbnRCYXNlLnJlbmRlclF1ZXN0aW9uRGVzY3JpcHRpb24odGhpcy5xdWVzdGlvbikgOiBudWxsO1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBjc3NDbGFzc2VzLnJvb3RDaGVja2JveCB9LFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IGl0ZW1DbGFzcyB9LFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwibGFiZWxcIiwgeyBjbGFzc05hbWU6IGNzc0NsYXNzZXMuY2hlY2tib3hMYWJlbCB9LFxuICAgICAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImlucHV0XCIsIHsgcmVmOiB0aGlzLmNoZWNrUmVmLCB0eXBlOiBcImNoZWNrYm94XCIsIG5hbWU6IHRoaXMucXVlc3Rpb24ubmFtZSwgdmFsdWU6IHRoaXMucXVlc3Rpb24uYm9vbGVhblZhbHVlID09PSBudWxsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPyBcIlwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgOiB0aGlzLnF1ZXN0aW9uLmJvb2xlYW5WYWx1ZSwgaWQ6IHRoaXMucXVlc3Rpb24uaW5wdXRJZCwgY2xhc3NOYW1lOiBjc3NDbGFzc2VzLmNvbnRyb2xDaGVja2JveCwgZGlzYWJsZWQ6IHRoaXMucXVlc3Rpb24uaXNEaXNhYmxlZEF0dHIsIHJlYWRPbmx5OiB0aGlzLnF1ZXN0aW9uLmlzUmVhZE9ubHlBdHRyLCBjaGVja2VkOiB0aGlzLnF1ZXN0aW9uLmJvb2xlYW5WYWx1ZSB8fCBmYWxzZSwgb25DaGFuZ2U6IHRoaXMuaGFuZGxlT25DaGFuZ2UsIFwiYXJpYS1yZXF1aXJlZFwiOiB0aGlzLnF1ZXN0aW9uLmFyaWFSZXF1aXJlZCwgXCJhcmlhLWxhYmVsXCI6IHRoaXMucXVlc3Rpb24uYXJpYUxhYmVsLCBcImFyaWEtaW52YWxpZFwiOiB0aGlzLnF1ZXN0aW9uLmFyaWFJbnZhbGlkLCBcImFyaWEtZXJyb3JtZXNzYWdlXCI6IHRoaXMucXVlc3Rpb24uYXJpYUVycm9ybWVzc2FnZSB9KSxcbiAgICAgICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJzcGFuXCIsIHsgY2xhc3NOYW1lOiBjc3NDbGFzc2VzLmNoZWNrYm94TWF0ZXJpYWxEZWNvcmF0b3IgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucXVlc3Rpb24uc3ZnSWNvbiA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJzdmdcIiwgeyBjbGFzc05hbWU6IGNzc0NsYXNzZXMuY2hlY2tib3hJdGVtRGVjb3JhdG9yIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwidXNlXCIsIHsgeGxpbmtIcmVmOiB0aGlzLnF1ZXN0aW9uLnN2Z0ljb24gfSkpIDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwic3BhblwiLCB7IGNsYXNzTmFtZTogXCJjaGVja1wiIH0pKSxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWVzdGlvbi5pc0xhYmVsUmVuZGVyZWQgJiYgKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwic3BhblwiLCB7IGNsYXNzTmFtZTogY3NzQ2xhc3Nlcy5jaGVja2JveENvbnRyb2xMYWJlbCwgaWQ6IHRoaXMucXVlc3Rpb24ubGFiZWxSZW5kZXJlZEFyaWFJRCB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0odGl0bGVfYWN0aW9uc19UaXRsZUFjdGlvbnMsIHsgZWxlbWVudDogdGhpcy5xdWVzdGlvbiwgY3NzQ2xhc3NlczogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzIH0pKSkpLFxuICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uKSkpO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVF1ZXN0aW9uQm9vbGVhbkNoZWNrYm94O1xufShib29sZWFuX1N1cnZleVF1ZXN0aW9uQm9vbGVhbikpO1xuXG5SZWFjdFF1ZXN0aW9uRmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlclF1ZXN0aW9uKFwic3YtYm9vbGVhbi1jaGVja2JveFwiLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oYm9vbGVhbl9jaGVja2JveF9TdXJ2ZXlRdWVzdGlvbkJvb2xlYW5DaGVja2JveCwgcHJvcHMpO1xufSk7XG5leHRlcm5hbF9yb290X1N1cnZleV9jb21tb25qczJfc3VydmV5X2NvcmVfY29tbW9uanNfc3VydmV5X2NvcmVfYW1kX3N1cnZleV9jb3JlX1tcIlJlbmRlcmVyRmFjdG9yeVwiXS5JbnN0YW5jZS5yZWdpc3RlclJlbmRlcmVyKFwiYm9vbGVhblwiLCBcImNoZWNrYm94XCIsIFwic3YtYm9vbGVhbi1jaGVja2JveFwiKTtcblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL2Jvb2xlYW4tcmFkaW8udHN4XG52YXIgYm9vbGVhbl9yYWRpb19leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cblxudmFyIGJvb2xlYW5fcmFkaW9fU3VydmV5UXVlc3Rpb25Cb29sZWFuUmFkaW8gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgYm9vbGVhbl9yYWRpb19leHRlbmRzKFN1cnZleVF1ZXN0aW9uQm9vbGVhblJhZGlvLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uQm9vbGVhblJhZGlvKHByb3BzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5oYW5kbGVPbkNoYW5nZSA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgX3RoaXMucXVlc3Rpb24uYm9vbGVhblZhbHVlID0gZXZlbnQubmF0aXZlRXZlbnQudGFyZ2V0LnZhbHVlID09IFwidHJ1ZVwiO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFN1cnZleVF1ZXN0aW9uQm9vbGVhblJhZGlvLnByb3RvdHlwZS5yZW5kZXJSYWRpb0l0ZW0gPSBmdW5jdGlvbiAodmFsdWUsIGxvY1RleHQpIHtcbiAgICAgICAgdmFyIGNzc0NsYXNzZXMgPSB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXM7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyByb2xlOiBcInByZXNlbnRhdGlvblwiLCBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uZ2V0UmFkaW9JdGVtQ2xhc3MoY3NzQ2xhc3NlcywgdmFsdWUpIH0sXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImxhYmVsXCIsIHsgY2xhc3NOYW1lOiBjc3NDbGFzc2VzLnJhZGlvTGFiZWwgfSxcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImlucHV0XCIsIHsgdHlwZTogXCJyYWRpb1wiLCBuYW1lOiB0aGlzLnF1ZXN0aW9uLm5hbWUsIHZhbHVlOiB2YWx1ZSwgXCJhcmlhLWVycm9ybWVzc2FnZVwiOiB0aGlzLnF1ZXN0aW9uLmFyaWFFcnJvcm1lc3NhZ2UsIGNoZWNrZWQ6IHZhbHVlID09PSB0aGlzLnF1ZXN0aW9uLmJvb2xlYW5WYWx1ZVJlbmRlcmVkLCBkaXNhYmxlZDogdGhpcy5xdWVzdGlvbi5pc0Rpc2FibGVkQXR0ciwgcmVhZE9ubHk6IHRoaXMucXVlc3Rpb24uaXNSZWFkT25seUF0dHIsIGNsYXNzTmFtZTogY3NzQ2xhc3Nlcy5pdGVtUmFkaW9Db250cm9sLCBvbkNoYW5nZTogdGhpcy5oYW5kbGVPbkNoYW5nZSB9KSxcbiAgICAgICAgICAgICAgICB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMubWF0ZXJpYWxSYWRpb0RlY29yYXRvciA/XG4gICAgICAgICAgICAgICAgICAgIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInNwYW5cIiwgeyBjbGFzc05hbWU6IGNzc0NsYXNzZXMubWF0ZXJpYWxSYWRpb0RlY29yYXRvciB9LCB0aGlzLnF1ZXN0aW9uLml0ZW1TdmdJY29uID9cbiAgICAgICAgICAgICAgICAgICAgICAgIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInN2Z1wiLCB7IGNsYXNzTmFtZTogY3NzQ2xhc3Nlcy5pdGVtUmFkaW9EZWNvcmF0b3IgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInVzZVwiLCB7IHhsaW5rSHJlZjogdGhpcy5xdWVzdGlvbi5pdGVtU3ZnSWNvbiB9KSkpIDogbnVsbCkpIDogbnVsbCxcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInNwYW5cIiwgeyBjbGFzc05hbWU6IGNzc0NsYXNzZXMucmFkaW9Db250cm9sTGFiZWwgfSwgdGhpcy5yZW5kZXJMb2NTdHJpbmcobG9jVGV4dCkpKSkpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25Cb29sZWFuUmFkaW8ucHJvdG90eXBlLnJlbmRlckVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjc3NDbGFzc2VzID0gdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzO1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBjc3NDbGFzc2VzLnJvb3RSYWRpbyB9LFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJmaWVsZHNldFwiLCB7IHJvbGU6IFwicHJlc2VudGF0aW9uXCIsIGNsYXNzTmFtZTogY3NzQ2xhc3Nlcy5yYWRpb0ZpZWxkc2V0IH0sICF0aGlzLnF1ZXN0aW9uLnN3YXBPcmRlciA/XG4gICAgICAgICAgICAgICAgKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJGcmFnbWVudFwiXSwgbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJSYWRpb0l0ZW0oZmFsc2UsIHRoaXMucXVlc3Rpb24ubG9jTGFiZWxGYWxzZSksXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyUmFkaW9JdGVtKHRydWUsIHRoaXMucXVlc3Rpb24ubG9jTGFiZWxUcnVlKSkpXG4gICAgICAgICAgICAgICAgOlxuICAgICAgICAgICAgICAgICAgICAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcIkZyYWdtZW50XCJdLCBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJSYWRpb0l0ZW0odHJ1ZSwgdGhpcy5xdWVzdGlvbi5sb2NMYWJlbFRydWUpLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJSYWRpb0l0ZW0oZmFsc2UsIHRoaXMucXVlc3Rpb24ubG9jTGFiZWxGYWxzZSkpKSkpKTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvbkJvb2xlYW5SYWRpbztcbn0oYm9vbGVhbl9TdXJ2ZXlRdWVzdGlvbkJvb2xlYW4pKTtcblxuUmVhY3RRdWVzdGlvbkZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJRdWVzdGlvbihcInN2LWJvb2xlYW4tcmFkaW9cIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKGJvb2xlYW5fcmFkaW9fU3VydmV5UXVlc3Rpb25Cb29sZWFuUmFkaW8sIHByb3BzKTtcbn0pO1xuZXh0ZXJuYWxfcm9vdF9TdXJ2ZXlfY29tbW9uanMyX3N1cnZleV9jb3JlX2NvbW1vbmpzX3N1cnZleV9jb3JlX2FtZF9zdXJ2ZXlfY29yZV9bXCJSZW5kZXJlckZhY3RvcnlcIl0uSW5zdGFuY2UucmVnaXN0ZXJSZW5kZXJlcihcImJvb2xlYW5cIiwgXCJyYWRpb1wiLCBcInN2LWJvb2xlYW4tcmFkaW9cIik7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9yZWFjdHF1ZXN0aW9uX2VtcHR5LnRzeFxudmFyIHJlYWN0cXVlc3Rpb25fZW1wdHlfZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG52YXIgcmVhY3RxdWVzdGlvbl9lbXB0eV9TdXJ2ZXlRdWVzdGlvbkVtcHR5ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJlYWN0cXVlc3Rpb25fZW1wdHlfZXh0ZW5kcyhTdXJ2ZXlRdWVzdGlvbkVtcHR5LCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uRW1wdHkocHJvcHMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLnN0YXRlID0geyB2YWx1ZTogX3RoaXMucXVlc3Rpb24udmFsdWUgfTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25FbXB0eS5wcm90b3R5cGUsIFwicXVlc3Rpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnF1ZXN0aW9uQmFzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleVF1ZXN0aW9uRW1wdHkucHJvdG90eXBlLnJlbmRlckVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCBudWxsKTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvbkVtcHR5O1xufShyZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5UXVlc3Rpb25FbGVtZW50QmFzZSkpO1xuXG5SZWFjdFF1ZXN0aW9uRmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlclF1ZXN0aW9uKFwiZW1wdHlcIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHJlYWN0cXVlc3Rpb25fZW1wdHlfU3VydmV5UXVlc3Rpb25FbXB0eSwgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9jb21wb25lbnRzL21hdHJpeC9yb3cudHN4XG52YXIgbWF0cml4X3Jvd19leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cbnZhciByb3dfTWF0cml4Um93ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIG1hdHJpeF9yb3dfZXh0ZW5kcyhNYXRyaXhSb3csIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTWF0cml4Um93KHByb3BzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5yb290ID0gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVSZWYoKTtcbiAgICAgICAgX3RoaXMub25Qb2ludGVyRG93bkhhbmRsZXIgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIF90aGlzLnBhcmVudE1hdHJpeC5vblBvaW50ZXJEb3duKGV2ZW50Lm5hdGl2ZUV2ZW50LCBfdGhpcy5tb2RlbC5yb3cpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNYXRyaXhSb3cucHJvdG90eXBlLCBcIm1vZGVsXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5tb2RlbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShNYXRyaXhSb3cucHJvdG90eXBlLCBcInBhcmVudE1hdHJpeFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMucGFyZW50TWF0cml4O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgTWF0cml4Um93LnByb3RvdHlwZS5nZXRTdGF0ZUVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1vZGVsO1xuICAgIH07XG4gICAgTWF0cml4Um93LnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudC5jYWxsKHRoaXMpO1xuICAgICAgICBpZiAodGhpcy5yb290LmN1cnJlbnQpIHtcbiAgICAgICAgICAgIHRoaXMubW9kZWwuc2V0Um9vdEVsZW1lbnQodGhpcy5yb290LmN1cnJlbnQpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBNYXRyaXhSb3cucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMubW9kZWwuc2V0Um9vdEVsZW1lbnQodW5kZWZpbmVkKTtcbiAgICB9O1xuICAgIE1hdHJpeFJvdy5wcm90b3R5cGUuc2hvdWxkQ29tcG9uZW50VXBkYXRlID0gZnVuY3Rpb24gKG5leHRQcm9wcywgbmV4dFN0YXRlKSB7XG4gICAgICAgIGlmICghX3N1cGVyLnByb3RvdHlwZS5zaG91bGRDb21wb25lbnRVcGRhdGUuY2FsbCh0aGlzLCBuZXh0UHJvcHMsIG5leHRTdGF0ZSkpXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIGlmIChuZXh0UHJvcHMubW9kZWwgIT09IHRoaXMubW9kZWwpIHtcbiAgICAgICAgICAgIGlmIChuZXh0UHJvcHMuZWxlbWVudCkge1xuICAgICAgICAgICAgICAgIG5leHRQcm9wcy5lbGVtZW50LnNldFJvb3RFbGVtZW50KHRoaXMucm9vdC5jdXJyZW50KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLm1vZGVsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlbC5zZXRSb290RWxlbWVudCh1bmRlZmluZWQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgTWF0cml4Um93LnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBtb2RlbCA9IHRoaXMubW9kZWw7XG4gICAgICAgIGlmICghbW9kZWwudmlzaWJsZSlcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcInRyXCIsIHsgcmVmOiB0aGlzLnJvb3QsIGNsYXNzTmFtZTogbW9kZWwuY2xhc3NOYW1lLCBcImRhdGEtc3YtZHJvcC10YXJnZXQtbWF0cml4LXJvd1wiOiBtb2RlbC5yb3cgJiYgbW9kZWwucm93LmlkLCBvblBvaW50ZXJEb3duOiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIF90aGlzLm9uUG9pbnRlckRvd25IYW5kbGVyKGV2ZW50KTsgfSB9LCB0aGlzLnByb3BzLmNoaWxkcmVuKSk7XG4gICAgfTtcbiAgICByZXR1cm4gTWF0cml4Um93O1xufShyZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5RWxlbWVudEJhc2UpKTtcblxuUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlckVsZW1lbnQoXCJzdi1tYXRyaXgtcm93XCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQocm93X01hdHJpeFJvdywgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9jb21wb25lbnRzL21hdHJpeC1hY3Rpb25zL2RyYWctZHJvcC1pY29uL2RyYWctZHJvcC1pY29uLnRzeFxudmFyIGRyYWdfZHJvcF9pY29uX2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cblxudmFyIGRyYWdfZHJvcF9pY29uX1N1cnZleVF1ZXN0aW9uTWF0cml4RHluYW1pY0RyYWdEcm9wSWNvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBkcmFnX2Ryb3BfaWNvbl9leHRlbmRzKFN1cnZleVF1ZXN0aW9uTWF0cml4RHluYW1pY0RyYWdEcm9wSWNvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlRdWVzdGlvbk1hdHJpeER5bmFtaWNEcmFnRHJvcEljb24oKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uTWF0cml4RHluYW1pY0RyYWdEcm9wSWNvbi5wcm90b3R5cGUsIFwicXVlc3Rpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLml0ZW0uZGF0YS5xdWVzdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4RHluYW1pY0RyYWdEcm9wSWNvbi5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucXVlc3Rpb24uaWNvbkRyYWdFbGVtZW50KSB7XG4gICAgICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcInN2Z1wiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmRyYWdFbGVtZW50RGVjb3JhdG9yIH0sXG4gICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwidXNlXCIsIHsgeGxpbmtIcmVmOiB0aGlzLnF1ZXN0aW9uLmljb25EcmFnRWxlbWVudCB9KSkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMuaWNvbkRyYWcgfSkpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5UXVlc3Rpb25NYXRyaXhEeW5hbWljRHJhZ0Ryb3BJY29uO1xufShSZWFjdFN1cnZleUVsZW1lbnQpKTtcblxuUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlckVsZW1lbnQoXCJzdi1tYXRyaXgtZHJhZy1kcm9wLWljb25cIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChkcmFnX2Ryb3BfaWNvbl9TdXJ2ZXlRdWVzdGlvbk1hdHJpeER5bmFtaWNEcmFnRHJvcEljb24sIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvcmVhY3RxdWVzdGlvbl9tYXRyaXhkcm9wZG93bmJhc2UudHN4XG52YXIgcmVhY3RxdWVzdGlvbl9tYXRyaXhkcm9wZG93bmJhc2VfZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG5cblxuXG5cblxuXG5cblxudmFyIHJlYWN0cXVlc3Rpb25fbWF0cml4ZHJvcGRvd25iYXNlX1N1cnZleVF1ZXN0aW9uTWF0cml4VGFibGUgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcmVhY3RxdWVzdGlvbl9tYXRyaXhkcm9wZG93bmJhc2VfZXh0ZW5kcyhTdXJ2ZXlRdWVzdGlvbk1hdHJpeFRhYmxlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uTWF0cml4VGFibGUoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uTWF0cml4VGFibGUucHJvdG90eXBlLCBcInF1ZXN0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5xdWVzdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbk1hdHJpeFRhYmxlLnByb3RvdHlwZSwgXCJjcmVhdG9yXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5jcmVhdG9yO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uTWF0cml4VGFibGUucHJvdG90eXBlLCBcInRhYmxlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5xdWVzdGlvbi5yZW5kZXJlZFRhYmxlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXhUYWJsZS5wcm90b3R5cGUuZ2V0U3RhdGVFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50YWJsZTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4VGFibGUucHJvdG90eXBlLndyYXBDZWxsID0gZnVuY3Rpb24gKGNlbGwsIGVsZW1lbnQsIHJlYXNvbikge1xuICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy53cmFwQ2VsbChjZWxsLCBlbGVtZW50LCByZWFzb24pO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXhUYWJsZS5wcm90b3R5cGUucmVuZGVySGVhZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGFibGUgPSB0aGlzLnF1ZXN0aW9uLnJlbmRlcmVkVGFibGU7XG4gICAgICAgIGlmICghdGFibGUuc2hvd0hlYWRlcilcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB2YXIgaGVhZGVycyA9IFtdO1xuICAgICAgICB2YXIgY2VsbHMgPSB0YWJsZS5oZWFkZXJSb3cuY2VsbHM7XG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2VsbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHZhciBjZWxsID0gY2VsbHNbaV07XG4gICAgICAgICAgICB2YXIga2V5ID0gXCJjb2x1bW5cIiArIGk7XG4gICAgICAgICAgICB2YXIgY29sdW1uU3R5bGUgPSB7fTtcbiAgICAgICAgICAgIGlmICghIWNlbGwud2lkdGgpIHtcbiAgICAgICAgICAgICAgICBjb2x1bW5TdHlsZS53aWR0aCA9IGNlbGwud2lkdGg7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoISFjZWxsLm1pbldpZHRoKSB7XG4gICAgICAgICAgICAgICAgY29sdW1uU3R5bGUubWluV2lkdGggPSBjZWxsLm1pbldpZHRoO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFyIGNlbGxDb250ZW50ID0gdGhpcy5yZW5kZXJDZWxsQ29udGVudChjZWxsLCBcImNvbHVtbi1oZWFkZXJcIiwge30pO1xuICAgICAgICAgICAgdmFyIGhlYWRlciA9IGNlbGwuaGFzVGl0bGUgP1xuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwidGhcIiwgeyBjbGFzc05hbWU6IGNlbGwuY2xhc3NOYW1lLCBrZXk6IGtleSwgc3R5bGU6IGNvbHVtblN0eWxlIH0sXG4gICAgICAgICAgICAgICAgICAgIFwiIFwiLFxuICAgICAgICAgICAgICAgICAgICBjZWxsQ29udGVudCxcbiAgICAgICAgICAgICAgICAgICAgXCIgXCIpXG4gICAgICAgICAgICAgICAgOiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInRkXCIsIHsgY2xhc3NOYW1lOiBjZWxsLmNsYXNzTmFtZSwga2V5OiBrZXksIHN0eWxlOiBjb2x1bW5TdHlsZSB9KTtcbiAgICAgICAgICAgIGhlYWRlcnMucHVzaChoZWFkZXIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJ0aGVhZFwiLCBudWxsLFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJ0clwiLCBudWxsLCBoZWFkZXJzKSkpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXhUYWJsZS5wcm90b3R5cGUucmVuZGVyRm9vdGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdGFibGUgPSB0aGlzLnF1ZXN0aW9uLnJlbmRlcmVkVGFibGU7XG4gICAgICAgIGlmICghdGFibGUuc2hvd0Zvb3RlcilcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB2YXIgcm93ID0gdGhpcy5yZW5kZXJSb3coXCJmb290ZXJcIiwgdGFibGUuZm9vdGVyUm93LCB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMsIFwicm93LWZvb3RlclwiKTtcbiAgICAgICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwidGZvb3RcIiwgbnVsbCwgcm93KTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4VGFibGUucHJvdG90eXBlLnJlbmRlclJvd3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjc3NDbGFzc2VzID0gdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzO1xuICAgICAgICB2YXIgcm93cyA9IFtdO1xuICAgICAgICB2YXIgcmVuZGVyZWRSb3dzID0gdGhpcy5xdWVzdGlvbi5yZW5kZXJlZFRhYmxlLnJlbmRlcmVkUm93cztcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZW5kZXJlZFJvd3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIHJvd3MucHVzaCh0aGlzLnJlbmRlclJvdyhyZW5kZXJlZFJvd3NbaV0uaWQsIHJlbmRlcmVkUm93c1tpXSwgY3NzQ2xhc3NlcykpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInRib2R5XCIsIG51bGwsIHJvd3MpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXhUYWJsZS5wcm90b3R5cGUucmVuZGVyUm93ID0gZnVuY3Rpb24gKGtleVZhbHVlLCByb3csIGNzc0NsYXNzZXMsIHJlYXNvbikge1xuICAgICAgICB2YXIgbWF0cml4cm93ID0gW107XG4gICAgICAgIHZhciBjZWxscyA9IHJvdy5jZWxscztcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjZWxscy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgbWF0cml4cm93LnB1c2godGhpcy5yZW5kZXJDZWxsKGNlbGxzW2ldLCBpLCBjc3NDbGFzc2VzLCByZWFzb24pKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIga2V5ID0gXCJyb3dcIiArIGtleVZhbHVlO1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJGcmFnbWVudFwiXSwgeyBrZXk6IGtleSB9LCAocmVhc29uID09IFwicm93LWZvb3RlclwiKSA/IGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwidHJcIiwgbnVsbCwgbWF0cml4cm93KSA6IGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHJvd19NYXRyaXhSb3csIHsgbW9kZWw6IHJvdywgcGFyZW50TWF0cml4OiB0aGlzLnF1ZXN0aW9uIH0sIG1hdHJpeHJvdykpKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4VGFibGUucHJvdG90eXBlLnJlbmRlckNlbGwgPSBmdW5jdGlvbiAoY2VsbCwgaW5kZXgsIGNzc0NsYXNzZXMsIHJlYXNvbikge1xuICAgICAgICB2YXIga2V5ID0gXCJjZWxsXCIgKyBpbmRleDtcbiAgICAgICAgaWYgKGNlbGwuaGFzUXVlc3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0ocmVhY3RxdWVzdGlvbl9tYXRyaXhkcm9wZG93bmJhc2VfU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkNlbGwsIHsga2V5OiBrZXksIGNzc0NsYXNzZXM6IGNzc0NsYXNzZXMsIGNlbGw6IGNlbGwsIGNyZWF0b3I6IHRoaXMuY3JlYXRvciwgcmVhc29uOiByZWFzb24gfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjZWxsLmlzRXJyb3JzQ2VsbCkge1xuICAgICAgICAgICAgaWYgKGNlbGwuaXNFcnJvcnNDZWxsKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyZWFjdHF1ZXN0aW9uX21hdHJpeGRyb3Bkb3duYmFzZV9TdXJ2ZXlRdWVzdGlvbk1hdHJpeERyb3Bkb3duRXJyb3JzQ2VsbCwgeyBjZWxsOiBjZWxsLCBrZXk6IGtleSwga2V5VmFsdWU6IGtleSwgcXVlc3Rpb246IGNlbGwucXVlc3Rpb24sIGNyZWF0b3I6IHRoaXMuY3JlYXRvciB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNhbGNSZWFzb24gPSByZWFzb247XG4gICAgICAgIGlmICghY2FsY1JlYXNvbikge1xuICAgICAgICAgICAgY2FsY1JlYXNvbiA9IGNlbGwuaGFzVGl0bGUgPyBcInJvdy1oZWFkZXJcIiA6IFwiXCI7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGNlbGxDb250ZW50ID0gdGhpcy5yZW5kZXJDZWxsQ29udGVudChjZWxsLCBjYWxjUmVhc29uLCBjc3NDbGFzc2VzKTtcbiAgICAgICAgdmFyIGNlbGxTdHlsZSA9IG51bGw7XG4gICAgICAgIGlmICghIWNlbGwud2lkdGggfHwgISFjZWxsLm1pbldpZHRoKSB7XG4gICAgICAgICAgICBjZWxsU3R5bGUgPSB7fTtcbiAgICAgICAgICAgIGlmICghIWNlbGwud2lkdGgpXG4gICAgICAgICAgICAgICAgY2VsbFN0eWxlLndpZHRoID0gY2VsbC53aWR0aDtcbiAgICAgICAgICAgIGlmICghIWNlbGwubWluV2lkdGgpXG4gICAgICAgICAgICAgICAgY2VsbFN0eWxlLm1pbldpZHRoID0gY2VsbC5taW5XaWR0aDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwidGRcIiwgeyBjbGFzc05hbWU6IGNlbGwuY2xhc3NOYW1lLCBrZXk6IGtleSwgc3R5bGU6IGNlbGxTdHlsZSwgY29sU3BhbjogY2VsbC5jb2xTcGFucywgdGl0bGU6IGNlbGwuZ2V0VGl0bGUoKSB9LCBjZWxsQ29udGVudCkpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXhUYWJsZS5wcm90b3R5cGUucmVuZGVyQ2VsbENvbnRlbnQgPSBmdW5jdGlvbiAoY2VsbCwgcmVhc29uLCBjc3NDbGFzc2VzKSB7XG4gICAgICAgIHZhciBjZWxsQ29udGVudCA9IG51bGw7XG4gICAgICAgIHZhciBjZWxsU3R5bGUgPSBudWxsO1xuICAgICAgICBpZiAoISFjZWxsLndpZHRoIHx8ICEhY2VsbC5taW5XaWR0aCkge1xuICAgICAgICAgICAgY2VsbFN0eWxlID0ge307XG4gICAgICAgICAgICBpZiAoISFjZWxsLndpZHRoKVxuICAgICAgICAgICAgICAgIGNlbGxTdHlsZS53aWR0aCA9IGNlbGwud2lkdGg7XG4gICAgICAgICAgICBpZiAoISFjZWxsLm1pbldpZHRoKVxuICAgICAgICAgICAgICAgIGNlbGxTdHlsZS5taW5XaWR0aCA9IGNlbGwubWluV2lkdGg7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNlbGwuaGFzVGl0bGUpIHtcbiAgICAgICAgICAgIHJlYXNvbiA9IFwicm93LWhlYWRlclwiO1xuICAgICAgICAgICAgdmFyIHN0ciA9IHRoaXMucmVuZGVyTG9jU3RyaW5nKGNlbGwubG9jVGl0bGUpO1xuICAgICAgICAgICAgdmFyIHJlcXVpcmVfMSA9ICEhY2VsbC5jb2x1bW4gPyBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyZWFjdHF1ZXN0aW9uX21hdHJpeGRyb3Bkb3duYmFzZV9TdXJ2ZXlRdWVzdGlvbk1hdHJpeEhlYWRlclJlcXVpcmVkLCB7IGNvbHVtbjogY2VsbC5jb2x1bW4sIHF1ZXN0aW9uOiB0aGlzLnF1ZXN0aW9uIH0pIDogbnVsbDtcbiAgICAgICAgICAgIGNlbGxDb250ZW50ID0gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJGcmFnbWVudFwiXSwgbnVsbCxcbiAgICAgICAgICAgICAgICBzdHIsXG4gICAgICAgICAgICAgICAgcmVxdWlyZV8xKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNlbGwuaXNEcmFnSGFuZGxlckNlbGwpIHtcbiAgICAgICAgICAgIGNlbGxDb250ZW50ID0gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJGcmFnbWVudFwiXSwgbnVsbCxcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShkcmFnX2Ryb3BfaWNvbl9TdXJ2ZXlRdWVzdGlvbk1hdHJpeER5bmFtaWNEcmFnRHJvcEljb24sIHsgaXRlbTogeyBkYXRhOiB7IHJvdzogY2VsbC5yb3csIHF1ZXN0aW9uOiB0aGlzLnF1ZXN0aW9uIH0gfSB9KSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjZWxsLmlzQWN0aW9uc0NlbGwpIHtcbiAgICAgICAgICAgIGNlbGxDb250ZW50ID0gKFJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UuY3JlYXRlRWxlbWVudChcInN2LW1hdHJpeGR5bmFtaWMtYWN0aW9ucy1jZWxsXCIsIHtcbiAgICAgICAgICAgICAgICBxdWVzdGlvbjogdGhpcy5xdWVzdGlvbixcbiAgICAgICAgICAgICAgICBjc3NDbGFzc2VzOiBjc3NDbGFzc2VzLCBjZWxsOiBjZWxsLFxuICAgICAgICAgICAgICAgIG1vZGVsOiBjZWxsLml0ZW0uZ2V0RGF0YSgpXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGNlbGwuaGFzUGFuZWwpIHtcbiAgICAgICAgICAgIGNlbGxDb250ZW50ID0gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHBhbmVsX1N1cnZleVBhbmVsLCB7IGtleTogY2VsbC5wYW5lbC5pZCwgZWxlbWVudDogY2VsbC5wYW5lbCwgc3VydmV5OiB0aGlzLnF1ZXN0aW9uLnN1cnZleSwgY3NzQ2xhc3NlczogY3NzQ2xhc3NlcywgaXNEaXNwbGF5TW9kZTogdGhpcy5pc0Rpc3BsYXlNb2RlLCBjcmVhdG9yOiB0aGlzLmNyZWF0b3IgfSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghY2VsbENvbnRlbnQpXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgdmFyIHJlYWR5Q2VsbCA9IChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiRnJhZ21lbnRcIl0sIG51bGwsIGNlbGxDb250ZW50KSk7XG4gICAgICAgIHJldHVybiB0aGlzLndyYXBDZWxsKGNlbGwsIHJlYWR5Q2VsbCwgcmVhc29uKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4VGFibGUucHJvdG90eXBlLnJlbmRlckVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBoZWFkZXIgPSB0aGlzLnJlbmRlckhlYWRlcigpO1xuICAgICAgICB2YXIgZm9vdGVycyA9IHRoaXMucmVuZGVyRm9vdGVyKCk7XG4gICAgICAgIHZhciByb3dzID0gdGhpcy5yZW5kZXJSb3dzKCk7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJ0YWJsZVwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5nZXRUYWJsZUNzcygpIH0sXG4gICAgICAgICAgICBoZWFkZXIsXG4gICAgICAgICAgICByb3dzLFxuICAgICAgICAgICAgZm9vdGVycykpO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVF1ZXN0aW9uTWF0cml4VGFibGU7XG59KHJlYWN0cXVlc3Rpb25fZWxlbWVudF9TdXJ2ZXlFbGVtZW50QmFzZSkpO1xudmFyIHJlYWN0cXVlc3Rpb25fbWF0cml4ZHJvcGRvd25iYXNlX1N1cnZleVF1ZXN0aW9uTWF0cml4RHJvcGRvd25CYXNlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJlYWN0cXVlc3Rpb25fbWF0cml4ZHJvcGRvd25iYXNlX2V4dGVuZHMoU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkJhc2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkJhc2UocHJvcHMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgICAgIC8vQ3JlYXRlIHJlbmRlcmVkIHRhYmxlIGluIGNvbnRydWN0b3IgYW5kIG5vdCBvbiByZW5kZXJpbmdcbiAgICAgICAgdmFyIHRhYmxlID0gX3RoaXMucXVlc3Rpb24ucmVuZGVyZWRUYWJsZTtcbiAgICAgICAgX3RoaXMuc3RhdGUgPSBfdGhpcy5nZXRTdGF0ZSgpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbk1hdHJpeERyb3Bkb3duQmFzZS5wcm90b3R5cGUsIFwicXVlc3Rpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnF1ZXN0aW9uQmFzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4RHJvcGRvd25CYXNlLnByb3RvdHlwZS5nZXRTdGF0ZSA9IGZ1bmN0aW9uIChwcmV2U3RhdGUpIHtcbiAgICAgICAgaWYgKHByZXZTdGF0ZSA9PT0gdm9pZCAwKSB7IHByZXZTdGF0ZSA9IG51bGw7IH1cbiAgICAgICAgcmV0dXJuIHsgcm93Q291bnRlcjogIXByZXZTdGF0ZSA/IDAgOiBwcmV2U3RhdGUucm93Q291bnRlciArIDEgfTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4RHJvcGRvd25CYXNlLnByb3RvdHlwZS51cGRhdGVTdGF0ZU9uQ2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLmlzUmVuZGVyaW5nKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHRoaXMuZ2V0U3RhdGUodGhpcy5zdGF0ZSkpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkJhc2UucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMucXVlc3Rpb24ub25SZW5kZXJlZFRhYmxlUmVzZXRDYWxsYmFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIF90aGlzLnVwZGF0ZVN0YXRlT25DYWxsYmFjaygpO1xuICAgICAgICB9O1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkJhc2UucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMucXVlc3Rpb24ub25SZW5kZXJlZFRhYmxlUmVzZXRDYWxsYmFjayA9IGZ1bmN0aW9uICgpIHsgfTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4RHJvcGRvd25CYXNlLnByb3RvdHlwZS5yZW5kZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJUYWJsZURpdigpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkJhc2UucHJvdG90eXBlLnJlbmRlclRhYmxlRGl2ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgZGl2U3R5bGUgPSB0aGlzLnF1ZXN0aW9uLnNob3dIb3Jpem9udGFsU2Nyb2xsXG4gICAgICAgICAgICA/IHsgb3ZlcmZsb3dYOiBcInNjcm9sbFwiIH1cbiAgICAgICAgICAgIDoge307XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBzdHlsZTogZGl2U3R5bGUsIGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLnRhYmxlV3JhcHBlciwgcmVmOiBmdW5jdGlvbiAocm9vdCkgeyByZXR1cm4gKF90aGlzLnNldENvbnRyb2wocm9vdCkpOyB9IH0sXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyZWFjdHF1ZXN0aW9uX21hdHJpeGRyb3Bkb3duYmFzZV9TdXJ2ZXlRdWVzdGlvbk1hdHJpeFRhYmxlLCB7IHF1ZXN0aW9uOiB0aGlzLnF1ZXN0aW9uLCBjcmVhdG9yOiB0aGlzLmNyZWF0b3IsIHdyYXBDZWxsOiBmdW5jdGlvbiAoY2VsbCwgZWxlbWVudCwgcmVhc29uKSB7IHJldHVybiBfdGhpcy53cmFwQ2VsbChjZWxsLCBlbGVtZW50LCByZWFzb24pOyB9IH0pKSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkJhc2U7XG59KHJlYWN0cXVlc3Rpb25fZWxlbWVudF9TdXJ2ZXlRdWVzdGlvbkVsZW1lbnRCYXNlKSk7XG5cbnZhciByZWFjdHF1ZXN0aW9uX21hdHJpeGRyb3Bkb3duYmFzZV9TdXJ2ZXlRdWVzdGlvbk1hdHJpeEFjdGlvbnNDZWxsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJlYWN0cXVlc3Rpb25fbWF0cml4ZHJvcGRvd25iYXNlX2V4dGVuZHMoU3VydmV5UXVlc3Rpb25NYXRyaXhBY3Rpb25zQ2VsbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlRdWVzdGlvbk1hdHJpeEFjdGlvbnNDZWxsKHByb3BzKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uTWF0cml4QWN0aW9uc0NlbGwucHJvdG90eXBlLCBcIm1vZGVsXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5tb2RlbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4QWN0aW9uc0NlbGwucHJvdG90eXBlLnJlbmRlckVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oYWN0aW9uX2Jhcl9TdXJ2ZXlBY3Rpb25CYXIsIHsgbW9kZWw6IHRoaXMubW9kZWwsIGhhbmRsZUNsaWNrOiBmYWxzZSB9KSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5UXVlc3Rpb25NYXRyaXhBY3Rpb25zQ2VsbDtcbn0oUmVhY3RTdXJ2ZXlFbGVtZW50KSk7XG52YXIgcmVhY3RxdWVzdGlvbl9tYXRyaXhkcm9wZG93bmJhc2VfU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkVycm9yc0NlbGwgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcmVhY3RxdWVzdGlvbl9tYXRyaXhkcm9wZG93bmJhc2VfZXh0ZW5kcyhTdXJ2ZXlRdWVzdGlvbk1hdHJpeERyb3Bkb3duRXJyb3JzQ2VsbCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlRdWVzdGlvbk1hdHJpeERyb3Bkb3duRXJyb3JzQ2VsbChwcm9wcykge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbk1hdHJpeERyb3Bkb3duRXJyb3JzQ2VsbC5wcm90b3R5cGUsIFwia2V5XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5rZXlWYWx1ZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbk1hdHJpeERyb3Bkb3duRXJyb3JzQ2VsbC5wcm90b3R5cGUsIFwiY2VsbFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuY2VsbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4RHJvcGRvd25FcnJvcnNDZWxsLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5jZWxsLmlzVmlzaWJsZSlcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJ0ZFwiLCB7IGNsYXNzTmFtZTogdGhpcy5jZWxsLmNsYXNzTmFtZSwga2V5OiB0aGlzLmtleSwgY29sU3BhbjogdGhpcy5jZWxsLmNvbFNwYW5zLCB0aXRsZTogdGhpcy5jZWxsLmdldFRpdGxlKCkgfSwgX3N1cGVyLnByb3RvdHlwZS5yZW5kZXIuY2FsbCh0aGlzKSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbk1hdHJpeERyb3Bkb3duRXJyb3JzQ2VsbC5wcm90b3R5cGUuZ2V0UXVlc3Rpb25Qcm9wZXJ0aWVzVG9UcmFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5wcm90b3R5cGUuZ2V0UXVlc3Rpb25Qcm9wZXJ0aWVzVG9UcmFjay5jYWxsKHRoaXMpLmNvbmNhdChbXCJ2aXNpYmxlXCJdKTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvbk1hdHJpeERyb3Bkb3duRXJyb3JzQ2VsbDtcbn0ocmVhY3RxdWVzdGlvbl9TdXJ2ZXlRdWVzdGlvbkVycm9yQ2VsbCkpO1xuUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlckVsZW1lbnQoXCJzdi1tYXRyaXhkeW5hbWljLWFjdGlvbnMtY2VsbFwiLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0ocmVhY3RxdWVzdGlvbl9tYXRyaXhkcm9wZG93bmJhc2VfU3VydmV5UXVlc3Rpb25NYXRyaXhBY3Rpb25zQ2VsbCwgcHJvcHMpO1xufSk7XG52YXIgcmVhY3RxdWVzdGlvbl9tYXRyaXhkcm9wZG93bmJhc2VfU3VydmV5UXVlc3Rpb25NYXRyaXhIZWFkZXJSZXF1aXJlZCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICByZWFjdHF1ZXN0aW9uX21hdHJpeGRyb3Bkb3duYmFzZV9leHRlbmRzKFN1cnZleVF1ZXN0aW9uTWF0cml4SGVhZGVyUmVxdWlyZWQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UXVlc3Rpb25NYXRyaXhIZWFkZXJSZXF1aXJlZChwcm9wcykge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbk1hdHJpeEhlYWRlclJlcXVpcmVkLnByb3RvdHlwZSwgXCJjb2x1bW5cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLmNvbHVtbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbk1hdHJpeEhlYWRlclJlcXVpcmVkLnByb3RvdHlwZSwgXCJxdWVzdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMucXVlc3Rpb247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlRdWVzdGlvbk1hdHJpeEhlYWRlclJlcXVpcmVkLnByb3RvdHlwZS5nZXRTdGF0ZUVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbHVtbjtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4SGVhZGVyUmVxdWlyZWQucHJvdG90eXBlLnJlbmRlckVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5jb2x1bW4uaXNSZW5kZXJlZFJlcXVpcmVkKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcIkZyYWdtZW50XCJdLCBudWxsLFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJzcGFuXCIsIG51bGwsIFwiXFx1MDBBMFwiKSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwic3BhblwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmNlbGxSZXF1aXJlZFRleHQgfSwgdGhpcy5jb2x1bW4ucmVxdWlyZWRUZXh0KSkpO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVF1ZXN0aW9uTWF0cml4SGVhZGVyUmVxdWlyZWQ7XG59KFJlYWN0U3VydmV5RWxlbWVudCkpO1xudmFyIHJlYWN0cXVlc3Rpb25fbWF0cml4ZHJvcGRvd25iYXNlX1N1cnZleVF1ZXN0aW9uTWF0cml4RHJvcGRvd25DZWxsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJlYWN0cXVlc3Rpb25fbWF0cml4ZHJvcGRvd25iYXNlX2V4dGVuZHMoU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkNlbGwsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkNlbGwocHJvcHMpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkNlbGwucHJvdG90eXBlLCBcImNlbGxcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLmNlbGw7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkNlbGwucHJvdG90eXBlLCBcIml0ZW1Dc3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAhIXRoaXMuY2VsbCA/IHRoaXMuY2VsbC5jbGFzc05hbWUgOiBcIlwiO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkNlbGwucHJvdG90eXBlLmdldFF1ZXN0aW9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcSA9IF9zdXBlci5wcm90b3R5cGUuZ2V0UXVlc3Rpb24uY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKCEhcSlcbiAgICAgICAgICAgIHJldHVybiBxO1xuICAgICAgICByZXR1cm4gISF0aGlzLmNlbGwgPyB0aGlzLmNlbGwucXVlc3Rpb24gOiBudWxsO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkNlbGwucHJvdG90eXBlLmRvQWZ0ZXJSZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBlbCA9IHRoaXMuY2VsbFJlZi5jdXJyZW50O1xuICAgICAgICBpZiAoZWwgJiZcbiAgICAgICAgICAgIHRoaXMuY2VsbCAmJlxuICAgICAgICAgICAgdGhpcy5xdWVzdGlvbiAmJlxuICAgICAgICAgICAgdGhpcy5xdWVzdGlvbi5zdXJ2ZXkgJiZcbiAgICAgICAgICAgIGVsLmdldEF0dHJpYnV0ZShcImRhdGEtcmVuZGVyZWRcIikgIT09IFwiclwiKSB7XG4gICAgICAgICAgICBlbC5zZXRBdHRyaWJ1dGUoXCJkYXRhLXJlbmRlcmVkXCIsIFwiclwiKTtcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgICAgICAgICAgIGNlbGw6IHRoaXMuY2VsbCxcbiAgICAgICAgICAgICAgICBjZWxsUXVlc3Rpb246IHRoaXMucXVlc3Rpb24sXG4gICAgICAgICAgICAgICAgaHRtbEVsZW1lbnQ6IGVsLFxuICAgICAgICAgICAgICAgIHJvdzogdGhpcy5jZWxsLnJvdyxcbiAgICAgICAgICAgICAgICBjb2x1bW46IHRoaXMuY2VsbC5jZWxsLmNvbHVtbixcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLnF1ZXN0aW9uLnN1cnZleS5tYXRyaXhBZnRlckNlbGxSZW5kZXIodGhpcy5xdWVzdGlvbiwgb3B0aW9ucyk7XG4gICAgICAgICAgICB0aGlzLnF1ZXN0aW9uLmFmdGVyUmVuZGVyQ29yZShlbCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4RHJvcGRvd25DZWxsLnByb3RvdHlwZS5nZXRTaG93RXJyb3JzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKHRoaXMucXVlc3Rpb24uaXNWaXNpYmxlICYmXG4gICAgICAgICAgICAoIXRoaXMuY2VsbC5pc0Nob2ljZSB8fCB0aGlzLmNlbGwuaXNGaXJzdENob2ljZSkpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkNlbGwucHJvdG90eXBlLmdldENlbGxTdHlsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJlcyA9IF9zdXBlci5wcm90b3R5cGUuZ2V0Q2VsbFN0eWxlLmNhbGwodGhpcyk7XG4gICAgICAgIGlmICghIXRoaXMuY2VsbC53aWR0aCB8fCAhIXRoaXMuY2VsbC5taW5XaWR0aCkge1xuICAgICAgICAgICAgaWYgKCFyZXMpXG4gICAgICAgICAgICAgICAgcmVzID0ge307XG4gICAgICAgICAgICBpZiAoISF0aGlzLmNlbGwud2lkdGgpXG4gICAgICAgICAgICAgICAgcmVzLndpZHRoID0gdGhpcy5jZWxsLndpZHRoO1xuICAgICAgICAgICAgaWYgKCEhdGhpcy5jZWxsLm1pbldpZHRoKVxuICAgICAgICAgICAgICAgIHJlcy5taW5XaWR0aCA9IHRoaXMuY2VsbC5taW5XaWR0aDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gcmVzO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkNlbGwucHJvdG90eXBlLmdldEhlYWRlclRleHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNlbGwuaGVhZGVycztcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4RHJvcGRvd25DZWxsLnByb3RvdHlwZS5yZW5kZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuY2VsbC5pc1Zpc2libGUpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfc3VwZXIucHJvdG90eXBlLnJlbmRlckVsZW1lbnQuY2FsbCh0aGlzKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4RHJvcGRvd25DZWxsLnByb3RvdHlwZS5yZW5kZXJDZWxsQ29udGVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNvbnRlbnQgPSBfc3VwZXIucHJvdG90eXBlLnJlbmRlckNlbGxDb250ZW50LmNhbGwodGhpcyk7XG4gICAgICAgIHZhciByZXNwb25zaXZlVGl0bGUgPSB0aGlzLmNlbGwuc2hvd1Jlc3BvbnNpdmVUaXRsZSA/IChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInNwYW5cIiwgeyBjbGFzc05hbWU6IHRoaXMuY2VsbC5yZXNwb25zaXZlVGl0bGVDc3MgfSwgdGhpcy5yZW5kZXJMb2NTdHJpbmcodGhpcy5jZWxsLnJlc3BvbnNpdmVMb2NUaXRsZSkpKSA6IG51bGw7XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiRnJhZ21lbnRcIl0sIG51bGwsXG4gICAgICAgICAgICByZXNwb25zaXZlVGl0bGUsXG4gICAgICAgICAgICBjb250ZW50KTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4RHJvcGRvd25DZWxsLnByb3RvdHlwZS5yZW5kZXJRdWVzdGlvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLnF1ZXN0aW9uLmlzVmlzaWJsZSlcbiAgICAgICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiRnJhZ21lbnRcIl0sIG51bGwpO1xuICAgICAgICBpZiAoIXRoaXMuY2VsbC5pc0Nob2ljZSlcbiAgICAgICAgICAgIHJldHVybiByZWFjdHF1ZXN0aW9uX1N1cnZleVF1ZXN0aW9uLnJlbmRlclF1ZXN0aW9uQm9keSh0aGlzLmNyZWF0b3IsIHRoaXMucXVlc3Rpb24pO1xuICAgICAgICBpZiAodGhpcy5jZWxsLmlzT3RoZXJDaG9pY2UpXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5yZW5kZXJPdGhlckNvbW1lbnQoKTtcbiAgICAgICAgaWYgKHRoaXMuY2VsbC5pc0NoZWNrYm94KVxuICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyQ2VsbENoZWNrYm94QnV0dG9uKCk7XG4gICAgICAgIHJldHVybiB0aGlzLnJlbmRlckNlbGxSYWRpb2dyb3VwQnV0dG9uKCk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbk1hdHJpeERyb3Bkb3duQ2VsbC5wcm90b3R5cGUucmVuZGVyT3RoZXJDb21tZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcXVlc3Rpb24gPSB0aGlzLmNlbGwucXVlc3Rpb247XG4gICAgICAgIHZhciBjc3NDbGFzc2VzID0gcXVlc3Rpb24uY3NzQ2xhc3NlcyB8fCB7fTtcbiAgICAgICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFN1cnZleVF1ZXN0aW9uT3RoZXJWYWx1ZUl0ZW0sIHsgcXVlc3Rpb246IHF1ZXN0aW9uLCBjc3NDbGFzc2VzOiBjc3NDbGFzc2VzLCBvdGhlckNzczogY3NzQ2xhc3Nlcy5vdGhlciwgaXNEaXNwbGF5TW9kZTogcXVlc3Rpb24uaXNJbnB1dFJlYWRPbmx5IH0pO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkNlbGwucHJvdG90eXBlLnJlbmRlckNlbGxDaGVja2JveEJ1dHRvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGtleSA9IHRoaXMuY2VsbC5xdWVzdGlvbi5pZCArIFwiaXRlbVwiICsgdGhpcy5jZWxsLmNob2ljZUluZGV4O1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHJlYWN0cXVlc3Rpb25fY2hlY2tib3hfU3VydmV5UXVlc3Rpb25DaGVja2JveEl0ZW0sIHsga2V5OiBrZXksIHF1ZXN0aW9uOiB0aGlzLmNlbGwucXVlc3Rpb24sIGNzc0NsYXNzZXM6IHRoaXMuY2VsbC5xdWVzdGlvbi5jc3NDbGFzc2VzLCBpc0Rpc3BsYXlNb2RlOiB0aGlzLmNlbGwucXVlc3Rpb24uaXNJbnB1dFJlYWRPbmx5LCBpdGVtOiB0aGlzLmNlbGwuaXRlbSwgaXNGaXJzdDogdGhpcy5jZWxsLmlzRmlyc3RDaG9pY2UsIGluZGV4OiB0aGlzLmNlbGwuY2hvaWNlSW5kZXgudG9TdHJpbmcoKSwgaGlkZUNhcHRpb246IHRydWUgfSkpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkNlbGwucHJvdG90eXBlLnJlbmRlckNlbGxSYWRpb2dyb3VwQnV0dG9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIga2V5ID0gdGhpcy5jZWxsLnF1ZXN0aW9uLmlkICsgXCJpdGVtXCIgKyB0aGlzLmNlbGwuY2hvaWNlSW5kZXg7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0ocmVhY3RxdWVzdGlvbl9yYWRpb2dyb3VwX1N1cnZleVF1ZXN0aW9uUmFkaW9JdGVtLCB7IGtleToga2V5LCBxdWVzdGlvbjogdGhpcy5jZWxsLnF1ZXN0aW9uLCBjc3NDbGFzc2VzOiB0aGlzLmNlbGwucXVlc3Rpb24uY3NzQ2xhc3NlcywgaXNEaXNwbGF5TW9kZTogdGhpcy5jZWxsLnF1ZXN0aW9uLmlzSW5wdXRSZWFkT25seSwgaXRlbTogdGhpcy5jZWxsLml0ZW0sIGluZGV4OiB0aGlzLmNlbGwuY2hvaWNlSW5kZXgudG9TdHJpbmcoKSwgaXNDaGVja2VkOiB0aGlzLmNlbGwucXVlc3Rpb24udmFsdWUgPT09IHRoaXMuY2VsbC5pdGVtLnZhbHVlLCBpc0Rpc2FibGVkOiB0aGlzLmNlbGwucXVlc3Rpb24uaXNSZWFkT25seSB8fCAhdGhpcy5jZWxsLml0ZW0uaXNFbmFibGVkLCBoaWRlQ2FwdGlvbjogdHJ1ZSB9KSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkNlbGw7XG59KHJlYWN0cXVlc3Rpb25fU3VydmV5UXVlc3Rpb25BbmRFcnJvcnNDZWxsKSk7XG5cblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL3JlYWN0cXVlc3Rpb25fbWF0cml4ZHJvcGRvd24udHN4XG52YXIgcmVhY3RxdWVzdGlvbl9tYXRyaXhkcm9wZG93bl9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cbnZhciBTdXJ2ZXlRdWVzdGlvbk1hdHJpeERyb3Bkb3duID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJlYWN0cXVlc3Rpb25fbWF0cml4ZHJvcGRvd25fZXh0ZW5kcyhTdXJ2ZXlRdWVzdGlvbk1hdHJpeERyb3Bkb3duLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uTWF0cml4RHJvcGRvd24ocHJvcHMpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgIH1cbiAgICByZXR1cm4gU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bjtcbn0ocmVhY3RxdWVzdGlvbl9tYXRyaXhkcm9wZG93bmJhc2VfU3VydmV5UXVlc3Rpb25NYXRyaXhEcm9wZG93bkJhc2UpKTtcblxuUmVhY3RRdWVzdGlvbkZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJRdWVzdGlvbihcIm1hdHJpeGRyb3Bkb3duXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShTdXJ2ZXlRdWVzdGlvbk1hdHJpeERyb3Bkb3duLCBwcm9wcyk7XG59KTtcblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL3JlYWN0cXVlc3Rpb25fbWF0cml4ZHluYW1pYy50c3hcbnZhciByZWFjdHF1ZXN0aW9uX21hdHJpeGR5bmFtaWNfZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG5cblxudmFyIHJlYWN0cXVlc3Rpb25fbWF0cml4ZHluYW1pY19TdXJ2ZXlRdWVzdGlvbk1hdHJpeER5bmFtaWMgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcmVhY3RxdWVzdGlvbl9tYXRyaXhkeW5hbWljX2V4dGVuZHMoU3VydmV5UXVlc3Rpb25NYXRyaXhEeW5hbWljLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uTWF0cml4RHluYW1pYyhwcm9wcykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuaGFuZGxlT25Sb3dBZGRDbGljayA9IF90aGlzLmhhbmRsZU9uUm93QWRkQ2xpY2suYmluZChfdGhpcyk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uTWF0cml4RHluYW1pYy5wcm90b3R5cGUsIFwibWF0cml4XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5xdWVzdGlvbkJhc2U7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlRdWVzdGlvbk1hdHJpeER5bmFtaWMucHJvdG90eXBlLmhhbmRsZU9uUm93QWRkQ2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5tYXRyaXguYWRkUm93VUkoKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4RHluYW1pYy5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNzc0NsYXNzZXMgPSB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXM7XG4gICAgICAgIHZhciBzaG93VGFibGUgPSB0aGlzLnF1ZXN0aW9uLnJlbmRlcmVkVGFibGUuc2hvd1RhYmxlO1xuICAgICAgICB2YXIgbWFpbkRpdiA9IHNob3dUYWJsZVxuICAgICAgICAgICAgPyB0aGlzLnJlbmRlclRhYmxlRGl2KClcbiAgICAgICAgICAgIDogdGhpcy5yZW5kZXJOb1Jvd3NDb250ZW50KGNzc0NsYXNzZXMpO1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIG51bGwsXG4gICAgICAgICAgICB0aGlzLnJlbmRlckFkZFJvd0J1dHRvbk9uVG9wKGNzc0NsYXNzZXMpLFxuICAgICAgICAgICAgbWFpbkRpdixcbiAgICAgICAgICAgIHRoaXMucmVuZGVyQWRkUm93QnV0dG9uT25Cb3R0b20oY3NzQ2xhc3NlcykpKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4RHluYW1pYy5wcm90b3R5cGUucmVuZGVyQWRkUm93QnV0dG9uT25Ub3AgPSBmdW5jdGlvbiAoY3NzQ2xhc3Nlcykge1xuICAgICAgICBpZiAoIXRoaXMubWF0cml4LnJlbmRlcmVkVGFibGUuc2hvd0FkZFJvd09uVG9wKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIHJldHVybiB0aGlzLnJlbmRlckFkZFJvd0J1dHRvbihjc3NDbGFzc2VzKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4RHluYW1pYy5wcm90b3R5cGUucmVuZGVyQWRkUm93QnV0dG9uT25Cb3R0b20gPSBmdW5jdGlvbiAoY3NzQ2xhc3Nlcykge1xuICAgICAgICBpZiAoIXRoaXMubWF0cml4LnJlbmRlcmVkVGFibGUuc2hvd0FkZFJvd09uQm90dG9tKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIHJldHVybiB0aGlzLnJlbmRlckFkZFJvd0J1dHRvbihjc3NDbGFzc2VzKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4RHluYW1pYy5wcm90b3R5cGUucmVuZGVyTm9Sb3dzQ29udGVudCA9IGZ1bmN0aW9uIChjc3NDbGFzc2VzKSB7XG4gICAgICAgIHZhciB0ZXh0ID0gdGhpcy5yZW5kZXJMb2NTdHJpbmcodGhpcy5tYXRyaXgubG9jRW1wdHlSb3dzVGV4dCk7XG4gICAgICAgIHZhciB0ZXh0RGl2ID0gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IGNzc0NsYXNzZXMuZW1wdHlSb3dzVGV4dCB9LCB0ZXh0KTtcbiAgICAgICAgdmFyIGJ0biA9IHRoaXMubWF0cml4LnJlbmRlcmVkVGFibGUuc2hvd0FkZFJvdyA/IHRoaXMucmVuZGVyQWRkUm93QnV0dG9uKGNzc0NsYXNzZXMsIHRydWUpIDogdW5kZWZpbmVkO1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBjc3NDbGFzc2VzLmVtcHR5Um93c1NlY3Rpb24gfSxcbiAgICAgICAgICAgIHRleHREaXYsXG4gICAgICAgICAgICBidG4pKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4RHluYW1pYy5wcm90b3R5cGUucmVuZGVyQWRkUm93QnV0dG9uID0gZnVuY3Rpb24gKGNzc0NsYXNzZXMsIGlzRW1wdHlTZWN0aW9uKSB7XG4gICAgICAgIGlmIChpc0VtcHR5U2VjdGlvbiA9PT0gdm9pZCAwKSB7IGlzRW1wdHlTZWN0aW9uID0gZmFsc2U7IH1cbiAgICAgICAgcmV0dXJuIFJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UuY3JlYXRlRWxlbWVudChcInN2LW1hdHJpeGR5bmFtaWMtYWRkLWJ0blwiLCB7XG4gICAgICAgICAgICBxdWVzdGlvbjogdGhpcy5xdWVzdGlvbixcbiAgICAgICAgICAgIGNzc0NsYXNzZXM6IGNzc0NsYXNzZXMsIGlzRW1wdHlTZWN0aW9uOiBpc0VtcHR5U2VjdGlvblxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvbk1hdHJpeER5bmFtaWM7XG59KHJlYWN0cXVlc3Rpb25fbWF0cml4ZHJvcGRvd25iYXNlX1N1cnZleVF1ZXN0aW9uTWF0cml4RHJvcGRvd25CYXNlKSk7XG5cblJlYWN0UXVlc3Rpb25GYWN0b3J5Lkluc3RhbmNlLnJlZ2lzdGVyUXVlc3Rpb24oXCJtYXRyaXhkeW5hbWljXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyZWFjdHF1ZXN0aW9uX21hdHJpeGR5bmFtaWNfU3VydmV5UXVlc3Rpb25NYXRyaXhEeW5hbWljLCBwcm9wcyk7XG59KTtcbnZhciByZWFjdHF1ZXN0aW9uX21hdHJpeGR5bmFtaWNfU3VydmV5UXVlc3Rpb25NYXRyaXhEeW5hbWljQWRkQnV0dG9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJlYWN0cXVlc3Rpb25fbWF0cml4ZHluYW1pY19leHRlbmRzKFN1cnZleVF1ZXN0aW9uTWF0cml4RHluYW1pY0FkZEJ1dHRvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlRdWVzdGlvbk1hdHJpeER5bmFtaWNBZGRCdXR0b24ocHJvcHMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmhhbmRsZU9uUm93QWRkQ2xpY2sgPSBfdGhpcy5oYW5kbGVPblJvd0FkZENsaWNrLmJpbmQoX3RoaXMpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbk1hdHJpeER5bmFtaWNBZGRCdXR0b24ucHJvdG90eXBlLCBcIm1hdHJpeFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMucXVlc3Rpb247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlRdWVzdGlvbk1hdHJpeER5bmFtaWNBZGRCdXR0b24ucHJvdG90eXBlLmhhbmRsZU9uUm93QWRkQ2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5tYXRyaXguYWRkUm93VUkoKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4RHluYW1pY0FkZEJ1dHRvbi5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFkZFJvd1RleHQgPSB0aGlzLnJlbmRlckxvY1N0cmluZyh0aGlzLm1hdHJpeC5sb2NBZGRSb3dUZXh0KTtcbiAgICAgICAgdmFyIGFkZEJ1dHRvbiA9IChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImJ1dHRvblwiLCB7IGNsYXNzTmFtZTogdGhpcy5tYXRyaXguZ2V0QWRkUm93QnV0dG9uQ3NzKHRoaXMucHJvcHMuaXNFbXB0eVNlY3Rpb24pLCB0eXBlOiBcImJ1dHRvblwiLCBkaXNhYmxlZDogdGhpcy5tYXRyaXguaXNJbnB1dFJlYWRPbmx5LCBvbkNsaWNrOiB0aGlzLm1hdHJpeC5pc0Rlc2lnbk1vZGUgPyB1bmRlZmluZWQgOiB0aGlzLmhhbmRsZU9uUm93QWRkQ2xpY2sgfSxcbiAgICAgICAgICAgIGFkZFJvd1RleHQsXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInNwYW5cIiwgeyBjbGFzc05hbWU6IHRoaXMucHJvcHMuY3NzQ2xhc3Nlcy5pY29uQWRkIH0pKSk7XG4gICAgICAgIHJldHVybiAodGhpcy5wcm9wcy5pc0VtcHR5U2VjdGlvbiA/IGFkZEJ1dHRvbiA6IGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLnByb3BzLmNzc0NsYXNzZXMuZm9vdGVyIH0sIGFkZEJ1dHRvbikpO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVF1ZXN0aW9uTWF0cml4RHluYW1pY0FkZEJ1dHRvbjtcbn0oUmVhY3RTdXJ2ZXlFbGVtZW50KSk7XG5cblJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJFbGVtZW50KFwic3YtbWF0cml4ZHluYW1pYy1hZGQtYnRuXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyZWFjdHF1ZXN0aW9uX21hdHJpeGR5bmFtaWNfU3VydmV5UXVlc3Rpb25NYXRyaXhEeW5hbWljQWRkQnV0dG9uLCBwcm9wcyk7XG59KTtcblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL2NvbXBvbmVudHMvcGFuZWxkeW5hbWljLWFjdGlvbnMvcGFuZWxkeW5hbWljLWFkZC1idG4udHN4XG52YXIgcGFuZWxkeW5hbWljX2FkZF9idG5fZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG52YXIgU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNBY3Rpb24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcGFuZWxkeW5hbWljX2FkZF9idG5fZXh0ZW5kcyhTdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY0FjdGlvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY0FjdGlvbihwcm9wcykge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY0FjdGlvbi5wcm90b3R5cGUsIFwiZGF0YVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuICh0aGlzLnByb3BzLml0ZW0gJiYgdGhpcy5wcm9wcy5pdGVtLmRhdGEpIHx8IHRoaXMucHJvcHMuZGF0YTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY0FjdGlvbi5wcm90b3R5cGUsIFwicXVlc3Rpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiAodGhpcy5wcm9wcy5pdGVtICYmIHRoaXMucHJvcHMuaXRlbS5kYXRhLnF1ZXN0aW9uKSB8fCB0aGlzLnByb3BzLmRhdGEucXVlc3Rpb247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNBY3Rpb247XG59KFJlYWN0U3VydmV5RWxlbWVudCkpO1xuXG52YXIgcGFuZWxkeW5hbWljX2FkZF9idG5fU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNBZGRCdXR0b24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcGFuZWxkeW5hbWljX2FkZF9idG5fZXh0ZW5kcyhTdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY0FkZEJ1dHRvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY0FkZEJ1dHRvbigpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmhhbmRsZUNsaWNrID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICBfdGhpcy5xdWVzdGlvbi5hZGRQYW5lbFVJKCk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNBZGRCdXR0b24ucHJvdG90eXBlLnJlbmRlckVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5xdWVzdGlvbi5jYW5BZGRQYW5lbClcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB2YXIgYnRuVGV4dCA9IHRoaXMucmVuZGVyTG9jU3RyaW5nKHRoaXMucXVlc3Rpb24ubG9jUGFuZWxBZGRUZXh0KTtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIiwgeyB0eXBlOiBcImJ1dHRvblwiLCBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uZ2V0QWRkQnV0dG9uQ3NzKCksIG9uQ2xpY2s6IHRoaXMuaGFuZGxlQ2xpY2sgfSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcInNwYW5cIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5idXR0b25BZGRUZXh0IH0sIGJ0blRleHQpKSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNBZGRCdXR0b247XG59KFN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljQWN0aW9uKSk7XG5cblJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJFbGVtZW50KFwic3YtcGFuZWxkeW5hbWljLWFkZC1idG5cIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChwYW5lbGR5bmFtaWNfYWRkX2J0bl9TdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY0FkZEJ1dHRvbiwgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9jb21wb25lbnRzL3BhbmVsZHluYW1pYy1hY3Rpb25zL3BhbmVsZHluYW1pYy1uZXh0LWJ0bi50c3hcbnZhciBwYW5lbGR5bmFtaWNfbmV4dF9idG5fZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG5cbnZhciBwYW5lbGR5bmFtaWNfbmV4dF9idG5fU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNOZXh0QnV0dG9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHBhbmVsZHluYW1pY19uZXh0X2J0bl9leHRlbmRzKFN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljTmV4dEJ1dHRvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY05leHRCdXR0b24oKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5oYW5kbGVDbGljayA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgX3RoaXMucXVlc3Rpb24uZ29Ub05leHRQYW5lbCgpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljTmV4dEJ1dHRvbi5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyB0aXRsZTogdGhpcy5xdWVzdGlvbi5wYW5lbE5leHRUZXh0LCBvbkNsaWNrOiB0aGlzLmhhbmRsZUNsaWNrLCBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uZ2V0TmV4dEJ1dHRvbkNzcygpIH0sXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoc3ZnX2ljb25fU3ZnSWNvbiwgeyBpY29uTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLnByb2dyZXNzQnRuSWNvbiwgc2l6ZTogXCJhdXRvXCIgfSkpKTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY05leHRCdXR0b247XG59KFN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljQWN0aW9uKSk7XG5cblJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJFbGVtZW50KFwic3YtcGFuZWxkeW5hbWljLW5leHQtYnRuXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQocGFuZWxkeW5hbWljX25leHRfYnRuX1N1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljTmV4dEJ1dHRvbiwgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9jb21wb25lbnRzL3BhbmVsZHluYW1pYy1hY3Rpb25zL3BhbmVsZHluYW1pYy1wcmV2LWJ0bi50c3hcbnZhciBwYW5lbGR5bmFtaWNfcHJldl9idG5fZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG5cbnZhciBwYW5lbGR5bmFtaWNfcHJldl9idG5fU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNQcmV2QnV0dG9uID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHBhbmVsZHluYW1pY19wcmV2X2J0bl9leHRlbmRzKFN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljUHJldkJ1dHRvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY1ByZXZCdXR0b24oKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5oYW5kbGVDbGljayA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgX3RoaXMucXVlc3Rpb24uZ29Ub1ByZXZQYW5lbCgpO1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljUHJldkJ1dHRvbi5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyB0aXRsZTogdGhpcy5xdWVzdGlvbi5wYW5lbFByZXZUZXh0LCBvbkNsaWNrOiB0aGlzLmhhbmRsZUNsaWNrLCBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uZ2V0UHJldkJ1dHRvbkNzcygpIH0sXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoc3ZnX2ljb25fU3ZnSWNvbiwgeyBpY29uTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLnByb2dyZXNzQnRuSWNvbiwgc2l6ZTogXCJhdXRvXCIgfSkpKTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY1ByZXZCdXR0b247XG59KFN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljQWN0aW9uKSk7XG5cblJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJFbGVtZW50KFwic3YtcGFuZWxkeW5hbWljLXByZXYtYnRuXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQocGFuZWxkeW5hbWljX3ByZXZfYnRuX1N1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljUHJldkJ1dHRvbiwgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9jb21wb25lbnRzL3BhbmVsZHluYW1pYy1hY3Rpb25zL3BhbmVsZHluYW1pYy1wcm9ncmVzcy10ZXh0LnRzeFxudmFyIHBhbmVsZHluYW1pY19wcm9ncmVzc190ZXh0X2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cblxudmFyIHBhbmVsZHluYW1pY19wcm9ncmVzc190ZXh0X1N1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljUHJvZ3Jlc3NUZXh0ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHBhbmVsZHluYW1pY19wcm9ncmVzc190ZXh0X2V4dGVuZHMoU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNQcm9ncmVzc1RleHQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNQcm9ncmVzc1RleHQoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNQcm9ncmVzc1RleHQucHJvdG90eXBlLnJlbmRlckVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMucHJvZ3Jlc3NUZXh0IH0sIHRoaXMucXVlc3Rpb24ucHJvZ3Jlc3NUZXh0KSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNQcm9ncmVzc1RleHQ7XG59KFN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljQWN0aW9uKSk7XG5cblJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJFbGVtZW50KFwic3YtcGFuZWxkeW5hbWljLXByb2dyZXNzLXRleHRcIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChwYW5lbGR5bmFtaWNfcHJvZ3Jlc3NfdGV4dF9TdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY1Byb2dyZXNzVGV4dCwgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9yZWFjdHF1ZXN0aW9uX3BhbmVsZHluYW1pYy50c3hcbnZhciByZWFjdHF1ZXN0aW9uX3BhbmVsZHluYW1pY19leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cblxuXG5cblxuXG5cbnZhciByZWFjdHF1ZXN0aW9uX3BhbmVsZHluYW1pY19TdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pYyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICByZWFjdHF1ZXN0aW9uX3BhbmVsZHluYW1pY19leHRlbmRzKFN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljKHByb3BzKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljLnByb3RvdHlwZSwgXCJxdWVzdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucXVlc3Rpb25CYXNlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWMucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBwYW5lbENvdW50ZXI6IDAgfSk7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdGhpcy5xdWVzdGlvbi5wYW5lbENvdW50Q2hhbmdlZENhbGxiYWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc2VsZi51cGRhdGVRdWVzdGlvblJlbmRlcmluZygpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLnF1ZXN0aW9uLmN1cnJlbnRJbmRleENoYW5nZWRDYWxsYmFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHNlbGYudXBkYXRlUXVlc3Rpb25SZW5kZXJpbmcoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5xdWVzdGlvbi5yZW5kZXJNb2RlQ2hhbmdlZENhbGxiYWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgc2VsZi51cGRhdGVRdWVzdGlvblJlbmRlcmluZygpO1xuICAgICAgICB9O1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWMucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMucXVlc3Rpb24ucGFuZWxDb3VudENoYW5nZWRDYWxsYmFjayA9IGZ1bmN0aW9uICgpIHsgfTtcbiAgICAgICAgdGhpcy5xdWVzdGlvbi5jdXJyZW50SW5kZXhDaGFuZ2VkQ2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7IH07XG4gICAgICAgIHRoaXMucXVlc3Rpb24ucmVuZGVyTW9kZUNoYW5nZWRDYWxsYmFjayA9IGZ1bmN0aW9uICgpIHsgfTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljLnByb3RvdHlwZS51cGRhdGVRdWVzdGlvblJlbmRlcmluZyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBwYW5lbENvdW50ZXI6IHRoaXMuc3RhdGUgPyB0aGlzLnN0YXRlLnBhbmVsQ291bnRlciArIDEgOiAxLFxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljLnByb3RvdHlwZS5yZW5kZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgcGFuZWxzID0gW107XG4gICAgICAgIHRoaXMucXVlc3Rpb24ucmVuZGVyZWRQYW5lbHMuZm9yRWFjaChmdW5jdGlvbiAocGFuZWwsIGluZGV4KSB7XG4gICAgICAgICAgICBwYW5lbHMucHVzaChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyZWFjdHF1ZXN0aW9uX3BhbmVsZHluYW1pY19TdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY0l0ZW0sIHsga2V5OiBwYW5lbC5pZCwgZWxlbWVudDogcGFuZWwsIHF1ZXN0aW9uOiBfdGhpcy5xdWVzdGlvbiwgaW5kZXg6IGluZGV4LCBjc3NDbGFzc2VzOiBfdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLCBpc0Rpc3BsYXlNb2RlOiBfdGhpcy5pc0Rpc3BsYXlNb2RlLCBjcmVhdG9yOiBfdGhpcy5jcmVhdG9yIH0pKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhciBidG5BZGQgPSB0aGlzLnF1ZXN0aW9uLmlzUmVuZGVyTW9kZUxpc3QgJiYgdGhpcy5xdWVzdGlvbltcInNob3dMZWdhY3lOYXZpZ2F0aW9uXCJdXG4gICAgICAgICAgICA/IHRoaXMucmVuZGVyQWRkUm93QnV0dG9uKClcbiAgICAgICAgICAgIDogbnVsbDtcbiAgICAgICAgdmFyIG5hdlRvcCA9IHRoaXMucXVlc3Rpb24uaXNQcm9ncmVzc1RvcFNob3dpbmdcbiAgICAgICAgICAgID8gdGhpcy5yZW5kZXJOYXZpZ2F0b3IoKVxuICAgICAgICAgICAgOiBudWxsO1xuICAgICAgICB2YXIgbmF2Qm90dG9tID0gdGhpcy5xdWVzdGlvbi5pc1Byb2dyZXNzQm90dG9tU2hvd2luZ1xuICAgICAgICAgICAgPyB0aGlzLnJlbmRlck5hdmlnYXRvcigpXG4gICAgICAgICAgICA6IG51bGw7XG4gICAgICAgIHZhciBuYXZWMiA9IHRoaXMucmVuZGVyTmF2aWdhdG9yVjIoKTtcbiAgICAgICAgdmFyIG5vRW50cmllc1BsYWNlaG9sZGVyID0gdGhpcy5yZW5kZXJQbGFjZWhvbGRlcigpO1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMucm9vdCB9LFxuICAgICAgICAgICAgbm9FbnRyaWVzUGxhY2Vob2xkZXIsXG4gICAgICAgICAgICBuYXZUb3AsXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLnBhbmVsc0NvbnRhaW5lciB9LCBwYW5lbHMpLFxuICAgICAgICAgICAgbmF2Qm90dG9tLFxuICAgICAgICAgICAgYnRuQWRkLFxuICAgICAgICAgICAgbmF2VjIpKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljLnByb3RvdHlwZS5yZW5kZXJOYXZpZ2F0b3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5xdWVzdGlvbltcInNob3dMZWdhY3lOYXZpZ2F0aW9uXCJdKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5xdWVzdGlvbi5pc1JhbmdlU2hvd2luZyAmJiB0aGlzLnF1ZXN0aW9uLmlzUHJvZ3Jlc3NUb3BTaG93aW5nKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyUmFuZ2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHZhciByYW5nZSA9IHRoaXMucXVlc3Rpb24uaXNSYW5nZVNob3dpbmcgPyB0aGlzLnJlbmRlclJhbmdlKCkgOiBudWxsO1xuICAgICAgICB2YXIgYnRuUHJldiA9IHRoaXMucmVuZHJlclByZXZCdXR0b24oKTtcbiAgICAgICAgdmFyIGJ0bk5leHQgPSB0aGlzLnJlbmRyZXJOZXh0QnV0dG9uKCk7XG4gICAgICAgIHZhciBidG5BZGQgPSB0aGlzLnJlbmRlckFkZFJvd0J1dHRvbigpO1xuICAgICAgICB2YXIgcHJvZ3Jlc3NDbGFzcyA9IHRoaXMucXVlc3Rpb24uaXNQcm9ncmVzc1RvcFNob3dpbmdcbiAgICAgICAgICAgID8gdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLnByb2dyZXNzVG9wXG4gICAgICAgICAgICA6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5wcm9ncmVzc0JvdHRvbTtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogcHJvZ3Jlc3NDbGFzcyB9LFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBzdHlsZTogeyBjbGVhcjogXCJib3RoXCIgfSB9LFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMucHJvZ3Jlc3NDb250YWluZXIgfSxcbiAgICAgICAgICAgICAgICAgICAgYnRuUHJldixcbiAgICAgICAgICAgICAgICAgICAgcmFuZ2UsXG4gICAgICAgICAgICAgICAgICAgIGJ0bk5leHQpLFxuICAgICAgICAgICAgICAgIGJ0bkFkZCxcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlclByb2dyZXNzVGV4dCgpKSkpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWMucHJvdG90eXBlLnJlbmRlclByb2dyZXNzVGV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShwYW5lbGR5bmFtaWNfcHJvZ3Jlc3NfdGV4dF9TdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY1Byb2dyZXNzVGV4dCwgeyBkYXRhOiB7IHF1ZXN0aW9uOiB0aGlzLnF1ZXN0aW9uIH0gfSkpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWMucHJvdG90eXBlLnJlbmRyZXJQcmV2QnV0dG9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHBhbmVsZHluYW1pY19wcmV2X2J0bl9TdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY1ByZXZCdXR0b24sIHsgZGF0YTogeyBxdWVzdGlvbjogdGhpcy5xdWVzdGlvbiB9IH0pKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljLnByb3RvdHlwZS5yZW5kcmVyTmV4dEJ1dHRvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShwYW5lbGR5bmFtaWNfbmV4dF9idG5fU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNOZXh0QnV0dG9uLCB7IGRhdGE6IHsgcXVlc3Rpb246IHRoaXMucXVlc3Rpb24gfSB9KSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pYy5wcm90b3R5cGUucmVuZGVyUmFuZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5wcm9ncmVzcyB9LFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5wcm9ncmVzc0Jhciwgc3R5bGU6IHsgd2lkdGg6IHRoaXMucXVlc3Rpb24ucHJvZ3Jlc3MgfSwgcm9sZTogXCJwcm9ncmVzc2JhclwiIH0pKSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pYy5wcm90b3R5cGUucmVuZGVyQWRkUm93QnV0dG9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5jcmVhdGVFbGVtZW50KFwic3YtcGFuZWxkeW5hbWljLWFkZC1idG5cIiwge1xuICAgICAgICAgICAgZGF0YTogeyBxdWVzdGlvbjogdGhpcy5xdWVzdGlvbiB9XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWMucHJvdG90eXBlLnJlbmRlck5hdmlnYXRvclYyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMucXVlc3Rpb24uc2hvd05hdmlnYXRpb24pXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgdmFyIHJhbmdlID0gdGhpcy5xdWVzdGlvbi5pc1JhbmdlU2hvd2luZyAmJiB0aGlzLnF1ZXN0aW9uLmlzUHJvZ3Jlc3NCb3R0b21TaG93aW5nID8gdGhpcy5yZW5kZXJSYW5nZSgpIDogbnVsbDtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmZvb3RlciB9LFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJoclwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLnNlcGFyYXRvciB9KSxcbiAgICAgICAgICAgIHJhbmdlLFxuICAgICAgICAgICAgdGhpcy5xdWVzdGlvbi5mb290ZXJUb29sYmFyLnZpc2libGVBY3Rpb25zLmxlbmd0aCA/IChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmZvb3RlckJ1dHRvbnNDb250YWluZXIgfSxcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShhY3Rpb25fYmFyX1N1cnZleUFjdGlvbkJhciwgeyBtb2RlbDogdGhpcy5xdWVzdGlvbi5mb290ZXJUb29sYmFyIH0pKSkgOiBudWxsKSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pYy5wcm90b3R5cGUucmVuZGVyUGxhY2Vob2xkZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICh0aGlzLnF1ZXN0aW9uLmdldFNob3dOb0VudHJpZXNQbGFjZWhvbGRlcigpKSB7XG4gICAgICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMubm9FbnRyaWVzUGxhY2Vob2xkZXIgfSxcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInNwYW5cIiwgbnVsbCwgdGhpcy5yZW5kZXJMb2NTdHJpbmcodGhpcy5xdWVzdGlvbi5sb2NOb0VudHJpZXNUZXh0KSksXG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJBZGRSb3dCdXR0b24oKSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljO1xufShyZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5UXVlc3Rpb25FbGVtZW50QmFzZSkpO1xuXG52YXIgcmVhY3RxdWVzdGlvbl9wYW5lbGR5bmFtaWNfU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNJdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJlYWN0cXVlc3Rpb25fcGFuZWxkeW5hbWljX2V4dGVuZHMoU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNJdGVtLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljSXRlbSgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNJdGVtLnByb3RvdHlwZSwgXCJxdWVzdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMucXVlc3Rpb247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNJdGVtLnByb3RvdHlwZSwgXCJpbmRleFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuaW5kZXg7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY0l0ZW0ucHJvdG90eXBlLmdldFN1cnZleSA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICEhdGhpcy5xdWVzdGlvbiA/IHRoaXMucXVlc3Rpb24uc3VydmV5IDogbnVsbDtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljSXRlbS5wcm90b3R5cGUuZ2V0Q3NzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc3VydmV5ID0gdGhpcy5nZXRTdXJ2ZXkoKTtcbiAgICAgICAgcmV0dXJuICEhc3VydmV5ID8gc3VydmV5LmdldENzcygpIDoge307XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY0l0ZW0ucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHBhbmVsID0gX3N1cGVyLnByb3RvdHlwZS5yZW5kZXIuY2FsbCh0aGlzKTtcbiAgICAgICAgdmFyIHJlbW92ZUJ1dHRvbiA9IHRoaXMucmVuZGVyQnV0dG9uKCk7XG4gICAgICAgIHZhciBzZXBhcmF0b3IgPSB0aGlzLnF1ZXN0aW9uLnNob3dTZXBhcmF0b3IodGhpcy5pbmRleCkgP1xuICAgICAgICAgICAgKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiaHJcIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5zZXBhcmF0b3IgfSkpIDogbnVsbDtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiRnJhZ21lbnRcIl0sIG51bGwsXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5nZXRQYW5lbFdyYXBwZXJDc3ModGhpcy5wYW5lbCkgfSxcbiAgICAgICAgICAgICAgICBwYW5lbCxcbiAgICAgICAgICAgICAgICByZW1vdmVCdXR0b24pLFxuICAgICAgICAgICAgc2VwYXJhdG9yKSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY0l0ZW0ucHJvdG90eXBlLnJlbmRlckJ1dHRvbiA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKHRoaXMucXVlc3Rpb24ucGFuZWxSZW1vdmVCdXR0b25Mb2NhdGlvbiAhPT0gXCJyaWdodFwiIHx8XG4gICAgICAgICAgICAhdGhpcy5xdWVzdGlvbi5jYW5SZW1vdmVQYW5lbCB8fFxuICAgICAgICAgICAgKHRoaXMucXVlc3Rpb24uaXNSZW5kZXJNb2RlTGlzdCAmJiB0aGlzLnBhbmVsLmlzQ29sbGFwc2VkKSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UuY3JlYXRlRWxlbWVudChcInN2LXBhbmVsZHluYW1pYy1yZW1vdmUtYnRuXCIsIHtcbiAgICAgICAgICAgIGRhdGE6IHsgcXVlc3Rpb246IHRoaXMucXVlc3Rpb24sIHBhbmVsOiB0aGlzLnBhbmVsIH1cbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNJdGVtO1xufShwYW5lbF9TdXJ2ZXlQYW5lbCkpO1xuXG5SZWFjdFF1ZXN0aW9uRmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlclF1ZXN0aW9uKFwicGFuZWxkeW5hbWljXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyZWFjdHF1ZXN0aW9uX3BhbmVsZHluYW1pY19TdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pYywgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9wcm9ncmVzcy50c3hcbnZhciBwcm9ncmVzc19leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cblxudmFyIHByb2dyZXNzX1N1cnZleVByb2dyZXNzID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHByb2dyZXNzX2V4dGVuZHMoU3VydmV5UHJvZ3Jlc3MsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UHJvZ3Jlc3MocHJvcHMpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UHJvZ3Jlc3MucHJvdG90eXBlLCBcImlzVG9wXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5pc1RvcDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlQcm9ncmVzcy5wcm90b3R5cGUsIFwicHJvZ3Jlc3NcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN1cnZleS5wcm9ncmVzc1ZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVByb2dyZXNzLnByb3RvdHlwZSwgXCJwcm9ncmVzc1RleHRcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnN1cnZleS5wcm9ncmVzc1RleHQ7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlQcm9ncmVzcy5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgcHJvZ3Jlc3NTdHlsZSA9IHtcbiAgICAgICAgICAgIHdpZHRoOiB0aGlzLnByb2dyZXNzICsgXCIlXCIsXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMuc3VydmV5LmdldFByb2dyZXNzQ3NzQ2xhc3Nlcyh0aGlzLnByb3BzLmNvbnRhaW5lcikgfSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgc3R5bGU6IHByb2dyZXNzU3R5bGUsIGNsYXNzTmFtZTogdGhpcy5jc3MucHJvZ3Jlc3NCYXIsIHJvbGU6IFwicHJvZ3Jlc3NiYXJcIiwgXCJhcmlhLXZhbHVlbWluXCI6IDAsIFwiYXJpYS12YWx1ZW1heFwiOiAxMDAsIFwiYXJpYS1sYWJlbFwiOiBcInByb2dyZXNzXCIgfSxcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInNwYW5cIiwgeyBjbGFzc05hbWU6IGV4dGVybmFsX3Jvb3RfU3VydmV5X2NvbW1vbmpzMl9zdXJ2ZXlfY29yZV9jb21tb25qc19zdXJ2ZXlfY29yZV9hbWRfc3VydmV5X2NvcmVfW1wiU3VydmV5UHJvZ3Jlc3NNb2RlbFwiXS5nZXRQcm9ncmVzc1RleHRJbkJhckNzcyh0aGlzLmNzcykgfSwgdGhpcy5wcm9ncmVzc1RleHQpKSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwic3BhblwiLCB7IGNsYXNzTmFtZTogZXh0ZXJuYWxfcm9vdF9TdXJ2ZXlfY29tbW9uanMyX3N1cnZleV9jb3JlX2NvbW1vbmpzX3N1cnZleV9jb3JlX2FtZF9zdXJ2ZXlfY29yZV9bXCJTdXJ2ZXlQcm9ncmVzc01vZGVsXCJdLmdldFByb2dyZXNzVGV4dFVuZGVyQmFyQ3NzKHRoaXMuY3NzKSB9LCB0aGlzLnByb2dyZXNzVGV4dCkpKTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlQcm9ncmVzcztcbn0oU3VydmV5TmF2aWdhdGlvbkJhc2UpKTtcblxuUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlckVsZW1lbnQoXCJzdi1wcm9ncmVzcy1wYWdlc1wiLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0ocHJvZ3Jlc3NfU3VydmV5UHJvZ3Jlc3MsIHByb3BzKTtcbn0pO1xuUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlckVsZW1lbnQoXCJzdi1wcm9ncmVzcy1xdWVzdGlvbnNcIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHByb2dyZXNzX1N1cnZleVByb2dyZXNzLCBwcm9wcyk7XG59KTtcblJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJFbGVtZW50KFwic3YtcHJvZ3Jlc3MtY29ycmVjdHF1ZXN0aW9uc1wiLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0ocHJvZ3Jlc3NfU3VydmV5UHJvZ3Jlc3MsIHByb3BzKTtcbn0pO1xuUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlckVsZW1lbnQoXCJzdi1wcm9ncmVzcy1yZXF1aXJlZHF1ZXN0aW9uc1wiLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0ocHJvZ3Jlc3NfU3VydmV5UHJvZ3Jlc3MsIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvcHJvZ3Jlc3NCdXR0b25zLnRzeFxudmFyIHByb2dyZXNzQnV0dG9uc19leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cblxuXG52YXIgcHJvZ3Jlc3NCdXR0b25zX1N1cnZleVByb2dyZXNzQnV0dG9ucyA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBwcm9ncmVzc0J1dHRvbnNfZXh0ZW5kcyhTdXJ2ZXlQcm9ncmVzc0J1dHRvbnMsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UHJvZ3Jlc3NCdXR0b25zKHByb3BzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5saXN0Q29udGFpbmVyUmVmID0gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZVJlZlwiXSgpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlQcm9ncmVzc0J1dHRvbnMucHJvdG90eXBlLCBcIm1vZGVsXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5tb2RlbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlQcm9ncmVzc0J1dHRvbnMucHJvdG90eXBlLCBcImNvbnRhaW5lclwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuY29udGFpbmVyO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3VydmV5UHJvZ3Jlc3NCdXR0b25zLnByb3RvdHlwZS5vblJlc2l6ZSA9IGZ1bmN0aW9uIChjYW5TaG93SXRlbVRpdGxlcykge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgY2FuU2hvd0l0ZW1UaXRsZXM6IGNhblNob3dJdGVtVGl0bGVzIH0pO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgY2FuU2hvd0hlYWRlcjogIWNhblNob3dJdGVtVGl0bGVzIH0pO1xuICAgIH07XG4gICAgU3VydmV5UHJvZ3Jlc3NCdXR0b25zLnByb3RvdHlwZS5vblVwZGF0ZVNjcm9sbGVyID0gZnVuY3Rpb24gKGhhc1Njcm9sbGVyKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBoYXNTY3JvbGxlcjogaGFzU2Nyb2xsZXIgfSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlQcm9ncmVzc0J1dHRvbnMucHJvdG90eXBlLm9uVXBkYXRlU2V0dGluZ3MgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBjYW5TaG93SXRlbVRpdGxlczogdGhpcy5tb2RlbC5zaG93SXRlbVRpdGxlcyB9KTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGNhblNob3dGb290ZXI6ICF0aGlzLm1vZGVsLnNob3dJdGVtVGl0bGVzIH0pO1xuICAgIH07XG4gICAgU3VydmV5UHJvZ3Jlc3NCdXR0b25zLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMubW9kZWwuZ2V0Um9vdENzcyh0aGlzLnByb3BzLmNvbnRhaW5lciksIHN0eWxlOiB7IFwibWF4V2lkdGhcIjogdGhpcy5tb2RlbC5wcm9ncmVzc1dpZHRoIH0sIHJvbGU6IFwicHJvZ3Jlc3NiYXJcIiwgXCJhcmlhLXZhbHVlbWluXCI6IDAsIFwiYXJpYS12YWx1ZW1heFwiOiAxMDAsIFwiYXJpYS1sYWJlbFwiOiBcInByb2dyZXNzXCIgfSxcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuY2FuU2hvd0hlYWRlciA/IGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLmNzcy5wcm9ncmVzc0J1dHRvbnNIZWFkZXIgfSxcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5jc3MucHJvZ3Jlc3NCdXR0b25zUGFnZVRpdGxlLCB0aXRsZTogdGhpcy5tb2RlbC5oZWFkZXJUZXh0IH0sIHRoaXMubW9kZWwuaGVhZGVyVGV4dCkpIDogbnVsbCxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLmNzcy5wcm9ncmVzc0J1dHRvbnNDb250YWluZXIgfSxcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5tb2RlbC5nZXRTY3JvbGxCdXR0b25Dc3ModGhpcy5zdGF0ZS5oYXNTY3JvbGxlciwgdHJ1ZSksIHJvbGU6IFwiYnV0dG9uXCIsIG9uQ2xpY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy5jbGlja1Njcm9sbEJ1dHRvbihfdGhpcy5saXN0Q29udGFpbmVyUmVmLmN1cnJlbnQsIHRydWUpO1xuICAgICAgICAgICAgICAgICAgICB9IH0pLFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLmNzcy5wcm9ncmVzc0J1dHRvbnNMaXN0Q29udGFpbmVyLCByZWY6IHRoaXMubGlzdENvbnRhaW5lclJlZiB9LFxuICAgICAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInVsXCIsIHsgY2xhc3NOYW1lOiB0aGlzLmNzcy5wcm9ncmVzc0J1dHRvbnNMaXN0IH0sIHRoaXMuZ2V0TGlzdEVsZW1lbnRzKCkpKSxcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5tb2RlbC5nZXRTY3JvbGxCdXR0b25Dc3ModGhpcy5zdGF0ZS5oYXNTY3JvbGxlciwgZmFsc2UpLCByb2xlOiBcImJ1dHRvblwiLCBvbkNsaWNrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuY2xpY2tTY3JvbGxCdXR0b24oX3RoaXMubGlzdENvbnRhaW5lclJlZi5jdXJyZW50LCBmYWxzZSk7XG4gICAgICAgICAgICAgICAgICAgIH0gfSkpLFxuICAgICAgICAgICAgdGhpcy5zdGF0ZS5jYW5TaG93Rm9vdGVyID8gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMuY3NzLnByb2dyZXNzQnV0dG9uc0Zvb3RlciB9LFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLmNzcy5wcm9ncmVzc0J1dHRvbnNQYWdlVGl0bGUsIHRpdGxlOiB0aGlzLm1vZGVsLmZvb3RlclRleHQgfSwgdGhpcy5tb2RlbC5mb290ZXJUZXh0KSkgOiBudWxsKSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlQcm9ncmVzc0J1dHRvbnMucHJvdG90eXBlLmdldExpc3RFbGVtZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGJ1dHRvbnMgPSBbXTtcbiAgICAgICAgdGhpcy5zdXJ2ZXkudmlzaWJsZVBhZ2VzLmZvckVhY2goZnVuY3Rpb24gKHBhZ2UsIGluZGV4KSB7XG4gICAgICAgICAgICBidXR0b25zLnB1c2goX3RoaXMucmVuZGVyTGlzdEVsZW1lbnQocGFnZSwgaW5kZXgpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBidXR0b25zO1xuICAgIH07XG4gICAgU3VydmV5UHJvZ3Jlc3NCdXR0b25zLnByb3RvdHlwZS5yZW5kZXJMaXN0RWxlbWVudCA9IGZ1bmN0aW9uIChwYWdlLCBpbmRleCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICB2YXIgdGV4dCA9IHJlYWN0cXVlc3Rpb25fZWxlbWVudF9TdXJ2ZXlFbGVtZW50QmFzZS5yZW5kZXJMb2NTdHJpbmcocGFnZS5sb2NOYXZpZ2F0aW9uVGl0bGUpO1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwibGlcIiwgeyBrZXk6IFwibGlzdGVsZW1lbnRcIiArIGluZGV4LCBjbGFzc05hbWU6IHRoaXMubW9kZWwuZ2V0TGlzdEVsZW1lbnRDc3MoaW5kZXgpLCBvbkNsaWNrOiB0aGlzLm1vZGVsLmlzTGlzdEVsZW1lbnRDbGlja2FibGUoaW5kZXgpXG4gICAgICAgICAgICAgICAgPyBmdW5jdGlvbiAoKSB7IHJldHVybiBfdGhpcy5tb2RlbC5jbGlja0xpc3RFbGVtZW50KHBhZ2UpOyB9XG4gICAgICAgICAgICAgICAgOiB1bmRlZmluZWQsIFwiZGF0YS1wYWdlLW51bWJlclwiOiB0aGlzLm1vZGVsLmdldEl0ZW1OdW1iZXIocGFnZSkgfSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLmNzcy5wcm9ncmVzc0J1dHRvbnNDb25uZWN0b3IgfSksXG4gICAgICAgICAgICB0aGlzLnN0YXRlLmNhblNob3dJdGVtVGl0bGVzID8gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcIkZyYWdtZW50XCJdLCBudWxsLFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLmNzcy5wcm9ncmVzc0J1dHRvbnNQYWdlVGl0bGUsIHRpdGxlOiBwYWdlLnJlbmRlcmVkTmF2aWdhdGlvblRpdGxlIH0sIHRleHQpLFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLmNzcy5wcm9ncmVzc0J1dHRvbnNQYWdlRGVzY3JpcHRpb24sIHRpdGxlOiBwYWdlLm5hdmlnYXRpb25EZXNjcmlwdGlvbiB9LCBwYWdlLm5hdmlnYXRpb25EZXNjcmlwdGlvbikpIDogbnVsbCxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLmNzcy5wcm9ncmVzc0J1dHRvbnNCdXR0b24gfSxcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5jc3MucHJvZ3Jlc3NCdXR0b25zQnV0dG9uQmFja2dyb3VuZCB9KSxcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5jc3MucHJvZ3Jlc3NCdXR0b25zQnV0dG9uQ29udGVudCB9KSxcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInNwYW5cIiwgbnVsbCwgdGhpcy5tb2RlbC5nZXRJdGVtTnVtYmVyKHBhZ2UpKSkpKTtcbiAgICB9O1xuICAgIFN1cnZleVByb2dyZXNzQnV0dG9ucy5wcm90b3R5cGUuY2xpY2tTY3JvbGxCdXR0b24gPSBmdW5jdGlvbiAobGlzdENvbnRhaW5lckVsZW1lbnQsIGlzTGVmdFNjcm9sbCkge1xuICAgICAgICBpZiAoISFsaXN0Q29udGFpbmVyRWxlbWVudCkge1xuICAgICAgICAgICAgbGlzdENvbnRhaW5lckVsZW1lbnQuc2Nyb2xsTGVmdCArPSAoaXNMZWZ0U2Nyb2xsID8gLTEgOiAxKSAqIDcwO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBTdXJ2ZXlQcm9ncmVzc0J1dHRvbnMucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50LmNhbGwodGhpcyk7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3RoaXMucmVzcE1hbmFnZXIgPSBuZXcgZXh0ZXJuYWxfcm9vdF9TdXJ2ZXlfY29tbW9uanMyX3N1cnZleV9jb3JlX2NvbW1vbmpzX3N1cnZleV9jb3JlX2FtZF9zdXJ2ZXlfY29yZV9bXCJQcm9ncmVzc0J1dHRvbnNSZXNwb25zaXZpdHlNYW5hZ2VyXCJdKF90aGlzLm1vZGVsLCBfdGhpcy5saXN0Q29udGFpbmVyUmVmLmN1cnJlbnQsIF90aGlzKTtcbiAgICAgICAgfSwgMTApO1xuICAgIH07XG4gICAgU3VydmV5UHJvZ3Jlc3NCdXR0b25zLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCEhdGhpcy5yZXNwTWFuYWdlcikge1xuICAgICAgICAgICAgdGhpcy5yZXNwTWFuYWdlci5kaXNwb3NlKCk7XG4gICAgICAgIH1cbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudC5jYWxsKHRoaXMpO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVByb2dyZXNzQnV0dG9ucztcbn0oU3VydmV5TmF2aWdhdGlvbkJhc2UpKTtcblxuUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlckVsZW1lbnQoXCJzdi1wcm9ncmVzcy1idXR0b25zXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShwcm9ncmVzc0J1dHRvbnNfU3VydmV5UHJvZ3Jlc3NCdXR0b25zLCBwcm9wcyk7XG59KTtcblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL2NvbXBvbmVudHMvbGlzdC9saXN0LWl0ZW0udHN4XG52YXIgbGlzdF9pdGVtX2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cblxuXG52YXIgbGlzdF9pdGVtX0xpc3RJdGVtID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIGxpc3RfaXRlbV9leHRlbmRzKExpc3RJdGVtLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIExpc3RJdGVtKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuaGFuZGxlS2V5ZG93biA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgX3RoaXMubW9kZWwub25LZXlEb3duKGV2ZW50KTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTGlzdEl0ZW0ucHJvdG90eXBlLCBcIm1vZGVsXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5tb2RlbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMaXN0SXRlbS5wcm90b3R5cGUsIFwiaXRlbVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuaXRlbTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIExpc3RJdGVtLnByb3RvdHlwZS5nZXRTdGF0ZUVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLml0ZW07XG4gICAgfTtcbiAgICBMaXN0SXRlbS5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIXRoaXMuaXRlbSlcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB2YXIgY29udGVudFdyYXBTdHlsZSA9IHtcbiAgICAgICAgICAgIHBhZGRpbmdJbmxpbmVTdGFydDogdGhpcy5tb2RlbC5nZXRJdGVtSW5kZW50KHRoaXMuaXRlbSlcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGNsYXNzTmFtZSA9IHRoaXMubW9kZWwuZ2V0SXRlbUNsYXNzKHRoaXMuaXRlbSk7XG4gICAgICAgIHZhciBpdGVtQ29udGVudCA9IHRoaXMuaXRlbS5jb21wb25lbnQgfHwgXCJzdi1saXN0LWl0ZW0tY29udGVudFwiO1xuICAgICAgICB2YXIgbmV3RWxlbWVudCA9IFJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UuY3JlYXRlRWxlbWVudChpdGVtQ29udGVudCwgeyBpdGVtOiB0aGlzLml0ZW0sIGtleTogdGhpcy5pdGVtLmlkLCBtb2RlbDogdGhpcy5tb2RlbCB9KTtcbiAgICAgICAgdmFyIGNvbnRlbnRXcmFwID0gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgc3R5bGU6IGNvbnRlbnRXcmFwU3R5bGUsIGNsYXNzTmFtZTogdGhpcy5tb2RlbC5jc3NDbGFzc2VzLml0ZW1Cb2R5LCB0aXRsZTogdGhpcy5pdGVtLmxvY1RpdGxlLmNhbGN1bGF0ZWRUZXh0LCBvbk1vdXNlT3ZlcjogZnVuY3Rpb24gKGV2ZW50KSB7IF90aGlzLm1vZGVsLm9uSXRlbUhvdmVyKF90aGlzLml0ZW0pOyB9LCBvbk1vdXNlTGVhdmU6IGZ1bmN0aW9uIChldmVudCkgeyBfdGhpcy5tb2RlbC5vbkl0ZW1MZWF2ZShfdGhpcy5pdGVtKTsgfSB9LCBuZXdFbGVtZW50KTtcbiAgICAgICAgdmFyIHNlcGFyYXRvciA9IHRoaXMuaXRlbS5uZWVkU2VwYXJhdG9yID8gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLm1vZGVsLmNzc0NsYXNzZXMuaXRlbVNlcGFyYXRvciB9KSA6IG51bGw7XG4gICAgICAgIHZhciBpc1Zpc2libGUgPSB0aGlzLm1vZGVsLmlzSXRlbVZpc2libGUodGhpcy5pdGVtKTtcbiAgICAgICAgdmFyIHN0eWxlID0ge1xuICAgICAgICAgICAgZGlzcGxheTogaXNWaXNpYmxlID8gbnVsbCA6IFwibm9uZVwiXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBhdHRhY2hLZXkyY2xpY2soZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwibGlcIiwgeyBjbGFzc05hbWU6IGNsYXNzTmFtZSwgcm9sZTogXCJvcHRpb25cIiwgc3R5bGU6IHN0eWxlLCBpZDogdGhpcy5pdGVtLmVsZW1lbnRJZCwgXCJhcmlhLXNlbGVjdGVkXCI6IHRoaXMubW9kZWwuaXNJdGVtU2VsZWN0ZWQodGhpcy5pdGVtKSwgb25DbGljazogZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgX3RoaXMubW9kZWwub25JdGVtQ2xpY2soX3RoaXMuaXRlbSk7XG4gICAgICAgICAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgICAgICB9LCBvblBvaW50ZXJEb3duOiBmdW5jdGlvbiAoZXZlbnQpIHsgcmV0dXJuIF90aGlzLm1vZGVsLm9uUG9pbnRlckRvd24oZXZlbnQsIF90aGlzLml0ZW0pOyB9IH0sXG4gICAgICAgICAgICBzZXBhcmF0b3IsXG4gICAgICAgICAgICBjb250ZW50V3JhcCksIHRoaXMuaXRlbSk7XG4gICAgfTtcbiAgICBMaXN0SXRlbS5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5tb2RlbC5vbkxhc3RJdGVtUmVuZGVkKHRoaXMuaXRlbSk7XG4gICAgfTtcbiAgICByZXR1cm4gTGlzdEl0ZW07XG59KHJlYWN0cXVlc3Rpb25fZWxlbWVudF9TdXJ2ZXlFbGVtZW50QmFzZSkpO1xuXG5SZWFjdEVsZW1lbnRGYWN0b3J5Lkluc3RhbmNlLnJlZ2lzdGVyRWxlbWVudChcInN2LWxpc3QtaXRlbVwiLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KGxpc3RfaXRlbV9MaXN0SXRlbSwgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9jb21wb25lbnRzL2xpc3QvbGlzdC50c3hcbnZhciBsaXN0X2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cblxuXG5cblxudmFyIGxpc3RfTGlzdCA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBsaXN0X2V4dGVuZHMoTGlzdCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBMaXN0KHByb3BzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5oYW5kbGVLZXlkb3duID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICBfdGhpcy5tb2RlbC5vbktleURvd24oZXZlbnQpO1xuICAgICAgICB9O1xuICAgICAgICBfdGhpcy5oYW5kbGVNb3VzZU1vdmUgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIF90aGlzLm1vZGVsLm9uTW91c2VNb3ZlKGV2ZW50KTtcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBmaWx0ZXJTdHJpbmc6IF90aGlzLm1vZGVsLmZpbHRlclN0cmluZyB8fCBcIlwiXG4gICAgICAgIH07XG4gICAgICAgIF90aGlzLmxpc3RDb250YWluZXJSZWYgPSBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZVJlZigpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMaXN0LnByb3RvdHlwZSwgXCJtb2RlbFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMubW9kZWw7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBMaXN0LnByb3RvdHlwZS5nZXRTdGF0ZUVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm1vZGVsO1xuICAgIH07XG4gICAgTGlzdC5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKCEhdGhpcy5saXN0Q29udGFpbmVyUmVmICYmICEhdGhpcy5saXN0Q29udGFpbmVyUmVmLmN1cnJlbnQpIHtcbiAgICAgICAgICAgIHRoaXMubW9kZWwuaW5pdExpc3RDb250YWluZXJIdG1sRWxlbWVudCh0aGlzLmxpc3RDb250YWluZXJSZWYuY3VycmVudCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIExpc3QucHJvdG90eXBlLmNvbXBvbmVudERpZFVwZGF0ZSA9IGZ1bmN0aW9uIChwcmV2UHJvcHMsIHByZXZTdGF0ZSkge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50RGlkVXBkYXRlLmNhbGwodGhpcywgcHJldlByb3BzLCBwcmV2U3RhdGUpO1xuICAgICAgICBpZiAodGhpcy5tb2RlbCAhPT0gcHJldlByb3BzLm1vZGVsKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5tb2RlbCAmJiAhISgoX2EgPSB0aGlzLmxpc3RDb250YWluZXJSZWYpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5jdXJyZW50KSkge1xuICAgICAgICAgICAgICAgIHRoaXMubW9kZWwuaW5pdExpc3RDb250YWluZXJIdG1sRWxlbWVudCh0aGlzLmxpc3RDb250YWluZXJSZWYuY3VycmVudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAocHJldlByb3BzLm1vZGVsKSB7XG4gICAgICAgICAgICAgICAgcHJldlByb3BzLm1vZGVsLmluaXRMaXN0Q29udGFpbmVySHRtbEVsZW1lbnQodW5kZWZpbmVkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG4gICAgTGlzdC5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQuY2FsbCh0aGlzKTtcbiAgICAgICAgaWYgKCEhdGhpcy5tb2RlbCkge1xuICAgICAgICAgICAgdGhpcy5tb2RlbC5pbml0TGlzdENvbnRhaW5lckh0bWxFbGVtZW50KHVuZGVmaW5lZCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIExpc3QucHJvdG90eXBlLnJlbmRlckVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLm1vZGVsLmNzc0NsYXNzZXMucm9vdCwgcmVmOiB0aGlzLmxpc3RDb250YWluZXJSZWYgfSxcbiAgICAgICAgICAgIHRoaXMuc2VhcmNoRWxlbWVudENvbnRlbnQoKSxcbiAgICAgICAgICAgIHRoaXMuZW1wdHlDb250ZW50KCksXG4gICAgICAgICAgICB0aGlzLnJlbmRlckxpc3QoKSkpO1xuICAgIH07XG4gICAgTGlzdC5wcm90b3R5cGUucmVuZGVyTGlzdCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLm1vZGVsLnJlbmRlckVsZW1lbnRzKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIHZhciBpdGVtcyA9IHRoaXMucmVuZGVySXRlbXMoKTtcbiAgICAgICAgdmFyIHVsU3R5bGUgPSB7IGRpc3BsYXk6IHRoaXMubW9kZWwuaXNFbXB0eSA/IFwibm9uZVwiIDogbnVsbCB9O1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcInVsXCIsIHsgY2xhc3NOYW1lOiB0aGlzLm1vZGVsLmdldExpc3RDbGFzcygpLCBzdHlsZTogdWxTdHlsZSwgcm9sZTogXCJsaXN0Ym94XCIsIGlkOiB0aGlzLm1vZGVsLmVsZW1lbnRJZCwgb25Nb3VzZURvd246IGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfSwgb25LZXlEb3duOiB0aGlzLmhhbmRsZUtleWRvd24sIG9uTW91c2VNb3ZlOiB0aGlzLmhhbmRsZU1vdXNlTW92ZSB9LCBpdGVtcykpO1xuICAgIH07XG4gICAgTGlzdC5wcm90b3R5cGUucmVuZGVySXRlbXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghdGhpcy5tb2RlbCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIGl0ZW1zID0gdGhpcy5tb2RlbC5yZW5kZXJlZEFjdGlvbnM7XG4gICAgICAgIGlmICghaXRlbXMpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpdGVtcy5tYXAoZnVuY3Rpb24gKGl0ZW0sIGl0ZW1JbmRleCkge1xuICAgICAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQobGlzdF9pdGVtX0xpc3RJdGVtLCB7IG1vZGVsOiBfdGhpcy5tb2RlbCwgaXRlbTogaXRlbSwga2V5OiBcIml0ZW1cIiArIGl0ZW1JbmRleCB9KSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgTGlzdC5wcm90b3R5cGUuc2VhcmNoRWxlbWVudENvbnRlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIGlmICghdGhpcy5tb2RlbC5zaG93RmlsdGVyKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdmFyIG9uQ2hhbmdlID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICB2YXIgcm9vdCA9IGV4dGVybmFsX3Jvb3RfU3VydmV5X2NvbW1vbmpzMl9zdXJ2ZXlfY29yZV9jb21tb25qc19zdXJ2ZXlfY29yZV9hbWRfc3VydmV5X2NvcmVfW1wic2V0dGluZ3NcIl0uZW52aXJvbm1lbnQucm9vdDtcbiAgICAgICAgICAgICAgICBpZiAoZS50YXJnZXQgPT09IHJvb3QuYWN0aXZlRWxlbWVudCkge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5tb2RlbC5maWx0ZXJTdHJpbmcgPSBlLnRhcmdldC52YWx1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdmFyIG9uS2V5VXAgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIF90aGlzLm1vZGVsLmdvVG9JdGVtcyhlKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2YXIgY2xlYXJCdXR0b24gPSB0aGlzLm1vZGVsLnNob3dTZWFyY2hDbGVhckJ1dHRvbiAmJiAhIXRoaXMubW9kZWwuZmlsdGVyU3RyaW5nID9cbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIiwgeyBjbGFzc05hbWU6IHRoaXMubW9kZWwuY3NzQ2xhc3Nlcy5zZWFyY2hDbGVhckJ1dHRvbkljb24sIG9uQ2xpY2s6IGZ1bmN0aW9uIChldmVudCkgeyBfdGhpcy5tb2RlbC5vbkNsaWNrU2VhcmNoQ2xlYXJCdXR0b24oZXZlbnQpOyB9IH0sXG4gICAgICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChzdmdfaWNvbl9TdmdJY29uLCB7IGljb25OYW1lOiBcImljb24tc2VhcmNoY2xlYXJcIiwgc2l6ZTogXCJhdXRvXCIgfSkpIDogbnVsbDtcbiAgICAgICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLm1vZGVsLmNzc0NsYXNzZXMuZmlsdGVyIH0sXG4gICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLm1vZGVsLmNzc0NsYXNzZXMuZmlsdGVySWNvbiB9LFxuICAgICAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoc3ZnX2ljb25fU3ZnSWNvbiwgeyBpY29uTmFtZTogXCJpY29uLXNlYXJjaFwiLCBzaXplOiBcImF1dG9cIiB9KSksXG4gICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIiwgeyB0eXBlOiBcInRleHRcIiwgY2xhc3NOYW1lOiB0aGlzLm1vZGVsLmNzc0NsYXNzZXMuZmlsdGVySW5wdXQsIFwiYXJpYS1sYWJlbFwiOiB0aGlzLm1vZGVsLmZpbHRlclN0cmluZ1BsYWNlaG9sZGVyLCBwbGFjZWhvbGRlcjogdGhpcy5tb2RlbC5maWx0ZXJTdHJpbmdQbGFjZWhvbGRlciwgdmFsdWU6IHRoaXMuc3RhdGUuZmlsdGVyU3RyaW5nLCBvbktleVVwOiBvbktleVVwLCBvbkNoYW5nZTogb25DaGFuZ2UgfSksXG4gICAgICAgICAgICAgICAgY2xlYXJCdXR0b24pKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgTGlzdC5wcm90b3R5cGUuZW1wdHlDb250ZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc3R5bGUgPSB7IGRpc3BsYXk6IHRoaXMubW9kZWwuaXNFbXB0eSA/IG51bGwgOiBcIm5vbmVcIiB9O1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5tb2RlbC5jc3NDbGFzc2VzLmVtcHR5Q29udGFpbmVyLCBzdHlsZTogc3R5bGUgfSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5tb2RlbC5jc3NDbGFzc2VzLmVtcHR5VGV4dCwgXCJhcmlhLWxhYmVsXCI6IHRoaXMubW9kZWwuZW1wdHlNZXNzYWdlIH0sIHRoaXMubW9kZWwuZW1wdHlNZXNzYWdlKSkpO1xuICAgIH07XG4gICAgcmV0dXJuIExpc3Q7XG59KHJlYWN0cXVlc3Rpb25fZWxlbWVudF9TdXJ2ZXlFbGVtZW50QmFzZSkpO1xuXG5SZWFjdEVsZW1lbnRGYWN0b3J5Lkluc3RhbmNlLnJlZ2lzdGVyRWxlbWVudChcInN2LWxpc3RcIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChsaXN0X0xpc3QsIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvcHJvZ3Jlc3NUb2MudHN4XG52YXIgcHJvZ3Jlc3NUb2NfZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG5cblxuXG52YXIgcHJvZ3Jlc3NUb2NfU3VydmV5UHJvZ3Jlc3NUb2MgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcHJvZ3Jlc3NUb2NfZXh0ZW5kcyhTdXJ2ZXlQcm9ncmVzc1RvYywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlQcm9ncmVzc1RvYygpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTdXJ2ZXlQcm9ncmVzc1RvYy5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgdG9jTW9kZWwgPSB0aGlzLnByb3BzLm1vZGVsO1xuICAgICAgICB2YXIgY29udGVudDtcbiAgICAgICAgaWYgKHRvY01vZGVsLmlzTW9iaWxlKSB7XG4gICAgICAgICAgICBjb250ZW50ID0gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBvbkNsaWNrOiB0b2NNb2RlbC50b2dnbGVQb3B1cCB9LFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHN2Z19pY29uX1N2Z0ljb24sIHsgaWNvbk5hbWU6IHRvY01vZGVsLmljb24sIHNpemU6IDI0IH0pLFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHBvcHVwX1BvcHVwLCB7IG1vZGVsOiB0b2NNb2RlbC5wb3B1cE1vZGVsIH0pKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnRlbnQgPSBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShsaXN0X0xpc3QsIHsgbW9kZWw6IHRvY01vZGVsLmxpc3RNb2RlbCB9KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0b2NNb2RlbC5jb250YWluZXJDc3MgfSwgY29udGVudCkpO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVByb2dyZXNzVG9jO1xufShTdXJ2ZXlOYXZpZ2F0aW9uQmFzZSkpO1xuXG5SZWFjdEVsZW1lbnRGYWN0b3J5Lkluc3RhbmNlLnJlZ2lzdGVyRWxlbWVudChcInN2LW5hdmlnYXRpb24tdG9jXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShwcm9ncmVzc1RvY19TdXJ2ZXlQcm9ncmVzc1RvYywgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9yZWFjdHF1ZXN0aW9uX3JhdGluZy50c3hcbnZhciByZWFjdHF1ZXN0aW9uX3JhdGluZ19leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cblxudmFyIHJlYWN0cXVlc3Rpb25fcmF0aW5nX1N1cnZleVF1ZXN0aW9uUmF0aW5nID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJlYWN0cXVlc3Rpb25fcmF0aW5nX2V4dGVuZHMoU3VydmV5UXVlc3Rpb25SYXRpbmcsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UXVlc3Rpb25SYXRpbmcocHJvcHMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmhhbmRsZU9uQ2xpY2sgPSBfdGhpcy5oYW5kbGVPbkNsaWNrLmJpbmQoX3RoaXMpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvblJhdGluZy5wcm90b3R5cGUsIFwicXVlc3Rpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnF1ZXN0aW9uQmFzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleVF1ZXN0aW9uUmF0aW5nLnByb3RvdHlwZS5oYW5kbGVPbkNsaWNrID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHRoaXMucXVlc3Rpb24uc2V0VmFsdWVGcm9tQ2xpY2soZXZlbnQudGFyZ2V0LnZhbHVlKTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHZhbHVlOiB0aGlzLnF1ZXN0aW9uLnZhbHVlIH0pO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25SYXRpbmcucHJvdG90eXBlLnJlbmRlckl0ZW0gPSBmdW5jdGlvbiAoaXRlbSwgaW5kZXgpIHtcbiAgICAgICAgdmFyIHJlbmRlcmVkSXRlbSA9IFJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UuY3JlYXRlRWxlbWVudCh0aGlzLnF1ZXN0aW9uLml0ZW1Db21wb25lbnQsIHtcbiAgICAgICAgICAgIHF1ZXN0aW9uOiB0aGlzLnF1ZXN0aW9uLFxuICAgICAgICAgICAgaXRlbTogaXRlbSxcbiAgICAgICAgICAgIGluZGV4OiBpbmRleCxcbiAgICAgICAgICAgIGtleTogXCJ2YWx1ZVwiICsgaW5kZXgsXG4gICAgICAgICAgICBoYW5kbGVPbkNsaWNrOiB0aGlzLmhhbmRsZU9uQ2xpY2ssXG4gICAgICAgICAgICBpc0Rpc3BsYXlNb2RlOiB0aGlzLmlzRGlzcGxheU1vZGVcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiByZW5kZXJlZEl0ZW07XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvblJhdGluZy5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGNzc0NsYXNzZXMgPSB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXM7XG4gICAgICAgIHZhciBtaW5UZXh0ID0gdGhpcy5xdWVzdGlvbi5taW5SYXRlRGVzY3JpcHRpb25cbiAgICAgICAgICAgID8gdGhpcy5yZW5kZXJMb2NTdHJpbmcodGhpcy5xdWVzdGlvbi5sb2NNaW5SYXRlRGVzY3JpcHRpb24pXG4gICAgICAgICAgICA6IG51bGw7XG4gICAgICAgIHZhciBtYXhUZXh0ID0gdGhpcy5xdWVzdGlvbi5tYXhSYXRlRGVzY3JpcHRpb25cbiAgICAgICAgICAgID8gdGhpcy5yZW5kZXJMb2NTdHJpbmcodGhpcy5xdWVzdGlvbi5sb2NNYXhSYXRlRGVzY3JpcHRpb24pXG4gICAgICAgICAgICA6IG51bGw7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24ucmF0aW5nUm9vdENzcywgcmVmOiBmdW5jdGlvbiAoZGl2KSB7IHJldHVybiAoX3RoaXMuc2V0Q29udHJvbChkaXYpKTsgfSB9LFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJmaWVsZHNldFwiLCB7IHJvbGU6IFwicmFkaW9ncm91cFwiIH0sXG4gICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJsZWdlbmRcIiwgeyByb2xlOiBcInByZXNlbnRhdGlvblwiLCBjbGFzc05hbWU6IFwic3YtaGlkZGVuXCIgfSksXG4gICAgICAgICAgICAgICAgISF0aGlzLnF1ZXN0aW9uLmhhc01pbkxhYmVsID8gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJzcGFuXCIsIHsgY2xhc3NOYW1lOiBjc3NDbGFzc2VzLm1pblRleHQgfSwgbWluVGV4dCkgOiBudWxsLFxuICAgICAgICAgICAgICAgIHRoaXMucXVlc3Rpb24ucmVuZGVyZWRSYXRlSXRlbXMubWFwKGZ1bmN0aW9uIChpdGVtLCBpbmRleCkgeyByZXR1cm4gX3RoaXMucmVuZGVySXRlbShpdGVtLCBpbmRleCk7IH0pLFxuICAgICAgICAgICAgICAgICEhdGhpcy5xdWVzdGlvbi5oYXNNYXhMYWJlbCA/IGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwic3BhblwiLCB7IGNsYXNzTmFtZTogY3NzQ2xhc3Nlcy5tYXhUZXh0IH0sIG1heFRleHQpIDogbnVsbCkpKTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvblJhdGluZztcbn0ocmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleVF1ZXN0aW9uRWxlbWVudEJhc2UpKTtcblxuUmVhY3RRdWVzdGlvbkZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJRdWVzdGlvbihcInJhdGluZ1wiLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0ocmVhY3RxdWVzdGlvbl9yYXRpbmdfU3VydmV5UXVlc3Rpb25SYXRpbmcsIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvcmF0aW5nLWRyb3Bkb3duLnRzeFxudmFyIHJhdGluZ19kcm9wZG93bl9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cblxuXG52YXIgcmF0aW5nX2Ryb3Bkb3duX1N1cnZleVF1ZXN0aW9uUmF0aW5nRHJvcGRvd24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcmF0aW5nX2Ryb3Bkb3duX2V4dGVuZHMoU3VydmV5UXVlc3Rpb25SYXRpbmdEcm9wZG93biwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlRdWVzdGlvblJhdGluZ0Ryb3Bkb3duKHByb3BzKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICB9XG4gICAgU3VydmV5UXVlc3Rpb25SYXRpbmdEcm9wZG93bi5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGNzc0NsYXNzZXMgPSB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXM7XG4gICAgICAgIHZhciBzZWxlY3QgPSB0aGlzLnJlbmRlclNlbGVjdChjc3NDbGFzc2VzKTtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLnJvb3REcm9wZG93biB9LCBzZWxlY3QpKTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvblJhdGluZ0Ryb3Bkb3duO1xufShkcm9wZG93bl9iYXNlX1N1cnZleVF1ZXN0aW9uRHJvcGRvd25CYXNlKSk7XG5cblJlYWN0UXVlc3Rpb25GYWN0b3J5Lkluc3RhbmNlLnJlZ2lzdGVyUXVlc3Rpb24oXCJzdi1yYXRpbmctZHJvcGRvd25cIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHJhdGluZ19kcm9wZG93bl9TdXJ2ZXlRdWVzdGlvblJhdGluZ0Ryb3Bkb3duLCBwcm9wcyk7XG59KTtcbmV4dGVybmFsX3Jvb3RfU3VydmV5X2NvbW1vbmpzMl9zdXJ2ZXlfY29yZV9jb21tb25qc19zdXJ2ZXlfY29yZV9hbWRfc3VydmV5X2NvcmVfW1wiUmVuZGVyZXJGYWN0b3J5XCJdLkluc3RhbmNlLnJlZ2lzdGVyUmVuZGVyZXIoXCJyYXRpbmdcIiwgXCJkcm9wZG93blwiLCBcInN2LXJhdGluZy1kcm9wZG93blwiKTtcblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL3JlYWN0cXVlc3Rpb25fZXhwcmVzc2lvbi50c3hcbnZhciByZWFjdHF1ZXN0aW9uX2V4cHJlc3Npb25fZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG52YXIgcmVhY3RxdWVzdGlvbl9leHByZXNzaW9uX1N1cnZleVF1ZXN0aW9uRXhwcmVzc2lvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICByZWFjdHF1ZXN0aW9uX2V4cHJlc3Npb25fZXh0ZW5kcyhTdXJ2ZXlRdWVzdGlvbkV4cHJlc3Npb24sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UXVlc3Rpb25FeHByZXNzaW9uKHByb3BzKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uRXhwcmVzc2lvbi5wcm90b3R5cGUsIFwicXVlc3Rpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnF1ZXN0aW9uQmFzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleVF1ZXN0aW9uRXhwcmVzc2lvbi5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGNzc0NsYXNzZXMgPSB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXM7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBpZDogdGhpcy5xdWVzdGlvbi5pbnB1dElkLCBjbGFzc05hbWU6IGNzc0NsYXNzZXMucm9vdCwgcmVmOiBmdW5jdGlvbiAoZGl2KSB7IHJldHVybiAoX3RoaXMuc2V0Q29udHJvbChkaXYpKTsgfSB9LCB0aGlzLnF1ZXN0aW9uLmZvcm1hdGVkVmFsdWUpKTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvbkV4cHJlc3Npb247XG59KHJlYWN0cXVlc3Rpb25fZWxlbWVudF9TdXJ2ZXlRdWVzdGlvbkVsZW1lbnRCYXNlKSk7XG5cblJlYWN0UXVlc3Rpb25GYWN0b3J5Lkluc3RhbmNlLnJlZ2lzdGVyUXVlc3Rpb24oXCJleHByZXNzaW9uXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyZWFjdHF1ZXN0aW9uX2V4cHJlc3Npb25fU3VydmV5UXVlc3Rpb25FeHByZXNzaW9uLCBwcm9wcyk7XG59KTtcblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL3JlYWN0LXBvcHVwLXN1cnZleS50c3hcbnZhciByZWFjdF9wb3B1cF9zdXJ2ZXlfZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG5cbnZhciByZWFjdF9wb3B1cF9zdXJ2ZXlfUG9wdXBTdXJ2ZXkgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcmVhY3RfcG9wdXBfc3VydmV5X2V4dGVuZHMoUG9wdXBTdXJ2ZXksIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gUG9wdXBTdXJ2ZXkocHJvcHMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmhhbmRsZU9uRXhwYW5kZWQgPSBfdGhpcy5oYW5kbGVPbkV4cGFuZGVkLmJpbmQoX3RoaXMpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIFBvcHVwU3VydmV5LnByb3RvdHlwZS5nZXRTdGF0ZUVsZW1lbnRzID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gW3RoaXMucG9wdXAsIHRoaXMucG9wdXAuc3VydmV5XTtcbiAgICB9O1xuICAgIFBvcHVwU3VydmV5LnByb3RvdHlwZS5oYW5kbGVPbkV4cGFuZGVkID0gZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHRoaXMucG9wdXAuY2hhbmdlRXhwYW5kQ29sbGFwc2UoKTtcbiAgICB9O1xuICAgIFBvcHVwU3VydmV5LnByb3RvdHlwZS5jYW5SZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIucHJvdG90eXBlLmNhblJlbmRlci5jYWxsKHRoaXMpICYmIHRoaXMucG9wdXAuaXNTaG93aW5nO1xuICAgIH07XG4gICAgUG9wdXBTdXJ2ZXkucHJvdG90eXBlLnJlbmRlckVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBoZWFkZXIgPSB0aGlzLnJlbmRlcldpbmRvd0hlYWRlcigpO1xuICAgICAgICB2YXIgYm9keSA9IHRoaXMucmVuZGVyQm9keSgpO1xuICAgICAgICB2YXIgc3R5bGUgPSB7fTtcbiAgICAgICAgaWYgKCEhdGhpcy5wb3B1cC5yZW5kZXJlZFdpZHRoKSB7XG4gICAgICAgICAgICBzdHlsZS53aWR0aCA9IHRoaXMucG9wdXAucmVuZGVyZWRXaWR0aDtcbiAgICAgICAgICAgIHN0eWxlLm1heFdpZHRoID0gdGhpcy5wb3B1cC5yZW5kZXJlZFdpZHRoO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMucG9wdXAuY3NzUm9vdCwgc3R5bGU6IHN0eWxlLCBvblNjcm9sbDogZnVuY3Rpb24gKCkgeyByZXR1cm4gX3RoaXMucG9wdXAub25TY3JvbGwoKTsgfSB9LFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMucG9wdXAuY3NzUm9vdENvbnRlbnQgfSxcbiAgICAgICAgICAgICAgICBoZWFkZXIsXG4gICAgICAgICAgICAgICAgYm9keSkpKTtcbiAgICB9O1xuICAgIFBvcHVwU3VydmV5LnByb3RvdHlwZS5yZW5kZXJXaW5kb3dIZWFkZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBwb3B1cCA9IHRoaXMucG9wdXA7XG4gICAgICAgIHZhciBoZWFkZXJDc3MgPSBwb3B1cC5jc3NIZWFkZXJSb290O1xuICAgICAgICB2YXIgdGl0bGVDb2xsYXBzZWQgPSBudWxsO1xuICAgICAgICB2YXIgZXhwYW5kQ29sbGFwc2VJY29uO1xuICAgICAgICB2YXIgY2xvc2VCdXR0b24gPSBudWxsO1xuICAgICAgICB2YXIgYWxsb3dGdWxsU2NyZWVuQnV0b24gPSBudWxsO1xuICAgICAgICBpZiAocG9wdXAuaXNDb2xsYXBzZWQpIHtcbiAgICAgICAgICAgIGhlYWRlckNzcyArPSBcIiBcIiArIHBvcHVwLmNzc1Jvb3RDb2xsYXBzZWRNb2Q7XG4gICAgICAgICAgICB0aXRsZUNvbGxhcHNlZCA9IHRoaXMucmVuZGVyVGl0bGVDb2xsYXBzZWQocG9wdXApO1xuICAgICAgICAgICAgZXhwYW5kQ29sbGFwc2VJY29uID0gdGhpcy5yZW5kZXJFeHBhbmRJY29uKCk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBleHBhbmRDb2xsYXBzZUljb24gPSB0aGlzLnJlbmRlckNvbGxhcHNlSWNvbigpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwb3B1cC5hbGxvd0Nsb3NlKSB7XG4gICAgICAgICAgICBjbG9zZUJ1dHRvbiA9IHRoaXMucmVuZGVyQ2xvc2VCdXR0b24odGhpcy5wb3B1cCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBvcHVwLmFsbG93RnVsbFNjcmVlbikge1xuICAgICAgICAgICAgYWxsb3dGdWxsU2NyZWVuQnV0b24gPSB0aGlzLnJlbmRlckFsbG93RnVsbFNjcmVlbkJ1dG9uKHRoaXMucG9wdXApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHBvcHVwLmNzc0hlYWRlclJvb3QgfSxcbiAgICAgICAgICAgIHRpdGxlQ29sbGFwc2VkLFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IHBvcHVwLmNzc0hlYWRlckJ1dHRvbnNDb250YWluZXIgfSxcbiAgICAgICAgICAgICAgICBhbGxvd0Z1bGxTY3JlZW5CdXRvbixcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogcG9wdXAuY3NzSGVhZGVyQ29sbGFwc2VCdXR0b24sIG9uQ2xpY2s6IHRoaXMuaGFuZGxlT25FeHBhbmRlZCB9LCBleHBhbmRDb2xsYXBzZUljb24pLFxuICAgICAgICAgICAgICAgIGNsb3NlQnV0dG9uKSkpO1xuICAgIH07XG4gICAgUG9wdXBTdXJ2ZXkucHJvdG90eXBlLnJlbmRlclRpdGxlQ29sbGFwc2VkID0gZnVuY3Rpb24gKHBvcHVwKSB7XG4gICAgICAgIGlmICghcG9wdXAubG9jVGl0bGUpXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBwb3B1cC5jc3NIZWFkZXJUaXRsZUNvbGxhcHNlZCB9LCBwb3B1cC5sb2NUaXRsZS5yZW5kZXJlZEh0bWwpO1xuICAgIH07XG4gICAgUG9wdXBTdXJ2ZXkucHJvdG90eXBlLnJlbmRlckV4cGFuZEljb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShzdmdfaWNvbl9TdmdJY29uLCB7IGljb25OYW1lOiBcImljb24tcmVzdG9yZV8xNngxNlwiLCBzaXplOiAxNiB9KTtcbiAgICB9O1xuICAgIFBvcHVwU3VydmV5LnByb3RvdHlwZS5yZW5kZXJDb2xsYXBzZUljb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShzdmdfaWNvbl9TdmdJY29uLCB7IGljb25OYW1lOiBcImljb24tbWluaW1pemVfMTZ4MTZcIiwgc2l6ZTogMTYgfSk7XG4gICAgfTtcbiAgICBQb3B1cFN1cnZleS5wcm90b3R5cGUucmVuZGVyQ2xvc2VCdXR0b24gPSBmdW5jdGlvbiAocG9wdXApIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogcG9wdXAuY3NzSGVhZGVyQ2xvc2VCdXR0b24sIG9uQ2xpY2s6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBwb3B1cC5oaWRlKCk7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBfdGhpcy5wcm9wcy5vbkNsb3NlID09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgICAgICAgICAgICBfdGhpcy5wcm9wcy5vbkNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSB9LFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oc3ZnX2ljb25fU3ZnSWNvbiwgeyBpY29uTmFtZTogXCJpY29uLWNsb3NlXzE2eDE2XCIsIHNpemU6IDE2IH0pKSk7XG4gICAgfTtcbiAgICBQb3B1cFN1cnZleS5wcm90b3R5cGUucmVuZGVyQWxsb3dGdWxsU2NyZWVuQnV0b24gPSBmdW5jdGlvbiAocG9wdXApIHtcbiAgICAgICAgdmFyIEljb247XG4gICAgICAgIGlmIChwb3B1cC5pc0Z1bGxTY3JlZW4pIHtcbiAgICAgICAgICAgIEljb24gPSBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShzdmdfaWNvbl9TdmdJY29uLCB7IGljb25OYW1lOiBcImljb24tYmFjay10by1wYW5lbF8xNngxNlwiLCBzaXplOiAxNiB9KTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIEljb24gPSBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShzdmdfaWNvbl9TdmdJY29uLCB7IGljb25OYW1lOiBcImljb24tZnVsbC1zY3JlZW5fMTZ4MTZcIiwgc2l6ZTogMTYgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogcG9wdXAuY3NzSGVhZGVyRnVsbFNjcmVlbkJ1dHRvbiwgb25DbGljazogZnVuY3Rpb24gKCkgeyBwb3B1cC50b2dnbGVGdWxsU2NyZWVuKCk7IH0gfSwgSWNvbikpO1xuICAgIH07XG4gICAgUG9wdXBTdXJ2ZXkucHJvdG90eXBlLnJlbmRlckJvZHkgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5wb3B1cC5jc3NCb2R5IH0sIHRoaXMuZG9SZW5kZXIoKSk7XG4gICAgfTtcbiAgICBQb3B1cFN1cnZleS5wcm90b3R5cGUuY3JlYXRlU3VydmV5ID0gZnVuY3Rpb24gKG5ld1Byb3BzKSB7XG4gICAgICAgIGlmICghbmV3UHJvcHMpXG4gICAgICAgICAgICBuZXdQcm9wcyA9IHt9O1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNyZWF0ZVN1cnZleS5jYWxsKHRoaXMsIG5ld1Byb3BzKTtcbiAgICAgICAgdGhpcy5wb3B1cCA9IG5ldyBleHRlcm5hbF9yb290X1N1cnZleV9jb21tb25qczJfc3VydmV5X2NvcmVfY29tbW9uanNfc3VydmV5X2NvcmVfYW1kX3N1cnZleV9jb3JlX1tcIlBvcHVwU3VydmV5TW9kZWxcIl0obnVsbCwgdGhpcy5zdXJ2ZXkpO1xuICAgICAgICBpZiAobmV3UHJvcHMuY2xvc2VPbkNvbXBsZXRlVGltZW91dCkge1xuICAgICAgICAgICAgdGhpcy5wb3B1cC5jbG9zZU9uQ29tcGxldGVUaW1lb3V0ID0gbmV3UHJvcHMuY2xvc2VPbkNvbXBsZXRlVGltZW91dDtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnBvcHVwLmFsbG93Q2xvc2UgPSBuZXdQcm9wcy5hbGxvd0Nsb3NlO1xuICAgICAgICB0aGlzLnBvcHVwLmFsbG93RnVsbFNjcmVlbiA9IG5ld1Byb3BzLmFsbG93RnVsbFNjcmVlbjtcbiAgICAgICAgdGhpcy5wb3B1cC5pc1Nob3dpbmcgPSB0cnVlO1xuICAgICAgICBpZiAoIXRoaXMucG9wdXAuaXNFeHBhbmRlZCAmJiAobmV3UHJvcHMuZXhwYW5kZWQgfHwgbmV3UHJvcHMuaXNFeHBhbmRlZCkpXG4gICAgICAgICAgICB0aGlzLnBvcHVwLmV4cGFuZCgpO1xuICAgIH07XG4gICAgcmV0dXJuIFBvcHVwU3VydmV5O1xufShyZWFjdFN1cnZleV9TdXJ2ZXkpKTtcblxuLyoqXG4gKiBPYnNvbGV0ZS4gUGxlYXNlIHVzZSBQb3B1cFN1cnZleVxuICovXG52YXIgU3VydmV5V2luZG93ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJlYWN0X3BvcHVwX3N1cnZleV9leHRlbmRzKFN1cnZleVdpbmRvdywgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlXaW5kb3coKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgcmV0dXJuIFN1cnZleVdpbmRvdztcbn0ocmVhY3RfcG9wdXBfc3VydmV5X1BvcHVwU3VydmV5KSk7XG5cblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL2ltYWdlcGlja2VyLnRzeFxudmFyIGltYWdlcGlja2VyX2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cblxuXG5cbnZhciBpbWFnZXBpY2tlcl9TdXJ2ZXlRdWVzdGlvbkltYWdlUGlja2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIGltYWdlcGlja2VyX2V4dGVuZHMoU3VydmV5UXVlc3Rpb25JbWFnZVBpY2tlciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlRdWVzdGlvbkltYWdlUGlja2VyKHByb3BzKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uSW1hZ2VQaWNrZXIucHJvdG90eXBlLCBcInF1ZXN0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5xdWVzdGlvbkJhc2U7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkltYWdlUGlja2VyLnByb3RvdHlwZS5yZW5kZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY3NzQ2xhc3NlcyA9IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3NlcztcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImZpZWxkc2V0XCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmdldFNlbGVjdEJhc2VSb290Q3NzKCkgfSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwibGVnZW5kXCIsIHsgY2xhc3NOYW1lOiBcInN2LWhpZGRlblwiIH0sIHRoaXMucXVlc3Rpb24ubG9jVGl0bGUucmVuZGVyZWRIdG1sKSxcbiAgICAgICAgICAgIHRoaXMucXVlc3Rpb24uaGFzQ29sdW1ucyA/IHRoaXMuZ2V0Q29sdW1ucyhjc3NDbGFzc2VzKSA6IHRoaXMuZ2V0SXRlbXMoY3NzQ2xhc3NlcykpKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uSW1hZ2VQaWNrZXIucHJvdG90eXBlLmdldENvbHVtbnMgPSBmdW5jdGlvbiAoY3NzQ2xhc3Nlcykge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gdGhpcy5xdWVzdGlvbi5jb2x1bW5zLm1hcChmdW5jdGlvbiAoY29sdW1uLCBjaSkge1xuICAgICAgICAgICAgdmFyIGl0ZW1zID0gY29sdW1uLm1hcChmdW5jdGlvbiAoaXRlbSwgaWkpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMucmVuZGVySXRlbShcIml0ZW1cIiArIGlpLCBpdGVtLCBjc3NDbGFzc2VzKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGtleTogXCJjb2x1bW5cIiArIGNpICsgX3RoaXMucXVlc3Rpb24uZ2V0SXRlbXNDb2x1bW5LZXkoY29sdW1uKSwgY2xhc3NOYW1lOiBfdGhpcy5xdWVzdGlvbi5nZXRDb2x1bW5DbGFzcygpLCByb2xlOiBcInByZXNlbnRhdGlvblwiIH0sIGl0ZW1zKSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25JbWFnZVBpY2tlci5wcm90b3R5cGUuZ2V0SXRlbXMgPSBmdW5jdGlvbiAoY3NzQ2xhc3Nlcykge1xuICAgICAgICB2YXIgaXRlbXMgPSBbXTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnF1ZXN0aW9uLnZpc2libGVDaG9pY2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IHRoaXMucXVlc3Rpb24udmlzaWJsZUNob2ljZXNbaV07XG4gICAgICAgICAgICB2YXIga2V5ID0gXCJpdGVtXCIgKyBpO1xuICAgICAgICAgICAgaXRlbXMucHVzaCh0aGlzLnJlbmRlckl0ZW0oa2V5LCBpdGVtLCBjc3NDbGFzc2VzKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGl0ZW1zO1xuICAgIH07XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uSW1hZ2VQaWNrZXIucHJvdG90eXBlLCBcInRleHRTdHlsZVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHsgbWFyZ2luTGVmdDogXCIzcHhcIiwgZGlzcGxheTogXCJpbmxpbmVcIiwgcG9zaXRpb246IFwic3RhdGljXCIgfTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleVF1ZXN0aW9uSW1hZ2VQaWNrZXIucHJvdG90eXBlLnJlbmRlckl0ZW0gPSBmdW5jdGlvbiAoa2V5LCBpdGVtLCBjc3NDbGFzc2VzKSB7XG4gICAgICAgIHZhciByZW5kZXJlZEl0ZW0gPSBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShpbWFnZXBpY2tlcl9TdXJ2ZXlRdWVzdGlvbkltYWdlUGlja2VySXRlbSwgeyBrZXk6IGtleSwgcXVlc3Rpb246IHRoaXMucXVlc3Rpb24sIGl0ZW06IGl0ZW0sIGNzc0NsYXNzZXM6IGNzc0NsYXNzZXMgfSk7XG4gICAgICAgIHZhciBzdXJ2ZXkgPSB0aGlzLnF1ZXN0aW9uLnN1cnZleTtcbiAgICAgICAgdmFyIHdyYXBwZWRJdGVtID0gbnVsbDtcbiAgICAgICAgaWYgKCEhc3VydmV5KSB7XG4gICAgICAgICAgICB3cmFwcGVkSXRlbSA9IHJlYWN0c3VydmV5bW9kZWxfUmVhY3RTdXJ2ZXlFbGVtZW50c1dyYXBwZXIud3JhcEl0ZW1WYWx1ZShzdXJ2ZXksIHJlbmRlcmVkSXRlbSwgdGhpcy5xdWVzdGlvbiwgaXRlbSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHdyYXBwZWRJdGVtICE9PSBudWxsICYmIHdyYXBwZWRJdGVtICE9PSB2b2lkIDAgPyB3cmFwcGVkSXRlbSA6IHJlbmRlcmVkSXRlbTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvbkltYWdlUGlja2VyO1xufShyZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5UXVlc3Rpb25FbGVtZW50QmFzZSkpO1xuXG52YXIgaW1hZ2VwaWNrZXJfU3VydmV5UXVlc3Rpb25JbWFnZVBpY2tlckl0ZW0gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgaW1hZ2VwaWNrZXJfZXh0ZW5kcyhTdXJ2ZXlRdWVzdGlvbkltYWdlUGlja2VySXRlbSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlRdWVzdGlvbkltYWdlUGlja2VySXRlbShwcm9wcykge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuaGFuZGxlT25DaGFuZ2UgPSBfdGhpcy5oYW5kbGVPbkNoYW5nZS5iaW5kKF90aGlzKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBTdXJ2ZXlRdWVzdGlvbkltYWdlUGlja2VySXRlbS5wcm90b3R5cGUuZ2V0U3RhdGVFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5pdGVtO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25JbWFnZVBpY2tlckl0ZW0ucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNvbXBvbmVudERpZE1vdW50LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMucmVhY3RPblN0ckNoYW5nZWQoKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uSW1hZ2VQaWNrZXJJdGVtLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jb21wb25lbnRXaWxsVW5tb3VudC5jYWxsKHRoaXMpO1xuICAgICAgICB0aGlzLml0ZW0ubG9jSW1hZ2VMaW5rLm9uQ2hhbmdlZCA9IGZ1bmN0aW9uICgpIHsgfTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uSW1hZ2VQaWNrZXJJdGVtLnByb3RvdHlwZS5jb21wb25lbnREaWRVcGRhdGUgPSBmdW5jdGlvbiAocHJldlByb3BzLCBwcmV2U3RhdGUpIHtcbiAgICAgICAgX3N1cGVyLnByb3RvdHlwZS5jb21wb25lbnREaWRVcGRhdGUuY2FsbCh0aGlzLCBwcmV2UHJvcHMsIHByZXZTdGF0ZSk7XG4gICAgICAgIHRoaXMucmVhY3RPblN0ckNoYW5nZWQoKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uSW1hZ2VQaWNrZXJJdGVtLnByb3RvdHlwZS5yZWFjdE9uU3RyQ2hhbmdlZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdGhpcy5pdGVtLmxvY0ltYWdlTGluay5vbkNoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBfdGhpcy5zZXRTdGF0ZSh7IGxvY0ltYWdlTGlua2NoYW5nZWQ6ICEhX3RoaXMuc3RhdGUgJiYgX3RoaXMuc3RhdGUubG9jSW1hZ2VMaW5rID8gX3RoaXMuc3RhdGUubG9jSW1hZ2VMaW5rICsgMSA6IDEgfSk7XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25JbWFnZVBpY2tlckl0ZW0ucHJvdG90eXBlLCBcImNzc0NsYXNzZXNcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLmNzc0NsYXNzZXM7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25JbWFnZVBpY2tlckl0ZW0ucHJvdG90eXBlLCBcIml0ZW1cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLml0ZW07XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25JbWFnZVBpY2tlckl0ZW0ucHJvdG90eXBlLCBcInF1ZXN0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5xdWVzdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleVF1ZXN0aW9uSW1hZ2VQaWNrZXJJdGVtLnByb3RvdHlwZS5oYW5kbGVPbkNoYW5nZSA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICBpZiAodGhpcy5xdWVzdGlvbi5pc1JlYWRPbmx5QXR0cilcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgaWYgKHRoaXMucXVlc3Rpb24ubXVsdGlTZWxlY3QpIHtcbiAgICAgICAgICAgIGlmIChldmVudC50YXJnZXQuY2hlY2tlZCkge1xuICAgICAgICAgICAgICAgIHRoaXMucXVlc3Rpb24udmFsdWUgPSB0aGlzLnF1ZXN0aW9uLnZhbHVlLmNvbmNhdChldmVudC50YXJnZXQudmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdmFyIGN1cnJWYWx1ZSA9IHRoaXMucXVlc3Rpb24udmFsdWU7XG4gICAgICAgICAgICAgICAgY3VyclZhbHVlLnNwbGljZSh0aGlzLnF1ZXN0aW9uLnZhbHVlLmluZGV4T2YoZXZlbnQudGFyZ2V0LnZhbHVlKSwgMSk7XG4gICAgICAgICAgICAgICAgdGhpcy5xdWVzdGlvbi52YWx1ZSA9IGN1cnJWYWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucXVlc3Rpb24udmFsdWUgPSBldmVudC50YXJnZXQudmFsdWU7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHZhbHVlOiB0aGlzLnF1ZXN0aW9uLnZhbHVlIH0pO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25JbWFnZVBpY2tlckl0ZW0ucHJvdG90eXBlLnJlbmRlckVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBpdGVtID0gdGhpcy5pdGVtO1xuICAgICAgICB2YXIgcXVlc3Rpb24gPSB0aGlzLnF1ZXN0aW9uO1xuICAgICAgICB2YXIgY3NzQ2xhc3NlcyA9IHRoaXMuY3NzQ2xhc3NlcztcbiAgICAgICAgdmFyIGlzQ2hlY2tlZCA9IHF1ZXN0aW9uLmlzSXRlbVNlbGVjdGVkKGl0ZW0pO1xuICAgICAgICB2YXIgaXRlbUNsYXNzID0gcXVlc3Rpb24uZ2V0SXRlbUNsYXNzKGl0ZW0pO1xuICAgICAgICB2YXIgdGV4dCA9IG51bGw7XG4gICAgICAgIGlmIChxdWVzdGlvbi5zaG93TGFiZWwpIHtcbiAgICAgICAgICAgIHRleHQgPSAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJzcGFuXCIsIHsgY2xhc3NOYW1lOiBxdWVzdGlvbi5jc3NDbGFzc2VzLml0ZW1UZXh0IH0sIGl0ZW0udGV4dCA/IHJlYWN0cXVlc3Rpb25fZWxlbWVudF9TdXJ2ZXlFbGVtZW50QmFzZS5yZW5kZXJMb2NTdHJpbmcoaXRlbS5sb2NUZXh0KSA6IGl0ZW0udmFsdWUpKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgc3R5bGUgPSB7IG9iamVjdEZpdDogdGhpcy5xdWVzdGlvbi5pbWFnZUZpdCB9O1xuICAgICAgICB2YXIgY29udHJvbCA9IG51bGw7XG4gICAgICAgIGlmIChpdGVtLmxvY0ltYWdlTGluay5yZW5kZXJlZEh0bWwgJiYgdGhpcy5xdWVzdGlvbi5jb250ZW50TW9kZSA9PT0gXCJpbWFnZVwiKSB7XG4gICAgICAgICAgICBjb250cm9sID0gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiaW1nXCIsIHsgY2xhc3NOYW1lOiBjc3NDbGFzc2VzLmltYWdlLCBzcmM6IGl0ZW0ubG9jSW1hZ2VMaW5rLnJlbmRlcmVkSHRtbCwgd2lkdGg6IHRoaXMucXVlc3Rpb24ucmVuZGVyZWRJbWFnZVdpZHRoLCBoZWlnaHQ6IHRoaXMucXVlc3Rpb24ucmVuZGVyZWRJbWFnZUhlaWdodCwgYWx0OiBpdGVtLmxvY1RleHQucmVuZGVyZWRIdG1sLCBzdHlsZTogc3R5bGUsIG9uTG9hZDogZnVuY3Rpb24gKGV2ZW50KSB7IF90aGlzLnF1ZXN0aW9uW1wib25Db250ZW50TG9hZGVkXCJdKGl0ZW0sIGV2ZW50Lm5hdGl2ZUV2ZW50KTsgfSwgb25FcnJvcjogZnVuY3Rpb24gKGV2ZW50KSB7IGl0ZW0ub25FcnJvckhhbmRsZXIoaXRlbSwgZXZlbnQubmF0aXZlRXZlbnQpOyB9IH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXRlbS5sb2NJbWFnZUxpbmsucmVuZGVyZWRIdG1sICYmIHRoaXMucXVlc3Rpb24uY29udGVudE1vZGUgPT09IFwidmlkZW9cIikge1xuICAgICAgICAgICAgY29udHJvbCA9IChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInZpZGVvXCIsIHsgY29udHJvbHM6IHRydWUsIGNsYXNzTmFtZTogY3NzQ2xhc3Nlcy5pbWFnZSwgc3JjOiBpdGVtLmxvY0ltYWdlTGluay5yZW5kZXJlZEh0bWwsIHdpZHRoOiB0aGlzLnF1ZXN0aW9uLnJlbmRlcmVkSW1hZ2VXaWR0aCwgaGVpZ2h0OiB0aGlzLnF1ZXN0aW9uLnJlbmRlcmVkSW1hZ2VIZWlnaHQsIHN0eWxlOiBzdHlsZSwgb25Mb2FkZWRNZXRhZGF0YTogZnVuY3Rpb24gKGV2ZW50KSB7IF90aGlzLnF1ZXN0aW9uW1wib25Db250ZW50TG9hZGVkXCJdKGl0ZW0sIGV2ZW50Lm5hdGl2ZUV2ZW50KTsgfSwgb25FcnJvcjogZnVuY3Rpb24gKGV2ZW50KSB7IGl0ZW0ub25FcnJvckhhbmRsZXIoaXRlbSwgZXZlbnQubmF0aXZlRXZlbnQpOyB9IH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWl0ZW0ubG9jSW1hZ2VMaW5rLnJlbmRlcmVkSHRtbCB8fCBpdGVtLmNvbnRlbnROb3RMb2FkZWQpIHtcbiAgICAgICAgICAgIHZhciBzdHlsZV8xID0ge1xuICAgICAgICAgICAgICAgIHdpZHRoOiB0aGlzLnF1ZXN0aW9uLnJlbmRlcmVkSW1hZ2VXaWR0aCxcbiAgICAgICAgICAgICAgICBoZWlnaHQ6IHRoaXMucXVlc3Rpb24ucmVuZGVyZWRJbWFnZUhlaWdodCxcbiAgICAgICAgICAgICAgICBvYmplY3RGaXQ6IHRoaXMucXVlc3Rpb24uaW1hZ2VGaXRcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBjb250cm9sID0gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBjc3NDbGFzc2VzLml0ZW1Ob0ltYWdlLCBzdHlsZTogc3R5bGVfMSB9LCBjc3NDbGFzc2VzLml0ZW1Ob0ltYWdlU3ZnSWNvbiA/XG4gICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oc3ZnX2ljb25fU3ZnSWNvbiwgeyBjbGFzc05hbWU6IGNzc0NsYXNzZXMuaXRlbU5vSW1hZ2VTdmdJY29uLCBpY29uTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLml0ZW1Ob0ltYWdlU3ZnSWNvbklkLCBzaXplOiA0OCB9KSA6XG4gICAgICAgICAgICAgICAgbnVsbCkpO1xuICAgICAgICB9XG4gICAgICAgIHZhciByZW5kZXJlZEl0ZW0gPSAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IGl0ZW1DbGFzcyB9LFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJsYWJlbFwiLCB7IGNsYXNzTmFtZTogY3NzQ2xhc3Nlcy5sYWJlbCB9LFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiaW5wdXRcIiwgeyBjbGFzc05hbWU6IGNzc0NsYXNzZXMuaXRlbUNvbnRyb2wsIGlkOiB0aGlzLnF1ZXN0aW9uLmdldEl0ZW1JZChpdGVtKSwgdHlwZTogdGhpcy5xdWVzdGlvbi5pbnB1dFR5cGUsIG5hbWU6IHRoaXMucXVlc3Rpb24ucXVlc3Rpb25OYW1lLCBjaGVja2VkOiBpc0NoZWNrZWQsIHZhbHVlOiBpdGVtLnZhbHVlLCBkaXNhYmxlZDogIXRoaXMucXVlc3Rpb24uZ2V0SXRlbUVuYWJsZWQoaXRlbSksIHJlYWRPbmx5OiB0aGlzLnF1ZXN0aW9uLmlzUmVhZE9ubHlBdHRyLCBvbkNoYW5nZTogdGhpcy5oYW5kbGVPbkNoYW5nZSwgXCJhcmlhLXJlcXVpcmVkXCI6IHRoaXMucXVlc3Rpb24uYXJpYVJlcXVpcmVkLCBcImFyaWEtbGFiZWxcIjogdGhpcy5xdWVzdGlvbi5hcmlhTGFiZWwsIFwiYXJpYS1pbnZhbGlkXCI6IHRoaXMucXVlc3Rpb24uYXJpYUludmFsaWQsIFwiYXJpYS1lcnJvcm1lc3NhZ2VcIjogdGhpcy5xdWVzdGlvbi5hcmlhRXJyb3JtZXNzYWdlIH0pLFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMuaXRlbURlY29yYXRvciB9LFxuICAgICAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmltYWdlQ29udGFpbmVyIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAhIXRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5jaGVja2VkSXRlbURlY29yYXRvciA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJzcGFuXCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMuY2hlY2tlZEl0ZW1EZWNvcmF0b3IgfSwgISF0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMuY2hlY2tlZEl0ZW1TdmdJY29uSWQgPyBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShzdmdfaWNvbl9TdmdJY29uLCB7IHNpemU6IFwiYXV0b1wiLCBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5jaGVja2VkSXRlbVN2Z0ljb24sIGljb25OYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMuY2hlY2tlZEl0ZW1TdmdJY29uSWQgfSkgOiBudWxsKSA6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sKSxcbiAgICAgICAgICAgICAgICAgICAgdGV4dCkpKSk7XG4gICAgICAgIHJldHVybiByZW5kZXJlZEl0ZW07XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5UXVlc3Rpb25JbWFnZVBpY2tlckl0ZW07XG59KFJlYWN0U3VydmV5RWxlbWVudCkpO1xuXG5SZWFjdFF1ZXN0aW9uRmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlclF1ZXN0aW9uKFwiaW1hZ2VwaWNrZXJcIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKGltYWdlcGlja2VyX1N1cnZleVF1ZXN0aW9uSW1hZ2VQaWNrZXIsIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvaW1hZ2UudHN4XG52YXIgaW1hZ2VfZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG5cbnZhciBpbWFnZV9TdXJ2ZXlRdWVzdGlvbkltYWdlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIGltYWdlX2V4dGVuZHMoU3VydmV5UXVlc3Rpb25JbWFnZSwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlRdWVzdGlvbkltYWdlKHByb3BzKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICB9XG4gICAgU3VydmV5UXVlc3Rpb25JbWFnZS5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIF9zdXBlci5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQuY2FsbCh0aGlzKTtcbiAgICAgICAgdGhpcy5xdWVzdGlvbi5sb2NJbWFnZUxpbmsub25DaGFuZ2VkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgX3RoaXMuZm9yY2VVcGRhdGUoKTtcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uSW1hZ2UucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfc3VwZXIucHJvdG90eXBlLmNvbXBvbmVudFdpbGxVbm1vdW50LmNhbGwodGhpcyk7XG4gICAgICAgIHRoaXMucXVlc3Rpb24ubG9jSW1hZ2VMaW5rLm9uQ2hhbmdlZCA9IGZ1bmN0aW9uICgpIHsgfTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbkltYWdlLnByb3RvdHlwZSwgXCJxdWVzdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucXVlc3Rpb25CYXNlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3VydmV5UXVlc3Rpb25JbWFnZS5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgdmFyIGNzc0NsYXNzZXMgPSB0aGlzLnF1ZXN0aW9uLmdldEltYWdlQ3NzKCk7XG4gICAgICAgIHZhciBzdHlsZSA9IHsgb2JqZWN0Rml0OiB0aGlzLnF1ZXN0aW9uLmltYWdlRml0LCB3aWR0aDogdGhpcy5xdWVzdGlvbi5yZW5kZXJlZFN0eWxlV2lkdGgsIGhlaWdodDogdGhpcy5xdWVzdGlvbi5yZW5kZXJlZFN0eWxlSGVpZ2h0IH07XG4gICAgICAgIGlmICghdGhpcy5xdWVzdGlvbi5pbWFnZUxpbmsgfHwgdGhpcy5xdWVzdGlvbi5jb250ZW50Tm90TG9hZGVkKSB7XG4gICAgICAgICAgICBzdHlsZVtcImRpc3BsYXlcIl0gPSBcIm5vbmVcIjtcbiAgICAgICAgfVxuICAgICAgICB2YXIgY29udHJvbCA9IG51bGw7XG4gICAgICAgIGlmICh0aGlzLnF1ZXN0aW9uLnJlbmRlcmVkTW9kZSA9PT0gXCJpbWFnZVwiKSB7XG4gICAgICAgICAgICBjb250cm9sID0gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiaW1nXCIsIHsgY2xhc3NOYW1lOiBjc3NDbGFzc2VzLCBzcmM6IHRoaXMucXVlc3Rpb24ubG9jSW1hZ2VMaW5rLnJlbmRlcmVkSHRtbCwgYWx0OiB0aGlzLnF1ZXN0aW9uLmFsdFRleHQgfHwgdGhpcy5xdWVzdGlvbi50aXRsZSwgd2lkdGg6IHRoaXMucXVlc3Rpb24ucmVuZGVyZWRXaWR0aCwgaGVpZ2h0OiB0aGlzLnF1ZXN0aW9uLnJlbmRlcmVkSGVpZ2h0LCBcbiAgICAgICAgICAgICAgICAvL2FsdD17aXRlbS50ZXh0IHx8IGl0ZW0udmFsdWV9XG4gICAgICAgICAgICAgICAgc3R5bGU6IHN0eWxlLCBvbkxvYWQ6IGZ1bmN0aW9uIChldmVudCkgeyBfdGhpcy5xdWVzdGlvbi5vbkxvYWRIYW5kbGVyKCk7IH0sIG9uRXJyb3I6IGZ1bmN0aW9uIChldmVudCkgeyBfdGhpcy5xdWVzdGlvbi5vbkVycm9ySGFuZGxlcigpOyB9IH0pKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5xdWVzdGlvbi5yZW5kZXJlZE1vZGUgPT09IFwidmlkZW9cIikge1xuICAgICAgICAgICAgY29udHJvbCA9IChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcInZpZGVvXCIsIHsgY29udHJvbHM6IHRydWUsIGNsYXNzTmFtZTogY3NzQ2xhc3Nlcywgc3JjOiB0aGlzLnF1ZXN0aW9uLmxvY0ltYWdlTGluay5yZW5kZXJlZEh0bWwsIHdpZHRoOiB0aGlzLnF1ZXN0aW9uLnJlbmRlcmVkV2lkdGgsIGhlaWdodDogdGhpcy5xdWVzdGlvbi5yZW5kZXJlZEhlaWdodCwgc3R5bGU6IHN0eWxlLCBvbkxvYWRlZE1ldGFkYXRhOiBmdW5jdGlvbiAoZXZlbnQpIHsgX3RoaXMucXVlc3Rpb24ub25Mb2FkSGFuZGxlcigpOyB9LCBvbkVycm9yOiBmdW5jdGlvbiAoZXZlbnQpIHsgX3RoaXMucXVlc3Rpb24ub25FcnJvckhhbmRsZXIoKTsgfSB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMucXVlc3Rpb24ucmVuZGVyZWRNb2RlID09PSBcInlvdXR1YmVcIikge1xuICAgICAgICAgICAgY29udHJvbCA9IChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImlmcmFtZVwiLCB7IGNsYXNzTmFtZTogY3NzQ2xhc3Nlcywgc3JjOiB0aGlzLnF1ZXN0aW9uLmxvY0ltYWdlTGluay5yZW5kZXJlZEh0bWwsIHdpZHRoOiB0aGlzLnF1ZXN0aW9uLnJlbmRlcmVkV2lkdGgsIGhlaWdodDogdGhpcy5xdWVzdGlvbi5yZW5kZXJlZEhlaWdodCwgc3R5bGU6IHN0eWxlIH0pKTtcbiAgICAgICAgfVxuICAgICAgICB2YXIgbm9JbWFnZSA9IG51bGw7XG4gICAgICAgIGlmICghdGhpcy5xdWVzdGlvbi5pbWFnZUxpbmsgfHwgdGhpcy5xdWVzdGlvbi5jb250ZW50Tm90TG9hZGVkKSB7XG4gICAgICAgICAgICBub0ltYWdlID0gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMubm9JbWFnZSB9LFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKHN2Z19pY29uX1N2Z0ljb24sIHsgaWNvbk5hbWU6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5ub0ltYWdlU3ZnSWNvbklkLCBzaXplOiA0OCB9KSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLnJvb3QgfSxcbiAgICAgICAgICAgIGNvbnRyb2wsXG4gICAgICAgICAgICBub0ltYWdlKTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvbkltYWdlO1xufShyZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5UXVlc3Rpb25FbGVtZW50QmFzZSkpO1xuXG5SZWFjdFF1ZXN0aW9uRmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlclF1ZXN0aW9uKFwiaW1hZ2VcIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKGltYWdlX1N1cnZleVF1ZXN0aW9uSW1hZ2UsIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvc2lnbmF0dXJlcGFkLnRzeFxudmFyIHNpZ25hdHVyZXBhZF9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cblxuXG52YXIgc2lnbmF0dXJlcGFkX1N1cnZleVF1ZXN0aW9uU2lnbmF0dXJlUGFkID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHNpZ25hdHVyZXBhZF9leHRlbmRzKFN1cnZleVF1ZXN0aW9uU2lnbmF0dXJlUGFkLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uU2lnbmF0dXJlUGFkKHByb3BzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5zdGF0ZSA9IHsgdmFsdWU6IF90aGlzLnF1ZXN0aW9uLnZhbHVlIH07XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleVF1ZXN0aW9uU2lnbmF0dXJlUGFkLnByb3RvdHlwZSwgXCJxdWVzdGlvblwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucXVlc3Rpb25CYXNlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3VydmV5UXVlc3Rpb25TaWduYXR1cmVQYWQucHJvdG90eXBlLnJlbmRlckVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IHRoaXM7XG4gICAgICAgIHZhciBjc3NDbGFzc2VzID0gdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzO1xuICAgICAgICB2YXIgbG9hZGluZ0luZGljYXRvciA9IHRoaXMucXVlc3Rpb24uc2hvd0xvYWRpbmdJbmRpY2F0b3IgPyB0aGlzLnJlbmRlckxvYWRpbmdJbmRpY2F0b3IoKSA6IG51bGw7XG4gICAgICAgIHZhciBjbGVhckJ1dHRvbiA9IHRoaXMucmVuZGVyQ2xlYW5CdXR0b24oKTtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCB7IGNsYXNzTmFtZTogY3NzQ2xhc3Nlcy5yb290LCByZWY6IGZ1bmN0aW9uIChyb290KSB7IHJldHVybiAoX3RoaXMuc2V0Q29udHJvbChyb290KSk7IH0sIHN0eWxlOiB7IHdpZHRoOiB0aGlzLnF1ZXN0aW9uLnJlbmRlcmVkQ2FudmFzV2lkdGggfSB9LFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IGNzc0NsYXNzZXMucGxhY2Vob2xkZXIsIHN0eWxlOiB7IGRpc3BsYXk6IHRoaXMucXVlc3Rpb24ubmVlZFNob3dQbGFjZWhvbGRlcigpID8gXCJcIiA6IFwibm9uZVwiIH0gfSwgdGhpcy5yZW5kZXJMb2NTdHJpbmcodGhpcy5xdWVzdGlvbi5sb2NSZW5kZXJlZFBsYWNlaG9sZGVyKSksXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShcImRpdlwiLCBudWxsLFxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyQmFja2dyb3VuZEltYWdlKCksXG4gICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJjYW52YXNcIiwgeyB0YWJJbmRleDogLTEsIGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmNhbnZhcywgb25CbHVyOiBmdW5jdGlvbiAoZXZlbnQpIHsgX3RoaXMucXVlc3Rpb24ub25CbHVyKGV2ZW50KTsgfSB9KSksXG4gICAgICAgICAgICBjbGVhckJ1dHRvbixcbiAgICAgICAgICAgIGxvYWRpbmdJbmRpY2F0b3IpKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uU2lnbmF0dXJlUGFkLnByb3RvdHlwZS5yZW5kZXJCYWNrZ3JvdW5kSW1hZ2UgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5xdWVzdGlvbi5iYWNrZ3JvdW5kSW1hZ2UpXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiaW1nXCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMuYmFja2dyb3VuZEltYWdlLCBzcmM6IHRoaXMucXVlc3Rpb24uYmFja2dyb3VuZEltYWdlLCBzdHlsZTogeyB3aWR0aDogdGhpcy5xdWVzdGlvbi5yZW5kZXJlZENhbnZhc1dpZHRoIH0gfSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvblNpZ25hdHVyZVBhZC5wcm90b3R5cGUucmVuZGVyTG9hZGluZ0luZGljYXRvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMubG9hZGluZ0luZGljYXRvciB9LFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0obG9hZGluZ19pbmRpY2F0b3JfTG9hZGluZ0luZGljYXRvckNvbXBvbmVudCwgbnVsbCkpO1xuICAgIH07XG4gICAgU3VydmV5UXVlc3Rpb25TaWduYXR1cmVQYWQucHJvdG90eXBlLnJlbmRlckNsZWFuQnV0dG9uID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICBpZiAoIXRoaXMucXVlc3Rpb24uY2FuU2hvd0NsZWFyQnV0dG9uKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIHZhciBjc3NDbGFzc2VzID0gdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzO1xuICAgICAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oXCJkaXZcIiwgeyBjbGFzc05hbWU6IGNzc0NsYXNzZXMuY29udHJvbHMgfSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwiYnV0dG9uXCIsIHsgdHlwZTogXCJidXR0b25cIiwgY2xhc3NOYW1lOiBjc3NDbGFzc2VzLmNsZWFyQnV0dG9uLCB0aXRsZTogdGhpcy5xdWVzdGlvbi5jbGVhckJ1dHRvbkNhcHRpb24sIG9uQ2xpY2s6IGZ1bmN0aW9uICgpIHsgcmV0dXJuIF90aGlzLnF1ZXN0aW9uLmNsZWFyVmFsdWUodHJ1ZSk7IH0gfSwgdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmNsZWFyQnV0dG9uSWNvbklkID8gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oc3ZnX2ljb25fU3ZnSWNvbiwgeyBpY29uTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmNsZWFyQnV0dG9uSWNvbklkLCBzaXplOiBcImF1dG9cIiB9KSA6IGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9bXCJjcmVhdGVFbGVtZW50XCJdKFwic3BhblwiLCBudWxsLCBcIlxcdTI3MTZcIikpKTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvblNpZ25hdHVyZVBhZDtcbn0ocmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleVF1ZXN0aW9uRWxlbWVudEJhc2UpKTtcblxuUmVhY3RRdWVzdGlvbkZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJRdWVzdGlvbihcInNpZ25hdHVyZXBhZFwiLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X1tcImNyZWF0ZUVsZW1lbnRcIl0oc2lnbmF0dXJlcGFkX1N1cnZleVF1ZXN0aW9uU2lnbmF0dXJlUGFkLCBwcm9wcyk7XG59KTtcblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL3JlYWN0cXVlc3Rpb25fYnV0dG9uZ3JvdXAudHN4XG52YXIgcmVhY3RxdWVzdGlvbl9idXR0b25ncm91cF9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cblxuXG52YXIgcmVhY3RxdWVzdGlvbl9idXR0b25ncm91cF9TdXJ2ZXlRdWVzdGlvbkJ1dHRvbkdyb3VwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJlYWN0cXVlc3Rpb25fYnV0dG9uZ3JvdXBfZXh0ZW5kcyhTdXJ2ZXlRdWVzdGlvbkJ1dHRvbkdyb3VwLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uQnV0dG9uR3JvdXAocHJvcHMpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25CdXR0b25Hcm91cC5wcm90b3R5cGUsIFwicXVlc3Rpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnF1ZXN0aW9uQmFzZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleVF1ZXN0aW9uQnV0dG9uR3JvdXAucHJvdG90eXBlLmdldFN0YXRlRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucXVlc3Rpb247XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkJ1dHRvbkdyb3VwLnByb3RvdHlwZS5yZW5kZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaXRlbXMgPSB0aGlzLnJlbmRlckl0ZW1zKCk7XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5yb290IH0sIGl0ZW1zKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uQnV0dG9uR3JvdXAucHJvdG90eXBlLnJlbmRlckl0ZW1zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gdGhpcy5xdWVzdGlvbi52aXNpYmxlQ2hvaWNlcy5tYXAoZnVuY3Rpb24gKGl0ZW0sIGluZGV4KSB7XG4gICAgICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChyZWFjdHF1ZXN0aW9uX2J1dHRvbmdyb3VwX1N1cnZleUJ1dHRvbkdyb3VwSXRlbSwgeyBrZXk6IF90aGlzLnF1ZXN0aW9uLmlucHV0SWQgKyBcIl9cIiArIGluZGV4LCBpdGVtOiBpdGVtLCBxdWVzdGlvbjogX3RoaXMucXVlc3Rpb24sIGluZGV4OiBpbmRleCB9KSk7XG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVF1ZXN0aW9uQnV0dG9uR3JvdXA7XG59KHJlYWN0cXVlc3Rpb25fZWxlbWVudF9TdXJ2ZXlRdWVzdGlvbkVsZW1lbnRCYXNlKSk7XG5cbnZhciByZWFjdHF1ZXN0aW9uX2J1dHRvbmdyb3VwX1N1cnZleUJ1dHRvbkdyb3VwSXRlbSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICByZWFjdHF1ZXN0aW9uX2J1dHRvbmdyb3VwX2V4dGVuZHMoU3VydmV5QnV0dG9uR3JvdXBJdGVtLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleUJ1dHRvbkdyb3VwSXRlbShwcm9wcykge1xuICAgICAgICByZXR1cm4gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlCdXR0b25Hcm91cEl0ZW0ucHJvdG90eXBlLCBcImluZGV4XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5pbmRleDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlCdXR0b25Hcm91cEl0ZW0ucHJvdG90eXBlLCBcInF1ZXN0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5xdWVzdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlCdXR0b25Hcm91cEl0ZW0ucHJvdG90eXBlLCBcIml0ZW1cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLml0ZW07XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlCdXR0b25Hcm91cEl0ZW0ucHJvdG90eXBlLmdldFN0YXRlRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlbTtcbiAgICB9O1xuICAgIFN1cnZleUJ1dHRvbkdyb3VwSXRlbS5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5tb2RlbCA9IG5ldyBleHRlcm5hbF9yb290X1N1cnZleV9jb21tb25qczJfc3VydmV5X2NvcmVfY29tbW9uanNfc3VydmV5X2NvcmVfYW1kX3N1cnZleV9jb3JlX1tcIkJ1dHRvbkdyb3VwSXRlbU1vZGVsXCJdKHRoaXMucXVlc3Rpb24sIHRoaXMuaXRlbSwgdGhpcy5pbmRleCk7XG4gICAgICAgIHZhciBpY29uID0gdGhpcy5yZW5kZXJJY29uKCk7XG4gICAgICAgIHZhciBpbnB1dCA9IHRoaXMucmVuZGVySW5wdXQoKTtcbiAgICAgICAgdmFyIGNhcHRpb24gPSB0aGlzLnJlbmRlckNhcHRpb24oKTtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiLCB7IHJvbGU6IFwicmFkaW9cIiwgY2xhc3NOYW1lOiB0aGlzLm1vZGVsLmNzcy5sYWJlbCwgdGl0bGU6IHRoaXMubW9kZWwuY2FwdGlvbi5yZW5kZXJlZEh0bWwgfSxcbiAgICAgICAgICAgIGlucHV0LFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiB0aGlzLm1vZGVsLmNzcy5kZWNvcmF0b3IgfSxcbiAgICAgICAgICAgICAgICBpY29uLFxuICAgICAgICAgICAgICAgIGNhcHRpb24pKSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlCdXR0b25Hcm91cEl0ZW0ucHJvdG90eXBlLnJlbmRlckljb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghIXRoaXMubW9kZWwuaWNvbk5hbWUpIHtcbiAgICAgICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KHN2Z19pY29uX1N2Z0ljb24sIHsgY2xhc3NOYW1lOiB0aGlzLm1vZGVsLmNzcy5pY29uLCBpY29uTmFtZTogdGhpcy5tb2RlbC5pY29uTmFtZSwgc2l6ZTogdGhpcy5tb2RlbC5pY29uU2l6ZSB8fCAyNCB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBTdXJ2ZXlCdXR0b25Hcm91cEl0ZW0ucHJvdG90eXBlLnJlbmRlcklucHV0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcImlucHV0XCIsIHsgY2xhc3NOYW1lOiB0aGlzLm1vZGVsLmNzcy5jb250cm9sLCBpZDogdGhpcy5tb2RlbC5pZCwgdHlwZTogXCJyYWRpb1wiLCBuYW1lOiB0aGlzLm1vZGVsLm5hbWUsIGNoZWNrZWQ6IHRoaXMubW9kZWwuc2VsZWN0ZWQsIHZhbHVlOiB0aGlzLm1vZGVsLnZhbHVlLCBkaXNhYmxlZDogdGhpcy5tb2RlbC5yZWFkT25seSwgb25DaGFuZ2U6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICBfdGhpcy5tb2RlbC5vbkNoYW5nZSgpO1xuICAgICAgICAgICAgfSwgXCJhcmlhLXJlcXVpcmVkXCI6IHRoaXMubW9kZWwuaXNSZXF1aXJlZCwgXCJhcmlhLWxhYmVsXCI6IHRoaXMubW9kZWwuY2FwdGlvbi5yZW5kZXJlZEh0bWwsIFwiYXJpYS1pbnZhbGlkXCI6IHRoaXMubW9kZWwuaGFzRXJyb3JzLCBcImFyaWEtZXJyb3JtZXNzYWdlXCI6IHRoaXMubW9kZWwuZGVzY3JpYmVkQnksIHJvbGU6IFwicmFkaW9cIiB9KSk7XG4gICAgfTtcbiAgICBTdXJ2ZXlCdXR0b25Hcm91cEl0ZW0ucHJvdG90eXBlLnJlbmRlckNhcHRpb24gPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5tb2RlbC5zaG93Q2FwdGlvbilcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB2YXIgY2FwdGlvbiA9IHRoaXMucmVuZGVyTG9jU3RyaW5nKHRoaXMubW9kZWwuY2FwdGlvbik7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwic3BhblwiLCB7IGNsYXNzTmFtZTogdGhpcy5tb2RlbC5jc3MuY2FwdGlvbiwgdGl0bGU6IHRoaXMubW9kZWwuY2FwdGlvbi5yZW5kZXJlZEh0bWwgfSwgY2FwdGlvbikpO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleUJ1dHRvbkdyb3VwSXRlbTtcbn0ocmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleUVsZW1lbnRCYXNlKSk7XG5cbi8vIFJlYWN0UXVlc3Rpb25GYWN0b3J5Lkluc3RhbmNlLnJlZ2lzdGVyUXVlc3Rpb24oXCJidXR0b25ncm91cFwiLCBwcm9wcyA9PiB7XG4vLyAgIHJldHVybiBSZWFjdC5jcmVhdGVFbGVtZW50KFN1cnZleVF1ZXN0aW9uQnV0dG9uR3JvdXAsIHByb3BzKTtcbi8vIH0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvcmVhY3RxdWVzdGlvbl9jdXN0b20udHN4XG52YXIgcmVhY3RxdWVzdGlvbl9jdXN0b21fZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG5cblxudmFyIHJlYWN0cXVlc3Rpb25fY3VzdG9tX1N1cnZleVF1ZXN0aW9uQ3VzdG9tID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHJlYWN0cXVlc3Rpb25fY3VzdG9tX2V4dGVuZHMoU3VydmV5UXVlc3Rpb25DdXN0b20sIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5UXVlc3Rpb25DdXN0b20ocHJvcHMpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBTdXJ2ZXlRdWVzdGlvbkN1c3RvbS5wcm90b3R5cGUuZ2V0U3RhdGVFbGVtZW50cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHJlcyA9IF9zdXBlci5wcm90b3R5cGUuZ2V0U3RhdGVFbGVtZW50cy5jYWxsKHRoaXMpO1xuICAgICAgICBpZiAoISF0aGlzLnF1ZXN0aW9uLmNvbnRlbnRRdWVzdGlvbikge1xuICAgICAgICAgICAgcmVzLnB1c2godGhpcy5xdWVzdGlvbi5jb250ZW50UXVlc3Rpb24pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkN1c3RvbS5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHJlYWN0cXVlc3Rpb25fU3VydmV5UXVlc3Rpb24ucmVuZGVyUXVlc3Rpb25Cb2R5KHRoaXMuY3JlYXRvciwgdGhpcy5xdWVzdGlvbi5jb250ZW50UXVlc3Rpb24pO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVF1ZXN0aW9uQ3VzdG9tO1xufShyZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5UXVlc3Rpb25VbmNvbnRyb2xsZWRFbGVtZW50KSk7XG5cbnZhciByZWFjdHF1ZXN0aW9uX2N1c3RvbV9TdXJ2ZXlRdWVzdGlvbkNvbXBvc2l0ZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICByZWFjdHF1ZXN0aW9uX2N1c3RvbV9leHRlbmRzKFN1cnZleVF1ZXN0aW9uQ29tcG9zaXRlLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uQ29tcG9zaXRlKHByb3BzKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICB9XG4gICAgU3VydmV5UXVlc3Rpb25Db21wb3NpdGUucHJvdG90eXBlLmNhblJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuICEhdGhpcy5xdWVzdGlvbi5jb250ZW50UGFuZWw7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbkNvbXBvc2l0ZS5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShwYW5lbF9TdXJ2ZXlQYW5lbCwgeyBlbGVtZW50OiB0aGlzLnF1ZXN0aW9uLmNvbnRlbnRQYW5lbCwgY3JlYXRvcjogdGhpcy5jcmVhdG9yLCBzdXJ2ZXk6IHRoaXMucXVlc3Rpb24uc3VydmV5IH0pKTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvbkNvbXBvc2l0ZTtcbn0ocmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleVF1ZXN0aW9uVW5jb250cm9sbGVkRWxlbWVudCkpO1xuXG5SZWFjdFF1ZXN0aW9uRmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlclF1ZXN0aW9uKFwiY3VzdG9tXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyZWFjdHF1ZXN0aW9uX2N1c3RvbV9TdXJ2ZXlRdWVzdGlvbkN1c3RvbSwgcHJvcHMpO1xufSk7XG5SZWFjdFF1ZXN0aW9uRmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlclF1ZXN0aW9uKFwiY29tcG9zaXRlXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfW1wiY3JlYXRlRWxlbWVudFwiXShyZWFjdHF1ZXN0aW9uX2N1c3RvbV9TdXJ2ZXlRdWVzdGlvbkNvbXBvc2l0ZSwgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9jb21wb25lbnRzL2xpc3QvbGlzdC1pdGVtLWNvbnRlbnQudHN4XG52YXIgbGlzdF9pdGVtX2NvbnRlbnRfZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG5cbnZhciBsaXN0X2l0ZW1fY29udGVudF9MaXN0SXRlbUNvbnRlbnQgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgbGlzdF9pdGVtX2NvbnRlbnRfZXh0ZW5kcyhMaXN0SXRlbUNvbnRlbnQsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTGlzdEl0ZW1Db250ZW50KCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMaXN0SXRlbUNvbnRlbnQucHJvdG90eXBlLCBcIm1vZGVsXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5tb2RlbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShMaXN0SXRlbUNvbnRlbnQucHJvdG90eXBlLCBcIml0ZW1cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLml0ZW07XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBMaXN0SXRlbUNvbnRlbnQucHJvdG90eXBlLmdldFN0YXRlRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuaXRlbTtcbiAgICB9O1xuICAgIExpc3RJdGVtQ29udGVudC5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMuaXRlbSlcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB2YXIgY29udGVudCA9IFtdO1xuICAgICAgICB2YXIgdGV4dCA9IHRoaXMucmVuZGVyTG9jU3RyaW5nKHRoaXMuaXRlbS5sb2NUaXRsZSwgdW5kZWZpbmVkLCBcImxvY1N0cmluZ1wiKTtcbiAgICAgICAgaWYgKHRoaXMuaXRlbS5pY29uTmFtZSkge1xuICAgICAgICAgICAgdmFyIGljb24gPSBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoc3ZnX2ljb25fU3ZnSWNvbiwgeyBrZXk6IFwiaWNvblwiLCBjbGFzc05hbWU6IHRoaXMubW9kZWwuY3NzQ2xhc3Nlcy5pdGVtSWNvbiwgaWNvbk5hbWU6IHRoaXMuaXRlbS5pY29uTmFtZSwgc2l6ZTogdGhpcy5pdGVtLmljb25TaXplLCBcImFyaWEtbGFiZWxcIjogdGhpcy5pdGVtLnRpdGxlIH0pO1xuICAgICAgICAgICAgY29udGVudC5wdXNoKGljb24pO1xuICAgICAgICAgICAgY29udGVudC5wdXNoKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcInNwYW5cIiwgeyBrZXk6IFwidGV4dFwiIH0sIHRleHQpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbnRlbnQucHVzaCh0ZXh0KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5pdGVtLm1hcmtlckljb25OYW1lKSB7XG4gICAgICAgICAgICB2YXIgaWNvbiA9IGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChzdmdfaWNvbl9TdmdJY29uLCB7IGtleTogXCJtYXJrZXJcIiwgY2xhc3NOYW1lOiB0aGlzLml0ZW0uY3NzQ2xhc3Nlcy5pdGVtTWFya2VySWNvbiwgaWNvbk5hbWU6IHRoaXMuaXRlbS5tYXJrZXJJY29uTmFtZSwgc2l6ZTogdGhpcy5pdGVtLm1hcmtlckljb25TaXplIH0pO1xuICAgICAgICAgICAgY29udGVudC5wdXNoKGljb24pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5GcmFnbWVudCwgbnVsbCwgY29udGVudCk7XG4gICAgfTtcbiAgICByZXR1cm4gTGlzdEl0ZW1Db250ZW50O1xufShyZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5RWxlbWVudEJhc2UpKTtcblxuUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlckVsZW1lbnQoXCJzdi1saXN0LWl0ZW0tY29udGVudFwiLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KGxpc3RfaXRlbV9jb250ZW50X0xpc3RJdGVtQ29udGVudCwgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9jb21wb25lbnRzL2xpc3QvbGlzdC1pdGVtLWdyb3VwLnRzeFxudmFyIGxpc3RfaXRlbV9ncm91cF9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cblxudmFyIGxpc3RfaXRlbV9ncm91cF9MaXN0SXRlbUdyb3VwID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIGxpc3RfaXRlbV9ncm91cF9leHRlbmRzKExpc3RJdGVtR3JvdXAsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTGlzdEl0ZW1Hcm91cCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoTGlzdEl0ZW1Hcm91cC5wcm90b3R5cGUsIFwibW9kZWxcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLm1vZGVsO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExpc3RJdGVtR3JvdXAucHJvdG90eXBlLCBcIml0ZW1cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLml0ZW07XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBMaXN0SXRlbUdyb3VwLnByb3RvdHlwZS5nZXRTdGF0ZUVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLml0ZW07XG4gICAgfTtcbiAgICBMaXN0SXRlbUdyb3VwLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgaWYgKCF0aGlzLml0ZW0pXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgdmFyIG5ld0VsZW1lbnQgPSBSZWFjdEVsZW1lbnRGYWN0b3J5Lkluc3RhbmNlLmNyZWF0ZUVsZW1lbnQoXCJzdi1saXN0LWl0ZW0tY29udGVudFwiLCB7IGl0ZW06IHRoaXMuaXRlbSwga2V5OiBcImNvbnRlbnRcIiArIHRoaXMuaXRlbS5pZCwgbW9kZWw6IHRoaXMubW9kZWwgfSk7XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5GcmFnbWVudCwgbnVsbCxcbiAgICAgICAgICAgIG5ld0VsZW1lbnQsXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQocG9wdXBfUG9wdXAsIHsgbW9kZWw6IChfYSA9IHRoaXMuaXRlbSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnBvcHVwTW9kZWwgfSkpO1xuICAgIH07XG4gICAgcmV0dXJuIExpc3RJdGVtR3JvdXA7XG59KHJlYWN0cXVlc3Rpb25fZWxlbWVudF9TdXJ2ZXlFbGVtZW50QmFzZSkpO1xuXG5SZWFjdEVsZW1lbnRGYWN0b3J5Lkluc3RhbmNlLnJlZ2lzdGVyRWxlbWVudChcInN2LWxpc3QtaXRlbS1ncm91cFwiLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KGxpc3RfaXRlbV9ncm91cF9MaXN0SXRlbUdyb3VwLCBwcm9wcyk7XG59KTtcblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL2NvbXBvbmVudHMvc3VydmV5LWhlYWRlci9sb2dvLWltYWdlLnRzeFxudmFyIGxvZ29faW1hZ2VfZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxudmFyIGxvZ29faW1hZ2VfTG9nb0ltYWdlID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIGxvZ29faW1hZ2VfZXh0ZW5kcyhMb2dvSW1hZ2UsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gTG9nb0ltYWdlKHByb3BzKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIuY2FsbCh0aGlzLCBwcm9wcykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KExvZ29JbWFnZS5wcm90b3R5cGUsIFwic3VydmV5XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5kYXRhO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgTG9nb0ltYWdlLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjb250ZW50ID0gW107XG4gICAgICAgIGNvbnRlbnQucHVzaChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBrZXk6IFwibG9nby1pbWFnZVwiLCBjbGFzc05hbWU6IHRoaXMuc3VydmV5LmxvZ29DbGFzc05hbWVzIH0sXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJpbWdcIiwgeyBjbGFzc05hbWU6IHRoaXMuc3VydmV5LmNzcy5sb2dvSW1hZ2UsIHNyYzogdGhpcy5zdXJ2ZXkubG9jTG9nby5yZW5kZXJlZEh0bWwsIGFsdDogdGhpcy5zdXJ2ZXkubG9jVGl0bGUucmVuZGVyZWRIdG1sLCB3aWR0aDogdGhpcy5zdXJ2ZXkucmVuZGVyZWRMb2dvV2lkdGgsIGhlaWdodDogdGhpcy5zdXJ2ZXkucmVuZGVyZWRMb2dvSGVpZ2h0LCBzdHlsZTogeyBvYmplY3RGaXQ6IHRoaXMuc3VydmV5LmxvZ29GaXQsIHdpZHRoOiB0aGlzLnN1cnZleS5yZW5kZXJlZFN0eWxlTG9nb1dpZHRoLCBoZWlnaHQ6IHRoaXMuc3VydmV5LnJlbmRlcmVkU3R5bGVMb2dvSGVpZ2h0IH0gfSkpKTtcbiAgICAgICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLkZyYWdtZW50LCBudWxsLCBjb250ZW50KTtcbiAgICB9O1xuICAgIHJldHVybiBMb2dvSW1hZ2U7XG59KGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuQ29tcG9uZW50KSk7XG5cblJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJFbGVtZW50KFwic3YtbG9nby1pbWFnZVwiLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KGxvZ29faW1hZ2VfTG9nb0ltYWdlLCBwcm9wcyk7XG59KTtcblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9wYWNrYWdlcy9zdXJ2ZXktcmVhY3QtdWkvc3JjL2NvbXBvbmVudHMvbWF0cml4LWFjdGlvbnMvcmVtb3ZlLWJ1dHRvbi9yZW1vdmUtYnV0dG9uLnRzeFxudmFyIHJlbW92ZV9idXR0b25fZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG52YXIgcmVtb3ZlX2J1dHRvbl9TdXJ2ZXlRdWVzdGlvbk1hdHJpeER5bmFtaWNSZW1vdmVCdXR0b24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgcmVtb3ZlX2J1dHRvbl9leHRlbmRzKFN1cnZleVF1ZXN0aW9uTWF0cml4RHluYW1pY1JlbW92ZUJ1dHRvbiwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlRdWVzdGlvbk1hdHJpeER5bmFtaWNSZW1vdmVCdXR0b24ocHJvcHMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLmhhbmRsZU9uUm93UmVtb3ZlQ2xpY2sgPSBfdGhpcy5oYW5kbGVPblJvd1JlbW92ZUNsaWNrLmJpbmQoX3RoaXMpO1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbk1hdHJpeER5bmFtaWNSZW1vdmVCdXR0b24ucHJvdG90eXBlLCBcInF1ZXN0aW9uXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5pdGVtLmRhdGEucXVlc3Rpb247XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5UXVlc3Rpb25NYXRyaXhEeW5hbWljUmVtb3ZlQnV0dG9uLnByb3RvdHlwZSwgXCJyb3dcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLml0ZW0uZGF0YS5yb3c7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlRdWVzdGlvbk1hdHJpeER5bmFtaWNSZW1vdmVCdXR0b24ucHJvdG90eXBlLmhhbmRsZU9uUm93UmVtb3ZlQ2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgdGhpcy5xdWVzdGlvbi5yZW1vdmVSb3dVSSh0aGlzLnJvdyk7XG4gICAgfTtcbiAgICBTdXJ2ZXlRdWVzdGlvbk1hdHJpeER5bmFtaWNSZW1vdmVCdXR0b24ucHJvdG90eXBlLnJlbmRlckVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciByZW1vdmVSb3dUZXh0ID0gdGhpcy5yZW5kZXJMb2NTdHJpbmcodGhpcy5xdWVzdGlvbi5sb2NSZW1vdmVSb3dUZXh0KTtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uZ2V0UmVtb3ZlUm93QnV0dG9uQ3NzKCksIHR5cGU6IFwiYnV0dG9uXCIsIG9uQ2xpY2s6IHRoaXMuaGFuZGxlT25Sb3dSZW1vdmVDbGljaywgZGlzYWJsZWQ6IHRoaXMucXVlc3Rpb24uaXNJbnB1dFJlYWRPbmx5IH0sXG4gICAgICAgICAgICByZW1vdmVSb3dUZXh0LFxuICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwic3BhblwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5jc3NDbGFzc2VzLmljb25SZW1vdmUgfSkpKTtcbiAgICB9O1xuICAgIHJldHVybiBTdXJ2ZXlRdWVzdGlvbk1hdHJpeER5bmFtaWNSZW1vdmVCdXR0b247XG59KFJlYWN0U3VydmV5RWxlbWVudCkpO1xuXG5SZWFjdEVsZW1lbnRGYWN0b3J5Lkluc3RhbmNlLnJlZ2lzdGVyRWxlbWVudChcInN2LW1hdHJpeC1yZW1vdmUtYnV0dG9uXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQocmVtb3ZlX2J1dHRvbl9TdXJ2ZXlRdWVzdGlvbk1hdHJpeER5bmFtaWNSZW1vdmVCdXR0b24sIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvY29tcG9uZW50cy9tYXRyaXgtYWN0aW9ucy9kZXRhaWwtYnV0dG9uL2RldGFpbC1idXR0b24udHN4XG52YXIgZGV0YWlsX2J1dHRvbl9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cblxudmFyIGRldGFpbF9idXR0b25fU3VydmV5UXVlc3Rpb25NYXRyaXhEZXRhaWxCdXR0b24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgZGV0YWlsX2J1dHRvbl9leHRlbmRzKFN1cnZleVF1ZXN0aW9uTWF0cml4RGV0YWlsQnV0dG9uLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uTWF0cml4RGV0YWlsQnV0dG9uKHByb3BzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5oYW5kbGVPblNob3dIaWRlQ2xpY2sgPSBfdGhpcy5oYW5kbGVPblNob3dIaWRlQ2xpY2suYmluZChfdGhpcyk7XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXhEZXRhaWxCdXR0b24ucHJvdG90eXBlLmdldFN0YXRlRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuaXRlbTtcbiAgICB9O1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbk1hdHJpeERldGFpbEJ1dHRvbi5wcm90b3R5cGUsIFwiaXRlbVwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMuaXRlbTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbk1hdHJpeERldGFpbEJ1dHRvbi5wcm90b3R5cGUsIFwicXVlc3Rpb25cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLml0ZW0uZGF0YS5xdWVzdGlvbjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlRdWVzdGlvbk1hdHJpeERldGFpbEJ1dHRvbi5wcm90b3R5cGUsIFwicm93XCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5pdGVtLmRhdGEucm93O1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3VydmV5UXVlc3Rpb25NYXRyaXhEZXRhaWxCdXR0b24ucHJvdG90eXBlLmhhbmRsZU9uU2hvd0hpZGVDbGljayA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICB0aGlzLnJvdy5zaG93SGlkZURldGFpbFBhbmVsQ2xpY2soKTtcbiAgICB9O1xuICAgIFN1cnZleVF1ZXN0aW9uTWF0cml4RGV0YWlsQnV0dG9uLnByb3RvdHlwZS5yZW5kZXJFbGVtZW50ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgaXNFeHBhbmRlZCA9IHRoaXMucm93LmlzRGV0YWlsUGFuZWxTaG93aW5nO1xuICAgICAgICB2YXIgYXJpYUV4cGFuZGVkID0gaXNFeHBhbmRlZDtcbiAgICAgICAgdmFyIGFyaWFDb250cm9scyA9IGlzRXhwYW5kZWQgPyB0aGlzLnJvdy5kZXRhaWxQYW5lbElkIDogdW5kZWZpbmVkO1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiLCB7IHR5cGU6IFwiYnV0dG9uXCIsIG9uQ2xpY2s6IHRoaXMuaGFuZGxlT25TaG93SGlkZUNsaWNrLCBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uZ2V0RGV0YWlsUGFuZWxCdXR0b25Dc3ModGhpcy5yb3cpLCBcImFyaWEtZXhwYW5kZWRcIjogYXJpYUV4cGFuZGVkLCBcImFyaWEtY29udHJvbHNcIjogYXJpYUNvbnRyb2xzIH0sXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoc3ZnX2ljb25fU3ZnSWNvbiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uZ2V0RGV0YWlsUGFuZWxJY29uQ3NzKHRoaXMucm93KSwgaWNvbk5hbWU6IHRoaXMucXVlc3Rpb24uZ2V0RGV0YWlsUGFuZWxJY29uSWQodGhpcy5yb3cpLCBzaXplOiBcImF1dG9cIiB9KSkpO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleVF1ZXN0aW9uTWF0cml4RGV0YWlsQnV0dG9uO1xufShSZWFjdFN1cnZleUVsZW1lbnQpKTtcblxuUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlckVsZW1lbnQoXCJzdi1tYXRyaXgtZGV0YWlsLWJ1dHRvblwiLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KGRldGFpbF9idXR0b25fU3VydmV5UXVlc3Rpb25NYXRyaXhEZXRhaWxCdXR0b24sIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvY29tcG9uZW50cy9wYW5lbGR5bmFtaWMtYWN0aW9ucy9wYW5lbGR5bmFtaWMtcmVtb3ZlLWJ0bi50c3hcbnZhciBwYW5lbGR5bmFtaWNfcmVtb3ZlX2J0bl9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cbnZhciBwYW5lbGR5bmFtaWNfcmVtb3ZlX2J0bl9TdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY1JlbW92ZUJ1dHRvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBwYW5lbGR5bmFtaWNfcmVtb3ZlX2J0bl9leHRlbmRzKFN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljUmVtb3ZlQnV0dG9uLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljUmVtb3ZlQnV0dG9uKCkge1xuICAgICAgICB2YXIgX3RoaXMgPSBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICAgICAgX3RoaXMuaGFuZGxlQ2xpY2sgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIF90aGlzLnF1ZXN0aW9uLnJlbW92ZVBhbmVsVUkoX3RoaXMuZGF0YS5wYW5lbCk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBfdGhpcztcbiAgICB9XG4gICAgU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNSZW1vdmVCdXR0b24ucHJvdG90eXBlLnJlbmRlckVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBidG5UZXh0ID0gdGhpcy5yZW5kZXJMb2NTdHJpbmcodGhpcy5xdWVzdGlvbi5sb2NQYW5lbFJlbW92ZVRleHQpO1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiLCB7IGNsYXNzTmFtZTogdGhpcy5xdWVzdGlvbi5nZXRQYW5lbFJlbW92ZUJ1dHRvbkNzcygpLCBvbkNsaWNrOiB0aGlzLmhhbmRsZUNsaWNrLCB0eXBlOiBcImJ1dHRvblwiIH0sXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIHsgY2xhc3NOYW1lOiB0aGlzLnF1ZXN0aW9uLmNzc0NsYXNzZXMuYnV0dG9uUmVtb3ZlVGV4dCB9LCBidG5UZXh0KSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcInNwYW5cIiwgeyBjbGFzc05hbWU6IHRoaXMucXVlc3Rpb24uY3NzQ2xhc3Nlcy5pY29uUmVtb3ZlIH0pKSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5UXVlc3Rpb25QYW5lbER5bmFtaWNSZW1vdmVCdXR0b247XG59KFN1cnZleVF1ZXN0aW9uUGFuZWxEeW5hbWljQWN0aW9uKSk7XG5cblJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJFbGVtZW50KFwic3YtcGFuZWxkeW5hbWljLXJlbW92ZS1idG5cIiwgZnVuY3Rpb24gKHByb3BzKSB7XG4gICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChwYW5lbGR5bmFtaWNfcmVtb3ZlX2J0bl9TdXJ2ZXlRdWVzdGlvblBhbmVsRHluYW1pY1JlbW92ZUJ1dHRvbiwgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9jb21wb25lbnRzL3N1cnZleS1hY3Rpb25zL3N1cnZleS1uYXYtYnV0dG9uLnRzeFxudmFyIHN1cnZleV9uYXZfYnV0dG9uX2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cblxudmFyIHN1cnZleV9uYXZfYnV0dG9uX1N1cnZleU5hdmlnYXRpb25CdXR0b24gPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgc3VydmV5X25hdl9idXR0b25fZXh0ZW5kcyhTdXJ2ZXlOYXZpZ2F0aW9uQnV0dG9uLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFN1cnZleU5hdmlnYXRpb25CdXR0b24oKSB7XG4gICAgICAgIHJldHVybiBfc3VwZXIgIT09IG51bGwgJiYgX3N1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykgfHwgdGhpcztcbiAgICB9XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleU5hdmlnYXRpb25CdXR0b24ucHJvdG90eXBlLCBcIml0ZW1cIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLml0ZW07XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBTdXJ2ZXlOYXZpZ2F0aW9uQnV0dG9uLnByb3RvdHlwZS5jYW5SZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLml0ZW0uaXNWaXNpYmxlO1xuICAgIH07XG4gICAgU3VydmV5TmF2aWdhdGlvbkJ1dHRvbi5wcm90b3R5cGUucmVuZGVyRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiLCB7IGNsYXNzTmFtZTogdGhpcy5pdGVtLmlubmVyQ3NzLCB0eXBlOiBcImJ1dHRvblwiLCBkaXNhYmxlZDogdGhpcy5pdGVtLmRpc2FibGVkLCBvbk1vdXNlRG93bjogdGhpcy5pdGVtLmRhdGEgJiYgdGhpcy5pdGVtLmRhdGEubW91c2VEb3duLCBvbkNsaWNrOiB0aGlzLml0ZW0uYWN0aW9uLCB0aXRsZTogdGhpcy5pdGVtLmdldFRvb2x0aXAoKSwgdmFsdWU6IHRoaXMuaXRlbS50aXRsZSB9KSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5TmF2aWdhdGlvbkJ1dHRvbjtcbn0oUmVhY3RTdXJ2ZXlFbGVtZW50KSk7XG5cblJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJFbGVtZW50KFwic3YtbmF2LWJ0blwiLCBmdW5jdGlvbiAocHJvcHMpIHtcbiAgICByZXR1cm4gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KHN1cnZleV9uYXZfYnV0dG9uX1N1cnZleU5hdmlnYXRpb25CdXR0b24sIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvc3RyaW5nLXZpZXdlci50c3hcbnZhciBzdHJpbmdfdmlld2VyX2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cblxudmFyIHN0cmluZ192aWV3ZXJfU3VydmV5TG9jU3RyaW5nVmlld2VyID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHN0cmluZ192aWV3ZXJfZXh0ZW5kcyhTdXJ2ZXlMb2NTdHJpbmdWaWV3ZXIsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gU3VydmV5TG9jU3RyaW5nVmlld2VyKHByb3BzKSB7XG4gICAgICAgIHZhciBfdGhpcyA9IF9zdXBlci5jYWxsKHRoaXMsIHByb3BzKSB8fCB0aGlzO1xuICAgICAgICBfdGhpcy5vbkNoYW5nZWRIYW5kbGVyID0gZnVuY3Rpb24gKHNlbmRlciwgb3B0aW9ucykge1xuICAgICAgICAgICAgaWYgKF90aGlzLmlzUmVuZGVyaW5nKVxuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIF90aGlzLnNldFN0YXRlKHsgY2hhbmdlZDogISFfdGhpcy5zdGF0ZSAmJiBfdGhpcy5zdGF0ZS5jaGFuZ2VkID8gX3RoaXMuc3RhdGUuY2hhbmdlZCArIDEgOiAxIH0pO1xuICAgICAgICB9O1xuICAgICAgICBfdGhpcy5yb290UmVmID0gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVSZWYoKTtcbiAgICAgICAgcmV0dXJuIF90aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoU3VydmV5TG9jU3RyaW5nVmlld2VyLnByb3RvdHlwZSwgXCJsb2NTdHJcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLmxvY1N0cjtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlMb2NTdHJpbmdWaWV3ZXIucHJvdG90eXBlLCBcInN0eWxlXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5zdHlsZTtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIFN1cnZleUxvY1N0cmluZ1ZpZXdlci5wcm90b3R5cGUuY29tcG9uZW50RGlkTW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMucmVhY3RPblN0ckNoYW5nZWQoKTtcbiAgICB9O1xuICAgIFN1cnZleUxvY1N0cmluZ1ZpZXdlci5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5sb2NTdHIpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubG9jU3RyLm9uU3RyaW5nQ2hhbmdlZC5yZW1vdmUodGhpcy5vbkNoYW5nZWRIYW5kbGVyKTtcbiAgICB9O1xuICAgIFN1cnZleUxvY1N0cmluZ1ZpZXdlci5wcm90b3R5cGUuY29tcG9uZW50RGlkVXBkYXRlID0gZnVuY3Rpb24gKHByZXZQcm9wcywgcHJldlN0YXRlKSB7XG4gICAgICAgIGlmICghIXByZXZQcm9wcy5sb2NTdHIpIHtcbiAgICAgICAgICAgIHByZXZQcm9wcy5sb2NTdHIub25TdHJpbmdDaGFuZ2VkLnJlbW92ZSh0aGlzLm9uQ2hhbmdlZEhhbmRsZXIpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVhY3RPblN0ckNoYW5nZWQoKTtcbiAgICB9O1xuICAgIFN1cnZleUxvY1N0cmluZ1ZpZXdlci5wcm90b3R5cGUucmVhY3RPblN0ckNoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5sb2NTdHIpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubG9jU3RyLm9uU3RyaW5nQ2hhbmdlZC5hZGQodGhpcy5vbkNoYW5nZWRIYW5kbGVyKTtcbiAgICB9O1xuICAgIFN1cnZleUxvY1N0cmluZ1ZpZXdlci5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMubG9jU3RyKVxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIHRoaXMuaXNSZW5kZXJpbmcgPSB0cnVlO1xuICAgICAgICB2YXIgc3RyRWwgPSB0aGlzLnJlbmRlclN0cmluZygpO1xuICAgICAgICB0aGlzLmlzUmVuZGVyaW5nID0gZmFsc2U7XG4gICAgICAgIHJldHVybiBzdHJFbDtcbiAgICB9O1xuICAgIFN1cnZleUxvY1N0cmluZ1ZpZXdlci5wcm90b3R5cGUucmVuZGVyU3RyaW5nID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY2xhc3NOYW1lID0gdGhpcy5sb2NTdHIuYWxsb3dMaW5lQnJlYWtzID8gXCJzdi1zdHJpbmctdmlld2VyIHN2LXN0cmluZy12aWV3ZXItLW11bHRpbGluZVwiIDogXCJzdi1zdHJpbmctdmlld2VyXCI7XG4gICAgICAgIGlmICh0aGlzLmxvY1N0ci5oYXNIdG1sKSB7XG4gICAgICAgICAgICB2YXIgaHRtbFZhbHVlID0geyBfX2h0bWw6IHRoaXMubG9jU3RyLnJlbmRlcmVkSHRtbCB9O1xuICAgICAgICAgICAgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcInNwYW5cIiwgeyByZWY6IHRoaXMucm9vdFJlZiwgY2xhc3NOYW1lOiBjbGFzc05hbWUsIHN0eWxlOiB0aGlzLnN0eWxlLCBkYW5nZXJvdXNseVNldElubmVySFRNTDogaHRtbFZhbHVlIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIsIHsgcmVmOiB0aGlzLnJvb3RSZWYsIGNsYXNzTmFtZTogY2xhc3NOYW1lLCBzdHlsZTogdGhpcy5zdHlsZSB9LCB0aGlzLmxvY1N0ci5yZW5kZXJlZEh0bWwpO1xuICAgIH07XG4gICAgcmV0dXJuIFN1cnZleUxvY1N0cmluZ1ZpZXdlcjtcbn0oZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5Db21wb25lbnQpKTtcblxuUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5yZWdpc3RlckVsZW1lbnQoZXh0ZXJuYWxfcm9vdF9TdXJ2ZXlfY29tbW9uanMyX3N1cnZleV9jb3JlX2NvbW1vbmpzX3N1cnZleV9jb3JlX2FtZF9zdXJ2ZXlfY29yZV9bXCJMb2NhbGl6YWJsZVN0cmluZ1wiXS5kZWZhdWx0UmVuZGVyZXIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoc3RyaW5nX3ZpZXdlcl9TdXJ2ZXlMb2NTdHJpbmdWaWV3ZXIsIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvY29tcG9uZW50cy9xdWVzdGlvbi1lcnJvci50c3hcbnZhciBxdWVzdGlvbl9lcnJvcl9leHRlbmRzID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19leHRlbmRzKSB8fCAoZnVuY3Rpb24gKCkge1xuICAgIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyA9IE9iamVjdC5zZXRQcm90b3R5cGVPZiB8fFxuICAgICAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxuICAgICAgICAgICAgZnVuY3Rpb24gKGQsIGIpIHsgZm9yICh2YXIgcCBpbiBiKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKGIsIHApKSBkW3BdID0gYltwXTsgfTtcbiAgICAgICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgfTtcbiAgICByZXR1cm4gZnVuY3Rpb24gKGQsIGIpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBiICE9PSBcImZ1bmN0aW9uXCIgJiYgYiAhPT0gbnVsbClcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDbGFzcyBleHRlbmRzIHZhbHVlIFwiICsgU3RyaW5nKGIpICsgXCIgaXMgbm90IGEgY29uc3RydWN0b3Igb3IgbnVsbFwiKTtcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICAgICAgZnVuY3Rpb24gX18oKSB7IHRoaXMuY29uc3RydWN0b3IgPSBkOyB9XG4gICAgICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcbiAgICB9O1xufSkoKTtcblxuXG5cbnZhciBxdWVzdGlvbl9lcnJvcl9RdWVzdGlvbkVycm9yQ29tcG9uZW50ID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIHF1ZXN0aW9uX2Vycm9yX2V4dGVuZHMoUXVlc3Rpb25FcnJvckNvbXBvbmVudCwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBRdWVzdGlvbkVycm9yQ29tcG9uZW50KCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFF1ZXN0aW9uRXJyb3JDb21wb25lbnQucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgbnVsbCxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcInNwYW5cIiwgeyBjbGFzc05hbWU6IHRoaXMucHJvcHMuY3NzQ2xhc3Nlcy5lcnJvci5pY29uIHx8IHVuZGVmaW5lZCwgXCJhcmlhLWhpZGRlblwiOiBcInRydWVcIiB9KSxcbiAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcInNwYW5cIiwgeyBjbGFzc05hbWU6IHRoaXMucHJvcHMuY3NzQ2xhc3Nlcy5lcnJvci5pdGVtIHx8IHVuZGVmaW5lZCB9LFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChzdHJpbmdfdmlld2VyX1N1cnZleUxvY1N0cmluZ1ZpZXdlciwgeyBsb2NTdHI6IHRoaXMucHJvcHMuZXJyb3IubG9jVGV4dCB9KSkpKTtcbiAgICB9O1xuICAgIHJldHVybiBRdWVzdGlvbkVycm9yQ29tcG9uZW50O1xufShleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLkNvbXBvbmVudCkpO1xuXG5SZWFjdEVsZW1lbnRGYWN0b3J5Lkluc3RhbmNlLnJlZ2lzdGVyRWxlbWVudChcInN2LXF1ZXN0aW9uLWVycm9yXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQocXVlc3Rpb25fZXJyb3JfUXVlc3Rpb25FcnJvckNvbXBvbmVudCwgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9jb21wb25lbnRzL3NrZWxldG9uLnRzeFxudmFyIHNrZWxldG9uX2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cbnZhciBza2VsZXRvbl9Ta2VsZXRvbiA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBza2VsZXRvbl9leHRlbmRzKFNrZWxldG9uLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIFNrZWxldG9uKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIFNrZWxldG9uLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgcmV0dXJuIChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3Ytc2tlbGV0b24tZWxlbWVudFwiLCBpZDogKF9hID0gdGhpcy5wcm9wcy5lbGVtZW50KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaWQgfSkpO1xuICAgIH07XG4gICAgcmV0dXJuIFNrZWxldG9uO1xufShleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLkNvbXBvbmVudCkpO1xuXG5SZWFjdEVsZW1lbnRGYWN0b3J5Lkluc3RhbmNlLnJlZ2lzdGVyRWxlbWVudChcInN2LXNrZWxldG9uXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoc2tlbGV0b25fU2tlbGV0b24sIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9zcmMvY29tcG9uZW50cy9oZWFkZXIudHN4XG52YXIgaGVhZGVyX2V4dGVuZHMgPSAodW5kZWZpbmVkICYmIHVuZGVmaW5lZC5fX2V4dGVuZHMpIHx8IChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XG4gICAgICAgICAgICAoeyBfX3Byb3RvX186IFtdIH0gaW5zdGFuY2VvZiBBcnJheSAmJiBmdW5jdGlvbiAoZCwgYikgeyBkLl9fcHJvdG9fXyA9IGI7IH0pIHx8XG4gICAgICAgICAgICBmdW5jdGlvbiAoZCwgYikgeyBmb3IgKHZhciBwIGluIGIpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwoYiwgcCkpIGRbcF0gPSBiW3BdOyB9O1xuICAgICAgICByZXR1cm4gZXh0ZW5kU3RhdGljcyhkLCBiKTtcbiAgICB9O1xuICAgIHJldHVybiBmdW5jdGlvbiAoZCwgYikge1xuICAgICAgICBpZiAodHlwZW9mIGIgIT09IFwiZnVuY3Rpb25cIiAmJiBiICE9PSBudWxsKVxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNsYXNzIGV4dGVuZHMgdmFsdWUgXCIgKyBTdHJpbmcoYikgKyBcIiBpcyBub3QgYSBjb25zdHJ1Y3RvciBvciBudWxsXCIpO1xuICAgICAgICBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cbiAgICAgICAgZC5wcm90b3R5cGUgPSBiID09PSBudWxsID8gT2JqZWN0LmNyZWF0ZShiKSA6IChfXy5wcm90b3R5cGUgPSBiLnByb3RvdHlwZSwgbmV3IF9fKCkpO1xuICAgIH07XG59KSgpO1xuXG5cblxuXG52YXIgaGVhZGVyX0hlYWRlck1vYmlsZSA9IC8qKiBAY2xhc3MgKi8gKGZ1bmN0aW9uIChfc3VwZXIpIHtcbiAgICBoZWFkZXJfZXh0ZW5kcyhIZWFkZXJNb2JpbGUsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSGVhZGVyTW9iaWxlKCkge1xuICAgICAgICByZXR1cm4gX3N1cGVyICE9PSBudWxsICYmIF9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpIHx8IHRoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShIZWFkZXJNb2JpbGUucHJvdG90eXBlLCBcIm1vZGVsXCIsIHtcbiAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5tb2RlbDtcbiAgICAgICAgfSxcbiAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZVxuICAgIH0pO1xuICAgIEhlYWRlck1vYmlsZS5wcm90b3R5cGUucmVuZGVyTG9nb0ltYWdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY29tcG9uZW50TmFtZSA9IHRoaXMubW9kZWwuc3VydmV5LmdldEVsZW1lbnRXcmFwcGVyQ29tcG9uZW50TmFtZSh0aGlzLm1vZGVsLnN1cnZleSwgXCJsb2dvLWltYWdlXCIpO1xuICAgICAgICB2YXIgY29tcG9uZW50RGF0YSA9IHRoaXMubW9kZWwuc3VydmV5LmdldEVsZW1lbnRXcmFwcGVyQ29tcG9uZW50RGF0YSh0aGlzLm1vZGVsLnN1cnZleSwgXCJsb2dvLWltYWdlXCIpO1xuICAgICAgICByZXR1cm4gUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5jcmVhdGVFbGVtZW50KGNvbXBvbmVudE5hbWUsIHtcbiAgICAgICAgICAgIGRhdGE6IGNvbXBvbmVudERhdGEsXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgSGVhZGVyTW9iaWxlLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN2LWhlYWRlci0tbW9iaWxlXCIgfSxcbiAgICAgICAgICAgIHRoaXMubW9kZWwuc3VydmV5Lmhhc0xvZ28gPyAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwiZGl2XCIsIHsgY2xhc3NOYW1lOiBcInN2LWhlYWRlcl9fbG9nb1wiIH0sIHRoaXMucmVuZGVyTG9nb0ltYWdlKCkpKSA6IG51bGwsXG4gICAgICAgICAgICB0aGlzLm1vZGVsLnN1cnZleS5oYXNUaXRsZSA/IChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3YtaGVhZGVyX190aXRsZVwiLCBzdHlsZTogeyBtYXhXaWR0aDogdGhpcy5tb2RlbC50ZXh0QXJlYVdpZHRoIH0gfSxcbiAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQodGl0bGVfZWxlbWVudF9UaXRsZUVsZW1lbnQsIHsgZWxlbWVudDogdGhpcy5tb2RlbC5zdXJ2ZXkgfSkpKSA6IG51bGwsXG4gICAgICAgICAgICB0aGlzLm1vZGVsLnN1cnZleS5yZW5kZXJlZEhhc0Rlc2NyaXB0aW9uID8gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzdi1oZWFkZXJfX2Rlc2NyaXB0aW9uXCIsIHN0eWxlOiB7IG1heFdpZHRoOiB0aGlzLm1vZGVsLnRleHRBcmVhV2lkdGggfSB9LFxuICAgICAgICAgICAgICAgIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5tb2RlbC5zdXJ2ZXkuY3NzLmRlc2NyaXB0aW9uIH0sIHJlYWN0cXVlc3Rpb25fZWxlbWVudF9TdXJ2ZXlFbGVtZW50QmFzZS5yZW5kZXJMb2NTdHJpbmcodGhpcy5tb2RlbC5zdXJ2ZXkubG9jRGVzY3JpcHRpb24pKSkpIDogbnVsbCkpO1xuICAgIH07XG4gICAgcmV0dXJuIEhlYWRlck1vYmlsZTtcbn0oZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5Db21wb25lbnQpKTtcblxudmFyIGhlYWRlcl9IZWFkZXJDZWxsID0gLyoqIEBjbGFzcyAqLyAoZnVuY3Rpb24gKF9zdXBlcikge1xuICAgIGhlYWRlcl9leHRlbmRzKEhlYWRlckNlbGwsIF9zdXBlcik7XG4gICAgZnVuY3Rpb24gSGVhZGVyQ2VsbCgpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSGVhZGVyQ2VsbC5wcm90b3R5cGUsIFwibW9kZWxcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLm1vZGVsO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgSGVhZGVyQ2VsbC5wcm90b3R5cGUucmVuZGVyTG9nb0ltYWdlID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgY29tcG9uZW50TmFtZSA9IHRoaXMubW9kZWwuc3VydmV5LmdldEVsZW1lbnRXcmFwcGVyQ29tcG9uZW50TmFtZSh0aGlzLm1vZGVsLnN1cnZleSwgXCJsb2dvLWltYWdlXCIpO1xuICAgICAgICB2YXIgY29tcG9uZW50RGF0YSA9IHRoaXMubW9kZWwuc3VydmV5LmdldEVsZW1lbnRXcmFwcGVyQ29tcG9uZW50RGF0YSh0aGlzLm1vZGVsLnN1cnZleSwgXCJsb2dvLWltYWdlXCIpO1xuICAgICAgICByZXR1cm4gUmVhY3RFbGVtZW50RmFjdG9yeS5JbnN0YW5jZS5jcmVhdGVFbGVtZW50KGNvbXBvbmVudE5hbWUsIHtcbiAgICAgICAgICAgIGRhdGE6IGNvbXBvbmVudERhdGEsXG4gICAgICAgIH0pO1xuICAgIH07XG4gICAgSGVhZGVyQ2VsbC5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5tb2RlbC5jc3MsIHN0eWxlOiB0aGlzLm1vZGVsLnN0eWxlIH0sXG4gICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3YtaGVhZGVyX19jZWxsLWNvbnRlbnRcIiwgc3R5bGU6IHRoaXMubW9kZWwuY29udGVudFN0eWxlIH0sXG4gICAgICAgICAgICAgICAgdGhpcy5tb2RlbC5zaG93TG9nbyA/IChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3YtaGVhZGVyX19sb2dvXCIgfSwgdGhpcy5yZW5kZXJMb2dvSW1hZ2UoKSkpIDogbnVsbCxcbiAgICAgICAgICAgICAgICB0aGlzLm1vZGVsLnNob3dUaXRsZSA/IChleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IFwic3YtaGVhZGVyX190aXRsZVwiLCBzdHlsZTogeyBtYXhXaWR0aDogdGhpcy5tb2RlbC50ZXh0QXJlYVdpZHRoIH0gfSxcbiAgICAgICAgICAgICAgICAgICAgZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KHRpdGxlX2VsZW1lbnRfVGl0bGVFbGVtZW50LCB7IGVsZW1lbnQ6IHRoaXMubW9kZWwuc3VydmV5IH0pKSkgOiBudWxsLFxuICAgICAgICAgICAgICAgIHRoaXMubW9kZWwuc2hvd0Rlc2NyaXB0aW9uID8gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogXCJzdi1oZWFkZXJfX2Rlc2NyaXB0aW9uXCIsIHN0eWxlOiB7IG1heFdpZHRoOiB0aGlzLm1vZGVsLnRleHRBcmVhV2lkdGggfSB9LFxuICAgICAgICAgICAgICAgICAgICBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBjbGFzc05hbWU6IHRoaXMubW9kZWwuc3VydmV5LmNzcy5kZXNjcmlwdGlvbiB9LCByZWFjdHF1ZXN0aW9uX2VsZW1lbnRfU3VydmV5RWxlbWVudEJhc2UucmVuZGVyTG9jU3RyaW5nKHRoaXMubW9kZWwuc3VydmV5LmxvY0Rlc2NyaXB0aW9uKSkpKSA6IG51bGwpKSk7XG4gICAgfTtcbiAgICByZXR1cm4gSGVhZGVyQ2VsbDtcbn0oZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5Db21wb25lbnQpKTtcblxudmFyIGhlYWRlcl9IZWFkZXIgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgaGVhZGVyX2V4dGVuZHMoSGVhZGVyLCBfc3VwZXIpO1xuICAgIGZ1bmN0aW9uIEhlYWRlcigpIHtcbiAgICAgICAgcmV0dXJuIF9zdXBlciAhPT0gbnVsbCAmJiBfc3VwZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKSB8fCB0aGlzO1xuICAgIH1cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoSGVhZGVyLnByb3RvdHlwZSwgXCJtb2RlbFwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMubW9kZWw7XG4gICAgICAgIH0sXG4gICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICB9KTtcbiAgICBIZWFkZXIucHJvdG90eXBlLmdldFN0YXRlRWxlbWVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubW9kZWw7XG4gICAgfTtcbiAgICBIZWFkZXIucHJvdG90eXBlLnJlbmRlckVsZW1lbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMubW9kZWwuc3VydmV5ID0gdGhpcy5wcm9wcy5zdXJ2ZXk7XG4gICAgICAgIGlmICghKHRoaXMucHJvcHMuc3VydmV5LmhlYWRlclZpZXcgPT09IFwiYWR2YW5jZWRcIikpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHZhciBoZWFkZXJDb250ZW50ID0gbnVsbDtcbiAgICAgICAgaWYgKHRoaXMucHJvcHMuc3VydmV5LmlzTW9iaWxlKSB7XG4gICAgICAgICAgICBoZWFkZXJDb250ZW50ID0gZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KGhlYWRlcl9IZWFkZXJNb2JpbGUsIHsgbW9kZWw6IHRoaXMubW9kZWwgfSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBoZWFkZXJDb250ZW50ID0gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5tb2RlbC5jb250ZW50Q2xhc3Nlcywgc3R5bGU6IHsgbWF4V2lkdGg6IHRoaXMubW9kZWwubWF4V2lkdGggfSB9LCB0aGlzLm1vZGVsLmNlbGxzLm1hcChmdW5jdGlvbiAoY2VsbCwgaW5kZXgpIHsgcmV0dXJuIGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChoZWFkZXJfSGVhZGVyQ2VsbCwgeyBrZXk6IGluZGV4LCBtb2RlbDogY2VsbCB9KTsgfSkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gKGV4dGVybmFsX3Jvb3RfUmVhY3RfY29tbW9uanMyX3JlYWN0X2NvbW1vbmpzX3JlYWN0X2FtZF9yZWFjdF9kZWZhdWx0LmEuY3JlYXRlRWxlbWVudChcImRpdlwiLCB7IGNsYXNzTmFtZTogdGhpcy5tb2RlbC5oZWFkZXJDbGFzc2VzLCBzdHlsZTogeyBoZWlnaHQ6IHRoaXMubW9kZWwucmVuZGVyZWRIZWlnaHQgfSB9LFxuICAgICAgICAgICAgdGhpcy5tb2RlbC5iYWNrZ3JvdW5kSW1hZ2UgPyBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiwgeyBzdHlsZTogdGhpcy5tb2RlbC5iYWNrZ3JvdW5kSW1hZ2VTdHlsZSwgY2xhc3NOYW1lOiB0aGlzLm1vZGVsLmJhY2tncm91bmRJbWFnZUNsYXNzZXMgfSkgOiBudWxsLFxuICAgICAgICAgICAgaGVhZGVyQ29udGVudCkpO1xuICAgIH07XG4gICAgcmV0dXJuIEhlYWRlcjtcbn0ocmVhY3RxdWVzdGlvbl9lbGVtZW50X1N1cnZleUVsZW1lbnRCYXNlKSk7XG5cblJlYWN0RWxlbWVudEZhY3RvcnkuSW5zdGFuY2UucmVnaXN0ZXJFbGVtZW50KFwic3YtaGVhZGVyXCIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoaGVhZGVyX0hlYWRlciwgcHJvcHMpO1xufSk7XG5cbi8vIENPTkNBVEVOQVRFRCBNT0RVTEU6IC4vcGFja2FnZXMvc3VydmV5LXJlYWN0LXVpL3NyYy9zdHJpbmctZWRpdG9yLnRzeFxudmFyIHN0cmluZ19lZGl0b3JfZXh0ZW5kcyA9ICh1bmRlZmluZWQgJiYgdW5kZWZpbmVkLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgZXh0ZW5kU3RhdGljcyA9IGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHxcbiAgICAgICAgICAgICh7IF9fcHJvdG9fXzogW10gfSBpbnN0YW5jZW9mIEFycmF5ICYmIGZ1bmN0aW9uIChkLCBiKSB7IGQuX19wcm90b19fID0gYjsgfSkgfHxcbiAgICAgICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChiLCBwKSkgZFtwXSA9IGJbcF07IH07XG4gICAgICAgIHJldHVybiBleHRlbmRTdGF0aWNzKGQsIGIpO1xuICAgIH07XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XG4gICAgICAgIGlmICh0eXBlb2YgYiAhPT0gXCJmdW5jdGlvblwiICYmIGIgIT09IG51bGwpXG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSBcIiArIFN0cmluZyhiKSArIFwiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGxcIik7XG4gICAgICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XG4gICAgICAgIGZ1bmN0aW9uIF9fKCkgeyB0aGlzLmNvbnN0cnVjdG9yID0gZDsgfVxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XG4gICAgfTtcbn0pKCk7XG5cblxuXG52YXIgc3RyaW5nX2VkaXRvcl9TdXJ2ZXlMb2NTdHJpbmdFZGl0b3IgPSAvKiogQGNsYXNzICovIChmdW5jdGlvbiAoX3N1cGVyKSB7XG4gICAgc3RyaW5nX2VkaXRvcl9leHRlbmRzKFN1cnZleUxvY1N0cmluZ0VkaXRvciwgX3N1cGVyKTtcbiAgICBmdW5jdGlvbiBTdXJ2ZXlMb2NTdHJpbmdFZGl0b3IocHJvcHMpIHtcbiAgICAgICAgdmFyIF90aGlzID0gX3N1cGVyLmNhbGwodGhpcywgcHJvcHMpIHx8IHRoaXM7XG4gICAgICAgIF90aGlzLm9uSW5wdXQgPSBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgICAgIF90aGlzLmxvY1N0ci50ZXh0ID0gZXZlbnQudGFyZ2V0LmlubmVyVGV4dDtcbiAgICAgICAgfTtcbiAgICAgICAgX3RoaXMub25DbGljayA9IGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICB9O1xuICAgICAgICBfdGhpcy5zdGF0ZSA9IHsgY2hhbmdlZDogMCB9O1xuICAgICAgICByZXR1cm4gX3RoaXM7XG4gICAgfVxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShTdXJ2ZXlMb2NTdHJpbmdFZGl0b3IucHJvdG90eXBlLCBcImxvY1N0clwiLCB7XG4gICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMucHJvcHMubG9jU3RyO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFN1cnZleUxvY1N0cmluZ0VkaXRvci5wcm90b3R5cGUsIFwic3R5bGVcIiwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLnN0eWxlO1xuICAgICAgICB9LFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlXG4gICAgfSk7XG4gICAgU3VydmV5TG9jU3RyaW5nRWRpdG9yLnByb3RvdHlwZS5jb21wb25lbnREaWRNb3VudCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWYgKCF0aGlzLmxvY1N0cilcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgICAgICB0aGlzLmxvY1N0ci5vbkNoYW5nZWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICBzZWxmLnNldFN0YXRlKHsgY2hhbmdlZDogc2VsZi5zdGF0ZS5jaGFuZ2VkICsgMSB9KTtcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFN1cnZleUxvY1N0cmluZ0VkaXRvci5wcm90b3R5cGUuY29tcG9uZW50V2lsbFVubW91bnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghdGhpcy5sb2NTdHIpXG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIHRoaXMubG9jU3RyLm9uQ2hhbmdlZCA9IGZ1bmN0aW9uICgpIHsgfTtcbiAgICB9O1xuICAgIFN1cnZleUxvY1N0cmluZ0VkaXRvci5wcm90b3R5cGUucmVuZGVyID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoIXRoaXMubG9jU3RyKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5sb2NTdHIuaGFzSHRtbCkge1xuICAgICAgICAgICAgdmFyIGh0bWxWYWx1ZSA9IHsgX19odG1sOiB0aGlzLmxvY1N0ci5yZW5kZXJlZEh0bWwgfTtcbiAgICAgICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwic3BhblwiLCB7IGNsYXNzTmFtZTogXCJzdi1zdHJpbmctZWRpdG9yXCIsIGNvbnRlbnRFZGl0YWJsZTogXCJ0cnVlXCIsIHN1cHByZXNzQ29udGVudEVkaXRhYmxlV2FybmluZzogdHJ1ZSwgc3R5bGU6IHRoaXMuc3R5bGUsIGRhbmdlcm91c2x5U2V0SW5uZXJIVE1MOiBodG1sVmFsdWUsIG9uQmx1cjogdGhpcy5vbklucHV0LCBvbkNsaWNrOiB0aGlzLm9uQ2xpY2sgfSkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAoZXh0ZXJuYWxfcm9vdF9SZWFjdF9jb21tb25qczJfcmVhY3RfY29tbW9uanNfcmVhY3RfYW1kX3JlYWN0X2RlZmF1bHQuYS5jcmVhdGVFbGVtZW50KFwic3BhblwiLCB7IGNsYXNzTmFtZTogXCJzdi1zdHJpbmctZWRpdG9yXCIsIGNvbnRlbnRFZGl0YWJsZTogXCJ0cnVlXCIsIHN1cHByZXNzQ29udGVudEVkaXRhYmxlV2FybmluZzogdHJ1ZSwgc3R5bGU6IHRoaXMuc3R5bGUsIG9uQmx1cjogdGhpcy5vbklucHV0LCBvbkNsaWNrOiB0aGlzLm9uQ2xpY2sgfSwgdGhpcy5sb2NTdHIucmVuZGVyZWRIdG1sKSk7XG4gICAgfTtcbiAgICByZXR1cm4gU3VydmV5TG9jU3RyaW5nRWRpdG9yO1xufShleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLkNvbXBvbmVudCkpO1xuXG5SZWFjdEVsZW1lbnRGYWN0b3J5Lkluc3RhbmNlLnJlZ2lzdGVyRWxlbWVudChleHRlcm5hbF9yb290X1N1cnZleV9jb21tb25qczJfc3VydmV5X2NvcmVfY29tbW9uanNfc3VydmV5X2NvcmVfYW1kX3N1cnZleV9jb3JlX1tcIkxvY2FsaXphYmxlU3RyaW5nXCJdLmVkaXRhYmxlUmVuZGVyZXIsIGZ1bmN0aW9uIChwcm9wcykge1xuICAgIHJldHVybiBleHRlcm5hbF9yb290X1JlYWN0X2NvbW1vbmpzMl9yZWFjdF9jb21tb25qc19yZWFjdF9hbWRfcmVhY3RfZGVmYXVsdC5hLmNyZWF0ZUVsZW1lbnQoc3RyaW5nX2VkaXRvcl9TdXJ2ZXlMb2NTdHJpbmdFZGl0b3IsIHByb3BzKTtcbn0pO1xuXG4vLyBDT05DQVRFTkFURUQgTU9EVUxFOiAuL3BhY2thZ2VzL3N1cnZleS1yZWFjdC11aS9lbnRyaWVzL3JlYWN0LXVpLW1vZGVsLnRzXG4vLyByZWFjdFxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuLy9VbmNvbW1lbnQgdG8gaW5jbHVkZSB0aGUgXCJkYXRlXCIgcXVlc3Rpb24gdHlwZS5cbi8vZXhwb3J0IHtkZWZhdWx0IGFzIFN1cnZleVF1ZXN0aW9uRGF0ZX0gZnJvbSBcIi4uL3BsdWdpbnMvcmVhY3QvcmVhY3RxdWVzdGlvbmRhdGVcIjtcblxuLy8gQ09OQ0FURU5BVEVEIE1PRFVMRTogLi9zcmMvZW50cmllcy9yZWFjdC11aS50c1xuXG5cblxuT2JqZWN0KGV4dGVybmFsX3Jvb3RfU3VydmV5X2NvbW1vbmpzMl9zdXJ2ZXlfY29yZV9jb21tb25qc19zdXJ2ZXlfY29yZV9hbWRfc3VydmV5X2NvcmVfW1wiY2hlY2tMaWJyYXJ5VmVyc2lvblwiXSkoXCJcIiArIFwiMS4xMS4xM1wiLCBcInN1cnZleS1yZWFjdC11aVwiKTtcblxuXG4vKioqLyB9KSxcblxuLyoqKi8gXCJyZWFjdFwiOlxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogZXh0ZXJuYWwge1wicm9vdFwiOlwiUmVhY3RcIixcImNvbW1vbmpzMlwiOlwicmVhY3RcIixcImNvbW1vbmpzXCI6XCJyZWFjdFwiLFwiYW1kXCI6XCJyZWFjdFwifSAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cbi8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxubW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX3JlYWN0X187XG5cbi8qKiovIH0pLFxuXG4vKioqLyBcInJlYWN0LWRvbVwiOlxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiohKlxcXG4gICEqKiogZXh0ZXJuYWwge1wicm9vdFwiOlwiUmVhY3RET01cIixcImNvbW1vbmpzMlwiOlwicmVhY3QtZG9tXCIsXCJjb21tb25qc1wiOlwicmVhY3QtZG9tXCIsXCJhbWRcIjpcInJlYWN0LWRvbVwifSAqKiohXG4gIFxcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cbi8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxubW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX3JlYWN0X2RvbV9fO1xuXG4vKioqLyB9KSxcblxuLyoqKi8gXCJzdXJ2ZXktY29yZVwiOlxuLyohKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqISpcXFxuICAhKioqIGV4dGVybmFsIHtcInJvb3RcIjpcIlN1cnZleVwiLFwiY29tbW9uanMyXCI6XCJzdXJ2ZXktY29yZVwiLFwiY29tbW9uanNcIjpcInN1cnZleS1jb3JlXCIsXCJhbWRcIjpcInN1cnZleS1jb3JlXCJ9ICoqKiFcbiAgXFwqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG4vKiEgbm8gc3RhdGljIGV4cG9ydHMgZm91bmQgKi9cbi8qISBNb2R1bGVDb25jYXRlbmF0aW9uIGJhaWxvdXQ6IE1vZHVsZSBpcyBub3QgYW4gRUNNQVNjcmlwdCBtb2R1bGUgKi9cbi8qKiovIChmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMpIHtcblxubW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX3N1cnZleV9jb3JlX187XG5cbi8qKiovIH0pXG5cbi8qKioqKiovIH0pO1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1zdXJ2ZXktcmVhY3QtdWkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/.pnpm/survey-react-ui@1.11.13_react-dom@18.3.1_react@18.3.1__react@18.3.1_survey-core@1.11.13/node_modules/survey-react-ui/survey-react-ui.js\n");

/***/ })

};
;